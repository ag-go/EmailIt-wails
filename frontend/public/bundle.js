var app=function(){"use strict";function t(){}function e(t){return t()}function i(){return Object.create(null)}function n(t){t.forEach(e)}function r(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function o(e,i,n){e.$$.on_destroy.push(function(e,...i){if(null==e)return t;const n=e.subscribe(...i);return n.unsubscribe?()=>n.unsubscribe():n}(i,n))}function l(t,e,i,n){if(t){const r=a(t,e,i,n);return t[0](r)}}function a(t,e,i,n){return t[1]&&n?function(t,e){for(const i in e)t[i]=e[i];return t}(i.ctx.slice(),t[1](n(e))):i.ctx}function h(t,e,i,n){if(t[2]&&n){const r=t[2](n(i));if(void 0===e.dirty)return r;if("object"==typeof r){const t=[],i=Math.max(e.dirty.length,r.length);for(let n=0;n<i;n+=1)t[n]=e.dirty[n]|r[n];return t}return e.dirty|r}return e.dirty}function c(t,e,i,n,r,s){if(r){const o=a(e,i,n,s);t.p(o,r)}}function u(t){if(t.ctx.length>32){const e=[],i=t.ctx.length/32;for(let t=0;t<i;t++)e[t]=-1;return e}return-1}function f(t,e,i){return t.set(i),e}function d(t,e){t.appendChild(e)}function p(t,e,i){t.insertBefore(e,i||null)}function g(t){t.parentNode.removeChild(t)}function m(t,e){for(let i=0;i<t.length;i+=1)t[i]&&t[i].d(e)}function b(t){return document.createElement(t)}function O(t){return document.createTextNode(t)}function v(){return O(" ")}function w(){return O("")}function y(t,e,i,n){return t.addEventListener(e,i,n),()=>t.removeEventListener(e,i,n)}function x(t,e,i){null==i?t.removeAttribute(e):t.getAttribute(e)!==i&&t.setAttribute(e,i)}function k(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function S(t,e){t.value=null==e?"":e}function C(t,e,i,n){null===i?t.style.removeProperty(e):t.style.setProperty(e,i,n?"important":"")}function A(t,e){for(let i=0;i<t.options.length;i+=1){const n=t.options[i];if(n.__value===e)return void(n.selected=!0)}t.selectedIndex=-1}function T(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function P(t,e,i){t.classList[i?"add":"remove"](e)}class M{constructor(t=!1){this.is_svg=!1,this.is_svg=t,this.e=this.n=null}c(t){this.h(t)}m(t,e,i=null){this.e||(this.is_svg?this.e=function(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}(e.nodeName):this.e=b(e.nodeName),this.t=e,this.c(t)),this.i(i)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)p(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(g)}}let Q;function R(t){Q=t}function $(){if(!Q)throw new Error("Function called outside component initialization");return Q}function _(t){$().$$.on_mount.push(t)}function D(t){$().$$.after_update.push(t)}function E(){const t=$();return(e,i,{cancelable:n=!1}={})=>{const r=t.$$.callbacks[e];if(r){const s=function(t,e,{bubbles:i=!1,cancelable:n=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,i,n,e),r}(e,i,{cancelable:n});return r.slice().forEach((e=>{e.call(t,s)})),!s.defaultPrevented}return!0}}const N=[],B=[],I=[],z=[],L=Promise.resolve();let W=!1;function V(){W||(W=!0,L.then(Z))}function j(){return V(),L}function q(t){I.push(t)}function H(t){z.push(t)}const X=new Set;let F=0;function Z(){const t=Q;do{for(;F<N.length;){const t=N[F];F++,R(t),G(t.$$)}for(R(null),N.length=0,F=0;B.length;)B.pop()();for(let t=0;t<I.length;t+=1){const e=I[t];X.has(e)||(X.add(e),e())}I.length=0}while(N.length);for(;z.length;)z.pop()();W=!1,X.clear(),R(t)}function G(t){if(null!==t.fragment){t.update(),n(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(q)}}const U=new Set;let Y;function K(){Y={r:0,c:[],p:Y}}function J(){Y.r||n(Y.c),Y=Y.p}function tt(t,e){t&&t.i&&(U.delete(t),t.i(e))}function et(t,e,i,n){if(t&&t.o){if(U.has(t))return;U.add(t),Y.c.push((()=>{U.delete(t),n&&(i&&t.d(1),n())})),t.o(e)}else n&&n()}function it(t,e,i){const n=t.$$.props[e];void 0!==n&&(t.$$.bound[n]=i,i(t.$$.ctx[n]))}function nt(t){t&&t.c()}function rt(t,i,s,o){const{fragment:l,on_mount:a,on_destroy:h,after_update:c}=t.$$;l&&l.m(i,s),o||q((()=>{const i=a.map(e).filter(r);h?h.push(...i):n(i),t.$$.on_mount=[]})),c.forEach(q)}function st(t,e){const i=t.$$;null!==i.fragment&&(n(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function ot(e,r,s,o,l,a,h,c=[-1]){const u=Q;R(e);const f=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:l,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(u?u.$$.context:[])),callbacks:i(),dirty:c,skip_bound:!1,root:r.target||u.$$.root};h&&h(f.root);let d=!1;if(f.ctx=s?s(e,r.props||{},((t,i,...n)=>{const r=n.length?n[0]:i;return f.ctx&&l(f.ctx[t],f.ctx[t]=r)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](r),d&&function(t,e){-1===t.$$.dirty[0]&&(N.push(t),V(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),i})):[],f.update(),d=!0,n(f.before_update),f.fragment=!!o&&o(f.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);f.fragment&&f.fragment.l(t),t.forEach(g)}else f.fragment&&f.fragment.c();r.intro&&tt(e.$$.fragment),rt(e,r.target,r.anchor,r.customElement),Z()}R(u)}class lt{$destroy(){st(this,1),this.$destroy=t}$on(t,e){const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(e),()=>{const t=i.indexOf(e);-1!==t&&i.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}class at{constructor(){}lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,i){let n=[];return this.decompose(0,t,n,2),i.length&&i.decompose(0,i.length,n,3),this.decompose(e,this.length,n,1),ct.from(n,this.length-(e-t)+i.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){let i=[];return this.decompose(t,e,i,0),ct.from(i,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),i=this.length-this.scanIdentical(t,-1),n=new dt(this),r=new dt(t);for(let t=e,s=e;;){if(n.next(t),r.next(t),t=0,n.lineBreak!=r.lineBreak||n.done!=r.done||n.value!=r.value)return!1;if(s+=n.value.length,n.done||s>=i)return!0}}iter(t=1){return new dt(this,t)}iterRange(t,e=this.length){return new pt(this,t,e)}iterLines(t,e){let i;if(null==t)i=this.iter();else{null==e&&(e=this.lines+1);let n=this.line(t).from;i=this.iterRange(n,Math.max(n,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new gt(i)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}static of(t){if(0==t.length)throw new RangeError("A document must have at least one line");return 1!=t.length||t[0]?t.length<=32?new ht(t):ct.from(ht.split(t,[])):at.empty}}class ht extends at{constructor(t,e=function(t){let e=-1;for(let i of t)e+=i.length+1;return e}(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,i,n){for(let r=0;;r++){let s=this.text[r],o=n+s.length;if((e?i:o)>=t)return new mt(n,o,i,s);n=o+1,i++}}decompose(t,e,i,n){let r=t<=0&&e>=this.length?this:new ht(ft(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(1&n){let t=i.pop(),e=ut(r.text,t.text.slice(),0,r.length);if(e.length<=32)i.push(new ht(e,t.length+r.length));else{let t=e.length>>1;i.push(new ht(e.slice(0,t)),new ht(e.slice(t)))}}else i.push(r)}replace(t,e,i){if(!(i instanceof ht))return super.replace(t,e,i);let n=ut(this.text,ut(i.text,ft(this.text,0,t)),e),r=this.length+i.length-(e-t);return n.length<=32?new ht(n,r):ct.from(ht.split(n,[]),r)}sliceString(t,e=this.length,i="\n"){let n="";for(let r=0,s=0;r<=e&&s<this.text.length;s++){let o=this.text[s],l=r+o.length;r>t&&s&&(n+=i),t<l&&e>r&&(n+=o.slice(Math.max(0,t-r),e-r)),r=l+1}return n}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let i=[],n=-1;for(let r of t)i.push(r),n+=r.length+1,32==i.length&&(e.push(new ht(i,n)),i=[],n=-1);return n>-1&&e.push(new ht(i,n)),e}}class ct extends at{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let e of t)this.lines+=e.lines}lineInner(t,e,i,n){for(let r=0;;r++){let s=this.children[r],o=n+s.length,l=i+s.lines-1;if((e?l:o)>=t)return s.lineInner(t,e,i,n);n=o+1,i=l+1}}decompose(t,e,i,n){for(let r=0,s=0;s<=e&&r<this.children.length;r++){let o=this.children[r],l=s+o.length;if(t<=l&&e>=s){let r=n&((s<=t?1:0)|(l>=e?2:0));s>=t&&l<=e&&!r?i.push(o):o.decompose(t-s,e-s,i,r)}s=l+1}}replace(t,e,i){if(i.lines<this.lines)for(let n=0,r=0;n<this.children.length;n++){let s=this.children[n],o=r+s.length;if(t>=r&&e<=o){let l=s.replace(t-r,e-r,i),a=this.lines-s.lines+l.lines;if(l.lines<a>>4&&l.lines>a>>6){let r=this.children.slice();return r[n]=l,new ct(r,this.length-(e-t)+i.length)}return super.replace(r,o,l)}r=o+1}return super.replace(t,e,i)}sliceString(t,e=this.length,i="\n"){let n="";for(let r=0,s=0;r<this.children.length&&s<=e;r++){let o=this.children[r],l=s+o.length;s>t&&r&&(n+=i),t<l&&e>s&&(n+=o.sliceString(t-s,e-s,i)),s=l+1}return n}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof ct))return 0;let i=0,[n,r,s,o]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;n+=e,r+=e){if(n==s||r==o)return i;let l=this.children[n],a=t.children[r];if(l!=a)return i+l.scanIdentical(a,e);i+=l.length+1}}static from(t,e=t.reduce(((t,e)=>t+e.length+1),-1)){let i=0;for(let e of t)i+=e.lines;if(i<32){let i=[];for(let e of t)e.flatten(i);return new ht(i,e)}let n=Math.max(32,i>>5),r=n<<1,s=n>>1,o=[],l=0,a=-1,h=[];function c(t){let e;if(t.lines>r&&t instanceof ct)for(let e of t.children)c(e);else t.lines>s&&(l>s||!l)?(u(),o.push(t)):t instanceof ht&&l&&(e=h[h.length-1])instanceof ht&&t.lines+e.lines<=32?(l+=t.lines,a+=t.length+1,h[h.length-1]=new ht(e.text.concat(t.text),e.length+1+t.length)):(l+t.lines>n&&u(),l+=t.lines,a+=t.length+1,h.push(t))}function u(){0!=l&&(o.push(1==h.length?h[0]:ct.from(h,a)),a=-1,l=h.length=0)}for(let e of t)c(e);return u(),1==o.length?o[0]:new ct(o,e)}}function ut(t,e,i=0,n=1e9){for(let r=0,s=0,o=!0;s<t.length&&r<=n;s++){let l=t[s],a=r+l.length;a>=i&&(a>n&&(l=l.slice(0,n-r)),r<i&&(l=l.slice(i-r)),o?(e[e.length-1]+=l,o=!1):e.push(l)),r=a+1}return e}function ft(t,e,i){return ut(t,[""],e,i)}at.empty=new ht([""],0);class dt{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof ht?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,n=this.nodes[i],r=this.offsets[i],s=r>>1,o=n instanceof ht?n.text.length:n.children.length;if(s==(e>0?o:0)){if(0==i)return this.done=!0,this.value="",this;e>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&r)==(e>0?0:1)){if(this.offsets[i]+=e,0==t)return this.lineBreak=!0,this.value="\n",this;t--}else if(n instanceof ht){let r=n.text[s+(e<0?-1:0)];if(this.offsets[i]+=e,r.length>Math.max(0,t))return this.value=0==t?r:e>0?r.slice(t):r.slice(0,r.length-t),this;t-=r.length}else{let r=n.children[s+(e<0?-1:0)];t>r.length?(t-=r.length,this.offsets[i]+=e):(e<0&&this.offsets[i]--,this.nodes.push(r),this.offsets.push(e>0?1:(r instanceof ht?r.text.length:r.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class pt{constructor(t,e,i){this.value="",this.done=!1,this.cursor=new dt(t,e>i?-1:1),this.pos=e>i?t.length:0,this.from=Math.min(e,i),this.to=Math.max(e,i)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let i=e<0?this.pos-this.from:this.to-this.pos;t>i&&(t=i),i-=t;let{value:n}=this.cursor.next(t);return this.pos+=(n.length+t)*e,this.value=n.length<=i?n:e<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class gt{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:i,value:n}=this.inner.next(t);return e?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(at.prototype[Symbol.iterator]=function(){return this.iter()},dt.prototype[Symbol.iterator]=pt.prototype[Symbol.iterator]=gt.prototype[Symbol.iterator]=function(){return this});class mt{constructor(t,e,i,n){this.from=t,this.to=e,this.number=i,this.text=n}get length(){return this.to-this.from}}let bt="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((t=>t?parseInt(t,36):1));for(let t=1;t<bt.length;t++)bt[t]+=bt[t-1];function Ot(t){for(let e=1;e<bt.length;e+=2)if(bt[e]>t)return bt[e-1]<=t;return!1}function vt(t){return t>=127462&&t<=127487}function wt(t,e,i=!0,n=!0){return(i?yt:xt)(t,e,n)}function yt(t,e,i){if(e==t.length)return e;e&&kt(t.charCodeAt(e))&&St(t.charCodeAt(e-1))&&e--;let n=Ct(t,e);for(e+=Tt(n);e<t.length;){let r=Ct(t,e);if(8205==n||8205==r||i&&Ot(r))e+=Tt(r),n=r;else{if(!vt(r))break;{let i=0,n=e-2;for(;n>=0&&vt(Ct(t,n));)i++,n-=2;if(i%2==0)break;e+=2}}}return e}function xt(t,e,i){for(;e>0;){let n=yt(t,e-2,i);if(n<e)return n;e--}return 0}function kt(t){return t>=56320&&t<57344}function St(t){return t>=55296&&t<56320}function Ct(t,e){let i=t.charCodeAt(e);if(!St(i)||e+1==t.length)return i;let n=t.charCodeAt(e+1);return kt(n)?n-56320+(i-55296<<10)+65536:i}function At(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}function Tt(t){return t<65536?1:2}const Pt=/\r\n?|\n/;var Mt=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(Mt||(Mt={}));class Qt{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e+1];t+=i<0?this.sections[e]:i}return t}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(t){for(let e=0,i=0,n=0;e<this.sections.length;){let r=this.sections[e++],s=this.sections[e++];s<0?(t(i,n,r),n+=r):n+=s,i+=r}}iterChangedRanges(t,e=!1){Dt(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];n<0?t.push(i,n):t.push(n,i)}return new Qt(t)}composeDesc(t){return this.empty?t:t.empty?this:Nt(this,t)}mapDesc(t,e=!1){return t.empty?this:Et(this,t,e)}mapPos(t,e=-1,i=Mt.Simple){let n=0,r=0;for(let s=0;s<this.sections.length;){let o=this.sections[s++],l=this.sections[s++],a=n+o;if(l<0){if(a>t)return r+(t-n);r+=o}else{if(i!=Mt.Simple&&a>=t&&(i==Mt.TrackDel&&n<t&&a>t||i==Mt.TrackBefore&&n<t||i==Mt.TrackAfter&&a>t))return null;if(a>t||a==t&&e<0&&!o)return t==n||e<0?r:r+l;r+=l}n=a}if(t>n)throw new RangeError(`Position ${t} is out of range for changeset of length ${n}`);return r}touchesRange(t,e=t){for(let i=0,n=0;i<this.sections.length&&n<=e;){let r=n+this.sections[i++];if(this.sections[i++]>=0&&n<=e&&r>=t)return!(n<t&&r>e)||"cover";n=r}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+i+(n>=0?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some((t=>"number"!=typeof t)))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Qt(t)}static create(t){return new Qt(t)}}class Rt extends Qt{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return Dt(this,((e,i,n,r,s)=>t=t.replace(n,n+(i-e),s)),!1),t}mapDesc(t,e=!1){return Et(this,t,e,!0)}invert(t){let e=this.sections.slice(),i=[];for(let n=0,r=0;n<e.length;n+=2){let s=e[n],o=e[n+1];if(o>=0){e[n]=o,e[n+1]=s;let l=n>>1;for(;i.length<l;)i.push(at.empty);i.push(s?t.slice(r,r+s):at.empty)}r+=s}return new Rt(e,i)}compose(t){return this.empty?t:t.empty?this:Nt(this,t,!0)}map(t,e=!1){return t.empty?this:Et(this,t,e,!0)}iterChanges(t,e=!1){Dt(this,t,e)}get desc(){return Qt.create(this.sections)}filter(t){let e=[],i=[],n=[],r=new Bt(this);t:for(let s=0,o=0;;){let l=s==t.length?1e9:t[s++];for(;o<l||o==l&&0==r.len;){if(r.done)break t;let t=Math.min(r.len,l-o);$t(n,t,-1);let s=-1==r.ins?-1:0==r.off?r.ins:0;$t(e,t,s),s>0&&_t(i,e,r.text),r.forward(t),o+=t}let a=t[s++];for(;o<a;){if(r.done)break t;let t=Math.min(r.len,a-o);$t(e,t,-1),$t(n,t,-1==r.ins?-1:0==r.off?r.ins:0),r.forward(t),o+=t}}return{changes:new Rt(e,i),filtered:Qt.create(n)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e],n=this.sections[e+1];n<0?t.push(i):0==n?t.push([i]):t.push([i].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,i){let n=[],r=[],s=0,o=null;function l(t=!1){if(!t&&!n.length)return;s<e&&$t(n,e-s,-1);let i=new Rt(n,r);o=o?o.compose(i.map(o)):i,n=[],r=[],s=0}return function t(a){if(Array.isArray(a))for(let e of a)t(e);else if(a instanceof Rt){if(a.length!=e)throw new RangeError(`Mismatched change set length (got ${a.length}, expected ${e})`);l(),o=o?o.compose(a.map(o)):a}else{let{from:t,to:o=t,insert:h}=a;if(t>o||t<0||o>e)throw new RangeError(`Invalid change range ${t} to ${o} (in doc of length ${e})`);let c=h?"string"==typeof h?at.of(h.split(i||Pt)):h:at.empty,u=c.length;if(t==o&&0==u)return;t<s&&l(),t>s&&$t(n,t-s,-1),$t(n,o-t,u),_t(r,n,c),s=o}}(t),l(!o),o}static empty(t){return new Rt(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],i=[];for(let n=0;n<t.length;n++){let r=t[n];if("number"==typeof r)e.push(r,-1);else{if(!Array.isArray(r)||"number"!=typeof r[0]||r.some(((t,e)=>e&&"string"!=typeof t)))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==r.length)e.push(r[0],0);else{for(;i.length<n;)i.push(at.empty);i[n]=at.of(r.slice(1)),e.push(r[0],i[n].length)}}}return new Rt(e,i)}static createSet(t,e){return new Rt(t,e)}}function $t(t,e,i,n=!1){if(0==e&&i<=0)return;let r=t.length-2;r>=0&&i<=0&&i==t[r+1]?t[r]+=e:0==e&&0==t[r]?t[r+1]+=i:n?(t[r]+=e,t[r+1]+=i):t.push(e,i)}function _t(t,e,i){if(0==i.length)return;let n=e.length-2>>1;if(n<t.length)t[t.length-1]=t[t.length-1].append(i);else{for(;t.length<n;)t.push(at.empty);t.push(i)}}function Dt(t,e,i){let n=t.inserted;for(let r=0,s=0,o=0;o<t.sections.length;){let l=t.sections[o++],a=t.sections[o++];if(a<0)r+=l,s+=l;else{let h=r,c=s,u=at.empty;for(;h+=l,c+=a,a&&n&&(u=u.append(n[o-2>>1])),!(i||o==t.sections.length||t.sections[o+1]<0);)l=t.sections[o++],a=t.sections[o++];e(r,h,s,c,u),r=h,s=c}}}function Et(t,e,i,n=!1){let r=[],s=n?[]:null,o=new Bt(t),l=new Bt(e);for(let t=-1;;)if(-1==o.ins&&-1==l.ins){let t=Math.min(o.len,l.len);$t(r,t,-1),o.forward(t),l.forward(t)}else if(l.ins>=0&&(o.ins<0||t==o.i||0==o.off&&(l.len<o.len||l.len==o.len&&!i))){let e=l.len;for($t(r,l.ins,-1);e;){let i=Math.min(o.len,e);o.ins>=0&&t<o.i&&o.len<=i&&($t(r,0,o.ins),s&&_t(s,r,o.text),t=o.i),o.forward(i),e-=i}l.next()}else{if(!(o.ins>=0)){if(o.done&&l.done)return s?Rt.createSet(r,s):Qt.create(r);throw new Error("Mismatched change set lengths")}{let e=0,i=o.len;for(;i;)if(-1==l.ins){let t=Math.min(i,l.len);e+=t,i-=t,l.forward(t)}else{if(!(0==l.ins&&l.len<i))break;i-=l.len,l.next()}$t(r,e,t<o.i?o.ins:0),s&&t<o.i&&_t(s,r,o.text),t=o.i,o.forward(o.len-i)}}}function Nt(t,e,i=!1){let n=[],r=i?[]:null,s=new Bt(t),o=new Bt(e);for(let t=!1;;){if(s.done&&o.done)return r?Rt.createSet(n,r):Qt.create(n);if(0==s.ins)$t(n,s.len,0,t),s.next();else if(0!=o.len||o.done){if(s.done||o.done)throw new Error("Mismatched change set lengths");{let e=Math.min(s.len2,o.len),i=n.length;if(-1==s.ins){let i=-1==o.ins?-1:o.off?0:o.ins;$t(n,e,i,t),r&&i&&_t(r,n,o.text)}else-1==o.ins?($t(n,s.off?0:s.len,e,t),r&&_t(r,n,s.textBit(e))):($t(n,s.off?0:s.len,o.off?0:o.ins,t),r&&!o.off&&_t(r,n,o.text));t=(s.ins>e||o.ins>=0&&o.len>e)&&(t||n.length>i),s.forward2(e),o.forward(e)}}else $t(n,0,o.ins,t),r&&_t(r,n,o.text),o.next()}}class Bt{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?at.empty:t[e]}textBit(t){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length&&!t?at.empty:e[i].slice(this.off,null==t?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){-1==this.ins?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class It{constructor(t,e,i){this.from=t,this.to=e,this.flags=i}get anchor(){return 16&this.flags?this.to:this.from}get head(){return 16&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 4&this.flags?-1:8&this.flags?1:0}get bidiLevel(){let t=3&this.flags;return 3==t?null:t}get goalColumn(){let t=this.flags>>5;return 33554431==t?void 0:t}map(t,e=-1){let i,n;return this.empty?i=n=t.mapPos(this.from,e):(i=t.mapPos(this.from,1),n=t.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new It(i,n,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return zt.range(t,e);let i=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return zt.range(this.anchor,i)}eq(t){return this.anchor==t.anchor&&this.head==t.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||"number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid JSON representation for SelectionRange");return zt.range(t.anchor,t.head)}static create(t,e,i){return new It(t,e,i)}}class zt{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:zt.create(this.ranges.map((i=>i.map(t,e))),this.mainIndex)}eq(t){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let e=0;e<this.ranges.length;e++)if(!this.ranges[e].eq(t.ranges[e]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new zt([this.main],0)}addRange(t,e=!0){return zt.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let i=this.ranges.slice();return i[e]=t,zt.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map((t=>t.toJSON())),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||"number"!=typeof t.main||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new zt(t.ranges.map((t=>It.fromJSON(t))),t.main)}static single(t,e=t){return new zt([zt.range(t,e)],0)}static create(t,e=0){if(0==t.length)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<t.length;n++){let r=t[n];if(r.empty?r.from<=i:r.from<i)return zt.normalized(t.slice(),e);i=r.to}return new zt(t,e)}static cursor(t,e=0,i,n){return It.create(t,t,(0==e?0:e<0?4:8)|(null==i?3:Math.min(2,i))|(null!=n?n:33554431)<<5)}static range(t,e,i){let n=(null!=i?i:33554431)<<5;return e<t?It.create(e,t,24|n):It.create(t,e,n|(e>t?4:0))}static normalized(t,e=0){let i=t[e];t.sort(((t,e)=>t.from-e.from)),e=t.indexOf(i);for(let i=1;i<t.length;i++){let n=t[i],r=t[i-1];if(n.empty?n.from<=r.to:n.from<r.to){let s=r.from,o=Math.max(n.to,r.to);i<=e&&e--,t.splice(--i,2,n.anchor>n.head?zt.range(o,s):zt.range(s,o))}}return new zt(t,e)}}function Lt(t,e){for(let i of t.ranges)if(i.to>e)throw new RangeError("Selection points outside of document")}let Wt=0;class Vt{constructor(t,e,i,n,r){this.combine=t,this.compareInput=e,this.compare=i,this.isStatic=n,this.id=Wt++,this.default=t([]),this.extensions="function"==typeof r?r(this):r}static define(t={}){return new Vt(t.combine||(t=>t),t.compareInput||((t,e)=>t===e),t.compare||(t.combine?(t,e)=>t===e:jt),!!t.static,t.enables)}of(t){return new qt([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new qt(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new qt(t,this,2,e)}from(t,e){return e||(e=t=>t),this.compute([t],(i=>e(i.field(t))))}}function jt(t,e){return t==e||t.length==e.length&&t.every(((t,i)=>t===e[i]))}class qt{constructor(t,e,i,n){this.dependencies=t,this.facet=e,this.type=i,this.value=n,this.id=Wt++}dynamicSlot(t){var e;let i=this.value,n=this.facet.compareInput,r=this.id,s=t[r]>>1,o=2==this.type,l=!1,a=!1,h=[];for(let i of this.dependencies)"doc"==i?l=!0:"selection"==i?a=!0:0==(1&(null!==(e=t[i.id])&&void 0!==e?e:1))&&h.push(t[i.id]);return{create:t=>(t.values[s]=i(t),1),update(t,e){if(l&&e.docChanged||a&&(e.docChanged||e.selection)||Xt(t,h)){let e=i(t);if(o?!Ht(e,t.values[s],n):!n(e,t.values[s]))return t.values[s]=e,1}return 0},reconfigure:(t,e)=>{let l=i(t),a=e.config.address[r];if(null!=a){let i=le(e,a);if(this.dependencies.every((i=>i instanceof Vt?e.facet(i)===t.facet(i):!(i instanceof Gt)||e.field(i,!1)==t.field(i,!1)))||(o?Ht(l,i,n):n(l,i)))return t.values[s]=i,0}return t.values[s]=l,1}}}}function Ht(t,e,i){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1;return!0}function Xt(t,e){let i=!1;for(let n of e)1&oe(t,n)&&(i=!0);return i}function Ft(t,e,i){let n=i.map((e=>t[e.id])),r=i.map((t=>t.type)),s=n.filter((t=>!(1&t))),o=t[e.id]>>1;function l(t){let i=[];for(let e=0;e<n.length;e++){let s=le(t,n[e]);if(2==r[e])for(let t of s)i.push(t);else i.push(s)}return e.combine(i)}return{create(t){for(let e of n)oe(t,e);return t.values[o]=l(t),1},update(t,i){if(!Xt(t,s))return 0;let n=l(t);return e.compare(n,t.values[o])?0:(t.values[o]=n,1)},reconfigure(t,r){let s=Xt(t,n),a=r.config.facets[e.id],h=r.facet(e);if(a&&!s&&jt(i,a))return t.values[o]=h,0;let c=l(t);return e.compare(c,h)?(t.values[o]=h,0):(t.values[o]=c,1)}}}const Zt=Vt.define({static:!0});class Gt{constructor(t,e,i,n,r){this.id=t,this.createF=e,this.updateF=i,this.compareF=n,this.spec=r,this.provides=void 0}static define(t){let e=new Gt(Wt++,t.create,t.update,t.compare||((t,e)=>t===e),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(Zt).find((t=>t.field==this));return((null==e?void 0:e.create)||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:t=>(t.values[e]=this.create(t),1),update:(t,i)=>{let n=t.values[e],r=this.updateF(n,i);return this.compareF(n,r)?0:(t.values[e]=r,1)},reconfigure:(t,i)=>null!=i.config.address[this.id]?(t.values[e]=i.field(this),0):(t.values[e]=this.create(t),1)}}init(t){return[this,Zt.of({field:this,create:t})]}get extension(){return this}}const Ut=4,Yt=3,Kt=2,Jt=1;function te(t){return e=>new ie(e,t)}const ee={highest:te(0),high:te(Jt),default:te(Kt),low:te(Yt),lowest:te(Ut)};class ie{constructor(t,e){this.inner=t,this.prec=e}}class ne{of(t){return new re(this,t)}reconfigure(t){return ne.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class re{constructor(t,e){this.compartment=t,this.inner=e}}class se{constructor(t,e,i,n,r,s){for(this.base=t,this.compartments=e,this.dynamicSlots=i,this.address=n,this.staticValues=r,this.facets=s,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return null==e?t.default:this.staticValues[e>>1]}static resolve(t,e,i){let n=[],r=Object.create(null),s=new Map;for(let i of function(t,e,i){let n=[[],[],[],[],[]],r=new Map;function s(t,o){let l=r.get(t);if(null!=l){if(l<=o)return;let e=n[l].indexOf(t);e>-1&&n[l].splice(e,1),t instanceof re&&i.delete(t.compartment)}if(r.set(t,o),Array.isArray(t))for(let e of t)s(e,o);else if(t instanceof re){if(i.has(t.compartment))throw new RangeError("Duplicate use of compartment in extensions");let n=e.get(t.compartment)||t.inner;i.set(t.compartment,n),s(n,o)}else if(t instanceof ie)s(t.inner,t.prec);else if(t instanceof Gt)n[o].push(t),t.provides&&s(t.provides,o);else if(t instanceof qt)n[o].push(t),t.facet.extensions&&s(t.facet.extensions,o);else{let e=t.extension;if(!e)throw new Error(`Unrecognized extension value in extension set (${t}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(e,o)}}return s(t,Kt),n.reduce(((t,e)=>t.concat(e)))}(t,e,s))i instanceof Gt?n.push(i):(r[i.facet.id]||(r[i.facet.id]=[])).push(i);let o=Object.create(null),l=[],a=[];for(let t of n)o[t.id]=a.length<<1,a.push((e=>t.slot(e)));let h=null==i?void 0:i.config.facets;for(let t in r){let e=r[t],n=e[0].facet,s=h&&h[t]||[];if(e.every((t=>0==t.type)))if(o[n.id]=l.length<<1|1,jt(s,e))l.push(i.facet(n));else{let t=n.combine(e.map((t=>t.value)));l.push(i&&n.compare(t,i.facet(n))?i.facet(n):t)}else{for(let t of e)0==t.type?(o[t.id]=l.length<<1|1,l.push(t.value)):(o[t.id]=a.length<<1,a.push((e=>t.dynamicSlot(e))));o[n.id]=a.length<<1,a.push((t=>Ft(t,n,e)))}}let c=a.map((t=>t(o)));return new se(t,s,c,o,l,r)}}function oe(t,e){if(1&e)return 2;let i=e>>1,n=t.status[i];if(4==n)throw new Error("Cyclic dependency between fields and/or facets");if(2&n)return n;t.status[i]=4;let r=t.computeSlot(t,t.config.dynamicSlots[i]);return t.status[i]=2|r}function le(t,e){return 1&e?t.config.staticValues[e>>1]:t.values[e>>1]}const ae=Vt.define(),he=Vt.define({combine:t=>t.some((t=>t)),static:!0}),ce=Vt.define({combine:t=>t.length?t[0]:void 0,static:!0}),ue=Vt.define(),fe=Vt.define(),de=Vt.define(),pe=Vt.define({combine:t=>!!t.length&&t[0]});class ge{constructor(t,e){this.type=t,this.value=e}static define(){return new me}}class me{of(t){return new ge(this,t)}}class be{constructor(t){this.map=t}of(t){return new Oe(this,t)}}class Oe{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return void 0===e?void 0:e==this.value?this:new Oe(this.type,e)}is(t){return this.type==t}static define(t={}){return new be(t.map||(t=>t))}static mapEffects(t,e){if(!t.length)return t;let i=[];for(let n of t){let t=n.map(e);t&&i.push(t)}return i}}Oe.reconfigure=Oe.define(),Oe.appendConfig=Oe.define();class ve{constructor(t,e,i,n,r,s){this.startState=t,this.changes=e,this.selection=i,this.effects=n,this.annotations=r,this.scrollIntoView=s,this._doc=null,this._state=null,i&&Lt(i,e.newLength),r.some((t=>t.type==ve.time))||(this.annotations=r.concat(ve.time.of(Date.now())))}static create(t,e,i,n,r,s){return new ve(t,e,i,n,r,s)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(ve.userEvent);return!(!e||!(e==t||e.length>t.length&&e.slice(0,t.length)==t&&"."==e[t.length]))}}function we(t,e){let i=[];for(let n=0,r=0;;){let s,o;if(n<t.length&&(r==e.length||e[r]>=t[n]))s=t[n++],o=t[n++];else{if(!(r<e.length))return i;s=e[r++],o=e[r++]}!i.length||i[i.length-1]<s?i.push(s,o):i[i.length-1]<o&&(i[i.length-1]=o)}}function ye(t,e,i){var n;let r,s,o;return i?(r=e.changes,s=Rt.empty(e.changes.length),o=t.changes.compose(e.changes)):(r=e.changes.map(t.changes),s=t.changes.mapDesc(e.changes,!0),o=t.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):null===(n=t.selection)||void 0===n?void 0:n.map(r),effects:Oe.mapEffects(t.effects,r).concat(Oe.mapEffects(e.effects,s)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function xe(t,e,i){let n=e.selection,r=Ce(e.annotations);return e.userEvent&&(r=r.concat(ve.userEvent.of(e.userEvent))),{changes:e.changes instanceof Rt?e.changes:Rt.of(e.changes||[],i,t.facet(ce)),selection:n&&(n instanceof zt?n:zt.single(n.anchor,n.head)),effects:Ce(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function ke(t,e,i){let n=xe(t,e.length?e[0]:{},t.doc.length);e.length&&!1===e[0].filter&&(i=!1);for(let r=1;r<e.length;r++){!1===e[r].filter&&(i=!1);let s=!!e[r].sequential;n=ye(n,xe(t,e[r],s?n.changes.newLength:t.doc.length),s)}let r=ve.create(t,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return function(t){let e=t.startState,i=e.facet(de),n=t;for(let r=i.length-1;r>=0;r--){let s=i[r](t);s&&Object.keys(s).length&&(n=ye(t,xe(e,s,t.changes.newLength),!0))}return n==t?t:ve.create(e,t.changes,t.selection,n.effects,n.annotations,n.scrollIntoView)}(i?function(t){let e=t.startState,i=!0;for(let n of e.facet(ue)){let e=n(t);if(!1===e){i=!1;break}Array.isArray(e)&&(i=!0===i?e:we(i,e))}if(!0!==i){let n,r;if(!1===i)r=t.changes.invertedDesc,n=Rt.empty(e.doc.length);else{let e=t.changes.filter(i);n=e.changes,r=e.filtered.mapDesc(e.changes).invertedDesc}t=ve.create(e,n,t.selection&&t.selection.map(r),Oe.mapEffects(t.effects,r),t.annotations,t.scrollIntoView)}let n=e.facet(fe);for(let i=n.length-1;i>=0;i--){let r=n[i](t);t=r instanceof ve?r:Array.isArray(r)&&1==r.length&&r[0]instanceof ve?r[0]:ke(e,Ce(r),!1)}return t}(r):r)}ve.time=ge.define(),ve.userEvent=ge.define(),ve.addToHistory=ge.define(),ve.remote=ge.define();const Se=[];function Ce(t){return null==t?Se:Array.isArray(t)?t:[t]}var Ae=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(Ae||(Ae={}));const Te=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Pe;try{Pe=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(t){}function Me(t){return e=>{if(!/\S/.test(e))return Ae.Space;if(function(t){if(Pe)return Pe.test(t);for(let e=0;e<t.length;e++){let i=t[e];if(/\w/.test(i)||i>""&&(i.toUpperCase()!=i.toLowerCase()||Te.test(i)))return!0}return!1}(e))return Ae.Word;for(let i=0;i<t.length;i++)if(e.indexOf(t[i])>-1)return Ae.Word;return Ae.Other}}class Qe{constructor(t,e,i,n,r,s){this.config=t,this.doc=e,this.selection=i,this.values=n,this.status=t.statusTemplate.slice(),this.computeSlot=r,s&&(s._state=this);for(let t=0;t<this.config.dynamicSlots.length;t++)oe(this,t<<1);this.computeSlot=null}field(t,e=!0){let i=this.config.address[t.id];if(null!=i)return oe(this,i),le(this,i);if(e)throw new RangeError("Field is not present in this state")}update(...t){return ke(this,t,!0)}applyTransaction(t){let e,i=this.config,{base:n,compartments:r}=i;for(let e of t.effects)e.is(ne.reconfigure)?(i&&(r=new Map,i.compartments.forEach(((t,e)=>r.set(e,t))),i=null),r.set(e.value.compartment,e.value.extension)):e.is(Oe.reconfigure)?(i=null,n=e.value):e.is(Oe.appendConfig)&&(i=null,n=Ce(n).concat(e.value));if(i)e=t.startState.values.slice();else{i=se.resolve(n,r,this);let t=new Qe(i,this.doc,this.selection,i.dynamicSlots.map((()=>null)),((t,e)=>e.reconfigure(t,this)),null);e=t.values}new Qe(i,t.newDoc,t.newSelection,e,((e,i)=>i.update(e,t)),t)}replaceSelection(t){return"string"==typeof t&&(t=this.toText(t)),this.changeByRange((e=>({changes:{from:e.from,to:e.to,insert:t},range:zt.cursor(e.from+t.length)})))}changeByRange(t){let e=this.selection,i=t(e.ranges[0]),n=this.changes(i.changes),r=[i.range],s=Ce(i.effects);for(let i=1;i<e.ranges.length;i++){let o=t(e.ranges[i]),l=this.changes(o.changes),a=l.map(n);for(let t=0;t<i;t++)r[t]=r[t].map(a);let h=n.mapDesc(l,!0);r.push(o.range.map(h)),n=n.compose(a),s=Oe.mapEffects(s,a).concat(Oe.mapEffects(Ce(o.effects),h))}return{changes:n,selection:zt.create(r,e.mainIndex),effects:s}}changes(t=[]){return t instanceof Rt?t:Rt.of(t,this.doc.length,this.facet(Qe.lineSeparator))}toText(t){return at.of(t.split(this.facet(Qe.lineSeparator)||Pt))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return null==e?t.default:(oe(this,e),le(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let i in t){let n=t[i];n instanceof Gt&&null!=this.config.address[n.id]&&(e[i]=n.spec.toJSON(this.field(t[i]),this))}return e}static fromJSON(t,e={},i){if(!t||"string"!=typeof t.doc)throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i)for(let e in i)if(Object.prototype.hasOwnProperty.call(t,e)){let r=i[e],s=t[e];n.push(r.init((t=>r.spec.fromJSON(s,t))))}return Qe.create({doc:t.doc,selection:zt.fromJSON(t.selection),extensions:e.extensions?n.concat([e.extensions]):n})}static create(t={}){let e=se.resolve(t.extensions||[],new Map),i=t.doc instanceof at?t.doc:at.of((t.doc||"").split(e.staticFacet(Qe.lineSeparator)||Pt)),n=t.selection?t.selection instanceof zt?t.selection:zt.single(t.selection.anchor,t.selection.head):zt.single(0);return Lt(n,i.length),e.staticFacet(he)||(n=n.asSingle()),new Qe(e,i,n,e.dynamicSlots.map((()=>null)),((t,e)=>e.create(t)),null)}get tabSize(){return this.facet(Qe.tabSize)}get lineBreak(){return this.facet(Qe.lineSeparator)||"\n"}get readOnly(){return this.facet(pe)}phrase(t,...e){for(let e of this.facet(Qe.phrases))if(Object.prototype.hasOwnProperty.call(e,t)){t=e[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,((t,i)=>{if("$"==i)return"$";let n=+(i||1);return!n||n>e.length?t:e[n-1]}))),t}languageDataAt(t,e,i=-1){let n=[];for(let r of this.facet(ae))for(let s of r(this,e,i))Object.prototype.hasOwnProperty.call(s,t)&&n.push(s[t]);return n}charCategorizer(t){return Me(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:i,length:n}=this.doc.lineAt(t),r=this.charCategorizer(t),s=t-i,o=t-i;for(;s>0;){let t=wt(e,s,!1);if(r(e.slice(t,s))!=Ae.Word)break;s=t}for(;o<n;){let t=wt(e,o);if(r(e.slice(o,t))!=Ae.Word)break;o=t}return s==o?null:zt.range(s+i,o+i)}}function Re(t,e,i={}){let n={};for(let e of t)for(let t of Object.keys(e)){let r=e[t],s=n[t];if(void 0===s)n[t]=r;else if(s===r||void 0===r);else{if(!Object.hasOwnProperty.call(i,t))throw new Error("Config merge conflict for field "+t);n[t]=i[t](s,r)}}for(let t in e)void 0===n[t]&&(n[t]=e[t]);return n}Qe.allowMultipleSelections=he,Qe.tabSize=Vt.define({combine:t=>t.length?t[0]:4}),Qe.lineSeparator=ce,Qe.readOnly=pe,Qe.phrases=Vt.define({compare(t,e){let i=Object.keys(t),n=Object.keys(e);return i.length==n.length&&i.every((i=>t[i]==e[i]))}}),Qe.languageData=ae,Qe.changeFilter=ue,Qe.transactionFilter=fe,Qe.transactionExtender=de,ne.reconfigure=Oe.define();class $e{eq(t){return this==t}range(t,e=t){return _e.create(t,e,this)}}$e.prototype.startSide=$e.prototype.endSide=0,$e.prototype.point=!1,$e.prototype.mapMode=Mt.TrackDel;class _e{constructor(t,e,i){this.from=t,this.to=e,this.value=i}static create(t,e,i){return new _e(t,e,i)}}function De(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class Ee{constructor(t,e,i,n){this.from=t,this.to=e,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(t,e,i,n=0){let r=i?this.to:this.from;for(let s=n,o=r.length;;){if(s==o)return s;let n=s+o>>1,l=r[n]-t||(i?this.value[n].endSide:this.value[n].startSide)-e;if(n==s)return l>=0?s:o;l>=0?o=n:s=n+1}}between(t,e,i,n){for(let r=this.findIndex(e,-1e9,!0),s=this.findIndex(i,1e9,!1,r);r<s;r++)if(!1===n(this.from[r]+t,this.to[r]+t,this.value[r]))return!1}map(t,e){let i=[],n=[],r=[],s=-1,o=-1;for(let l=0;l<this.value.length;l++){let a,h,c=this.value[l],u=this.from[l]+t,f=this.to[l]+t;if(u==f){let t=e.mapPos(u,c.startSide,c.mapMode);if(null==t)continue;if(a=h=t,c.startSide!=c.endSide&&(h=e.mapPos(u,c.endSide),h<a))continue}else if(a=e.mapPos(u,c.startSide),h=e.mapPos(f,c.endSide),a>h||a==h&&c.startSide>0&&c.endSide<=0)continue;(h-a||c.endSide-c.startSide)<0||(s<0&&(s=a),c.point&&(o=Math.max(o,h-a)),i.push(c),n.push(a-s),r.push(h-s))}return{mapped:i.length?new Ee(n,r,i,o):null,pos:s}}}class Ne{constructor(t,e,i,n){this.chunkPos=t,this.chunk=e,this.nextLayer=i,this.maxPoint=n}static create(t,e,i,n){return new Ne(t,e,i,n)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:i=!1,filterFrom:n=0,filterTo:r=this.length}=t,s=t.filter;if(0==e.length&&!s)return this;if(i&&(e=e.slice().sort(De)),this.isEmpty)return e.length?Ne.of(e):this;let o=new ze(this,null,-1).goto(0),l=0,a=[],h=new Be;for(;o.value||l<e.length;)if(l<e.length&&(o.from-e[l].from||o.startSide-e[l].value.startSide)>=0){let t=e[l++];h.addInner(t.from,t.to,t.value)||a.push(t)}else 1==o.rangeIndex&&o.chunkIndex<this.chunk.length&&(l==e.length||this.chunkEnd(o.chunkIndex)<e[l].from)&&(!s||n>this.chunkEnd(o.chunkIndex)||r<this.chunkPos[o.chunkIndex])&&h.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!s||n>o.to||r<o.from||s(o.from,o.to,o.value))&&(h.addInner(o.from,o.to,o.value)||a.push(_e.create(o.from,o.to,o.value))),o.next());return h.finishInner(this.nextLayer.isEmpty&&!a.length?Ne.empty:this.nextLayer.update({add:a,filter:s,filterFrom:n,filterTo:r}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],i=[],n=-1;for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r],l=t.touchesRange(s,s+o.length);if(!1===l)n=Math.max(n,o.maxPoint),e.push(o),i.push(t.mapPos(s));else if(!0===l){let{mapped:r,pos:l}=o.map(s,t);r&&(n=Math.max(n,r.maxPoint),e.push(r),i.push(l))}}let r=this.nextLayer.map(t);return 0==e.length?r:new Ne(i,e,r||Ne.empty,n)}between(t,e,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let r=this.chunkPos[n],s=this.chunk[n];if(e>=r&&t<=r+s.length&&!1===s.between(r,t-r,e-r,i))return}this.nextLayer.between(t,e,i)}}iter(t=0){return Le.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return Le.from(t).goto(e)}static compare(t,e,i,n,r=-1){let s=t.filter((t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=r)),o=e.filter((t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=r)),l=Ie(s,o,i),a=new Ve(s,l,r),h=new Ve(o,l,r);i.iterGaps(((t,e,i)=>je(a,t,h,e,i,n))),i.empty&&0==i.length&&je(a,0,h,0,0,n)}static eq(t,e,i=0,n){null==n&&(n=1e9);let r=t.filter((t=>!t.isEmpty&&e.indexOf(t)<0)),s=e.filter((e=>!e.isEmpty&&t.indexOf(e)<0));if(r.length!=s.length)return!1;if(!r.length)return!0;let o=Ie(r,s),l=new Ve(r,o,0).goto(i),a=new Ve(s,o,0).goto(i);for(;;){if(l.to!=a.to||!qe(l.active,a.active)||l.point&&(!a.point||!l.point.eq(a.point)))return!1;if(l.to>n)return!0;l.next(),a.next()}}static spans(t,e,i,n,r=-1){let s=new Ve(t,null,r).goto(e),o=e,l=s.openStart;for(;;){let t=Math.min(s.to,i);if(s.point?(n.point(o,t,s.point,s.activeForPoint(s.to),l,s.pointRank),l=s.openEnd(t)+(s.to>t?1:0)):t>o&&(n.span(o,t,s.active,l),l=s.openEnd(t)),s.to>i)break;o=s.to,s.next()}return l}static of(t,e=!1){let i=new Be;for(let n of t instanceof _e?[t]:e?function(t){if(t.length>1)for(let e=t[0],i=1;i<t.length;i++){let n=t[i];if(De(e,n)>0)return t.slice().sort(De);e=n}return t}(t):t)i.add(n.from,n.to,n.value);return i.finish()}}Ne.empty=new Ne([],[],null,-1),Ne.empty.nextLayer=Ne.empty;class Be{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(t){this.chunks.push(new Ee(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}add(t,e,i){this.addInner(t,e,i)||(this.nextLayer||(this.nextLayer=new Be)).add(t,e,i)}addInner(t,e,i){let n=t-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(t-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(n<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=i,this.lastFrom=t,this.lastTo=e,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let i=e.value.length-1;return this.last=e.value[i],this.lastFrom=e.from[i]+t,this.lastTo=e.to[i]+t,!0}finish(){return this.finishInner(Ne.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return t;let e=Ne.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function Ie(t,e,i){let n=new Map;for(let e of t)for(let t=0;t<e.chunk.length;t++)e.chunk[t].maxPoint<=0&&n.set(e.chunk[t],e.chunkPos[t]);let r=new Set;for(let t of e)for(let e=0;e<t.chunk.length;e++){let s=n.get(t.chunk[e]);null==s||(i?i.mapPos(s):s)!=t.chunkPos[e]||(null==i?void 0:i.touchesRange(s,s+t.chunk[e].length))||r.add(t.chunk[e])}return r}class ze{constructor(t,e,i,n=0){this.layer=t,this.skip=e,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,i){for(;this.chunkIndex<this.layer.chunk.length;){let e=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(e)||this.layer.chunkEnd(this.chunkIndex)<t||e.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],i=t+e.from[this.rangeIndex];if(this.from=i,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class Le{constructor(t){this.heap=t}static from(t,e=null,i=-1){let n=[];for(let r=0;r<t.length;r++)for(let s=t[r];!s.isEmpty;s=s.nextLayer)s.maxPoint>=i&&n.push(new ze(s,e,i,r));return 1==n.length?n[0]:new Le(n)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let i of this.heap)i.goto(t,e);for(let t=this.heap.length>>1;t>=0;t--)We(this.heap,t);return this.next(),this}forward(t,e){for(let i of this.heap)i.forward(t,e);for(let t=this.heap.length>>1;t>=0;t--)We(this.heap,t);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),We(this.heap,0)}}}function We(t,e){for(let i=t[e];;){let n=1+(e<<1);if(n>=t.length)break;let r=t[n];if(n+1<t.length&&r.compare(t[n+1])>=0&&(r=t[n+1],n++),i.compare(r)<0)break;t[n]=i,t[e]=r,e=n}}class Ve{constructor(t,e,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Le.from(t,e,i)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){He(this.active,t),He(this.activeTo,t),He(this.activeRank,t),this.minActive=Fe(this.active,this.activeTo)}addActive(t){let e=0,{value:i,to:n,rank:r}=this.cursor;for(;e<this.activeRank.length&&this.activeRank[e]<=r;)e++;Xe(this.active,e,i),Xe(this.activeTo,e,n),Xe(this.activeRank,e,r),t&&Xe(t,e,this.cursor.from),this.minActive=Fe(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let i=this.openStart<0?[]:null,n=0;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>t){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),i&&He(i,r)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let r=this.cursor.value;if(r.point){if(!(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.from<t&&(n=1),this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(i),this.cursor.next()}}}if(i){let e=0;for(;e<i.length&&i[e]<t;)e++;this.openStart=e+n}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>t||this.activeTo[i]==t&&this.active[i].endSide>=this.point.endSide)&&e.push(this.active[i]);return e.reverse()}openEnd(t){let e=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>t;i--)e++;return e}}function je(t,e,i,n,r,s){t.goto(e),i.goto(n);let o=n+r,l=n,a=n-e;for(;;){let e=t.to+a-i.to||t.endSide-i.endSide,n=e<0?t.to+a:i.to,r=Math.min(n,o);if(t.point||i.point?t.point&&i.point&&(t.point==i.point||t.point.eq(i.point))&&qe(t.activeForPoint(t.to+a),i.activeForPoint(i.to))||s.comparePoint(l,r,t.point,i.point):r>l&&!qe(t.active,i.active)&&s.compareRange(l,r,t.active,i.active),n>o)break;l=n,e<=0&&t.next(),e>=0&&i.next()}}function qe(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!=e[i]&&!t[i].eq(e[i]))return!1;return!0}function He(t,e){for(let i=e,n=t.length-1;i<n;i++)t[i]=t[i+1];t.pop()}function Xe(t,e,i){for(let i=t.length-1;i>=e;i--)t[i+1]=t[i];t[e]=i}function Fe(t,e){let i=-1,n=1e9;for(let r=0;r<e.length;r++)(e[r]-n||t[r].endSide-t[i].endSide)<0&&(i=r,n=e[r]);return i}function Ze(t,e,i=t.length){let n=0;for(let r=0;r<i;)9==t.charCodeAt(r)?(n+=e-n%e,r++):(n++,r=wt(t,r));return n}function Ge(t,e,i,n){for(let n=0,r=0;;){if(r>=e)return n;if(n==t.length)break;r+=9==t.charCodeAt(n)?i-r%i:1,n=wt(t,n)}return!0===n?-1:t.length}const Ue="undefined"==typeof Symbol?"__ͼ":Symbol.for("ͼ"),Ye="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),Ke="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{};class Je{constructor(t,e){this.rules=[];let{finish:i}=e||{};function n(t){return/^@/.test(t)?[t]:t.split(/,\s*/)}function r(t,e,s,o){let l=[],a=/^@(\w+)\b/.exec(t[0]),h=a&&"keyframes"==a[1];if(a&&null==e)return s.push(t[0]+";");for(let i in e){let o=e[i];if(/&/.test(i))r(i.split(/,\s*/).map((e=>t.map((t=>e.replace(/&/,t))))).reduce(((t,e)=>t.concat(e))),o,s);else if(o&&"object"==typeof o){if(!a)throw new RangeError("The value of a property ("+i+") should be a primitive value.");r(n(i),o,l,h)}else null!=o&&l.push(i.replace(/_.*/,"").replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()))+": "+o+";")}(l.length||h)&&s.push((!i||a||o?t:t.map(i)).join(", ")+" {"+l.join(" ")+"}")}for(let e in t)r(n(e),t[e],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let t=Ke[Ue]||1;return Ke[Ue]=t+1,"ͼ"+t.toString(36)}static mount(t,e){(t[Ye]||new ei(t)).mount(Array.isArray(e)?e:[e])}}let ti=null;class ei{constructor(t){if(!t.head&&t.adoptedStyleSheets&&"undefined"!=typeof CSSStyleSheet){if(ti)return t.adoptedStyleSheets=[ti.sheet].concat(t.adoptedStyleSheets),t[Ye]=ti;this.sheet=new CSSStyleSheet,t.adoptedStyleSheets=[this.sheet].concat(t.adoptedStyleSheets),ti=this}else{this.styleTag=(t.ownerDocument||t).createElement("style");let e=t.head||t;e.insertBefore(this.styleTag,e.firstChild)}this.modules=[],t[Ye]=this}mount(t){let e=this.sheet,i=0,n=0;for(let r=0;r<t.length;r++){let s=t[r],o=this.modules.indexOf(s);if(o<n&&o>-1&&(this.modules.splice(o,1),n--,o=-1),-1==o){if(this.modules.splice(n++,0,s),e)for(let t=0;t<s.rules.length;t++)e.insertRule(s.rules[t],i++)}else{for(;n<o;)i+=this.modules[n++].rules.length;i+=s.rules.length,n++}}if(!e){let t="";for(let e=0;e<this.modules.length;e++)t+=this.modules[e].getRules()+"\n";this.styleTag.textContent=t}}}for(var ii={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},ni={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},ri="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),si="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),oi="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),li="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),ai="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),hi=ri&&(li||+ri[1]<57)||oi&&li,ci=0;ci<10;ci++)ii[48+ci]=ii[96+ci]=String(ci);for(ci=1;ci<=24;ci++)ii[ci+111]="F"+ci;for(ci=65;ci<=90;ci++)ii[ci]=String.fromCharCode(ci+32),ni[ci]=String.fromCharCode(ci);for(var ui in ii)ni.hasOwnProperty(ui)||(ni[ui]=ii[ui]);function fi(t){var e=!(hi&&(t.ctrlKey||t.altKey||t.metaKey)||(si||ai)&&t.shiftKey&&t.key&&1==t.key.length)&&t.key||(t.shiftKey?ni:ii)[t.keyCode]||t.key||"Unidentified";return"Esc"==e&&(e="Escape"),"Del"==e&&(e="Delete"),"Left"==e&&(e="ArrowLeft"),"Up"==e&&(e="ArrowUp"),"Right"==e&&(e="ArrowRight"),"Down"==e&&(e="ArrowDown"),e}function di(t){let e;return e=11==t.nodeType?t.getSelection?t:t.ownerDocument:t,e.getSelection()}function pi(t,e){return!!e&&(t==e||t.contains(1!=e.nodeType?e.parentNode:e))}function gi(t,e){if(!e.anchorNode)return!1;try{return pi(t,e.anchorNode)}catch(t){return!1}}function mi(t){return 3==t.nodeType?Pi(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function bi(t,e,i,n){return!!i&&(vi(t,e,i,n,-1)||vi(t,e,i,n,1))}function Oi(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function vi(t,e,i,n,r){for(;;){if(t==i&&e==n)return!0;if(e==(r<0?0:wi(t))){if("DIV"==t.nodeName)return!1;let i=t.parentNode;if(!i||1!=i.nodeType)return!1;e=Oi(t)+(r<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[e+(r<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;e=r<0?wi(t):0}}}function wi(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}const yi={left:0,right:0,top:0,bottom:0};function xi(t,e){let i=e?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function ki(t){return{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}class Si{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){this.set(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let Ci,Ai=null;function Ti(t){if(t.setActive)return t.setActive();if(Ai)return t.focus(Ai);let e=[];for(let i=t;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==Ai?{get preventScroll(){return Ai={preventScroll:!0},!0}}:void 0),!Ai){Ai=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],r=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=r&&(i.scrollLeft=r)}}}function Pi(t,e,i=e){let n=Ci||(Ci=document.createRange());return n.setEnd(t,i),n.setStart(t,e),n}function Mi(t,e,i){let n={key:e,code:e,keyCode:i,which:i,cancelable:!0},r=new KeyboardEvent("keydown",n);r.synthetic=!0,t.dispatchEvent(r);let s=new KeyboardEvent("keyup",n);return s.synthetic=!0,t.dispatchEvent(s),r.defaultPrevented||s.defaultPrevented}function Qi(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}class Ri{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new Ri(t.parentNode,Oi(t),e)}static after(t,e){return new Ri(t.parentNode,Oi(t)+1,e)}}const $i=[];class _i{constructor(){this.parent=null,this.dom=null,this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}coordsAt(t,e){return null}sync(t){if(2&this.dirty){let e,i=this.dom,n=null;for(let r of this.children){if(r.dirty){if(!r.dom&&(e=n?n.nextSibling:i.firstChild)){let t=_i.get(e);t&&(t.parent||t.constructor!=r.constructor)||r.reuseDOM(e)}r.sync(t),r.dirty=0}if(e=n?n.nextSibling:i.firstChild,t&&!t.written&&t.node==i&&e!=r.dom&&(t.written=!0),r.dom.parentNode==i)for(;e&&e!=r.dom;)e=Di(e);else i.insertBefore(r.dom,e);n=r.dom}for(e=n?n.nextSibling:i.firstChild,e&&t&&t.node==i&&(t.written=!0);e;)e=Di(e)}else if(1&this.dirty)for(let e of this.children)e.dirty&&(e.sync(t),e.dirty=0)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=0==wi(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==n&&e.firstChild!=e.lastChild&&(n=t==e.firstChild?-1:1),t=e}i=n<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!_i.get(i);)i=i.nextSibling;if(!i)return this.length;for(let t=0,e=0;;t++){let n=this.children[t];if(n.dom==i)return e;e+=n.length+n.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,r=-1,s=-1,o=-1;for(let l=0,a=i,h=i;l<this.children.length;l++){let i=this.children[l],c=a+i.length;if(a<t&&c>e)return i.domBoundsAround(t,e,a);if(c>=t&&-1==n&&(n=l,r=a),a>e&&i.dom.parentNode==this.dom){s=l,o=h;break}h=c,a=c+i.breakAfter}return{from:r,to:o<0?i+this.length:o,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:s<this.children.length&&s>=0?this.children[s].dom:null}}markDirty(t=!1){this.dirty|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.dirty|=2),1&e.dirty)return;e.dirty|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.dirty&&this.markParentsDirty(!0))}setDOM(t){this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=$i){this.markDirty();for(let i=t;i<e;i++){let t=this.children[i];t.parent==this&&t.destroy()}this.children.splice(t,e-t,...i);for(let t=0;t<i.length;t++)i[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new Ei(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}merge(t,e,i,n,r,s){return!1}become(t){return!1}getSide(){return 0}destroy(){this.parent=null}}function Di(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}_i.prototype.breakAfter=0;class Ei{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function Ni(t,e,i,n,r,s,o,l,a){let{children:h}=t,c=h.length?h[e]:null,u=s.length?s[s.length-1]:null,f=u?u.breakAfter:o;if(!(e==n&&c&&!o&&!f&&s.length<2&&c.merge(i,r,s.length?u:null,0==i,l,a))){if(n<h.length){let t=h[n];t&&r<t.length?(e==n&&(t=t.split(r),r=0),!f&&u&&t.merge(0,r,u,!0,0,a)?s[s.length-1]=t:(r&&t.merge(0,r,null,!1,0,a),s.push(t))):(null==t?void 0:t.breakAfter)&&(u?u.breakAfter=1:o=1),n++}for(c&&(c.breakAfter=o,i>0&&(!o&&s.length&&c.merge(i,c.length,s[0],!1,l,0)?c.breakAfter=s.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,l,0),e++));e<n&&s.length;)if(h[n-1].become(s[s.length-1]))n--,s.pop(),a=s.length?0:l;else{if(!h[e].become(s[0]))break;e++,s.shift(),l=s.length?0:a}!s.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,l,a)&&e--,(e<n||s.length)&&t.replaceChildren(e,n,s)}}function Bi(t,e,i,n,r,s){let o=t.childCursor(),{i:l,off:a}=o.findPos(i,1),{i:h,off:c}=o.findPos(e,-1),u=e-i;for(let t of n)u+=t.length;t.length+=u,Ni(t,h,c,l,a,n,0,r,s)}let Ii="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},zi="undefined"!=typeof document?document:{documentElement:{style:{}}};const Li=/Edge\/(\d+)/.exec(Ii.userAgent),Wi=/MSIE \d/.test(Ii.userAgent),Vi=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ii.userAgent),ji=!!(Wi||Vi||Li),qi=!ji&&/gecko\/(\d+)/i.test(Ii.userAgent),Hi=!ji&&/Chrome\/(\d+)/.exec(Ii.userAgent),Xi="webkitFontSmoothing"in zi.documentElement.style,Fi=!ji&&/Apple Computer/.test(Ii.vendor),Zi=Fi&&(/Mobile\/\w+/.test(Ii.userAgent)||Ii.maxTouchPoints>2);var Gi={mac:Zi||/Mac/.test(Ii.platform),windows:/Win/.test(Ii.platform),linux:/Linux|X11/.test(Ii.platform),ie:ji,ie_version:Wi?zi.documentMode||6:Vi?+Vi[1]:Li?+Li[1]:0,gecko:qi,gecko_version:qi?+(/Firefox\/(\d+)/.exec(Ii.userAgent)||[0,0])[1]:0,chrome:!!Hi,chrome_version:Hi?+Hi[1]:0,ios:Zi,android:/Android\b/.test(Ii.userAgent),webkit:Xi,safari:Fi,webkit_version:Xi?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=zi.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class Ui extends _i{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){3==t.nodeType&&this.createDOM(t)}merge(t,e,i){return(!i||i instanceof Ui&&!(this.length-(e-t)+i.length>256))&&(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new Ui(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new Ri(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return Ki(this.dom,t,e)}}class Yi extends _i{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let t of e)t.setParent(this)}setAttrs(t){if(Qi(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.dirty|=6)}sync(t){this.dom?4&this.dirty&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t)}merge(t,e,i,n,r,s){return(!i||!(!(i instanceof Yi&&i.mark.eq(this.mark))||t&&r<=0||e<this.length&&s<=0))&&(Bi(this,t,e,i?i.children:[],r-1,s-1),this.markDirty(),!0)}split(t){let e=[],i=0,n=-1,r=0;for(let s of this.children){let o=i+s.length;o>t&&e.push(i<t?s.split(t-i):s),n<0&&i>=t&&(n=r),i=o,r++}let s=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new Yi(this.mark,e,s)}domAtPos(t){return sn(this.dom,this.children,t)}coordsAt(t,e){return ln(this,t,e)}}function Ki(t,e,i){let n=t.nodeValue.length;e>n&&(e=n);let r=e,s=e,o=0;0==e&&i<0||e==n&&i>=0?Gi.chrome||Gi.gecko||(e?(r--,o=1):s<n&&(s++,o=-1)):i<0?r--:s<n&&s++;let l=Pi(t,r,s).getClientRects();if(!l.length)return yi;let a=l[(o?o<0:i>=0)?0:l.length-1];return Gi.safari&&!o&&0==a.width&&(a=Array.prototype.find.call(l,(t=>t.width))||a),o?xi(a,o<0):a||null}class Ji extends _i{constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}static create(t,e,i){return new(t.customView||Ji)(t,e,i)}split(t){let e=Ji.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(t,e,i,n,r,s){return!(i&&(!(i instanceof Ji&&this.widget.compare(i.widget))||t>0&&r<=0||e<this.length&&s<=0))&&(this.length=t+(i?i.length:0)+(this.length-e),!0)}become(t){return t.length==this.length&&t instanceof Ji&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.eq(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return at.empty;let t=this;for(;t.parent;)t=t.parent;let e=t.editorView,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):at.empty}domAtPos(t){return 0==t?Ri.before(this.dom):Ri.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.dom.getClientRects(),n=null;if(!i.length)return yi;for(let e=t>0?i.length-1:0;n=i[e],!(t>0?0==e:e==i.length-1||n.top<n.bottom);e+=t>0?-1:1);return 0==t&&e>0||t==this.length&&e<=0?n:xi(n,0==t)}get isEditable(){return!1}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class tn extends Ji{domAtPos(t){let{topView:e,text:i}=this.widget;return e?en(t,0,e,i,((t,e)=>t.domAtPos(e)),(t=>new Ri(i,Math.min(t,i.nodeValue.length)))):new Ri(i,Math.min(t,i.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(t,e){let{topView:i,text:n}=this.widget;return i?nn(t,e,i,n):Math.min(e,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(t,e){let{topView:i,text:n}=this.widget;return i?en(t,e,i,n,((t,e,i)=>t.coordsAt(e,i)),((t,e)=>Ki(n,t,e))):Ki(n,t,e)}destroy(){var t;super.destroy(),null===(t=this.widget.topView)||void 0===t||t.destroy()}get isEditable(){return!0}}function en(t,e,i,n,r,s){if(i instanceof Yi){for(let o of i.children){let i=pi(o.dom,n),l=i?n.nodeValue.length:o.length;if(t<l||t==l&&o.getSide()<=0)return i?en(t,e,o,n,r,s):r(o,t,e);t-=l}return r(i,i.length,-1)}return i.dom==n?s(t,e):r(i,t,e)}function nn(t,e,i,n){if(i instanceof Yi)for(let r of i.children){let i=0,s=pi(r.dom,n);if(pi(r.dom,t))return i+(s?nn(t,e,r,n):r.localPosFromDOM(t,e));i+=s?n.nodeValue.length:r.length}else if(i.dom==n)return Math.min(e,n.nodeValue.length);return i.localPosFromDOM(t,e)}class rn extends _i{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof rn&&t.side==this.side}split(){return new rn(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return Ri.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){let e=this.dom.getBoundingClientRect(),i=function(t,e){let i=t.parent,n=i?i.children.indexOf(t):-1;for(;i&&n>=0;)if(e<0?n>0:n<i.children.length){let t=i.children[n+e];if(t instanceof Ui){let i=t.coordsAt(e<0?t.length:0,e);if(i)return i}n+=e}else{if(!(i instanceof Yi&&i.parent)){let t=i.dom.lastChild;if(t&&"BR"==t.nodeName)return t.getClientRects()[0];break}n=i.parent.children.indexOf(i)+(e<0?0:1),i=i.parent}return}(this,this.side>0?-1:1);return i&&i.top<e.bottom&&i.bottom>e.top?{left:e.left,right:e.right,top:i.top,bottom:i.bottom}:e}get overrideDOMText(){return at.empty}}function sn(t,e,i){let n=0;for(let r=0;n<e.length;n++){let s=e[n],o=r+s.length;if(!(o==r&&s.getSide()<=0)){if(i>r&&i<o&&s.dom.parentNode==t)return s.domAtPos(i-r);if(i<=r)break;r=o}}for(;n>0;n--){let i=e[n-1].dom;if(i.parentNode==t)return Ri.after(i)}return new Ri(t,0)}function on(t,e,i){let n,{children:r}=t;i>0&&e instanceof Yi&&r.length&&(n=r[r.length-1])instanceof Yi&&n.mark.eq(e.mark)?on(n,e.children[0],i-1):(r.push(e),e.setParent(t)),t.length+=e.length}function ln(t,e,i){for(let n=0,r=0;r<t.children.length;r++){let s,o=t.children[r],l=n+o.length;if((i<=0||l==t.length||o.getSide()>0?l>=e:l>e)&&(e<l||r+1==t.children.length||(s=t.children[r+1]).length||s.getSide()>0)){let t=0;if(l==n){if(o.getSide()<=0)continue;t=i=-o.getSide()}let r=o.coordsAt(Math.max(0,e-n),i);return t&&r?xi(r,i<0):r}n=l}let n=t.dom.lastChild;if(!n)return t.dom.getBoundingClientRect();let r=mi(n);return r[r.length-1]||null}function an(t,e){for(let i in t)"class"==i&&e.class?e.class+=" "+t.class:"style"==i&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}function hn(t,e){if(t==e)return!0;if(!t||!e)return!1;let i=Object.keys(t),n=Object.keys(e);if(i.length!=n.length)return!1;for(let r of i)if(-1==n.indexOf(r)||t[r]!==e[r])return!1;return!0}function cn(t,e,i){let n=null;if(e)for(let r in e)i&&r in i||t.removeAttribute(n=r);if(i)for(let r in i)e&&e[r]==i[r]||t.setAttribute(n=r,i[r]);return!!n}Ui.prototype.children=Ji.prototype.children=rn.prototype.children=$i;class un{eq(t){return!1}updateDOM(t){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}ignoreEvent(t){return!0}get customView(){return null}destroy(t){}}var fn=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(fn||(fn={}));class dn extends $e{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new pn(t)}static widget(t){let e=t.side||0,i=!!t.block;return e+=i?e>0?3e8:-4e8:e>0?1e8:-1e8,new mn(t,e,e,i,t.widget||null,!1)}static replace(t){let e,i,n=!!t.block;if(t.isBlockGap)e=-5e8,i=4e8;else{let{start:r,end:s}=bn(t,n);e=(r?n?-3e8:-1:5e8)-1,i=1+(s?n?2e8:1:-6e8)}return new mn(t,e,i,n,t.widget||null,!0)}static line(t){return new gn(t)}static set(t,e=!1){return Ne.of(t,e)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}dn.none=Ne.empty;class pn extends dn{constructor(t){let{start:e,end:i}=bn(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){return this==t||t instanceof pn&&this.tagName==t.tagName&&this.class==t.class&&hn(this.attrs,t.attrs)}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}pn.prototype.point=!1;class gn extends dn{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof gn&&hn(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}gn.prototype.mapMode=Mt.TrackBefore,gn.prototype.point=!0;class mn extends dn{constructor(t,e,i,n,r,s){super(e,i,r,t),this.block=n,this.isReplace=s,this.mapMode=n?e<=0?Mt.TrackBefore:Mt.TrackAfter:Mt.TrackDel}get type(){return this.startSide<this.endSide?fn.WidgetRange:this.startSide<=0?fn.WidgetBefore:fn.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(t){return t instanceof mn&&(e=this.widget,i=t.widget,e==i||!!(e&&i&&e.compare(i)))&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide;var e,i}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}function bn(t,e=!1){let{inclusiveStart:i,inclusiveEnd:n}=t;return null==i&&(i=t.inclusive),null==n&&(n=t.inclusive),{start:null!=i?i:e,end:null!=n?n:e}}function On(t,e,i,n=0){let r=i.length-1;r>=0&&i[r]+n>=t?i[r]=Math.max(i[r],e):i.push(t,e)}mn.prototype.point=!0;class vn extends _i{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,r,s){if(i){if(!(i instanceof vn))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),Bi(this,t,e,i?i.children:[],r,s),!0}split(t){let e=new vn;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let t=i;t<this.children.length;t++)e.append(this.children[t],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){hn(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){on(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=an(e,this.attrs||{})),i&&(this.attrs=an({class:i},this.attrs||{}))}domAtPos(t){return sn(this.dom,this.children,t)}reuseDOM(t){"DIV"==t.nodeName&&(this.setDOM(t),this.dirty|=6)}sync(t){var e;this.dom?4&this.dirty&&(Qi(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(cn(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t);let i=this.dom.lastChild;for(;i&&_i.get(i)instanceof Yi;)i=i.lastChild;if(!(i&&this.length&&("BR"==i.nodeName||0!=(null===(e=_i.get(i))||void 0===e?void 0:e.isEditable)||Gi.ios&&this.children.some((t=>t instanceof Ui))))){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t=0;for(let e of this.children){if(!(e instanceof Ui))return null;let i=mi(e.dom);if(1!=i.length)return null;t+=i[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length}}coordsAt(t,e){return ln(this,t,e)}become(t){return!1}get type(){return fn.Text}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let r=t.children[i],s=n+r.length;if(s>=e){if(r instanceof vn)return r;if(s>e)break}n=s+r.breakAfter}return null}}class wn extends _i{constructor(t,e,i){super(),this.widget=t,this.length=e,this.type=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,r,s){return!(i&&(!(i instanceof wn&&this.widget.compare(i.widget))||t>0&&r<=0||e<this.length&&s<=0))&&(this.length=t+(i?i.length:0)+(this.length-e),!0)}domAtPos(t){return 0==t?Ri.before(this.dom):Ri.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new wn(this.widget,e,this.type);return i.breakAfter=this.breakAfter,i}get children(){return $i}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):at.empty}domBoundsAround(){return null}become(t){return t instanceof wn&&t.type==this.type&&t.widget.constructor==this.widget.constructor&&(t.widget.eq(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class yn{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof wn&&t.type==fn.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new vn),this.atCursorPos=!0),this.curLine}flushBuffer(t){this.pendingBuffer&&(this.curLine.append(xn(new rn(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer([]),this.curLine=null,this.content.push(t)}finish(t){t?this.pendingBuffer=0:this.flushBuffer([]),this.posCovered()||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:i,done:n}=this.cursor.next(this.skip);if(this.skip=0,n)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer([]),this.curLine=null,t--;continue}this.text=e,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(0,i)),this.getLine().append(xn(new Ui(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,r,s){if(this.disallowBlockEffectsFor[s]&&i instanceof mn){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=e-t;if(i instanceof mn)if(i.block){let{type:t}=i;t!=fn.WidgetAfter||this.posCovered()||this.getLine(),this.addBlockWidget(new wn(i.widget||new kn("div"),o,t))}else{let s=Ji.create(i.widget||new kn("span"),o,i.startSide),l=this.atCursorPos&&!s.isEditable&&r<=n.length&&(t<e||i.startSide>0),a=!s.isEditable&&(t<e||i.startSide<=0),h=this.getLine();2!=this.pendingBuffer||l||(this.pendingBuffer=0),this.flushBuffer(n),l&&(h.append(xn(new rn(1),n),r),r=n.length+Math.max(0,r-n.length)),h.append(xn(s,n),r),this.atCursorPos=a,this.pendingBuffer=a?t<e?1:2:0}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=r)}static build(t,e,i,n,r){let s=new yn(t,e,i,r);return s.openEnd=Ne.spans(n,e,i,s),s.openStart<0&&(s.openStart=s.openEnd),s.finish(s.openEnd),s}}function xn(t,e){for(let i of e)t=new Yi(i,[t],t.length);return t}class kn extends un{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}}const Sn=Vt.define(),Cn=Vt.define(),An=Vt.define(),Tn=Vt.define(),Pn=Vt.define(),Mn=Vt.define(),Qn=Vt.define({combine:t=>t.some((t=>t))});class Rn{constructor(t,e="nearest",i="nearest",n=5,r=5){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=r}map(t){return t.empty?this:new Rn(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin)}}const $n=Oe.define({map:(t,e)=>t.map(e)});function _n(t,e,i){let n=t.facet(Tn);n.length?n[0](e):window.onerror?window.onerror(String(e),i,void 0,void 0,e):i?console.error(i+":",e):console.error(e)}const Dn=Vt.define({combine:t=>!t.length||t[0]});let En=0;const Nn=Vt.define();class Bn{constructor(t,e,i,n){this.id=t,this.create=e,this.domEventHandlers=i,this.extension=n(this)}static define(t,e){const{eventHandlers:i,provide:n,decorations:r}=e||{};return new Bn(En++,t,i,(t=>{let e=[Nn.of(t)];return r&&e.push(Wn.of((e=>{let i=e.plugin(t);return i?r(i):dn.none}))),n&&e.push(n(t)),e}))}static fromClass(t,e){return Bn.define((e=>new t(e)),e)}}class In{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(e){if(_n(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){_n(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null===(e=this.value)||void 0===e?void 0:e.destroy)try{this.value.destroy()}catch(e){_n(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const zn=Vt.define(),Ln=Vt.define(),Wn=Vt.define(),Vn=Vt.define(),jn=Vt.define(),qn=Vt.define();class Hn{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new Hn(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(0==e.length)return t;let i=[];for(let n=0,r=0,s=0,o=0;;n++){let l=n==t.length?null:t[n],a=s-o,h=l?l.fromB:1e9;for(;r<e.length&&e[r]<h;){let t=e[r],n=e[r+1],s=Math.max(o,t),l=Math.min(h,n);if(s<=l&&new Hn(s+a,l+a,s,l).addToSet(i),n>h)break;r+=2}if(!l)return i;new Hn(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),s=l.toA,o=l.toB}}}class Xn{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=Rt.empty(this.startState.doc.length);for(let t of i)this.changes=this.changes.compose(t.changes);let n=[];this.changes.iterChangedRanges(((t,e,i,r)=>n.push(new Hn(t,e,i,r)))),this.changedRanges=n;let r=t.hasFocus;r!=t.inputState.notifiedFocused&&(t.inputState.notifiedFocused=r,this.flags|=1)}static create(t,e,i){return new Xn(t,e,i)}get viewportChanged(){return(4&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(10&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((t=>t.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}var Fn=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(Fn||(Fn={}));const Zn=Fn.LTR,Gn=Fn.RTL;function Un(t){let e=[];for(let i=0;i<t.length;i++)e.push(1<<+t[i]);return e}const Yn=Un("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Kn=Un("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Jn=Object.create(null),tr=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),i=t.charCodeAt(1);Jn[e]=i,Jn[i]=-e}const er=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;class ir{constructor(t,e,i){this.from=t,this.to=e,this.level=i}get dir(){return this.level%2?Gn:Zn}side(t,e){return this.dir==e==t?this.to:this.from}static find(t,e,i,n){let r=-1;for(let s=0;s<t.length;s++){let o=t[s];if(o.from<=e&&o.to>=e){if(o.level==i)return s;(r<0||(0!=n?n<0?o.from<e:o.to>e:t[r].level>o.level))&&(r=s)}}if(r<0)throw new RangeError("Index out of range");return r}}const nr=[];function rr(t){return[new ir(0,t,0)]}let sr="";function or(t,e,i,n,r){var s;let o=n.head-t.from,l=-1;if(0==o){if(!r||!t.length)return null;e[0].level!=i&&(o=e[0].side(!1,i),l=0)}else if(o==t.length){if(r)return null;let t=e[e.length-1];t.level!=i&&(o=t.side(!0,i),l=e.length-1)}l<0&&(l=ir.find(e,o,null!==(s=n.bidiLevel)&&void 0!==s?s:-1,n.assoc));let a=e[l];o==a.side(r,i)&&(a=e[l+=r?1:-1],o=a.side(!r,i));let h=r==(a.dir==i),c=wt(t.text,o,h);if(sr=t.text.slice(Math.min(o,c),Math.max(o,c)),c!=a.side(r,i))return zt.cursor(c+t.from,h?-1:1,a.level);let u=l==(r?e.length-1:0)?null:e[l+(r?1:-1)];return u||a.level==i?u&&u.level<a.level?zt.cursor(u.side(!r,i)+t.from,r?1:-1,u.level):zt.cursor(c+t.from,r?-1:1,a.level):zt.cursor(r?t.to:t.from,r?-1:1,i)}const lr="￿";class ar{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(Qe.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=lr}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n),this.readNode(n);let t=n.nextSibling;if(t==e)break;let r=_i.get(n),s=_i.get(t);(r&&s?r.breakAfter:(r?r.breakAfter:hr(n))||hr(t)&&("BR"!=n.nodeName||n.cmIgnore))&&this.lineBreak(),n=t}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let r,s=-1,o=1;if(this.lineSeparator?(s=e.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(r=n.exec(e))&&(s=r.index,o=r[0].length),this.append(e.slice(i,s<0?e.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let e of this.points)e.node==t&&e.pos>this.text.length&&(e.pos-=o-1);i=s+o}}readNode(t){if(t.cmIgnore)return;let e=_i.get(t),i=e&&e.overrideDOMText;if(null!=i){this.findPointInside(t,i.length);for(let t=i.iter();!t.next().done;)t.lineBreak?this.lineBreak():this.append(t.value)}else 3==t.nodeType?this.readTextNode(t):"BR"==t.nodeName?t.nextSibling&&this.lineBreak():1==t.nodeType&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(3==t.nodeType?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+Math.min(e,i.offset))}}function hr(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}class cr{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class ur extends _i{constructor(t){super(),this.view=t,this.compositionDeco=dn.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new vn],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Hn(0,0,0,t.state.doc.length)],0)}get root(){return this.view.root}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(t){let e=t.changedRanges;this.minWidth>0&&e.length&&(e.every((({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo))?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=dn.none:(t.transactions.length||this.dirty)&&(this.compositionDeco=function(t,e){let i=dr(t);if(!i)return dn.none;let{from:n,to:r,node:s,text:o}=i,l=e.mapPos(n,1),a=Math.max(l,e.mapPos(r,-1)),{state:h}=t,c=3==s.nodeType?s.nodeValue:new ar([],h).readRange(s.firstChild,null).text;if(a-l<c.length)if(h.doc.sliceString(l,Math.min(h.doc.length,l+c.length),lr)==c)a=l+c.length;else{if(h.doc.sliceString(Math.max(0,a-c.length),a,lr)!=c)return dn.none;l=a-c.length}else if(h.doc.sliceString(l,a,lr)!=c)return dn.none;let u=_i.get(s);u instanceof tn?u=u.widget.topView:u&&(u.parent=null);return dn.set(dn.replace({widget:new pr(s,o,u),inclusive:!0}).range(l,a))}(this.view,t.changes)),(Gi.ie||Gi.chrome)&&!this.compositionDeco.size&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let i=function(t,e,i){let n=new mr;return Ne.compare(t,e,i,n),n.changes}(this.decorations,this.updateDeco(),t.changes);return e=Hn.extendWithRanges(e,i),(0!=this.dirty||0!=e.length)&&(this.updateInner(e,t.startState.doc.length),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e);let{observer:i}=this.view;i.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let t=Gi.chrome||Gi.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(t),this.dirty=0,t&&(t.written||i.selectionRange.focusNode!=t.node)&&(this.forceSelection=!0),this.dom.style.height=""}));let n=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let t of this.children)t instanceof wn&&t.widget instanceof fr&&n.push(t.dom);i.updateGaps(n)}updateChildren(t,e){let i=this.childCursor(e);for(let e=t.length-1;;e--){let n=e>=0?t[e]:null;if(!n)break;let{fromA:r,toA:s,fromB:o,toB:l}=n,{content:a,breakAtStart:h,openStart:c,openEnd:u}=yn.build(this.view.state.doc,o,l,this.decorations,this.dynamicDecorationMap),{i:f,off:d}=i.findPos(s,1),{i:p,off:g}=i.findPos(r,-1);Ni(this,p,g,f,d,a,h,c,u)}}updateSelection(t=!1,e=!1){if(!t&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange(),!e&&!this.mayControlSelection()||Gi.ios&&this.view.inputState.rapidCompositionStart)return;let i=this.forceSelection;this.forceSelection=!1;let n=this.view.state.selection.main,r=this.domAtPos(n.anchor),s=n.empty?r:this.domAtPos(n.head);if(Gi.gecko&&n.empty&&(1==(o=r).node.nodeType&&o.node.firstChild&&(0==o.offset||"false"==o.node.childNodes[o.offset-1].contentEditable)&&(o.offset==o.node.childNodes.length||"false"==o.node.childNodes[o.offset].contentEditable))){let t=document.createTextNode("");this.view.observer.ignore((()=>r.node.insertBefore(t,r.node.childNodes[r.offset]||null))),r=s=new Ri(t,0),i=!0}var o;let l=this.view.observer.selectionRange;!i&&l.focusNode&&bi(r.node,r.offset,l.anchorNode,l.anchorOffset)&&bi(s.node,s.offset,l.focusNode,l.focusOffset)||(this.view.observer.ignore((()=>{Gi.android&&Gi.chrome&&this.dom.contains(l.focusNode)&&function(t,e){for(let i=t;i&&i!=e;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}(l.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let t=di(this.root);if(t)if(n.empty){if(Gi.gecko){let t=(e=r.node,i=r.offset,1!=e.nodeType?0:(i&&"false"==e.childNodes[i-1].contentEditable?1:0)|(i<e.childNodes.length&&"false"==e.childNodes[i].contentEditable?2:0));if(t&&3!=t){let e=gr(r.node,r.offset,1==t?1:-1);e&&(r=new Ri(e,1==t?0:e.nodeValue.length))}}t.collapse(r.node,r.offset),null!=n.bidiLevel&&null!=l.cursorBidiLevel&&(l.cursorBidiLevel=n.bidiLevel)}else if(t.extend)t.collapse(r.node,r.offset),t.extend(s.node,s.offset);else{let e=document.createRange();n.anchor>n.head&&([r,s]=[s,r]),e.setEnd(s.node,s.offset),e.setStart(r.node,r.offset),t.removeAllRanges(),t.addRange(e)}else;var e,i})),this.view.observer.setSelectionRange(r,s)),this.impreciseAnchor=r.precise?null:new Ri(l.anchorNode,l.anchorOffset),this.impreciseHead=s.precise?null:new Ri(l.focusNode,l.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let t=this.view.state.selection.main,e=di(this.root);if(!(e&&t.empty&&t.assoc&&e.modify))return;let i=vn.find(this,t.head);if(!i)return;let n=i.posAtStart;if(t.head==n||t.head==n+i.length)return;let r=this.coordsAt(t.head,-1),s=this.coordsAt(t.head,1);if(!r||!s||r.bottom>s.top)return;let o=this.domAtPos(t.head+t.assoc);e.collapse(o.node,o.offset),e.modify("move",t.assoc<0?"forward":"backward","lineboundary")}mayControlSelection(){let t=this.root.activeElement;return t==this.dom||gi(this.dom,this.view.observer.selectionRange)&&!(t&&this.dom.contains(t))}nearest(t){for(let e=t;e;){let t=_i.get(e);if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(i<t.length||t instanceof vn)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){for(let i=this.length,n=this.children.length-1;;n--){let r=this.children[n],s=i-r.breakAfter-r.length;if(t>s||t==s&&r.type!=fn.WidgetBefore&&r.type!=fn.WidgetAfter&&(!n||2==e||this.children[n-1].breakAfter||this.children[n-1].type==fn.WidgetBefore&&e>-2))return r.coordsAt(t-s,e);i=s}}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,r=this.view.contentDOM.clientWidth,s=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,l=this.view.textDirection==Fn.LTR;for(let t=0,a=0;a<this.children.length;a++){let h=this.children[a],c=t+h.length;if(c>n)break;if(t>=i){let i=h.dom.getBoundingClientRect();if(e.push(i.height),s){let e=h.dom.lastChild,n=e?mi(e):[];if(n.length){let e=n[n.length-1],s=l?e.right-i.left:i.right-e.left;s>o&&(o=s,this.minWidth=r,this.minWidthFrom=t,this.minWidthTo=c)}}}t=c+h.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return"rtl"==getComputedStyle(this.children[e].dom).direction?Fn.RTL:Fn.LTR}measureTextSize(){for(let t of this.children)if(t instanceof vn){let e=t.measureTextSize();if(e)return e}let t,e,i=document.createElement("div");return i.className="cm-line",i.style.width="99999px",i.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(i);let n=mi(i.firstChild)[0];t=i.getBoundingClientRect().height,e=n?n.width/27:7,i.remove()})),{lineHeight:t,charWidth:e}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new Ei(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let r=n==e.viewports.length?null:e.viewports[n],s=r?r.from-1:this.length;if(s>i){let n=e.lineBlockAt(s).bottom-e.lineBlockAt(i).top;t.push(dn.replace({widget:new fr(n),block:!0,inclusive:!0,isBlockGap:!0}).range(i,s))}if(!r)break;i=r.to+1}return dn.set(t)}updateDeco(){let t=this.view.state.facet(Wn).map(((t,e)=>(this.dynamicDecorationMap[e]="function"==typeof t)?t(this.view):t));for(let e=t.length;e<t.length+3;e++)this.dynamicDecorationMap[e]=!1;return this.decorations=[...t,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(t){let e,{range:i}=t,n=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1);if(!n)return;!i.empty&&(e=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(n={left:Math.min(n.left,e.left),top:Math.min(n.top,e.top),right:Math.max(n.right,e.right),bottom:Math.max(n.bottom,e.bottom)});let r=0,s=0,o=0,l=0;for(let t of this.view.state.facet(jn).map((t=>t(this.view))))if(t){let{left:e,right:i,top:n,bottom:a}=t;null!=e&&(r=Math.max(r,e)),null!=i&&(s=Math.max(s,i)),null!=n&&(o=Math.max(o,n)),null!=a&&(l=Math.max(l,a))}let a={left:n.left-r,top:n.top-o,right:n.right+s,bottom:n.bottom+l};!function(t,e,i,n,r,s,o,l){let a=t.ownerDocument,h=a.defaultView;for(let c=t;c;)if(1==c.nodeType){let t,u=c==a.body;if(u)t=ki(h);else{if(c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.parentNode;continue}let e=c.getBoundingClientRect();t={left:e.left,right:e.left+c.clientWidth,top:e.top,bottom:e.top+c.clientHeight}}let f=0,d=0;if("nearest"==r)e.top<t.top?(d=-(t.top-e.top+o),i>0&&e.bottom>t.bottom+d&&(d=e.bottom-t.bottom+d+o)):e.bottom>t.bottom&&(d=e.bottom-t.bottom+o,i<0&&e.top-d<t.top&&(d=-(t.top+d-e.top+o)));else{let n=e.bottom-e.top,s=t.bottom-t.top;d=("center"==r&&n<=s?e.top+n/2-s/2:"start"==r||"center"==r&&i<0?e.top-o:e.bottom-s+o)-t.top}if("nearest"==n?e.left<t.left?(f=-(t.left-e.left+s),i>0&&e.right>t.right+f&&(f=e.right-t.right+f+s)):e.right>t.right&&(f=e.right-t.right+s,i<0&&e.left<t.left+f&&(f=-(t.left+f-e.left+s))):f=("center"==n?e.left+(e.right-e.left)/2-(t.right-t.left)/2:"start"==n==l?e.left-s:e.right-(t.right-t.left)+s)-t.left,f||d)if(u)h.scrollBy(f,d);else{if(d){let t=c.scrollTop;c.scrollTop+=d,d=c.scrollTop-t}if(f){let t=c.scrollLeft;c.scrollLeft+=f,f=c.scrollLeft-t}e={left:e.left-f,top:e.top-d,right:e.right-f,bottom:e.bottom-d}}if(u)break;c=c.assignedSlot||c.parentNode,n=r="nearest"}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,a,i.head<i.anchor?-1:1,t.x,t.y,t.xMargin,t.yMargin,this.view.textDirection==Fn.LTR)}}class fr extends un{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function dr(t){let e=t.observer.selectionRange,i=e.focusNode&&gr(e.focusNode,e.focusOffset,0);if(!i)return null;let n=t.docView.nearest(i);if(!n)return null;if(n instanceof vn){let t=i;for(;t.parentNode!=n.dom;)t=t.parentNode;let e=t.previousSibling;for(;e&&!_i.get(e);)e=e.previousSibling;let r=e?_i.get(e).posAtEnd:n.posAtStart;return{from:r,to:r,node:t,text:i}}{for(;;){let{parent:t}=n;if(!t)return null;if(t instanceof vn)break;n=t}let t=n.posAtStart;return{from:t,to:t+n.length,node:n.dom,text:i}}}class pr extends un{constructor(t,e,i){super(),this.top=t,this.text=e,this.topView=i}eq(t){return this.top==t.top&&this.text==t.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return tn}}function gr(t,e,i){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0&&i<=0)e=wi(t=t.childNodes[e-1]);else{if(!(1==t.nodeType&&e<t.childNodes.length&&i>=0))return null;t=t.childNodes[e],e=0}}}class mr{constructor(){this.changes=[]}compareRange(t,e){On(t,e,this.changes)}comparePoint(t,e){On(t,e,this.changes)}}function br(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function Or(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function vr(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function wr(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function yr(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function xr(t,e,i){let n,r,s,o,l,a,h,c;for(let u=t.firstChild;u;u=u.nextSibling){let t=mi(u);for(let f=0;f<t.length;f++){let d=t[f];r&&vr(r,d)&&(d=wr(yr(d,r.bottom),r.top));let p=br(e,d),g=Or(i,d);if(0==p&&0==g)return 3==u.nodeType?kr(u,e,i):xr(u,e,i);(!n||o>g||o==g&&s>p)&&(n=u,r=d,s=p,o=g),0==p?i>d.bottom&&(!h||h.bottom<d.bottom)?(l=u,h=d):i<d.top&&(!c||c.top>d.top)&&(a=u,c=d):h&&vr(h,d)?h=yr(h,d.bottom):c&&vr(c,d)&&(c=wr(c,d.top))}}if(h&&h.bottom>=i?(n=l,r=h):c&&c.top<=i&&(n=a,r=c),!n)return{node:t,offset:0};let u=Math.max(r.left,Math.min(r.right,e));return 3==n.nodeType?kr(n,u,i):s||"true"!=n.contentEditable?{node:t,offset:Array.prototype.indexOf.call(t.childNodes,n)+(e>=(r.left+r.right)/2?1:0)}:xr(n,u,i)}function kr(t,e,i){let n=t.nodeValue.length,r=-1,s=1e9,o=0;for(let l=0;l<n;l++){let n=Pi(t,l,l+1).getClientRects();for(let a=0;a<n.length;a++){let h=n[a];if(h.top==h.bottom)continue;o||(o=e-h.left);let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&c<s){let i=e>=(h.left+h.right)/2,n=i;if(Gi.chrome||Gi.gecko){Pi(t,l).getBoundingClientRect().left==h.right&&(n=!i)}if(c<=0)return{node:t,offset:l+(n?1:0)};r=l+(n?1:0),s=c}}}return{node:t,offset:r>-1?r:o>0?t.nodeValue.length:0}}function Sr(t,{x:e,y:i},n,r=-1){var s;let o,l=t.contentDOM.getBoundingClientRect(),a=l.top+t.viewState.paddingTop,{docHeight:h}=t.viewState,c=i-a;if(c<0)return 0;if(c>h)return t.state.doc.length;for(let e=t.defaultLineHeight/2,i=!1;o=t.elementAtHeight(c),o.type!=fn.Text;)for(;c=r>0?o.bottom+e:o.top-e,!(c>=0&&c<=h);){if(i)return n?null:0;i=!0,r=-r}i=a+c;let u=o.from;if(u<t.viewport.from)return 0==t.viewport.from?0:n?null:Cr(t,l,o,e,i);if(u>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:n?null:Cr(t,l,o,e,i);let f=t.dom.ownerDocument,d=t.root.elementFromPoint?t.root:f,p=d.elementFromPoint(e,i);p&&!t.contentDOM.contains(p)&&(p=null),p||(e=Math.max(l.left+1,Math.min(l.right-1,e)),p=d.elementFromPoint(e,i),p&&!t.contentDOM.contains(p)&&(p=null));let g,m=-1;if(p&&0!=(null===(s=t.docView.nearest(p))||void 0===s?void 0:s.isEditable))if(f.caretPositionFromPoint){let t=f.caretPositionFromPoint(e,i);t&&({offsetNode:g,offset:m}=t)}else if(f.caretRangeFromPoint){let t=f.caretRangeFromPoint(e,i);t&&(({startContainer:g,startOffset:m}=t),(Gi.safari&&function(t,e,i){let n;if(3!=t.nodeType||e!=(n=t.nodeValue.length))return!1;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return Pi(t,n-1,n).getBoundingClientRect().left>i}(g,m,e)||Gi.chrome&&function(t,e,i){if(0!=e)return!1;for(let e=t;;){let t=e.parentNode;if(!t||1!=t.nodeType||t.firstChild!=e)return!1;if(t.classList.contains("cm-line"))break;e=t}let n=1==t.nodeType?t.getBoundingClientRect():Pi(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect();return i-n.left>5}(g,m,e))&&(g=void 0))}if(!g||!t.docView.dom.contains(g)){let n=vn.find(t.docView,u);if(!n)return c>o.top+o.height/2?o.to:o.from;({node:g,offset:m}=xr(n.dom,e,i))}return t.docView.posFromDOM(g,m)}function Cr(t,e,i,n,r){let s=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&i.height>1.5*t.defaultLineHeight){s+=Math.floor((r-i.top)/t.defaultLineHeight)*t.viewState.heightOracle.lineLength}let o=t.state.sliceDoc(i.from,i.to);return i.from+Ge(o,s,t.state.tabSize)}function Ar(t,e,i,n){let r=t.state.doc.lineAt(e.head),s=t.bidiSpans(r),o=t.textDirectionAt(r.from);for(let l=e,a=null;;){let e=or(r,s,o,l,i),h=sr;if(!e){if(r.number==(i?t.state.doc.lines:1))return l;h="\n",r=t.state.doc.line(r.number+(i?1:-1)),s=t.bidiSpans(r),e=zt.cursor(i?r.from:r.to)}if(a){if(!a(h))return l}else{if(!n)return e;a=n(h)}l=e}}function Tr(t,e,i){let n=t.state.facet(Vn).map((e=>e(t)));for(;;){let t=!1;for(let r of n)r.between(i.from-1,i.from+1,((n,r,s)=>{i.from>n&&i.from<r&&(i=e.from>i.from?zt.cursor(n,1):zt.cursor(r,-1),t=!0)}));if(!t)return i}}class Pr{constructor(t){this.lastKeyCode=0,this.lastKeyTime=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.rapidCompositionStart=!1,this.mouseSelection=null;for(let e in _r){let i=_r[e];t.contentDOM.addEventListener(e,(n=>{$r(t,n)&&!this.ignoreDuringComposition(n)&&("keydown"==e&&this.keydown(t,n)||(this.mustFlushObserver(n)&&t.observer.forceFlush(),this.runCustomHandlers(e,t,n)?n.preventDefault():i(t,n)))})),this.registeredEvents.push(e)}Gi.chrome&&Gi.chrome_version>=102&&t.scrollDOM.addEventListener("wheel",(()=>{this.chromeScrollHack<0?t.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout((()=>{this.chromeScrollHack=-1,t.contentDOM.style.pointerEvents=""}),100)}),{passive:!0}),this.notifiedFocused=t.hasFocus,Gi.safari&&t.contentDOM.addEventListener("input",(()=>null))}setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}ensureHandlers(t,e){var i;let n;this.customHandlers=[];for(let r of e)if(n=null===(i=r.update(t).spec)||void 0===i?void 0:i.domEventHandlers){this.customHandlers.push({plugin:r.value,handlers:n});for(let e in n)this.registeredEvents.indexOf(e)<0&&"scroll"!=e&&(this.registeredEvents.push(e),t.contentDOM.addEventListener(e,(i=>{$r(t,i)&&this.runCustomHandlers(e,t,i)&&i.preventDefault()})))}}runCustomHandlers(t,e,i){for(let n of this.customHandlers){let r=n.handlers[t];if(r)try{if(r.call(n.plugin,i,e)||i.defaultPrevented)return!0}catch(t){_n(e.state,t)}}return!1}runScrollHandlers(t,e){for(let i of this.customHandlers){let n=i.handlers.scroll;if(n)try{n.call(i.plugin,e,t)}catch(e){_n(t.state,e)}}}keydown(t,e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),9==e.keyCode&&Date.now()<this.lastEscPress+2e3)return!0;if(Gi.android&&Gi.chrome&&!e.synthetic&&(13==e.keyCode||8==e.keyCode))return t.observer.delayAndroidKey(e.key,e.keyCode),!0;let i;return!(!Gi.ios||!(i=Mr.find((t=>t.keyCode==e.keyCode)))||e.ctrlKey||e.altKey||e.metaKey||e.synthetic)&&(this.pendingIOSKey=i,setTimeout((()=>this.flushIOSKey(t)),250),!0)}flushIOSKey(t){let e=this.pendingIOSKey;return!!e&&(this.pendingIOSKey=void 0,Mi(t.contentDOM,e.key,e.keyCode))}ignoreDuringComposition(t){return!!/^key/.test(t.type)&&(this.composing>0||!!(Gi.safari&&Date.now()-this.compositionEndedAt<100)&&(this.compositionEndedAt=0,!0))}mustFlushObserver(t){return"keydown"==t.type&&229!=t.keyCode||"compositionend"==t.type&&!Gi.ios}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.mouseSelection&&this.mouseSelection.update(t),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const Mr=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Qr=[16,17,18,20,91,92,224,225];class Rr{constructor(t,e,i,n){this.view=t,this.style=i,this.mustSelect=n,this.lastEvent=e;let r=t.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(Qe.allowMultipleSelections)&&function(t,e){let i=t.state.facet(Sn);return i.length?i[0](e):Gi.mac?e.metaKey:e.ctrlKey}(t,e),this.dragMove=function(t,e){let i=t.state.facet(Cn);return i.length?i[0](e):Gi.mac?!e.altKey:!e.ctrlKey}(t,e),this.dragging=!(!function(t,e){let{main:i}=t.state.selection;if(i.empty)return!1;let n=di(t.root);if(!n||0==n.rangeCount)return!0;let r=n.getRangeAt(0).getClientRects();for(let t=0;t<r.length;t++){let i=r[t];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}(t,e)||1!=Xr(e))&&null,!1===this.dragging&&(e.preventDefault(),this.select(e))}move(t){if(0==t.buttons)return this.destroy();!1===this.dragging&&this.select(this.lastEvent=t)}up(t){null==this.dragging&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}select(t){let e=this.style.get(t,this.extend,this.multiple);!this.mustSelect&&e.eq(this.view.state.selection)&&e.main.assoc==this.view.state.selection.main.assoc||this.view.dispatch({selection:e,userEvent:"select.pointer",scrollIntoView:!0}),this.mustSelect=!1}update(t){t.docChanged&&this.dragging&&(this.dragging=this.dragging.map(t.changes)),this.style.update(t)&&setTimeout((()=>this.select(this.lastEvent)),20)}}function $r(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i,n=e.target;n!=t.contentDOM;n=n.parentNode)if(!n||11==n.nodeType||(i=_i.get(n))&&i.ignoreEvent(e))return!1;return!0}const _r=Object.create(null),Dr=Gi.ie&&Gi.ie_version<15||Gi.ios&&Gi.webkit_version<604;function Er(t,e){let i,{state:n}=t,r=1,s=n.toText(e),o=s.lines==n.selection.ranges.length;if(null!=Zr&&n.selection.ranges.every((t=>t.empty))&&Zr==s.toString()){let t=-1;i=n.changeByRange((i=>{let l=n.doc.lineAt(i.from);if(l.from==t)return{range:i};t=l.from;let a=n.toText((o?s.line(r++).text:e)+n.lineBreak);return{changes:{from:l.from,insert:a},range:zt.cursor(i.from+a.length)}}))}else i=o?n.changeByRange((t=>{let e=s.line(r++);return{changes:{from:t.from,to:t.to,insert:e.text},range:zt.cursor(t.from+e.length)}})):n.replaceSelection(s);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}_r.keydown=(t,e)=>{t.inputState.setSelectionOrigin("select"),27==e.keyCode?t.inputState.lastEscPress=Date.now():Qr.indexOf(e.keyCode)<0&&(t.inputState.lastEscPress=0)};let Nr=0;function Br(t,e,i,n){if(1==n)return zt.cursor(e,i);if(2==n)return function(t,e,i=1){let n=t.charCategorizer(e),r=t.doc.lineAt(e),s=e-r.from;if(0==r.length)return zt.cursor(e);0==s?i=1:s==r.length&&(i=-1);let o=s,l=s;i<0?o=wt(r.text,s,!1):l=wt(r.text,s);let a=n(r.text.slice(o,l));for(;o>0;){let t=wt(r.text,o,!1);if(n(r.text.slice(t,o))!=a)break;o=t}for(;l<r.length;){let t=wt(r.text,l);if(n(r.text.slice(l,t))!=a)break;l=t}return zt.range(o+r.from,l+r.from)}(t.state,e,i);{let i=vn.find(t.docView,e),n=t.state.doc.lineAt(i?i.posAtEnd:e),r=i?i.posAtStart:n.from,s=i?i.posAtEnd:n.to;return s<t.state.doc.length&&s==n.to&&s++,zt.range(r,s)}}_r.touchstart=(t,e)=>{Nr=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},_r.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")},_r.mousedown=(t,e)=>{if(t.observer.flush(),Nr>Date.now()-2e3&&1==Xr(e))return;let i=null;for(let n of t.state.facet(An))if(i=n(t,e),i)break;if(i||0!=e.button||(i=function(t,e){let i=Wr(t,e),n=Xr(e),r=t.state.selection,s=i,o=e;return{update(t){t.docChanged&&(i&&(i.pos=t.changes.mapPos(i.pos)),r=r.map(t.changes),o=null)},get(e,l,a){let h;if(o&&e.clientX==o.clientX&&e.clientY==o.clientY?h=s:(h=s=Wr(t,e),o=e),!h||!i)return r;let c=Br(t,h.pos,h.bias,n);if(i.pos!=h.pos&&!l){let e=Br(t,i.pos,i.bias,n),r=Math.min(e.from,c.from),s=Math.max(e.to,c.to);c=r<c.from?zt.range(r,s):zt.range(s,r)}return l?r.replaceRange(r.main.extend(c.from,c.to)):a&&r.ranges.length>1&&r.ranges.some((t=>t.eq(c)))?function(t,e){for(let i=0;;i++)if(t.ranges[i].eq(e))return zt.create(t.ranges.slice(0,i).concat(t.ranges.slice(i+1)),t.mainIndex==i?0:t.mainIndex-(t.mainIndex>i?1:0))}(r,c):a?r.addRange(c):zt.create([c])}}}(t,e)),i){let n=t.root.activeElement!=t.contentDOM;n&&t.observer.ignore((()=>Ti(t.contentDOM))),t.inputState.startMouseSelection(new Rr(t,e,i,n))}};let Ir=(t,e)=>t>=e.top&&t<=e.bottom,zr=(t,e,i)=>Ir(e,i)&&t>=i.left&&t<=i.right;function Lr(t,e,i,n){let r=vn.find(t.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(0==s)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&zr(i,n,o))return-1;let l=r.coordsAt(s,1);return l&&zr(i,n,l)?1:o&&Ir(n,o)?-1:1}function Wr(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:Lr(t,i,e.clientX,e.clientY)}}const Vr=Gi.ie&&Gi.ie_version<=11;let jr=null,qr=0,Hr=0;function Xr(t){if(!Vr)return t.detail;let e=jr,i=Hr;return jr=t,Hr=Date.now(),qr=!e||i>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(qr+1)%3:1}function Fr(t,e,i,n){if(!i)return;let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:s}=t.inputState,o=n&&s&&s.dragging&&s.dragMove?{from:s.dragging.from,to:s.dragging.to}:null,l={from:r,insert:i},a=t.state.changes(o?[o,l]:l);t.focus(),t.dispatch({changes:a,selection:{anchor:a.mapPos(r,-1),head:a.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"})}_r.dragstart=(t,e)=>{let{selection:{main:i}}=t.state,{mouseSelection:n}=t.inputState;n&&(n.dragging=i),e.dataTransfer&&(e.dataTransfer.setData("Text",t.state.sliceDoc(i.from,i.to)),e.dataTransfer.effectAllowed="copyMove")},_r.drop=(t,e)=>{if(!e.dataTransfer)return;if(t.state.readOnly)return e.preventDefault();let i=e.dataTransfer.files;if(i&&i.length){e.preventDefault();let n=Array(i.length),r=0,s=()=>{++r==i.length&&Fr(t,e,n.filter((t=>null!=t)).join(t.state.lineBreak),!1)};for(let t=0;t<i.length;t++){let e=new FileReader;e.onerror=s,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(n[t]=e.result),s()},e.readAsText(i[t])}}else Fr(t,e,e.dataTransfer.getData("Text"),!0)},_r.paste=(t,e)=>{if(t.state.readOnly)return e.preventDefault();t.observer.flush();let i=Dr?null:e.clipboardData;i?(Er(t,i.getData("text/plain")),e.preventDefault()):function(t){let e=t.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((()=>{t.focus(),i.remove(),Er(t,i.value)}),50)}(t)};let Zr=null;function Gr(t){setTimeout((()=>{t.hasFocus!=t.inputState.notifiedFocused&&t.update([])}),10)}function Ur(t,e){if(t.docView.compositionDeco.size){t.inputState.rapidCompositionStart=e;try{t.update([])}finally{t.inputState.rapidCompositionStart=!1}}}_r.copy=_r.cut=(t,e)=>{let{text:i,ranges:n,linewise:r}=function(t){let e=[],i=[],n=!1;for(let n of t.selection.ranges)n.empty||(e.push(t.sliceDoc(n.from,n.to)),i.push(n));if(!e.length){let r=-1;for(let{from:n}of t.selection.ranges){let s=t.doc.lineAt(n);s.number>r&&(e.push(s.text),i.push({from:s.from,to:Math.min(t.doc.length,s.to+1)})),r=s.number}n=!0}return{text:e.join(t.lineBreak),ranges:i,linewise:n}}(t.state);if(!i&&!r)return;Zr=r?i:null;let s=Dr?null:e.clipboardData;s?(e.preventDefault(),s.clearData(),s.setData("text/plain",i)):function(t,e){let i=t.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout((()=>{n.remove(),t.focus()}),50)}(t,i),"cut"!=e.type||t.state.readOnly||t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"})},_r.focus=Gr,_r.blur=t=>{t.observer.clearSelectionRange(),Gr(t)},_r.compositionstart=_r.compositionupdate=t=>{null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0,t.docView.compositionDeco.size&&(t.observer.flush(),Ur(t,!0)))},_r.compositionend=t=>{t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionFirstChange=null,setTimeout((()=>{t.inputState.composing<0&&Ur(t,!1)}),50)},_r.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()},_r.beforeinput=(t,e)=>{var i;let n;if(Gi.chrome&&Gi.android&&(n=Mr.find((t=>t.inputType==e.inputType)))&&(t.observer.delayAndroidKey(n.key,n.keyCode),"Backspace"==n.key||"Delete"==n.key)){let e=(null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0;setTimeout((()=>{var i;((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>e+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())}),100)}};const Yr=["pre-wrap","normal","pre-line","break-spaces"];class Kr{constructor(){this.doc=at.empty,this.lineWrapping=!1,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength)),this.lineHeight*i}heightForLine(t){if(!this.lineWrapping)return this.lineHeight;return(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return Yr.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(10*n)]||(e=!0,this.heightSamples[Math.floor(10*n)]=!0)}return e}refresh(t,e,i,n,r){let s=Yr.indexOf(t)>-1,o=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=s;if(this.lineWrapping=s,this.lineHeight=e,this.charWidth=i,this.lineLength=n,o){this.heightSamples={};for(let t=0;t<r.length;t++){let e=r[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return o}}class Jr{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class ts{constructor(t,e,i,n,r){this.from=t,this.length=e,this.top=i,this.height=n,this.type=r}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(t){let e=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(t.type)?t.type:[t]);return new ts(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var es=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(es||(es={}));const is=.001;class ns{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t,e){this.height!=e&&(Math.abs(this.height-e)>is&&(t.heightChanged=!0),this.height=e)}replace(t,e,i){return ns.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let r=this;for(let s=n.length-1;s>=0;s--){let{fromA:o,toA:l,fromB:a,toB:h}=n[s],c=r.lineAt(o,es.ByPosNoHeight,e,0,0),u=c.to>=l?c:r.lineAt(l,es.ByPosNoHeight,e,0,0);for(h+=u.to-l,l=u.to;s>0&&c.from<=n[s-1].toA;)o=n[s-1].fromA,a=n[s-1].fromB,s--,o<c.from&&(c=r.lineAt(o,es.ByPosNoHeight,e,0,0));a+=c.from-o,o=c.from;let f=hs.build(i,t,a,h);r=r.replace(o,l,f)}return r.updateHeight(i,0)}static empty(){return new ss(0,0)}static of(t){if(1==t.length)return t[0];let e=0,i=t.length,n=0,r=0;for(;;)if(e==i)if(n>2*r){let r=t[e-1];r.break?t.splice(--e,1,r.left,null,r.right):t.splice(--e,1,r.left,r.right),i+=1+r.break,n-=r.size}else{if(!(r>2*n))break;{let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,r-=e.size}}else if(n<r){let i=t[e++];i&&(n+=i.size)}else{let e=t[--i];e&&(r+=e.size)}let s=0;return null==t[e-1]?(s=1,e--):null==t[e]&&(s=1,i++),new ls(ns.of(t.slice(0,e)),s,ns.of(t.slice(i)))}}ns.prototype.size=1;class rs extends ns{constructor(t,e,i){super(t,e),this.type=i}blockAt(t,e,i,n){return new ts(n,this.length,i,this.height,this.type)}lineAt(t,e,i,n,r){return this.blockAt(0,i,n,r)}forEachLine(t,e,i,n,r,s){t<=r+this.length&&e>=r&&s(this.blockAt(0,i,n,r))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(t,n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class ss extends rs{constructor(t,e){super(t,e,fn.Text),this.collapsed=0,this.widgetHeight=0}replace(t,e,i){let n=i[0];return 1==i.length&&(n instanceof ss||n instanceof os&&4&n.flags)&&Math.abs(this.length-n.length)<10?(n instanceof os?n=new ss(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):ns.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(t,n.heights[n.index++]):(i||this.outdated)&&this.setHeight(t,Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class os extends ns{constructor(t){super(t,0)}lines(t,e){let i=t.lineAt(e).number,n=t.lineAt(e+this.length).number;return{firstLine:i,lastLine:n,lineHeight:this.height/(n-i+1)}}blockAt(t,e,i,n){let{firstLine:r,lastLine:s,lineHeight:o}=this.lines(e,n),l=Math.max(0,Math.min(s-r,Math.floor((t-i)/o))),{from:a,length:h}=e.line(r+l);return new ts(a,h,i+o*l,o,fn.Text)}lineAt(t,e,i,n,r){if(e==es.ByHeight)return this.blockAt(t,i,n,r);if(e==es.ByPosNoHeight){let{from:e,to:n}=i.lineAt(t);return new ts(e,n-e,0,0,fn.Text)}let{firstLine:s,lineHeight:o}=this.lines(i,r),{from:l,length:a,number:h}=i.lineAt(t);return new ts(l,a,n+o*(h-s),o,fn.Text)}forEachLine(t,e,i,n,r,s){let{firstLine:o,lineHeight:l}=this.lines(i,r);for(let a=Math.max(t,r),h=Math.min(r+this.length,e);a<=h;){let e=i.lineAt(a);a==t&&(n+=l*(e.number-o)),s(new ts(e.from,e.length,n,l,fn.Text)),n+=l,a=e.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let t=i[i.length-1];t instanceof os?i[i.length-1]=new os(t.length+n):i.push(null,new os(n-1))}if(t>0){let e=i[0];e instanceof os?i[0]=new os(t+e.length):i.unshift(new os(t-1),null)}return ns.of(i)}decomposeLeft(t,e){e.push(new os(t-1),null)}decomposeRight(t,e){e.push(null,new os(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let r=e+this.length;if(n&&n.from<=e+this.length&&n.more){let i=[],s=Math.max(e,n.from),o=-1,l=t.heightChanged;for(n.from>e&&i.push(new os(n.from-e-1).updateHeight(t,e));s<=r&&n.more;){let e=t.doc.lineAt(s).length;i.length&&i.push(null);let r=n.heights[n.index++];-1==o?o=r:Math.abs(r-o)>=is&&(o=-2);let l=new ss(e,r);l.outdated=!1,i.push(l),s+=e+1}s<=r&&i.push(null,new os(r-s).updateHeight(t,s));let a=ns.of(i);return t.heightChanged=l||o<0||Math.abs(a.height-this.height)>=is||Math.abs(o-this.lines(t.doc,e).lineHeight)>=is,a}return(i||this.outdated)&&(this.setHeight(t,t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class ls extends ns{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return 1&this.flags}blockAt(t,e,i,n){let r=i+this.left.height;return t<r?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,r,n+this.left.length+this.break)}lineAt(t,e,i,n,r){let s=n+this.left.height,o=r+this.left.length+this.break,l=e==es.ByHeight?t<s:t<o,a=l?this.left.lineAt(t,e,i,n,r):this.right.lineAt(t,e,i,s,o);if(this.break||(l?a.to<o:a.from>o))return a;let h=e==es.ByPosNoHeight?es.ByPosNoHeight:es.ByPos;return l?a.join(this.right.lineAt(o,h,i,s,o)):this.left.lineAt(o,h,i,n,r).join(a)}forEachLine(t,e,i,n,r,s){let o=n+this.left.height,l=r+this.left.length+this.break;if(this.break)t<l&&this.left.forEachLine(t,e,i,n,r,s),e>=l&&this.right.forEachLine(t,e,i,o,l,s);else{let a=this.lineAt(l,es.ByPos,i,n,r);t<a.from&&this.left.forEachLine(t,a.from-1,i,n,r,s),a.to>=t&&a.from<=e&&s(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,o,l,s)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let r=[];t>0&&this.decomposeLeft(t,r);let s=r.length;for(let t of i)r.push(t);if(t>0&&as(r,s-1),e<this.length){let t=r.length;this.decomposeRight(e,r),as(r,t)}return ns.of(r)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?ns.of(this.break?[t,null,e]:[t,e]):(this.left=t,this.right=e,this.height=t.height+e.height,this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:r,right:s}=this,o=e+r.length+this.break,l=null;return n&&n.from<=e+r.length&&n.more?l=r=r.updateHeight(t,e,i,n):r.updateHeight(t,e,i),n&&n.from<=o+s.length&&n.more?l=s=s.updateHeight(t,o,i,n):s.updateHeight(t,o,i),l?this.balanced(r,s):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function as(t,e){let i,n;null==t[e]&&(i=t[e-1])instanceof os&&(n=t[e+1])instanceof os&&t.splice(e-1,3,new os(i.length+1+n.length))}class hs{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof ss?i.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new ss(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0;n<0&&(n=this.oracle.lineHeight);let r=e-t;i.block?this.addBlock(new rs(r,n,i.type)):(r||n>=5)&&this.addLineDeco(n,r)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new ss(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new os(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof ss)return t;let e=new ss(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine(),t.type!=fn.WidgetAfter||this.isCovered||this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,t.type!=fn.WidgetBefore&&(this.covering=t)}addLineDeco(t,e){let i=this.ensureLine();i.length+=e,i.collapsed+=e,i.widgetHeight=Math.max(i.widgetHeight,t),this.writtenTo=this.pos=this.pos+e}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof ss||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new ss(0,-1));let i=t;for(let t of this.nodes)t instanceof ss&&t.updateHeight(this.oracle,i),i+=t?t.length:1;return this.nodes}static build(t,e,i,n){let r=new hs(i,t);return Ne.spans(e,i,n,r,0),r.finish(i)}}class cs{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&On(t,e,this.changes,5)}}function us(t,e){let i=t.getBoundingClientRect(),n=Math.max(0,i.left),r=Math.min(innerWidth,i.right),s=Math.max(0,i.top),o=Math.min(innerHeight,i.bottom),l=t.ownerDocument.body;for(let e=t.parentNode;e&&e!=l;)if(1==e.nodeType){let t=e,i=window.getComputedStyle(t);if((t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)&&"visible"!=i.overflow){let e=t.getBoundingClientRect();n=Math.max(n,e.left),r=Math.min(r,e.right),s=Math.max(s,e.top),o=Math.min(o,e.bottom)}e="absolute"==i.position||"fixed"==i.position?t.offsetParent:t.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{left:n-i.left,right:Math.max(n,r)-i.left,top:s-(i.top+e),bottom:Math.max(s,o)-(i.top+e)}}function fs(t,e){let i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class ds{constructor(t,e,i){this.from=t,this.to=e,this.size=i}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],r=e[i];if(n.from!=r.from||n.to!=r.to||n.size!=r.size)return!1}return!0}draw(t){return dn.replace({widget:new ps(this.size,t)}).range(this.from,this.to)}}class ps extends un{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class gs{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.heightOracle=new Kr,this.scaler=xs,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Fn.RTL,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1,this.stateDeco=t.facet(Wn).filter((t=>"function"!=typeof t)),this.heightMap=ns.empty().applyChanges(this.stateDeco,at.empty,this.heightOracle.setDoc(t.doc),[new Hn(0,0,0,t.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=dn.set(this.lineGaps.map((t=>t.draw(!1)))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some((({from:t,to:e})=>n>=t&&n<=e))){let{from:e,to:i}=this.lineBlockAt(n);t.push(new ms(e,i))}}this.viewports=t.sort(((t,e)=>t.from-e.from)),this.scaler=this.heightMap.height<=7e6?xs:new ks(this.heightOracle.doc,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,(t=>{this.viewportLines.push(1==this.scaler.scale?t:Ss(t,this.scaler))}))}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(Wn).filter((t=>"function"!=typeof t));let n=t.changedRanges,r=Hn.extendWithRanges(n,function(t,e,i){let n=new cs;return Ne.compare(t,e,i,n,0),n.changes}(i,this.stateDeco,t?t.changes:Rt.empty(this.state.doc.length))),s=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),r),this.heightMap.height!=s&&(t.flags|=2);let o=r.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<o.from||e.range.head>o.to)||!this.viewportIsAppropriate(o))&&(o=this.getViewport(0,e));let l=!t.changes.empty||2&t.flags||o.from!=this.viewport.from||o.to!=this.viewport.to;this.viewport=o,this.updateForViewport(),l&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,r=i.whiteSpace;this.defaultTextDirection="rtl"==i.direction?Fn.RTL:Fn.LTR;let s=this.heightOracle.mustRefreshForWrapping(r),o=s||this.mustMeasureContent||this.contentDOMHeight!=e.clientHeight;this.contentDOMHeight=e.clientHeight,this.mustMeasureContent=!1;let l=0,a=0,h=parseInt(i.paddingTop)||0,c=parseInt(i.paddingBottom)||0;this.paddingTop==h&&this.paddingBottom==c||(this.paddingTop=h,this.paddingBottom=c,l|=10),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(o=!0),this.editorWidth=t.scrollDOM.clientWidth,l|=8);let u=(this.printing?fs:us)(e,this.paddingTop),f=u.top-this.pixelViewport.top,d=u.bottom-this.pixelViewport.bottom;this.pixelViewport=u;let p=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(p!=this.inView&&(this.inView=p,p&&(o=!0)),!this.inView)return 0;let g=e.clientWidth;if(this.contentDOMWidth==g&&this.editorHeight==t.scrollDOM.clientHeight||(this.contentDOMWidth=g,this.editorHeight=t.scrollDOM.clientHeight,l|=8),o){let e=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(e)&&(s=!0),s||n.lineWrapping&&Math.abs(g-this.contentDOMWidth)>n.charWidth){let{lineHeight:i,charWidth:o}=t.docView.measureTextSize();s=n.refresh(r,i,o,g/o,e),s&&(t.docView.minWidth=0,l|=8)}f>0&&d>0?a=Math.max(f,d):f<0&&d<0&&(a=Math.min(f,d)),n.heightChanged=!1;for(let i of this.viewports){let r=i.from==this.viewport.from?e:t.docView.measureVisibleLineHeights(i);this.heightMap=this.heightMap.updateHeight(n,0,s,new Jr(i.from,r))}n.heightChanged&&(l|=2)}let m=!this.viewportIsAppropriate(this.viewport,a)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return m&&(this.viewport=this.getViewport(a,this.scrollTarget)),this.updateForViewport(),(2&l||m)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(s?[]:this.lineGaps)),l|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),l}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,r=this.state.doc,{visibleTop:s,visibleBottom:o}=this,l=new ms(n.lineAt(s-1e3*i,es.ByHeight,r,0,0).from,n.lineAt(o+1e3*(1-i),es.ByHeight,r,0,0).to);if(e){let{head:t}=e.range;if(t<l.from||t>l.to){let i,s=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),o=n.lineAt(t,es.ByPos,r,0,0);i="center"==e.y?(o.top+o.bottom)/2-s/2:"start"==e.y||"nearest"==e.y&&t<l.from?o.top:o.bottom-s,l=new ms(n.lineAt(i-500,es.ByHeight,r,0,0).from,n.lineAt(i+s+500,es.ByHeight,r,0,0).to)}}return l}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new ms(this.heightMap.lineAt(i,es.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(n,es.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,es.ByPos,this.state.doc,0,0),{bottom:r}=this.heightMap.lineAt(e,es.ByPos,this.state.doc,0,0),{visibleTop:s,visibleBottom:o}=this;return(0==t||n<=s-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||r>=o+Math.max(10,Math.min(i,250)))&&n>s-2e3&&r<o+2e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new ds(e.mapPos(n.from),e.mapPos(n.to),n.size));return i}ensureLineGaps(t){let e=[];if(this.defaultTextDirection!=Fn.LTR)return e;for(let i of this.viewportLines){if(i.length<4e3)continue;let n,r,s=bs(i.from,i.to,this.stateDeco);if(s.total<4e3)continue;if(this.heightOracle.lineWrapping){let t=2e3/this.heightOracle.lineLength*this.heightOracle.lineHeight;n=Os(s,(this.visibleTop-i.top-t)/i.height),r=Os(s,(this.visibleBottom-i.top+t)/i.height)}else{let t=s.total*this.heightOracle.charWidth,e=2e3*this.heightOracle.charWidth;n=Os(s,(this.pixelViewport.left-e)/t),r=Os(s,(this.pixelViewport.right+e)/t)}let o=[];n>i.from&&o.push({from:i.from,to:n}),r<i.to&&o.push({from:r,to:i.to});let l=this.state.selection.main;l.from>=i.from&&l.from<=i.to&&ws(o,l.from-10,l.from+10),!l.empty&&l.to>=i.from&&l.to<=i.to&&ws(o,l.to-10,l.to+10);for(let{from:n,to:r}of o)r-n>1e3&&e.push(ys(t,(t=>t.from>=i.from&&t.to<=i.to&&Math.abs(t.from-n)<1e3&&Math.abs(t.to-r)<1e3))||new ds(n,r,this.gapSize(i,n,r,s)))}return e}gapSize(t,e,i,n){let r=vs(n,i)-vs(n,e);return this.heightOracle.lineWrapping?t.height*r:n.total*this.heightOracle.charWidth*r}updateLineGaps(t){ds.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=dn.set(t.map((t=>t.draw(this.heightOracle.lineWrapping)))))}computeVisibleRanges(){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let e=[];Ne.spans(t,this.viewport.from,this.viewport.to,{span(t,i){e.push({from:t,to:i})},point(){}},20);let i=e.length!=this.visibleRanges.length||this.visibleRanges.some(((t,i)=>t.from!=e[i].from||t.to!=e[i].to));return this.visibleRanges=e,i?4:0}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find((e=>e.from<=t&&e.to>=t))||Ss(this.heightMap.lineAt(t,es.ByPos,this.state.doc,0,0),this.scaler)}lineBlockAtHeight(t){return Ss(this.heightMap.lineAt(this.scaler.fromDOM(t),es.ByHeight,this.state.doc,0,0),this.scaler)}elementAtHeight(t){return Ss(this.heightMap.blockAt(this.scaler.fromDOM(t),this.state.doc,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class ms{constructor(t,e){this.from=t,this.to=e}}function bs(t,e,i){let n=[],r=t,s=0;return Ne.spans(i,t,e,{span(){},point(t,e){t>r&&(n.push({from:r,to:t}),s+=t-r),r=e}},20),r<e&&(n.push({from:r,to:e}),s+=e-r),{total:s,ranges:n}}function Os({total:t,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let n=Math.floor(t*i);for(let t=0;;t++){let{from:i,to:r}=e[t],s=r-i;if(n<=s)return i+n;n-=s}}function vs(t,e){let i=0;for(let{from:n,to:r}of t.ranges){if(e<=r){i+=e-n;break}i+=r-n}return i/t.total}function ws(t,e,i){for(let n=0;n<t.length;n++){let r=t[n];if(r.from<i&&r.to>e){let s=[];r.from<e&&s.push({from:r.from,to:e}),r.to>i&&s.push({from:i,to:r.to}),t.splice(n,1,...s),n+=s.length-1}}}function ys(t,e){for(let i of t)if(e(i))return i}const xs={toDOM:t=>t,fromDOM:t=>t,scale:1};class ks{constructor(t,e,i){let n=0,r=0,s=0;this.viewports=i.map((({from:i,to:r})=>{let s=e.lineAt(i,es.ByPos,t,0,0).top,o=e.lineAt(r,es.ByPos,t,0,0).bottom;return n+=o-s,{from:i,to:r,top:s,bottom:o,domTop:0,domBottom:0}})),this.scale=(7e6-n)/(e.height-n);for(let t of this.viewports)t.domTop=s+(t.top-r)*this.scale,s=t.domBottom=t.domTop+(t.bottom-t.top),r=t.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.top)return n+(t-i)*this.scale;if(t<=r.bottom)return r.domTop+(t-r.top);i=r.bottom,n=r.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.domTop)return i+(t-n)/this.scale;if(t<=r.domBottom)return r.top+(t-r.domTop);i=r.bottom,n=r.domBottom}}}function Ss(t,e){if(1==e.scale)return t;let i=e.toDOM(t.top),n=e.toDOM(t.bottom);return new ts(t.from,t.length,i,n-i,Array.isArray(t.type)?t.type.map((t=>Ss(t,e))):t.type)}const Cs=Vt.define({combine:t=>t.join(" ")}),As=Vt.define({combine:t=>t.indexOf(!0)>-1}),Ts=Je.newName(),Ps=Je.newName(),Ms=Je.newName(),Qs={"&light":"."+Ps,"&dark":"."+Ms};function Rs(t,e,i){return new Je(e,{finish:e=>/&/.test(e)?e.replace(/&\w*/,(e=>{if("&"==e)return t;if(!i||!i[e])throw new RangeError(`Unsupported selector: ${e}`);return i[e]})):t+" "+e})}const $s=Rs("."+Ts,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{position:"absolute",borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#f3f9ff"},"&dark .cm-activeLine":{backgroundColor:"#223039"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Qs),_s={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Ds=Gi.ie&&Gi.ie_version<=11;class Es{constructor(t,e,i){this.view=t,this.onChange=e,this.onScrollChanged=i,this.active=!1,this.selectionRange=new Si,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.scrollTargets=[],this.intersection=null,this.resize=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver((e=>{for(let t of e)this.queue.push(t);(Gi.ie&&Gi.ie_version<=11||Gi.ios&&t.composing)&&e.some((t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length))?this.flushSoon():this.flush()})),Ds&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),window.addEventListener("resize",this.onResize=this.onResize.bind(this)),"function"==typeof ResizeObserver&&(this.resize=new ResizeObserver((()=>{this.view.docView.lastUpdate<Date.now()-75&&this.onResize()})),this.resize.observe(t.scrollDOM)),window.addEventListener("beforeprint",this.onPrint=this.onPrint.bind(this)),this.start(),window.addEventListener("scroll",this.onScroll=this.onScroll.bind(this)),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange(),this.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}onScroll(t){this.intersecting&&this.flush(!1),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500)}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some(((e,i)=>e!=t[i])))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:e}=this,i=this.selectionRange;if(e.state.facet(Dn)?e.root.activeElement!=this.dom:!gi(e.dom,i))return;let n=i.anchorNode&&e.docView.nearest(i.anchorNode);n&&n.ignoreEvent(t)||((Gi.ie&&Gi.ie_version<=11||Gi.android&&Gi.chrome)&&!e.state.selection.main.empty&&i.focusNode&&bi(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1))}readSelectionRange(){let{root:t}=this.view,e=Gi.safari&&11==t.nodeType&&function(){let t=document.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}()==this.view.contentDOM&&function(t){let e=null;function i(t){t.preventDefault(),t.stopImmediatePropagation(),e=t.getTargetRanges()[0]}if(t.contentDOM.addEventListener("beforeinput",i,!0),document.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",i,!0),!e)return null;let n=e.startContainer,r=e.startOffset,s=e.endContainer,o=e.endOffset,l=t.docView.domAtPos(t.state.selection.main.anchor);bi(l.node,l.offset,s,o)&&([n,r,s,o]=[s,o,n,r]);return{anchorNode:n,anchorOffset:r,focusNode:s,focusOffset:o}}(this.view)||di(t);return!(!e||this.selectionRange.eq(e))&&(this.selectionRange.setRange(e),this.selectionChanged=!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(1==i.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else{if(11!=i.nodeType)break;i=i.host}if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,_s),Ds&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Ds&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){this.delayedAndroidKey||requestAnimationFrame((()=>{let t=this.delayedAndroidKey;this.delayedAndroidKey=null,this.delayedFlush=-1,this.flush()||Mi(this.view.contentDOM,t.key,t.keyCode)})),this.delayedAndroidKey&&"Enter"!=t||(this.delayedAndroidKey={key:t,keyCode:e})}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=window.setTimeout((()=>{this.delayedFlush=-1,this.flush()}),20))}forceFlush(){this.delayedFlush>=0&&(window.clearTimeout(this.delayedFlush),this.delayedFlush=-1,this.flush())}processRecords(){let t=this.queue;for(let e of this.observer.takeRecords())t.push(e);t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let r of t){let t=this.readMutation(r);t&&(t.typeOver&&(n=!0),-1==e?({from:e,to:i}=t):(e=Math.min(t.from,e),i=Math.max(t.to,i)))}return{from:e,to:i,typeOver:n}}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return;t&&this.readSelectionRange();let{from:e,to:i,typeOver:n}=this.processRecords(),r=this.selectionChanged&&gi(this.dom,this.selectionRange);if(e<0&&!r)return;this.selectionChanged=!1;let s=this.view.state,o=this.onChange(e,i,n);return this.view.state==s&&this.view.update([]),o}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty("attributes"==t.type),"attributes"==t.type&&(e.dirty|=4),"childList"==t.type){let i=Ns(e,t.previousSibling||t.target.previousSibling,-1),n=Ns(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}return"characterData"==t.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}destroy(){var t,e,i;this.stop(),null===(t=this.intersection)||void 0===t||t.disconnect(),null===(e=this.gapIntersection)||void 0===e||e.disconnect(),null===(i=this.resize)||void 0===i||i.disconnect();for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onResize),window.removeEventListener("beforeprint",this.onPrint),this.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout)}}function Ns(t,e,i){for(;e;){let n=_i.get(e);if(n&&n.parent==t)return n;let r=e.parentNode;e=r!=t.dom?r:i>0?e.nextSibling:e.previousSibling}return null}function Bs(t,e,i,n){let r,s,o=t.state.selection.main;if(e>-1){let n=t.docView.domBoundsAround(e,i,0);if(!n||t.state.readOnly)return!1;let{from:l,to:a}=n,h=t.docView.impreciseHead||t.docView.impreciseAnchor?[]:function(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:i,anchorOffset:n,focusNode:r,focusOffset:s}=t.observer.selectionRange;i&&(e.push(new cr(i,n)),r==i&&s==n||e.push(new cr(r,s)));return e}(t),c=new ar(h,t.state);c.readRange(n.startDOM,n.endDOM);let u=o.from,f=null;(8===t.inputState.lastKeyCode&&t.inputState.lastKeyTime>Date.now()-100||Gi.android&&c.text.length<a-l)&&(u=o.to,f="end");let d=function(t,e,i,n){let r=Math.min(t.length,e.length),s=0;for(;s<r&&t.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==r&&t.length==e.length)return null;let o=t.length,l=e.length;for(;o>0&&l>0&&t.charCodeAt(o-1)==e.charCodeAt(l-1);)o--,l--;if("end"==n){i-=o+Math.max(0,s-Math.min(o,l))-s}if(o<s&&t.length<e.length){s-=i<=s&&i>=o?s-i:0,l=s+(l-o),o=s}else if(l<s){s-=i<=s&&i>=l?s-i:0,o=s+(o-l),l=s}return{from:s,toA:o,toB:l}}(t.state.doc.sliceString(l,a,lr),c.text,u-l,f);d&&(Gi.chrome&&13==t.inputState.lastKeyCode&&d.toB==d.from+2&&"￿￿"==c.text.slice(d.from,d.toB)&&d.toB--,r={from:l+d.from,to:l+d.toA,insert:at.of(c.text.slice(d.from,d.toB).split(lr))}),s=function(t,e){if(0==t.length)return null;let i=t[0].pos,n=2==t.length?t[1].pos:i;return i>-1&&n>-1?zt.single(i+e,n+e):null}(h,l)}else if(t.hasFocus||!t.state.facet(Dn)){let e=t.observer.selectionRange,{impreciseHead:i,impreciseAnchor:n}=t.docView,r=i&&i.node==e.focusNode&&i.offset==e.focusOffset||!pi(t.contentDOM,e.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),l=n&&n.node==e.anchorNode&&n.offset==e.anchorOffset||!pi(t.contentDOM,e.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(e.anchorNode,e.anchorOffset);r==o.head&&l==o.anchor||(s=zt.single(l,r))}if(!r&&!s)return!1;if(!r&&n&&!o.empty&&s&&s.main.empty?r={from:o.from,to:o.to,insert:t.state.doc.slice(o.from,o.to)}:r&&r.from>=o.from&&r.to<=o.to&&(r.from!=o.from||r.to!=o.to)&&o.to-o.from-(r.to-r.from)<=4?r={from:o.from,to:o.to,insert:t.state.doc.slice(o.from,r.from).append(r.insert).append(t.state.doc.slice(r.to,o.to))}:(Gi.mac||Gi.android)&&r&&r.from==r.to&&r.from==o.head-1&&"."==r.insert.toString()&&(r={from:o.from,to:o.to,insert:at.of([" "])}),r){let e=t.state;if(Gi.ios&&t.inputState.flushIOSKey(t))return!0;if(Gi.android&&(r.from==o.from&&r.to==o.to&&1==r.insert.length&&2==r.insert.lines&&Mi(t.contentDOM,"Enter",13)||r.from==o.from-1&&r.to==o.to&&0==r.insert.length&&Mi(t.contentDOM,"Backspace",8)||r.from==o.from&&r.to==o.to+1&&0==r.insert.length&&Mi(t.contentDOM,"Delete",46)))return!0;let i,n=r.insert.toString();if(t.state.facet(Mn).some((e=>e(t,r.from,r.to,n))))return!0;if(t.inputState.composing>=0&&t.inputState.composing++,r.from>=o.from&&r.to<=o.to&&r.to-r.from>=(o.to-o.from)/3&&(!s||s.main.empty&&s.main.from==r.from+r.insert.length)&&t.inputState.composing<0){let n=o.from<r.from?e.sliceDoc(o.from,r.from):"",s=o.to>r.to?e.sliceDoc(r.to,o.to):"";i=e.replaceSelection(t.state.toText(n+r.insert.sliceString(0,void 0,t.state.lineBreak)+s))}else{let n=e.changes(r),l=s&&!e.selection.main.eq(s.main)&&s.main.to<=n.newLength?s.main:void 0;if(e.selection.ranges.length>1&&t.inputState.composing>=0&&r.to<=o.to&&r.to>=o.to-10){let s=t.state.sliceDoc(r.from,r.to),a=dr(t)||t.state.doc.lineAt(o.head),h=o.to-r.to,c=o.to-o.from;i=e.changeByRange((i=>{if(i.from==o.from&&i.to==o.to)return{changes:n,range:l||i.map(n)};let u=i.to-h,f=u-s.length;if(i.to-i.from!=c||t.state.sliceDoc(f,u)!=s||a&&i.to>=a.from&&i.from<=a.to)return{range:i};let d=e.changes({from:f,to:u,insert:r.insert}),p=i.to-o.to;return{changes:d,range:l?zt.range(Math.max(0,l.anchor+p),Math.max(0,l.head+p)):i.map(d)}}))}else i={changes:n,selection:l&&e.selection.replaceRange(l)}}let l="input.type";return t.composing&&(l+=".compose",t.inputState.compositionFirstChange&&(l+=".start",t.inputState.compositionFirstChange=!1)),t.dispatch(i,{scrollIntoView:!0,userEvent:l}),!0}if(s&&!s.main.eq(o)){let e=!1,i="select";return t.inputState.lastSelectionTime>Date.now()-50&&("select"==t.inputState.lastSelectionOrigin&&(e=!0),i=t.inputState.lastSelectionOrigin),t.dispatch({selection:s,scrollIntoView:e,userEvent:i}),!0}return!1}class Is{constructor(t={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: absolute; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=t.dispatch||(t=>this.update([t])),this.dispatch=this.dispatch.bind(this),this.root=t.root||function(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}(t.parent)||document,this.viewState=new gs(t.state||Qe.create(t)),this.plugins=this.state.facet(Nn).map((t=>new In(t)));for(let t of this.plugins)t.update(this);this.observer=new Es(this,((t,e,i)=>Bs(this,t,e,i)),(t=>{this.inputState.runScrollHandlers(this,t),this.observer.intersecting&&this.measure()})),this.inputState=new Pr(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new ur(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),t.parent&&t.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}dispatch(...t){this._dispatch(1==t.length&&t[0]instanceof ve?t[0]:this.state.update(...t))}update(t){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e,i=!1,n=!1,r=this.state;for(let e of t){if(e.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=e.state}if(this.destroyed)return void(this.viewState.state=r);if(this.observer.clear(),r.facet(Qe.phrases)!=this.state.facet(Qe.phrases))return this.setState(r);e=Xn.create(this,r,t);let s=this.viewState.scrollTarget;try{this.updateState=2;for(let e of t){if(s&&(s=s.map(e.changes)),e.scrollIntoView){let{main:t}=e.state.selection;s=new Rn(t.empty?t:zt.cursor(t.head,t.head>t.anchor?-1:1))}for(let t of e.effects)t.is($n)&&(s=t.value)}this.viewState.update(e,s),this.bidiCache=Ws.update(this.bidiCache,e.changes),e.empty||(this.updatePlugins(e),this.inputState.update(e)),i=this.docView.update(e),this.state.facet(qn)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some((t=>t.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(e.startState.facet(Cs)!=e.state.facet(Cs)&&(this.viewState.mustMeasureContent=!0),(i||n||s||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!e.empty)for(let t of this.state.facet(Pn))t(e)}setState(t){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=t);this.updateState=2;let e=this.hasFocus;try{for(let t of this.plugins)t.destroy(this);this.viewState=new gs(t),this.plugins=t.facet(Nn).map((t=>new In(t))),this.pluginMap.clear();for(let t of this.plugins)t.update(this);this.docView=new ur(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(Nn),i=t.state.facet(Nn);if(e!=i){let n=[];for(let r of i){let i=e.indexOf(r);if(i<0)n.push(new In(r));else{let e=this.plugins[i];e.mustUpdate=t,n.push(e)}}for(let e of this.plugins)e.mustUpdate!=t&&e.destroy(this);this.plugins=n,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let e of this.plugins)e.mustUpdate=t;for(let t=0;t<this.plugins.length;t++)this.plugins[t].update(this)}measure(t=!0){if(this.destroyed)return;this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,t&&this.observer.flush();let e=null;try{for(let t=0;;t++){this.updateState=1;let i=this.viewport,n=this.viewState.measure(this);if(!n&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(t>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let r=[];4&n||([this.measureRequests,r]=[r,this.measureRequests]);let s=r.map((t=>{try{return t.read(this)}catch(t){return _n(this.state,t),Ls}})),o=Xn.create(this,this.state,[]),l=!1,a=!1;o.flags|=n,e?e.flags|=n:e=o,this.updateState=2,o.empty||(this.updatePlugins(o),this.inputState.update(o),this.updateAttrs(),l=this.docView.update(o));for(let t=0;t<r.length;t++)if(s[t]!=Ls)try{let e=r[t];e.write&&e.write(s[t],this)}catch(t){_n(this.state,t)}if(this.viewState.scrollTarget&&(this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=!0),l&&this.docView.updateSelection(!0),this.viewport.from==i.from&&this.viewport.to==i.to&&!a&&0==this.measureRequests.length)break}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let t of this.state.facet(Pn))t(e)}get themeClasses(){return Ts+" "+(this.state.facet(As)?Ms:Ps)+" "+this.state.facet(Cs)}updateAttrs(){let t=Vs(this,zn,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Dn)?"true":"false",class:"cm-content",style:`${Gi.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),Vs(this,Ln,e);let i=this.observer.ignore((()=>{let i=cn(this.contentDOM,this.contentAttrs,e),n=cn(this.dom,this.editorAttrs,t);return i||n}));return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let t of i.effects)if(t.is(Is.announce)){e&&(this.announceDOM.textContent=""),e=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value}}mountStyles(){this.styleModules=this.state.facet(qn),Je.mount(this.root,this.styleModules.concat($s).reverse())}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=requestAnimationFrame((()=>this.measure()))),t){if(null!=t.key)for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key)return void(this.measureRequests[e]=t);this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find((e=>e.spec==t))||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return Tr(this,t,Ar(this,t,e,i))}moveByGroup(t,e){return Tr(this,t,Ar(this,t,e,(e=>function(t,e,i){let n=t.state.charCategorizer(e),r=n(i);return t=>{let e=n(t);return r==Ae.Space&&(r=e),r==e}}(this,t.head,e))))}moveToLineBoundary(t,e,i=!0){return function(t,e,i,n){let r=t.state.doc.lineAt(e.head),s=n&&t.lineWrapping?t.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head):null;if(s){let e=t.dom.getBoundingClientRect(),n=t.textDirectionAt(r.from),o=t.posAtCoords({x:i==(n==Fn.LTR)?e.right-1:e.left+1,y:(s.top+s.bottom)/2});if(null!=o)return zt.cursor(o,i?-1:1)}let o=vn.find(t.docView,e.head),l=o?i?o.posAtEnd:o.posAtStart:i?r.to:r.from;return zt.cursor(l,i?-1:1)}(this,t,e,i)}moveVertically(t,e,i){return Tr(this,t,function(t,e,i,n){let r=e.head,s=i?1:-1;if(r==(i?t.state.doc.length:0))return zt.cursor(r,e.assoc);let o,l=e.goalColumn,a=t.contentDOM.getBoundingClientRect(),h=t.coordsAtPos(r),c=t.documentTop;if(h)null==l&&(l=h.left-a.left),o=s<0?h.top:h.bottom;else{let e=t.viewState.lineBlockAt(r);null==l&&(l=Math.min(a.right-a.left,t.defaultCharacterWidth*(r-e.from))),o=(s<0?e.top:e.bottom)+c}let u=a.left+l,f=null!=n?n:t.defaultLineHeight>>1;for(let i=0;;i+=10){let n=o+(f+i)*s,h=Sr(t,{x:u,y:n},!1,s);if(n<a.top||n>a.bottom||(s<0?h<r:h>r))return zt.cursor(h,e.assoc,void 0,l)}}(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),Sr(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),r=this.bidiSpans(n);return xi(i,r[ir.find(r,t-n.from,-1,e)].dir==Fn.LTR==e>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(Qn)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>zs)return rr(t.length);let e=this.textDirectionAt(t.from);for(let i of this.bidiCache)if(i.from==t.from&&i.dir==e)return i.order;let i=function(t,e){let i=t.length,n=e==Zn?1:2,r=e==Zn?2:1;if(!t||1==n&&!er.test(t))return rr(i);for(let e=0,r=n,o=n;e<i;e++){let i=(s=t.charCodeAt(e))<=247?Yn[s]:1424<=s&&s<=1524?2:1536<=s&&s<=1785?Kn[s-1536]:1774<=s&&s<=2220?4:8192<=s&&s<=8203||8204==s?256:1;512==i?i=r:8==i&&4==o&&(i=16),nr[e]=4==i?2:i,7&i&&(o=i),r=i}var s;for(let t=0,e=n,r=n;t<i;t++){let n=nr[t];if(128==n)t<i-1&&e==nr[t+1]&&24&e?n=nr[t]=e:nr[t]=256;else if(64==n){let n=t+1;for(;n<i&&64==nr[n];)n++;let s=t&&8==e||n<i&&8==nr[n]?1==r?1:8:256;for(let e=t;e<n;e++)nr[e]=s;t=n-1}else 8==n&&1==r&&(nr[t]=1);e=n,7&n&&(r=n)}for(let e,s,o,l=0,a=0,h=0;l<i;l++)if(s=Jn[e=t.charCodeAt(l)])if(s<0){for(let t=a-3;t>=0;t-=3)if(tr[t+1]==-s){let e=tr[t+2],i=2&e?n:4&e?1&e?r:n:0;i&&(nr[l]=nr[tr[t]]=i),a=t;break}}else{if(189==tr.length)break;tr[a++]=l,tr[a++]=e,tr[a++]=h}else if(2==(o=nr[l])||1==o){let t=o==n;h=t?0:1;for(let e=a-3;e>=0;e-=3){let i=tr[e+2];if(2&i)break;if(t)tr[e+2]|=2;else{if(4&i)break;tr[e+2]|=4}}}for(let t=0;t<i;t++)if(256==nr[t]){let e=t+1;for(;e<i&&256==nr[e];)e++;let r=1==(t?nr[t-1]:n),s=r==(1==(e<i?nr[e]:n))?r?1:2:n;for(let i=t;i<e;i++)nr[i]=s;t=e-1}let o=[];if(1==n)for(let t=0;t<i;){let e=t,n=1!=nr[t++];for(;t<i&&n==(1!=nr[t]);)t++;if(n)for(let i=t;i>e;){let t=i,n=2!=nr[--i];for(;i>e&&n==(2!=nr[i-1]);)i--;o.push(new ir(i,t,n?2:1))}else o.push(new ir(e,t,0))}else for(let t=0;t<i;){let e=t,n=2==nr[t++];for(;t<i&&n==(2==nr[t]);)t++;o.push(new ir(e,t,n?1:2))}return o}(t.text,e);return this.bidiCache.push(new Ws(t.from,t.to,e,i)),i}get hasFocus(){var t;return(document.hasFocus()||Gi.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{Ti(this.contentDOM),this.docView.updateSelection()}))}destroy(){for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return $n.of(new Rn("number"==typeof t?zt.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}static domEventHandlers(t){return Bn.define((()=>({})),{eventHandlers:t})}static theme(t,e){let i=Je.newName(),n=[Cs.of(i),qn.of(Rs(`.${i}`,t))];return e&&e.dark&&n.push(As.of(!0)),n}static baseTheme(t){return ee.lowest(qn.of(Rs("."+Ts,t,Qs)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),n=i&&_i.get(i)||_i.get(t);return(null===(e=null==n?void 0:n.rootView)||void 0===e?void 0:e.view)||null}}Is.styleModule=qn,Is.inputHandler=Mn,Is.perLineTextDirection=Qn,Is.exceptionSink=Tn,Is.updateListener=Pn,Is.editable=Dn,Is.mouseSelectionStyle=An,Is.dragMovesSelection=Cn,Is.clickAddsSelectionRange=Sn,Is.decorations=Wn,Is.atomicRanges=Vn,Is.scrollMargins=jn,Is.darkTheme=As,Is.contentAttributes=Ln,Is.editorAttributes=zn,Is.lineWrapping=Is.contentAttributes.of({class:"cm-lineWrapping"}),Is.announce=Oe.define();const zs=4096,Ls={};class Ws{constructor(t,e,i,n){this.from=t,this.to=e,this.dir=i,this.order=n}static update(t,e){if(e.empty)return t;let i=[],n=t.length?t[t.length-1].dir:Fn.LTR;for(let r=Math.max(0,t.length-10);r<t.length;r++){let s=t[r];s.dir!=n||e.touchesRange(s.from,s.to)||i.push(new Ws(e.mapPos(s.from,1),e.mapPos(s.to,-1),s.dir,s.order))}return i}}function Vs(t,e,i){for(let n=t.state.facet(e),r=n.length-1;r>=0;r--){let e=n[r],s="function"==typeof e?e(t):e;s&&an(s,i)}return i}const js=Gi.mac?"mac":Gi.windows?"win":Gi.linux?"linux":"key";function qs(t,e,i){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),!1!==i&&e.shiftKey&&(t="Shift-"+t),t}const Hs=ee.default(Is.domEventHandlers({keydown:(t,e)=>Us(Zs(e.state),t,e,"editor")})),Xs=Vt.define({enables:Hs}),Fs=new WeakMap;function Zs(t){let e=t.facet(Xs),i=Fs.get(e);return i||Fs.set(e,i=function(t,e=js){let i=Object.create(null),n=Object.create(null),r=(t,e)=>{let i=n[t];if(null==i)n[t]=e;else if(i!=e)throw new Error("Key binding "+t+" is used both as a regular binding and as a multi-stroke prefix")},s=(t,n,s,o)=>{let l=i[t]||(i[t]=Object.create(null)),a=n.split(/ (?!$)/).map((t=>function(t,e){const i=t.split(/-(?!$)/);let n,r,s,o,l=i[i.length-1];"Space"==l&&(l=" ");for(let t=0;t<i.length-1;++t){const l=i[t];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))s=!0;else{if(!/^mod$/i.test(l))throw new Error("Unrecognized modifier name: "+l);"mac"==e?o=!0:r=!0}}return n&&(l="Alt-"+l),r&&(l="Ctrl-"+l),o&&(l="Meta-"+l),s&&(l="Shift-"+l),l}(t,e)));for(let e=1;e<a.length;e++){let i=a.slice(0,e).join(" ");r(i,!0),l[i]||(l[i]={preventDefault:!0,commands:[e=>{let n=Gs={view:e,prefix:i,scope:t};return setTimeout((()=>{Gs==n&&(Gs=null)}),4e3),!0}]})}let h=a.join(" ");r(h,!1);let c=l[h]||(l[h]={preventDefault:!1,commands:[]});c.commands.push(s),o&&(c.preventDefault=!0)};for(let i of t){let t=i[e]||i.key;if(t)for(let e of i.scope?i.scope.split(" "):["editor"])s(e,t,i.run,i.preventDefault),i.shift&&s(e,"Shift-"+t,i.shift,i.preventDefault)}return i}(e.reduce(((t,e)=>t.concat(e)),[]))),i}let Gs=null;function Us(t,e,i,n){let r=fi(e),s=Ct(r,0),o=Tt(s)==r.length&&" "!=r,l="",a=!1;Gs&&Gs.view==i&&Gs.scope==n&&(l=Gs.prefix+" ",(a=Qr.indexOf(e.keyCode)<0)&&(Gs=null));let h,c=t=>{if(t){for(let e of t.commands)if(e(i))return!0;t.preventDefault&&(a=!0)}return!1},u=t[n];if(u){if(c(u[l+qs(r,e,!o)]))return!0;if(o&&(e.shiftKey||e.altKey||e.metaKey||s>127)&&(h=ii[e.keyCode])&&h!=r){if(c(u[l+qs(h,e,!0)]))return!0;if(e.shiftKey&&ni[e.keyCode]!=h&&c(u[l+qs(ni[e.keyCode],e,!1)]))return!0}else if(o&&e.shiftKey&&c(u[l+qs(r,e,!0)]))return!0}return a}const Ys=!Gi.ios,Ks=Vt.define({combine:t=>Re(t,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(t,e)=>Math.min(t,e),drawRangeCursor:(t,e)=>t||e})});function Js(t={}){return[Ks.of(t),eo,no]}class to{constructor(t,e,i,n,r){this.left=t,this.top=e,this.width=i,this.height=n,this.className=r}draw(){let t=document.createElement("div");return t.className=this.className,this.adjust(t),t}adjust(t){t.style.left=this.left+"px",t.style.top=this.top+"px",this.width>=0&&(t.style.width=this.width+"px"),t.style.height=this.height+"px"}eq(t){return this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height&&this.className==t.className}}const eo=Bn.fromClass(class{constructor(t){this.view=t,this.rangePieces=[],this.cursors=[],this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.selectionLayer=t.scrollDOM.appendChild(document.createElement("div")),this.selectionLayer.className="cm-selectionLayer",this.selectionLayer.setAttribute("aria-hidden","true"),this.cursorLayer=t.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),t.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){this.cursorLayer.style.animationDuration=this.view.state.facet(Ks).cursorBlinkRate+"ms"}update(t){let e=t.startState.facet(Ks)!=t.state.facet(Ks);(e||t.selectionSet||t.geometryChanged||t.viewportChanged)&&this.view.requestMeasure(this.measureReq),t.transactions.some((t=>t.scrollIntoView))&&(this.cursorLayer.style.animationName="cm-blink"==this.cursorLayer.style.animationName?"cm-blink2":"cm-blink"),e&&this.setBlinkRate()}readPos(){let{state:t}=this.view,e=t.facet(Ks),i=t.selection.ranges.map((t=>t.empty?[]:function(t,e){if(e.to<=t.viewport.from||e.from>=t.viewport.to)return[];let i=Math.max(e.from,t.viewport.from),n=Math.min(e.to,t.viewport.to),r=t.textDirection==Fn.LTR,s=t.contentDOM,o=s.getBoundingClientRect(),l=ro(t),a=window.getComputedStyle(s.firstChild),h=o.left+parseInt(a.paddingLeft)+Math.min(0,parseInt(a.textIndent)),c=o.right-parseInt(a.paddingRight),u=oo(t,i),f=oo(t,n),d=u.type==fn.Text?u:null,p=f.type==fn.Text?f:null;t.lineWrapping&&(d&&(d=so(t,i,d)),p&&(p=so(t,n,p)));if(d&&p&&d.from==p.from)return m(b(e.from,e.to,d));{let i=d?b(e.from,null,d):O(u,!1),n=p?b(null,e.to,p):O(f,!0),r=[];return(d||u).to<(p||f).from-1?r.push(g(h,i.bottom,c,n.top)):i.bottom<n.top&&t.elementAtHeight((i.bottom+n.top)/2).type==fn.Text&&(i.bottom=n.top=(i.bottom+n.top)/2),m(i).concat(r).concat(m(n))}function g(t,e,i,n){return new to(t-l.left,e-l.top-.01,i-t,n-e+.01,"cm-selectionBackground")}function m({top:t,bottom:e,horizontal:i}){let n=[];for(let r=0;r<i.length;r+=2)n.push(g(i[r],t,i[r+1],e));return n}function b(e,i,n){let s=1e9,o=-1e9,l=[];function a(e,i,a,u,f){let d=t.coordsAtPos(e,e==n.to?-2:2),p=t.coordsAtPos(a,a==n.from?2:-2);s=Math.min(d.top,p.top,s),o=Math.max(d.bottom,p.bottom,o),f==Fn.LTR?l.push(r&&i?h:d.left,r&&u?c:p.right):l.push(!r&&u?h:p.left,!r&&i?c:d.right)}let u=null!=e?e:n.from,f=null!=i?i:n.to;for(let n of t.visibleRanges)if(n.to>u&&n.from<f)for(let r=Math.max(n.from,u),s=Math.min(n.to,f);;){let n=t.state.doc.lineAt(r);for(let o of t.bidiSpans(n)){let t=o.from+n.from,l=o.to+n.from;if(t>=s)break;l>r&&a(Math.max(t,r),null==e&&t<=u,Math.min(l,s),null==i&&l>=f,o.dir)}if(r=n.to+1,r>=s)break}return 0==l.length&&a(u,null==e,f,null==i,t.textDirection),{top:s,bottom:o,horizontal:l}}function O(t,e){let i=o.top+(e?t.top:t.bottom);return{top:i,bottom:i,horizontal:[]}}}(this.view,t))).reduce(((t,e)=>t.concat(e))),n=[];for(let i of t.selection.ranges){let r=i==t.selection.main;if(i.empty?!r||Ys:e.drawRangeCursor){let t=lo(this.view,i,r);t&&n.push(t)}}return{rangePieces:i,cursors:n}}drawSel({rangePieces:t,cursors:e}){if(t.length!=this.rangePieces.length||t.some(((t,e)=>!t.eq(this.rangePieces[e])))){this.selectionLayer.textContent="";for(let e of t)this.selectionLayer.appendChild(e.draw());this.rangePieces=t}if(e.length!=this.cursors.length||e.some(((t,e)=>!t.eq(this.cursors[e])))){let t=this.cursorLayer.children;if(t.length!==e.length){this.cursorLayer.textContent="";for(const t of e)this.cursorLayer.appendChild(t.draw())}else e.forEach(((e,i)=>e.adjust(t[i])));this.cursors=e}}destroy(){this.selectionLayer.remove(),this.cursorLayer.remove()}}),io={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};Ys&&(io[".cm-line"].caretColor="transparent !important");const no=ee.highest(Is.theme(io));function ro(t){let e=t.scrollDOM.getBoundingClientRect();return{left:(t.textDirection==Fn.LTR?e.left:e.right-t.scrollDOM.clientWidth)-t.scrollDOM.scrollLeft,top:e.top-t.scrollDOM.scrollTop}}function so(t,e,i){let n=zt.cursor(e);return{from:Math.max(i.from,t.moveToLineBoundary(n,!1,!0).from),to:Math.min(i.to,t.moveToLineBoundary(n,!0,!0).from),type:fn.Text}}function oo(t,e){let i=t.lineBlockAt(e);if(Array.isArray(i.type))for(let t of i.type)if(t.to>e||t.to==e&&(t.to==i.to||t.type==fn.Text))return t;return i}function lo(t,e,i){let n=t.coordsAtPos(e.head,e.assoc||1);if(!n)return null;let r=ro(t);return new to(n.left-r.left,n.top-r.top,-1,n.bottom-n.top,i?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary")}const ao=Oe.define({map:(t,e)=>null==t?null:e.mapPos(t)}),ho=Gt.define({create:()=>null,update:(t,e)=>(null!=t&&(t=e.changes.mapPos(t)),e.effects.reduce(((t,e)=>e.is(ao)?e.value:t),t))}),co=Bn.fromClass(class{constructor(t){this.view=t,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(t){var e;let i=t.state.field(ho);null==i?null!=this.cursor&&(null===(e=this.cursor)||void 0===e||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(t.startState.field(ho)!=i||t.docChanged||t.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let t=this.view.state.field(ho),e=null!=t&&this.view.coordsAtPos(t);if(!e)return null;let i=this.view.scrollDOM.getBoundingClientRect();return{left:e.left-i.left+this.view.scrollDOM.scrollLeft,top:e.top-i.top+this.view.scrollDOM.scrollTop,height:e.bottom-e.top}}drawCursor(t){this.cursor&&(t?(this.cursor.style.left=t.left+"px",this.cursor.style.top=t.top+"px",this.cursor.style.height=t.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(t){this.view.state.field(ho)!=t&&this.view.dispatch({effects:ao.of(t)})}},{eventHandlers:{dragover(t){this.setDropPos(this.view.posAtCoords({x:t.clientX,y:t.clientY}))},dragleave(t){t.target!=this.view.contentDOM&&this.view.contentDOM.contains(t.relatedTarget)||this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function uo(t,e,i,n,r){e.lastIndex=0;for(let s,o=t.iterRange(i,n),l=i;!o.next().done;l+=o.value.length)if(!o.lineBreak)for(;s=e.exec(o.value);)r(l+s.index,l+s.index+s[0].length,s)}class fo{constructor(t){let{regexp:e,decoration:i,boundary:n,maxLength:r=1e3}=t;if(!e.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");this.regexp=e,this.getDeco="function"==typeof i?i:()=>i,this.boundary=n,this.maxLength=r}createDeco(t){let e=new Be;for(let{from:i,to:n}of function(t,e){let i=t.visibleRanges;if(1==i.length&&i[0].from==t.viewport.from&&i[0].to==t.viewport.to)return i;let n=[];for(let{from:r,to:s}of i)r=Math.max(t.state.doc.lineAt(r).from,r-e),s=Math.min(t.state.doc.lineAt(s).to,s+e),n.length&&n[n.length-1].to>=r?n[n.length-1].to=s:n.push({from:r,to:s});return n}(t,this.maxLength))uo(t.state.doc,this.regexp,i,n,((i,n,r)=>e.add(i,n,this.getDeco(r,t,i))));return e.finish()}updateDeco(t,e){let i=1e9,n=-1;return t.docChanged&&t.changes.iterChanges(((e,r,s,o)=>{o>t.view.viewport.from&&s<t.view.viewport.to&&(i=Math.min(s,i),n=Math.max(o,n))})),t.viewportChanged||n-i>1e3?this.createDeco(t.view):n>-1?this.updateRange(t.view,e.map(t.changes),i,n):e}updateRange(t,e,i,n){for(let r of t.visibleRanges){let s=Math.max(r.from,i),o=Math.min(r.to,n);if(o>s){let i=t.state.doc.lineAt(s),n=i.to<o?t.state.doc.lineAt(o):i,l=Math.max(r.from,i.from),a=Math.min(r.to,n.to);if(this.boundary){for(;s>i.from;s--)if(this.boundary.test(i.text[s-1-i.from])){l=s;break}for(;o<n.to;o++)if(this.boundary.test(n.text[o-n.from])){a=o;break}}let h,c=[];if(i==n)for(this.regexp.lastIndex=l-i.from;(h=this.regexp.exec(i.text))&&h.index<a-i.from;){let e=h.index+i.from;c.push(this.getDeco(h,t,e).range(e,e+h[0].length))}else uo(t.state.doc,this.regexp,l,a,((e,i,n)=>c.push(this.getDeco(n,t,e).range(e,i))));e=e.update({filterFrom:l,filterTo:a,filter:(t,e)=>t<l||e>a,add:c})}}return e}}const po=null!=/x/.unicode?"gu":"g",go=new RegExp("[\0-\b\n--­؜​‎‏\u2028\u2029‭‮\ufeff￹-￼]",po),mo={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let bo=null;const Oo=Vt.define({combine(t){let e=Re(t,{render:null,specialChars:go,addSpecialChars:null});return(e.replaceTabs=!function(){var t;if(null==bo&&"undefined"!=typeof document&&document.body){let e=document.body.style;bo=null!=(null!==(t=e.tabSize)&&void 0!==t?t:e.MozTabSize)}return bo||!1}())&&(e.specialChars=new RegExp("\t|"+e.specialChars.source,po)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,po)),e}});function vo(t={}){return[Oo.of(t),wo||(wo=Bn.fromClass(class{constructor(t){this.view=t,this.decorations=dn.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(t.state.facet(Oo)),this.decorations=this.decorator.createDeco(t)}makeDecorator(t){return new fo({regexp:t.specialChars,decoration:(e,i,n)=>{let{doc:r}=i.state,s=Ct(e[0],0);if(9==s){let t=r.lineAt(n),e=i.state.tabSize,s=Ze(t.text,e,n-t.from);return dn.replace({widget:new xo((e-s%e)*this.view.defaultCharacterWidth)})}return this.decorationCache[s]||(this.decorationCache[s]=dn.replace({widget:new yo(t,s)}))},boundary:t.replaceTabs?void 0:/[^]/})}update(t){let e=t.state.facet(Oo);t.startState.facet(Oo)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(t.view)):this.decorations=this.decorator.updateDeco(t,this.decorations)}},{decorations:t=>t.decorations}))]}let wo=null;class yo extends un{constructor(t,e){super(),this.options=t,this.code=e}eq(t){return t.code==this.code}toDOM(t){let e=function(t){return t>=32?"•":10==t?"␤":String.fromCharCode(9216+t)}(this.code),i=t.state.phrase("Control character")+" "+(mo[this.code]||"0x"+this.code.toString(16)),n=this.options.render&&this.options.render(this.code,i,e);if(n)return n;let r=document.createElement("span");return r.textContent=e,r.title=i,r.setAttribute("aria-label",i),r.className="cm-specialChar",r}ignoreEvent(){return!1}}class xo extends un{constructor(t){super(),this.width=t}eq(t){return t.width==this.width}toDOM(){let t=document.createElement("span");return t.textContent="\t",t.className="cm-tab",t.style.width=this.width+"px",t}ignoreEvent(){return!1}}const ko=dn.line({class:"cm-activeLine"}),So=Bn.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.docChanged||t.selectionSet)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=-1,i=[];for(let n of t.state.selection.ranges){if(!n.empty)return dn.none;let r=t.lineBlockAt(n.head);r.from>e&&(i.push(ko.range(r.from)),e=r.from)}return dn.set(i)}},{decorations:t=>t.decorations}),Co=2e3;function Ao(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1),n=t.state.doc.lineAt(i),r=i-n.from,s=r>Co?-1:r==n.length?function(t,e){let i=t.coordsAtPos(t.viewport.from);return i?Math.round(Math.abs((i.left-e)/t.defaultCharacterWidth)):-1}(t,e.clientX):Ze(n.text,t.state.tabSize,i-n.from);return{line:n.number,col:s,off:r}}function To(t,e){let i=Ao(t,e),n=t.state.selection;return i?{update(t){if(t.docChanged){let e=t.changes.mapPos(t.startState.doc.line(i.line).from),r=t.state.doc.lineAt(e);i={line:r.number,col:i.col,off:Math.min(i.off,r.length)},n=n.map(t.changes)}},get(e,r,s){let o=Ao(t,e);if(!o)return n;let l=function(t,e,i){let n=Math.min(e.line,i.line),r=Math.max(e.line,i.line),s=[];if(e.off>Co||i.off>Co||e.col<0||i.col<0){let o=Math.min(e.off,i.off),l=Math.max(e.off,i.off);for(let e=n;e<=r;e++){let i=t.doc.line(e);i.length<=l&&s.push(zt.range(i.from+o,i.to+l))}}else{let o=Math.min(e.col,i.col),l=Math.max(e.col,i.col);for(let e=n;e<=r;e++){let i=t.doc.line(e),n=Ge(i.text,o,t.tabSize,!0);if(n>-1){let e=Ge(i.text,l,t.tabSize);s.push(zt.range(i.from+n,i.from+e))}}}return s}(t.state,i,o);return l.length?s?zt.create(l.concat(n.ranges)):zt.create(l):n}}:null}function Po(t){let e=(null==t?void 0:t.eventFilter)||(t=>t.altKey&&0==t.button);return Is.mouseSelectionStyle.of(((t,i)=>e(i)?To(t,i):null))}const Mo={Alt:[18,t=>t.altKey],Control:[17,t=>t.ctrlKey],Shift:[16,t=>t.shiftKey],Meta:[91,t=>t.metaKey]},Qo={style:"cursor: crosshair"};function Ro(t={}){let[e,i]=Mo[t.key||"Alt"],n=Bn.fromClass(class{constructor(t){this.view=t,this.isDown=!1}set(t){this.isDown!=t&&(this.isDown=t,this.view.update([]))}},{eventHandlers:{keydown(t){this.set(t.keyCode==e||i(t))},keyup(t){t.keyCode!=e&&i(t)||this.set(!1)}}});return[n,Is.contentAttributes.of((t=>{var e;return(null===(e=t.plugin(n))||void 0===e?void 0:e.isDown)?Qo:null}))]}const $o=Vt.define({combine(t){let e,i;for(let n of t)e=e||n.topContainer,i=i||n.bottomContainer;return{topContainer:e,bottomContainer:i}}});function _o(t,e){let i=t.plugin(Do),n=i?i.specs.indexOf(e):-1;return n>-1?i.panels[n]:null}const Do=Bn.fromClass(class{constructor(t){this.input=t.state.facet(Bo),this.specs=this.input.filter((t=>t)),this.panels=this.specs.map((e=>e(t)));let e=t.state.facet($o);this.top=new Eo(t,!0,e.topContainer),this.bottom=new Eo(t,!1,e.bottomContainer),this.top.sync(this.panels.filter((t=>t.top))),this.bottom.sync(this.panels.filter((t=>!t.top)));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(t){let e=t.state.facet($o);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Eo(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Eo(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let i=t.state.facet(Bo);if(i!=this.input){let e=i.filter((t=>t)),n=[],r=[],s=[],o=[];for(let i of e){let e,l=this.specs.indexOf(i);l<0?(e=i(t.view),o.push(e)):(e=this.panels[l],e.update&&e.update(t)),n.push(e),(e.top?r:s).push(e)}this.specs=e,this.panels=n,this.top.sync(r),this.bottom.sync(s);for(let t of o)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}else for(let e of this.panels)e.update&&e.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>Is.scrollMargins.of((e=>{let i=e.plugin(t);return i&&{top:i.top.scrollMargin(),bottom:i.bottom.scrollMargin()}}))});class Eo{constructor(t,e,i){this.view=t,this.top=e,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let e of this.panels)e.destroy&&t.indexOf(e)<0&&e.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(0==this.panels.length)return void(this.dom&&(this.dom.remove(),this.dom=void 0));if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=No(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=No(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function No(t){let e=t.nextSibling;return t.remove(),e}const Bo=Vt.define({enables:Do});class Io extends $e{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}Io.prototype.elementClass="",Io.prototype.toDOM=void 0,Io.prototype.mapMode=Mt.TrackBefore,Io.prototype.startSide=Io.prototype.endSide=-1,Io.prototype.point=!0;const zo=Vt.define(),Lo=Vt.define(),Wo=Vt.define({combine:t=>t.some((t=>t))});function Vo(t){let e=[jo];return t&&!1===t.fixed&&e.push(Wo.of(!0)),e}const jo=Bn.fromClass(class{constructor(t){this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=t.state.facet(Lo).map((e=>new Fo(t,e)));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!t.state.facet(Wo),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}update(t){if(this.updateGutters(t)){let e=this.prevViewport,i=t.view.viewport,n=Math.min(e.to,i.to)-Math.max(e.from,i.from);this.syncGutters(n<.8*(i.to-i.from))}t.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(Wo)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&this.dom.remove();let i=Ne.iter(this.view.state.facet(zo),this.view.viewport.from),n=[],r=this.gutters.map((t=>new Xo(t,this.view.viewport,-this.view.documentPadding.top)));for(let t of this.view.viewportLineBlocks){let e;if(Array.isArray(t.type)){for(let i of t.type)if(i.type==fn.Text){e=i;break}}else e=t.type==fn.Text?t:void 0;if(e){n.length&&(n=[]),Ho(i,n,t.from);for(let t of r)t.line(this.view,e,n)}}for(let t of r)t.finish();t&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(t){let e=t.startState.facet(Lo),i=t.state.facet(Lo),n=t.docChanged||t.heightChanged||t.viewportChanged||!Ne.eq(t.startState.facet(zo),t.state.facet(zo),t.view.viewport.from,t.view.viewport.to);if(e==i)for(let e of this.gutters)e.update(t)&&(n=!0);else{n=!0;let r=[];for(let n of i){let i=e.indexOf(n);i<0?r.push(new Fo(this.view,n)):(this.gutters[i].update(t),r.push(this.gutters[i]))}for(let t of this.gutters)t.dom.remove(),r.indexOf(t)<0&&t.destroy();for(let t of r)this.dom.appendChild(t.dom);this.gutters=r}return n}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove()}},{provide:t=>Is.scrollMargins.of((e=>{let i=e.plugin(t);return i&&0!=i.gutters.length&&i.fixed?e.textDirection==Fn.LTR?{left:i.dom.offsetWidth}:{right:i.dom.offsetWidth}:null}))});function qo(t){return Array.isArray(t)?t:[t]}function Ho(t,e,i){for(;t.value&&t.from<=i;)t.from==i&&e.push(t.value),t.next()}class Xo{constructor(t,e,i){this.gutter=t,this.height=i,this.localMarkers=[],this.i=0,this.cursor=Ne.iter(t.markers,e.from)}line(t,e,i){this.localMarkers.length&&(this.localMarkers=[]),Ho(this.cursor,this.localMarkers,e.from);let n=i.length?this.localMarkers.concat(i):this.localMarkers,r=this.gutter.config.lineMarker(t,e,n);r&&n.unshift(r);let s=this.gutter;if(0==n.length&&!s.config.renderEmptyElements)return;let o=e.top-this.height;if(this.i==s.elements.length){let i=new Zo(t,e.height,o,n);s.elements.push(i),s.dom.appendChild(i.dom)}else s.elements[this.i].update(t,e.height,o,n);this.height=e.bottom,this.i++}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let e=t.elements.pop();t.dom.removeChild(e.dom),e.destroy()}}}class Fo{constructor(t,e){this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in e.domEventHandlers)this.dom.addEventListener(i,(n=>{let r=t.lineBlockAtHeight(n.clientY-t.documentTop);e.domEventHandlers[i](t,r,n)&&n.preventDefault()}));this.markers=qo(e.markers(t)),e.initialSpacer&&(this.spacer=new Zo(t,0,0,[e.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let e=this.markers;if(this.markers=qo(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let e=this.config.updateSpacer(this.spacer.markers[0],t);e!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[e])}let i=t.view.viewport;return!Ne.eq(this.markers,e,i.from,i.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(t)}destroy(){for(let t of this.elements)t.destroy()}}class Zo{constructor(t,e,i,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,e,i,n)}update(t,e,i,n){this.height!=e&&(this.dom.style.height=(this.height=e)+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),function(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!t[i].compare(e[i]))return!1;return!0}(this.markers,n)||this.setMarkers(t,n)}setMarkers(t,e){let i="cm-gutterElement",n=this.dom.firstChild;for(let r=0,s=0;;){let o=s,l=r<e.length?e[r++]:null,a=!1;if(l){let t=l.elementClass;t&&(i+=" "+t);for(let t=s;t<this.markers.length;t++)if(this.markers[t].compare(l)){o=t,a=!0;break}}else o=this.markers.length;for(;s<o;){let t=this.markers[s++];if(t.toDOM){t.destroy(n);let e=n.nextSibling;n.remove(),n=e}}if(!l)break;l.toDOM&&(a?n=n.nextSibling:this.dom.insertBefore(l.toDOM(t),n)),a&&s++}this.dom.className=i,this.markers=e}destroy(){this.setMarkers(null,[])}}const Go=Vt.define(),Uo=Vt.define({combine:t=>Re(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,e){let i=Object.assign({},t);for(let t in e){let n=i[t],r=e[t];i[t]=n?(t,e,i)=>n(t,e,i)||r(t,e,i):r}return i}})});class Yo extends Io{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function Ko(t,e){return t.state.facet(Uo).formatNumber(e,t.state)}const Jo=Lo.compute([Uo],(t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers:t=>t.state.facet(Go),lineMarker:(t,e,i)=>i.some((t=>t.toDOM))?null:new Yo(Ko(t,t.state.doc.lineAt(e.from).number)),lineMarkerChange:t=>t.startState.facet(Uo)!=t.state.facet(Uo),initialSpacer:t=>new Yo(Ko(t,tl(t.state.doc.lines))),updateSpacer(t,e){let i=Ko(e.view,tl(e.view.state.doc.lines));return i==t.number?t:new Yo(i)},domEventHandlers:t.facet(Uo).domEventHandlers})));function tl(t){let e=9;for(;e<t;)e=10*e+9;return e}class el{constructor(){}lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,i){let n=[];return this.decompose(0,t,n,2),i.length&&i.decompose(0,i.length,n,3),this.decompose(e,this.length,n,1),nl.from(n,this.length-(e-t)+i.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){let i=[];return this.decompose(t,e,i,0),nl.from(i,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),i=this.length-this.scanIdentical(t,-1),n=new ol(this),r=new ol(t);for(let t=e,s=e;;){if(n.next(t),r.next(t),t=0,n.lineBreak!=r.lineBreak||n.done!=r.done||n.value!=r.value)return!1;if(s+=n.value.length,n.done||s>=i)return!0}}iter(t=1){return new ol(this,t)}iterRange(t,e=this.length){return new ll(this,t,e)}iterLines(t,e){let i;if(null==t)i=this.iter();else{null==e&&(e=this.lines+1);let n=this.line(t).from;i=this.iterRange(n,Math.max(n,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new al(i)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}static of(t){if(0==t.length)throw new RangeError("A document must have at least one line");return 1!=t.length||t[0]?t.length<=32?new il(t):nl.from(il.split(t,[])):el.empty}}class il extends el{constructor(t,e=function(t){let e=-1;for(let i of t)e+=i.length+1;return e}(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,i,n){for(let r=0;;r++){let s=this.text[r],o=n+s.length;if((e?i:o)>=t)return new hl(n,o,i,s);n=o+1,i++}}decompose(t,e,i,n){let r=t<=0&&e>=this.length?this:new il(sl(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(1&n){let t=i.pop(),e=rl(r.text,t.text.slice(),0,r.length);if(e.length<=32)i.push(new il(e,t.length+r.length));else{let t=e.length>>1;i.push(new il(e.slice(0,t)),new il(e.slice(t)))}}else i.push(r)}replace(t,e,i){if(!(i instanceof il))return super.replace(t,e,i);let n=rl(this.text,rl(i.text,sl(this.text,0,t)),e),r=this.length+i.length-(e-t);return n.length<=32?new il(n,r):nl.from(il.split(n,[]),r)}sliceString(t,e=this.length,i="\n"){let n="";for(let r=0,s=0;r<=e&&s<this.text.length;s++){let o=this.text[s],l=r+o.length;r>t&&s&&(n+=i),t<l&&e>r&&(n+=o.slice(Math.max(0,t-r),e-r)),r=l+1}return n}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let i=[],n=-1;for(let r of t)i.push(r),n+=r.length+1,32==i.length&&(e.push(new il(i,n)),i=[],n=-1);return n>-1&&e.push(new il(i,n)),e}}class nl extends el{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let e of t)this.lines+=e.lines}lineInner(t,e,i,n){for(let r=0;;r++){let s=this.children[r],o=n+s.length,l=i+s.lines-1;if((e?l:o)>=t)return s.lineInner(t,e,i,n);n=o+1,i=l+1}}decompose(t,e,i,n){for(let r=0,s=0;s<=e&&r<this.children.length;r++){let o=this.children[r],l=s+o.length;if(t<=l&&e>=s){let r=n&((s<=t?1:0)|(l>=e?2:0));s>=t&&l<=e&&!r?i.push(o):o.decompose(t-s,e-s,i,r)}s=l+1}}replace(t,e,i){if(i.lines<this.lines)for(let n=0,r=0;n<this.children.length;n++){let s=this.children[n],o=r+s.length;if(t>=r&&e<=o){let l=s.replace(t-r,e-r,i),a=this.lines-s.lines+l.lines;if(l.lines<a>>4&&l.lines>a>>6){let r=this.children.slice();return r[n]=l,new nl(r,this.length-(e-t)+i.length)}return super.replace(r,o,l)}r=o+1}return super.replace(t,e,i)}sliceString(t,e=this.length,i="\n"){let n="";for(let r=0,s=0;r<this.children.length&&s<=e;r++){let o=this.children[r],l=s+o.length;s>t&&r&&(n+=i),t<l&&e>s&&(n+=o.sliceString(t-s,e-s,i)),s=l+1}return n}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof nl))return 0;let i=0,[n,r,s,o]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;n+=e,r+=e){if(n==s||r==o)return i;let l=this.children[n],a=t.children[r];if(l!=a)return i+l.scanIdentical(a,e);i+=l.length+1}}static from(t,e=t.reduce(((t,e)=>t+e.length+1),-1)){let i=0;for(let e of t)i+=e.lines;if(i<32){let i=[];for(let e of t)e.flatten(i);return new il(i,e)}let n=Math.max(32,i>>5),r=n<<1,s=n>>1,o=[],l=0,a=-1,h=[];function c(t){let e;if(t.lines>r&&t instanceof nl)for(let e of t.children)c(e);else t.lines>s&&(l>s||!l)?(u(),o.push(t)):t instanceof il&&l&&(e=h[h.length-1])instanceof il&&t.lines+e.lines<=32?(l+=t.lines,a+=t.length+1,h[h.length-1]=new il(e.text.concat(t.text),e.length+1+t.length)):(l+t.lines>n&&u(),l+=t.lines,a+=t.length+1,h.push(t))}function u(){0!=l&&(o.push(1==h.length?h[0]:nl.from(h,a)),a=-1,l=h.length=0)}for(let e of t)c(e);return u(),1==o.length?o[0]:new nl(o,e)}}function rl(t,e,i=0,n=1e9){for(let r=0,s=0,o=!0;s<t.length&&r<=n;s++){let l=t[s],a=r+l.length;a>=i&&(a>n&&(l=l.slice(0,n-r)),r<i&&(l=l.slice(i-r)),o?(e[e.length-1]+=l,o=!1):e.push(l)),r=a+1}return e}function sl(t,e,i){return rl(t,[""],e,i)}el.empty=new il([""],0);class ol{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof il?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,n=this.nodes[i],r=this.offsets[i],s=r>>1,o=n instanceof il?n.text.length:n.children.length;if(s==(e>0?o:0)){if(0==i)return this.done=!0,this.value="",this;e>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&r)==(e>0?0:1)){if(this.offsets[i]+=e,0==t)return this.lineBreak=!0,this.value="\n",this;t--}else if(n instanceof il){let r=n.text[s+(e<0?-1:0)];if(this.offsets[i]+=e,r.length>Math.max(0,t))return this.value=0==t?r:e>0?r.slice(t):r.slice(0,r.length-t),this;t-=r.length}else{let r=n.children[s+(e<0?-1:0)];t>r.length?(t-=r.length,this.offsets[i]+=e):(e<0&&this.offsets[i]--,this.nodes.push(r),this.offsets.push(e>0?1:(r instanceof il?r.text.length:r.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class ll{constructor(t,e,i){this.value="",this.done=!1,this.cursor=new ol(t,e>i?-1:1),this.pos=e>i?t.length:0,this.from=Math.min(e,i),this.to=Math.max(e,i)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let i=e<0?this.pos-this.from:this.to-this.pos;t>i&&(t=i),i-=t;let{value:n}=this.cursor.next(t);return this.pos+=(n.length+t)*e,this.value=n.length<=i?n:e<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class al{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:i,value:n}=this.inner.next(t);return e?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(el.prototype[Symbol.iterator]=function(){return this.iter()},ol.prototype[Symbol.iterator]=ll.prototype[Symbol.iterator]=al.prototype[Symbol.iterator]=function(){return this});class hl{constructor(t,e,i,n){this.from=t,this.to=e,this.number=i,this.text=n}get length(){return this.to-this.from}}let cl="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((t=>t?parseInt(t,36):1));for(let t=1;t<cl.length;t++)cl[t]+=cl[t-1];function ul(t){for(let e=1;e<cl.length;e+=2)if(cl[e]>t)return cl[e-1]<=t;return!1}function fl(t){return t>=127462&&t<=127487}function dl(t,e,i=!0,n=!0){return(i?pl:gl)(t,e,n)}function pl(t,e,i){if(e==t.length)return e;e&&ml(t.charCodeAt(e))&&bl(t.charCodeAt(e-1))&&e--;let n=Ol(t,e);for(e+=wl(n);e<t.length;){let r=Ol(t,e);if(8205==n||8205==r||i&&ul(r))e+=wl(r),n=r;else{if(!fl(r))break;{let i=0,n=e-2;for(;n>=0&&fl(Ol(t,n));)i++,n-=2;if(i%2==0)break;e+=2}}}return e}function gl(t,e,i){for(;e>0;){let n=pl(t,e-2,i);if(n<e)return n;e--}return 0}function ml(t){return t>=56320&&t<57344}function bl(t){return t>=55296&&t<56320}function Ol(t,e){let i=t.charCodeAt(e);if(!bl(i)||e+1==t.length)return i;let n=t.charCodeAt(e+1);return ml(n)?n-56320+(i-55296<<10)+65536:i}function vl(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}function wl(t){return t<65536?1:2}const yl=/\r\n?|\n/;var xl=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(xl||(xl={}));class kl{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e+1];t+=i<0?this.sections[e]:i}return t}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(t){for(let e=0,i=0,n=0;e<this.sections.length;){let r=this.sections[e++],s=this.sections[e++];s<0?(t(i,n,r),n+=r):n+=s,i+=r}}iterChangedRanges(t,e=!1){Tl(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];n<0?t.push(i,n):t.push(n,i)}return new kl(t)}composeDesc(t){return this.empty?t:t.empty?this:Ml(this,t)}mapDesc(t,e=!1){return t.empty?this:Pl(this,t,e)}mapPos(t,e=-1,i=xl.Simple){let n=0,r=0;for(let s=0;s<this.sections.length;){let o=this.sections[s++],l=this.sections[s++],a=n+o;if(l<0){if(a>t)return r+(t-n);r+=o}else{if(i!=xl.Simple&&a>=t&&(i==xl.TrackDel&&n<t&&a>t||i==xl.TrackBefore&&n<t||i==xl.TrackAfter&&a>t))return null;if(a>t||a==t&&e<0&&!o)return t==n||e<0?r:r+l;r+=l}n=a}if(t>n)throw new RangeError(`Position ${t} is out of range for changeset of length ${n}`);return r}touchesRange(t,e=t){for(let i=0,n=0;i<this.sections.length&&n<=e;){let r=n+this.sections[i++];if(this.sections[i++]>=0&&n<=e&&r>=t)return!(n<t&&r>e)||"cover";n=r}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+i+(n>=0?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some((t=>"number"!=typeof t)))throw new RangeError("Invalid JSON representation of ChangeDesc");return new kl(t)}static create(t){return new kl(t)}}class Sl extends kl{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return Tl(this,((e,i,n,r,s)=>t=t.replace(n,n+(i-e),s)),!1),t}mapDesc(t,e=!1){return Pl(this,t,e,!0)}invert(t){let e=this.sections.slice(),i=[];for(let n=0,r=0;n<e.length;n+=2){let s=e[n],o=e[n+1];if(o>=0){e[n]=o,e[n+1]=s;let l=n>>1;for(;i.length<l;)i.push(el.empty);i.push(s?t.slice(r,r+s):el.empty)}r+=s}return new Sl(e,i)}compose(t){return this.empty?t:t.empty?this:Ml(this,t,!0)}map(t,e=!1){return t.empty?this:Pl(this,t,e,!0)}iterChanges(t,e=!1){Tl(this,t,e)}get desc(){return kl.create(this.sections)}filter(t){let e=[],i=[],n=[],r=new Ql(this);t:for(let s=0,o=0;;){let l=s==t.length?1e9:t[s++];for(;o<l||o==l&&0==r.len;){if(r.done)break t;let t=Math.min(r.len,l-o);Cl(n,t,-1);let s=-1==r.ins?-1:0==r.off?r.ins:0;Cl(e,t,s),s>0&&Al(i,e,r.text),r.forward(t),o+=t}let a=t[s++];for(;o<a;){if(r.done)break t;let t=Math.min(r.len,a-o);Cl(e,t,-1),Cl(n,t,-1==r.ins?-1:0==r.off?r.ins:0),r.forward(t),o+=t}}return{changes:new Sl(e,i),filtered:kl.create(n)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e],n=this.sections[e+1];n<0?t.push(i):0==n?t.push([i]):t.push([i].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,i){let n=[],r=[],s=0,o=null;function l(t=!1){if(!t&&!n.length)return;s<e&&Cl(n,e-s,-1);let i=new Sl(n,r);o=o?o.compose(i.map(o)):i,n=[],r=[],s=0}return function t(a){if(Array.isArray(a))for(let e of a)t(e);else if(a instanceof Sl){if(a.length!=e)throw new RangeError(`Mismatched change set length (got ${a.length}, expected ${e})`);l(),o=o?o.compose(a.map(o)):a}else{let{from:t,to:o=t,insert:h}=a;if(t>o||t<0||o>e)throw new RangeError(`Invalid change range ${t} to ${o} (in doc of length ${e})`);let c=h?"string"==typeof h?el.of(h.split(i||yl)):h:el.empty,u=c.length;if(t==o&&0==u)return;t<s&&l(),t>s&&Cl(n,t-s,-1),Cl(n,o-t,u),Al(r,n,c),s=o}}(t),l(!o),o}static empty(t){return new Sl(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],i=[];for(let n=0;n<t.length;n++){let r=t[n];if("number"==typeof r)e.push(r,-1);else{if(!Array.isArray(r)||"number"!=typeof r[0]||r.some(((t,e)=>e&&"string"!=typeof t)))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==r.length)e.push(r[0],0);else{for(;i.length<n;)i.push(el.empty);i[n]=el.of(r.slice(1)),e.push(r[0],i[n].length)}}}return new Sl(e,i)}static createSet(t,e){return new Sl(t,e)}}function Cl(t,e,i,n=!1){if(0==e&&i<=0)return;let r=t.length-2;r>=0&&i<=0&&i==t[r+1]?t[r]+=e:0==e&&0==t[r]?t[r+1]+=i:n?(t[r]+=e,t[r+1]+=i):t.push(e,i)}function Al(t,e,i){if(0==i.length)return;let n=e.length-2>>1;if(n<t.length)t[t.length-1]=t[t.length-1].append(i);else{for(;t.length<n;)t.push(el.empty);t.push(i)}}function Tl(t,e,i){let n=t.inserted;for(let r=0,s=0,o=0;o<t.sections.length;){let l=t.sections[o++],a=t.sections[o++];if(a<0)r+=l,s+=l;else{let h=r,c=s,u=el.empty;for(;h+=l,c+=a,a&&n&&(u=u.append(n[o-2>>1])),!(i||o==t.sections.length||t.sections[o+1]<0);)l=t.sections[o++],a=t.sections[o++];e(r,h,s,c,u),r=h,s=c}}}function Pl(t,e,i,n=!1){let r=[],s=n?[]:null,o=new Ql(t),l=new Ql(e);for(let t=0,e=0;;)if(-1==o.ins)t+=o.len,o.next();else if(-1==l.ins&&e<t){let i=Math.min(l.len,t-e);l.forward(i),Cl(r,i,-1),e+=i}else if(l.ins>=0&&(o.done||e<t||e==t&&(l.len<o.len||l.len==o.len&&!i))){for(Cl(r,l.ins,-1);t>e&&!o.done&&t+o.len<e+l.len;)t+=o.len,o.next();e+=l.len,l.next()}else{if(!(o.ins>=0)){if(o.done&&l.done)return s?Sl.createSet(r,s):kl.create(r);throw new Error("Mismatched change set lengths")}{let i=0,n=t+o.len;for(;;)if(l.ins>=0&&e>t&&e+l.len<n)i+=l.ins,e+=l.len,l.next();else{if(!(-1==l.ins&&e<n))break;{let t=Math.min(l.len,n-e);i+=t,l.forward(t),e+=t}}Cl(r,i,o.ins),s&&Al(s,r,o.text),t=n,o.next()}}}function Ml(t,e,i=!1){let n=[],r=i?[]:null,s=new Ql(t),o=new Ql(e);for(let t=!1;;){if(s.done&&o.done)return r?Sl.createSet(n,r):kl.create(n);if(0==s.ins)Cl(n,s.len,0,t),s.next();else if(0!=o.len||o.done){if(s.done||o.done)throw new Error("Mismatched change set lengths");{let e=Math.min(s.len2,o.len),i=n.length;if(-1==s.ins){let i=-1==o.ins?-1:o.off?0:o.ins;Cl(n,e,i,t),r&&i&&Al(r,n,o.text)}else-1==o.ins?(Cl(n,s.off?0:s.len,e,t),r&&Al(r,n,s.textBit(e))):(Cl(n,s.off?0:s.len,o.off?0:o.ins,t),r&&!o.off&&Al(r,n,o.text));t=(s.ins>e||o.ins>=0&&o.len>e)&&(t||n.length>i),s.forward2(e),o.forward(e)}}else Cl(n,0,o.ins,t),r&&Al(r,n,o.text),o.next()}}class Ql{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?el.empty:t[e]}textBit(t){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length&&!t?el.empty:e[i].slice(this.off,null==t?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){-1==this.ins?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class Rl{constructor(t,e,i){this.from=t,this.to=e,this.flags=i}get anchor(){return 16&this.flags?this.to:this.from}get head(){return 16&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 4&this.flags?-1:8&this.flags?1:0}get bidiLevel(){let t=3&this.flags;return 3==t?null:t}get goalColumn(){let t=this.flags>>5;return 33554431==t?void 0:t}map(t,e=-1){let i,n;return this.empty?i=n=t.mapPos(this.from,e):(i=t.mapPos(this.from,1),n=t.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new Rl(i,n,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return $l.range(t,e);let i=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return $l.range(this.anchor,i)}eq(t){return this.anchor==t.anchor&&this.head==t.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||"number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid JSON representation for SelectionRange");return $l.range(t.anchor,t.head)}static create(t,e,i){return new Rl(t,e,i)}}class $l{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:$l.create(this.ranges.map((i=>i.map(t,e))),this.mainIndex)}eq(t){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let e=0;e<this.ranges.length;e++)if(!this.ranges[e].eq(t.ranges[e]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new $l([this.main],0)}addRange(t,e=!0){return $l.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let i=this.ranges.slice();return i[e]=t,$l.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map((t=>t.toJSON())),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||"number"!=typeof t.main||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new $l(t.ranges.map((t=>Rl.fromJSON(t))),t.main)}static single(t,e=t){return new $l([$l.range(t,e)],0)}static create(t,e=0){if(0==t.length)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<t.length;n++){let r=t[n];if(r.empty?r.from<=i:r.from<i)return $l.normalized(t.slice(),e);i=r.to}return new $l(t,e)}static cursor(t,e=0,i,n){return Rl.create(t,t,(0==e?0:e<0?4:8)|(null==i?3:Math.min(2,i))|(null!=n?n:33554431)<<5)}static range(t,e,i){let n=(null!=i?i:33554431)<<5;return e<t?Rl.create(e,t,24|n):Rl.create(t,e,n|(e>t?4:0))}static normalized(t,e=0){let i=t[e];t.sort(((t,e)=>t.from-e.from)),e=t.indexOf(i);for(let i=1;i<t.length;i++){let n=t[i],r=t[i-1];if(n.empty?n.from<=r.to:n.from<r.to){let s=r.from,o=Math.max(n.to,r.to);i<=e&&e--,t.splice(--i,2,n.anchor>n.head?$l.range(o,s):$l.range(s,o))}}return new $l(t,e)}}function _l(t,e){for(let i of t.ranges)if(i.to>e)throw new RangeError("Selection points outside of document")}let Dl=0;class El{constructor(t,e,i,n,r){this.combine=t,this.compareInput=e,this.compare=i,this.isStatic=n,this.extensions=r,this.id=Dl++,this.default=t([])}static define(t={}){return new El(t.combine||(t=>t),t.compareInput||((t,e)=>t===e),t.compare||(t.combine?(t,e)=>t===e:Nl),!!t.static,t.enables)}of(t){return new Bl([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Bl(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Bl(t,this,2,e)}from(t,e){return e||(e=t=>t),this.compute([t],(i=>e(i.field(t))))}}function Nl(t,e){return t==e||t.length==e.length&&t.every(((t,i)=>t===e[i]))}class Bl{constructor(t,e,i,n){this.dependencies=t,this.facet=e,this.type=i,this.value=n,this.id=Dl++}dynamicSlot(t){var e;let i=this.value,n=this.facet.compareInput,r=this.id,s=t[r]>>1,o=2==this.type,l=!1,a=!1,h=[];for(let i of this.dependencies)"doc"==i?l=!0:"selection"==i?a=!0:0==(1&(null!==(e=t[i.id])&&void 0!==e?e:1))&&h.push(t[i.id]);return{create:t=>(t.values[s]=i(t),1),update(t,e){if(l&&e.docChanged||a&&(e.docChanged||e.selection)||zl(t,h)){let e=i(t);if(o?!Il(e,t.values[s],n):!n(e,t.values[s]))return t.values[s]=e,1}return 0},reconfigure:(t,e)=>{let l=i(t),a=e.config.address[r];if(null!=a){let i=ta(e,a);if(this.dependencies.every((i=>i instanceof El?e.facet(i)===t.facet(i):!(i instanceof Vl)||e.field(i,!1)==t.field(i,!1)))||(o?Il(l,i,n):n(l,i)))return t.values[s]=i,0}return t.values[s]=l,1}}}}function Il(t,e,i){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1;return!0}function zl(t,e){let i=!1;for(let n of e)1&Jl(t,n)&&(i=!0);return i}function Ll(t,e,i){let n=i.map((e=>t[e.id])),r=i.map((t=>t.type)),s=n.filter((t=>!(1&t))),o=t[e.id]>>1;function l(t){let i=[];for(let e=0;e<n.length;e++){let s=ta(t,n[e]);if(2==r[e])for(let t of s)i.push(t);else i.push(s)}return e.combine(i)}return{create(t){for(let e of n)Jl(t,e);return t.values[o]=l(t),1},update(t,i){if(!zl(t,s))return 0;let n=l(t);return e.compare(n,t.values[o])?0:(t.values[o]=n,1)},reconfigure(t,r){let s=zl(t,n),a=r.config.facets[e.id],h=r.facet(e);if(a&&!s&&Nl(i,a))return t.values[o]=h,0;let c=l(t);return e.compare(c,h)?(t.values[o]=h,0):(t.values[o]=c,1)}}}const Wl=El.define({static:!0});class Vl{constructor(t,e,i,n,r){this.id=t,this.createF=e,this.updateF=i,this.compareF=n,this.spec=r,this.provides=void 0}static define(t){let e=new Vl(Dl++,t.create,t.update,t.compare||((t,e)=>t===e),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(Wl).find((t=>t.field==this));return((null==e?void 0:e.create)||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:t=>(t.values[e]=this.create(t),1),update:(t,i)=>{let n=t.values[e],r=this.updateF(n,i);return this.compareF(n,r)?0:(t.values[e]=r,1)},reconfigure:(t,i)=>null!=i.config.address[this.id]?(t.values[e]=i.field(this),0):(t.values[e]=this.create(t),1)}}init(t){return[this,Wl.of({field:this,create:t})]}get extension(){return this}}const jl=4,ql=3,Hl=2,Xl=1;function Fl(t){return e=>new Gl(e,t)}const Zl={highest:Fl(0),high:Fl(Xl),default:Fl(Hl),low:Fl(ql),lowest:Fl(jl)};class Gl{constructor(t,e){this.inner=t,this.prec=e}}class Ul{of(t){return new Yl(this,t)}reconfigure(t){return Ul.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class Yl{constructor(t,e){this.compartment=t,this.inner=e}}class Kl{constructor(t,e,i,n,r,s){for(this.base=t,this.compartments=e,this.dynamicSlots=i,this.address=n,this.staticValues=r,this.facets=s,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return null==e?t.default:this.staticValues[e>>1]}static resolve(t,e,i){let n=[],r=Object.create(null),s=new Map;for(let i of function(t,e,i){let n=[[],[],[],[],[]],r=new Map;function s(t,o){let l=r.get(t);if(null!=l){if(l<=o)return;let e=n[l].indexOf(t);e>-1&&n[l].splice(e,1),t instanceof Yl&&i.delete(t.compartment)}if(r.set(t,o),Array.isArray(t))for(let e of t)s(e,o);else if(t instanceof Yl){if(i.has(t.compartment))throw new RangeError("Duplicate use of compartment in extensions");let n=e.get(t.compartment)||t.inner;i.set(t.compartment,n),s(n,o)}else if(t instanceof Gl)s(t.inner,t.prec);else if(t instanceof Vl)n[o].push(t),t.provides&&s(t.provides,o);else if(t instanceof Bl)n[o].push(t),t.facet.extensions&&s(t.facet.extensions,o);else{let e=t.extension;if(!e)throw new Error(`Unrecognized extension value in extension set (${t}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(e,o)}}return s(t,Hl),n.reduce(((t,e)=>t.concat(e)))}(t,e,s))i instanceof Vl?n.push(i):(r[i.facet.id]||(r[i.facet.id]=[])).push(i);let o=Object.create(null),l=[],a=[];for(let t of n)o[t.id]=a.length<<1,a.push((e=>t.slot(e)));let h=null==i?void 0:i.config.facets;for(let t in r){let e=r[t],n=e[0].facet,s=h&&h[t]||[];if(e.every((t=>0==t.type)))if(o[n.id]=l.length<<1|1,Nl(s,e))l.push(i.facet(n));else{let t=n.combine(e.map((t=>t.value)));l.push(i&&n.compare(t,i.facet(n))?i.facet(n):t)}else{for(let t of e)0==t.type?(o[t.id]=l.length<<1|1,l.push(t.value)):(o[t.id]=a.length<<1,a.push((e=>t.dynamicSlot(e))));o[n.id]=a.length<<1,a.push((t=>Ll(t,n,e)))}}let c=a.map((t=>t(o)));return new Kl(t,s,c,o,l,r)}}function Jl(t,e){if(1&e)return 2;let i=e>>1,n=t.status[i];if(4==n)throw new Error("Cyclic dependency between fields and/or facets");if(2&n)return n;t.status[i]=4;let r=t.computeSlot(t,t.config.dynamicSlots[i]);return t.status[i]=2|r}function ta(t,e){return 1&e?t.config.staticValues[e>>1]:t.values[e>>1]}const ea=El.define(),ia=El.define({combine:t=>t.some((t=>t)),static:!0}),na=El.define({combine:t=>t.length?t[0]:void 0,static:!0}),ra=El.define(),sa=El.define(),oa=El.define(),la=El.define({combine:t=>!!t.length&&t[0]});class aa{constructor(t,e){this.type=t,this.value=e}static define(){return new ha}}class ha{of(t){return new aa(this,t)}}class ca{constructor(t){this.map=t}of(t){return new ua(this,t)}}class ua{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return void 0===e?void 0:e==this.value?this:new ua(this.type,e)}is(t){return this.type==t}static define(t={}){return new ca(t.map||(t=>t))}static mapEffects(t,e){if(!t.length)return t;let i=[];for(let n of t){let t=n.map(e);t&&i.push(t)}return i}}ua.reconfigure=ua.define(),ua.appendConfig=ua.define();class fa{constructor(t,e,i,n,r,s){this.startState=t,this.changes=e,this.selection=i,this.effects=n,this.annotations=r,this.scrollIntoView=s,this._doc=null,this._state=null,i&&_l(i,e.newLength),r.some((t=>t.type==fa.time))||(this.annotations=r.concat(fa.time.of(Date.now())))}static create(t,e,i,n,r,s){return new fa(t,e,i,n,r,s)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(fa.userEvent);return!(!e||!(e==t||e.length>t.length&&e.slice(0,t.length)==t&&"."==e[t.length]))}}function da(t,e){let i=[];for(let n=0,r=0;;){let s,o;if(n<t.length&&(r==e.length||e[r]>=t[n]))s=t[n++],o=t[n++];else{if(!(r<e.length))return i;s=e[r++],o=e[r++]}!i.length||i[i.length-1]<s?i.push(s,o):i[i.length-1]<o&&(i[i.length-1]=o)}}function pa(t,e,i){var n;let r,s,o;return i?(r=e.changes,s=Sl.empty(e.changes.length),o=t.changes.compose(e.changes)):(r=e.changes.map(t.changes),s=t.changes.mapDesc(e.changes,!0),o=t.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):null===(n=t.selection)||void 0===n?void 0:n.map(r),effects:ua.mapEffects(t.effects,r).concat(ua.mapEffects(e.effects,s)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function ga(t,e,i){let n=e.selection,r=Oa(e.annotations);return e.userEvent&&(r=r.concat(fa.userEvent.of(e.userEvent))),{changes:e.changes instanceof Sl?e.changes:Sl.of(e.changes||[],i,t.facet(na)),selection:n&&(n instanceof $l?n:$l.single(n.anchor,n.head)),effects:Oa(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function ma(t,e,i){let n=ga(t,e.length?e[0]:{},t.doc.length);e.length&&!1===e[0].filter&&(i=!1);for(let r=1;r<e.length;r++){!1===e[r].filter&&(i=!1);let s=!!e[r].sequential;n=pa(n,ga(t,e[r],s?n.changes.newLength:t.doc.length),s)}let r=fa.create(t,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return function(t){let e=t.startState,i=e.facet(oa),n=t;for(let r=i.length-1;r>=0;r--){let s=i[r](t);s&&Object.keys(s).length&&(n=pa(t,ga(e,s,t.changes.newLength),!0))}return n==t?t:fa.create(e,t.changes,t.selection,n.effects,n.annotations,n.scrollIntoView)}(i?function(t){let e=t.startState,i=!0;for(let n of e.facet(ra)){let e=n(t);if(!1===e){i=!1;break}Array.isArray(e)&&(i=!0===i?e:da(i,e))}if(!0!==i){let n,r;if(!1===i)r=t.changes.invertedDesc,n=Sl.empty(e.doc.length);else{let e=t.changes.filter(i);n=e.changes,r=e.filtered.invertedDesc}t=fa.create(e,n,t.selection&&t.selection.map(r),ua.mapEffects(t.effects,r),t.annotations,t.scrollIntoView)}let n=e.facet(sa);for(let i=n.length-1;i>=0;i--){let r=n[i](t);t=r instanceof fa?r:Array.isArray(r)&&1==r.length&&r[0]instanceof fa?r[0]:ma(e,Oa(r),!1)}return t}(r):r)}fa.time=aa.define(),fa.userEvent=aa.define(),fa.addToHistory=aa.define(),fa.remote=aa.define();const ba=[];function Oa(t){return null==t?ba:Array.isArray(t)?t:[t]}var va=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(va||(va={}));const wa=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let ya;try{ya=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(t){}function xa(t){return e=>{if(!/\S/.test(e))return va.Space;if(function(t){if(ya)return ya.test(t);for(let e=0;e<t.length;e++){let i=t[e];if(/\w/.test(i)||i>""&&(i.toUpperCase()!=i.toLowerCase()||wa.test(i)))return!0}return!1}(e))return va.Word;for(let i=0;i<t.length;i++)if(e.indexOf(t[i])>-1)return va.Word;return va.Other}}class ka{constructor(t,e,i,n,r,s){this.config=t,this.doc=e,this.selection=i,this.values=n,this.status=t.statusTemplate.slice(),this.computeSlot=r,s&&(s._state=this);for(let t=0;t<this.config.dynamicSlots.length;t++)Jl(this,t<<1);this.computeSlot=null}field(t,e=!0){let i=this.config.address[t.id];if(null!=i)return Jl(this,i),ta(this,i);if(e)throw new RangeError("Field is not present in this state")}update(...t){return ma(this,t,!0)}applyTransaction(t){let e,i=this.config,{base:n,compartments:r}=i;for(let e of t.effects)e.is(Ul.reconfigure)?(i&&(r=new Map,i.compartments.forEach(((t,e)=>r.set(e,t))),i=null),r.set(e.value.compartment,e.value.extension)):e.is(ua.reconfigure)?(i=null,n=e.value):e.is(ua.appendConfig)&&(i=null,n=Oa(n).concat(e.value));if(i)e=t.startState.values.slice();else{i=Kl.resolve(n,r,this);let t=new ka(i,this.doc,this.selection,i.dynamicSlots.map((()=>null)),((t,e)=>e.reconfigure(t,this)),null);e=t.values}new ka(i,t.newDoc,t.newSelection,e,((e,i)=>i.update(e,t)),t)}replaceSelection(t){return"string"==typeof t&&(t=this.toText(t)),this.changeByRange((e=>({changes:{from:e.from,to:e.to,insert:t},range:$l.cursor(e.from+t.length)})))}changeByRange(t){let e=this.selection,i=t(e.ranges[0]),n=this.changes(i.changes),r=[i.range],s=Oa(i.effects);for(let i=1;i<e.ranges.length;i++){let o=t(e.ranges[i]),l=this.changes(o.changes),a=l.map(n);for(let t=0;t<i;t++)r[t]=r[t].map(a);let h=n.mapDesc(l,!0);r.push(o.range.map(h)),n=n.compose(a),s=ua.mapEffects(s,a).concat(ua.mapEffects(Oa(o.effects),h))}return{changes:n,selection:$l.create(r,e.mainIndex),effects:s}}changes(t=[]){return t instanceof Sl?t:Sl.of(t,this.doc.length,this.facet(ka.lineSeparator))}toText(t){return el.of(t.split(this.facet(ka.lineSeparator)||yl))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return null==e?t.default:(Jl(this,e),ta(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let i in t){let n=t[i];n instanceof Vl&&(e[i]=n.spec.toJSON(this.field(t[i]),this))}return e}static fromJSON(t,e={},i){if(!t||"string"!=typeof t.doc)throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i)for(let e in i){let r=i[e],s=t[e];n.push(r.init((t=>r.spec.fromJSON(s,t))))}return ka.create({doc:t.doc,selection:$l.fromJSON(t.selection),extensions:e.extensions?n.concat([e.extensions]):n})}static create(t={}){let e=Kl.resolve(t.extensions||[],new Map),i=t.doc instanceof el?t.doc:el.of((t.doc||"").split(e.staticFacet(ka.lineSeparator)||yl)),n=t.selection?t.selection instanceof $l?t.selection:$l.single(t.selection.anchor,t.selection.head):$l.single(0);return _l(n,i.length),e.staticFacet(ia)||(n=n.asSingle()),new ka(e,i,n,e.dynamicSlots.map((()=>null)),((t,e)=>e.create(t)),null)}get tabSize(){return this.facet(ka.tabSize)}get lineBreak(){return this.facet(ka.lineSeparator)||"\n"}get readOnly(){return this.facet(la)}phrase(t,...e){for(let e of this.facet(ka.phrases))if(Object.prototype.hasOwnProperty.call(e,t)){t=e[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,((t,i)=>{if("$"==i)return"$";let n=+(i||1);return n>e.length?t:e[n-1]}))),t}languageDataAt(t,e,i=-1){let n=[];for(let r of this.facet(ea))for(let s of r(this,e,i))Object.prototype.hasOwnProperty.call(s,t)&&n.push(s[t]);return n}charCategorizer(t){return xa(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:i,length:n}=this.doc.lineAt(t),r=this.charCategorizer(t),s=t-i,o=t-i;for(;s>0;){let t=dl(e,s,!1);if(r(e.slice(t,s))!=va.Word)break;s=t}for(;o<n;){let t=dl(e,o);if(r(e.slice(o,t))!=va.Word)break;o=t}return s==o?null:$l.range(s+i,o+i)}}ka.allowMultipleSelections=ia,ka.tabSize=El.define({combine:t=>t.length?t[0]:4}),ka.lineSeparator=na,ka.readOnly=la,ka.phrases=El.define({compare(t,e){let i=Object.keys(t),n=Object.keys(e);return i.length==n.length&&i.every((i=>t[i]==e[i]))}}),ka.languageData=ea,ka.changeFilter=ra,ka.transactionFilter=sa,ka.transactionExtender=oa,Ul.reconfigure=ua.define();class Sa{eq(t){return this==t}range(t,e=t){return Ca.create(t,e,this)}}Sa.prototype.startSide=Sa.prototype.endSide=0,Sa.prototype.point=!1,Sa.prototype.mapMode=xl.TrackDel;class Ca{constructor(t,e,i){this.from=t,this.to=e,this.value=i}static create(t,e,i){return new Ca(t,e,i)}}function Aa(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class Ta{constructor(t,e,i,n){this.from=t,this.to=e,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(t,e,i,n=0){let r=i?this.to:this.from;for(let s=n,o=r.length;;){if(s==o)return s;let n=s+o>>1,l=r[n]-t||(i?this.value[n].endSide:this.value[n].startSide)-e;if(n==s)return l>=0?s:o;l>=0?o=n:s=n+1}}between(t,e,i,n){for(let r=this.findIndex(e,-1e9,!0),s=this.findIndex(i,1e9,!1,r);r<s;r++)if(!1===n(this.from[r]+t,this.to[r]+t,this.value[r]))return!1}map(t,e){let i=[],n=[],r=[],s=-1,o=-1;for(let l=0;l<this.value.length;l++){let a,h,c=this.value[l],u=this.from[l]+t,f=this.to[l]+t;if(u==f){let t=e.mapPos(u,c.startSide,c.mapMode);if(null==t)continue;if(a=h=t,c.startSide!=c.endSide&&(h=e.mapPos(u,c.endSide),h<a))continue}else if(a=e.mapPos(u,c.startSide),h=e.mapPos(f,c.endSide),a>h||a==h&&c.startSide>0&&c.endSide<=0)continue;(h-a||c.endSide-c.startSide)<0||(s<0&&(s=a),c.point&&(o=Math.max(o,h-a)),i.push(c),n.push(a-s),r.push(h-s))}return{mapped:i.length?new Ta(n,r,i,o):null,pos:s}}}class Pa{constructor(t,e,i,n){this.chunkPos=t,this.chunk=e,this.nextLayer=i,this.maxPoint=n}static create(t,e,i,n){return new Pa(t,e,i,n)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:i=!1,filterFrom:n=0,filterTo:r=this.length}=t,s=t.filter;if(0==e.length&&!s)return this;if(i&&(e=e.slice().sort(Aa)),this.isEmpty)return e.length?Pa.of(e):this;let o=new Ra(this,null,-1).goto(0),l=0,a=[],h=new Ma;for(;o.value||l<e.length;)if(l<e.length&&(o.from-e[l].from||o.startSide-e[l].value.startSide)>=0){let t=e[l++];h.addInner(t.from,t.to,t.value)||a.push(t)}else 1==o.rangeIndex&&o.chunkIndex<this.chunk.length&&(l==e.length||this.chunkEnd(o.chunkIndex)<e[l].from)&&(!s||n>this.chunkEnd(o.chunkIndex)||r<this.chunkPos[o.chunkIndex])&&h.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!s||n>o.to||r<o.from||s(o.from,o.to,o.value))&&(h.addInner(o.from,o.to,o.value)||a.push(Ca.create(o.from,o.to,o.value))),o.next());return h.finishInner(this.nextLayer.isEmpty&&!a.length?Pa.empty:this.nextLayer.update({add:a,filter:s,filterFrom:n,filterTo:r}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],i=[],n=-1;for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r],l=t.touchesRange(s,s+o.length);if(!1===l)n=Math.max(n,o.maxPoint),e.push(o),i.push(t.mapPos(s));else if(!0===l){let{mapped:r,pos:l}=o.map(s,t);r&&(n=Math.max(n,r.maxPoint),e.push(r),i.push(l))}}let r=this.nextLayer.map(t);return 0==e.length?r:new Pa(i,e,r||Pa.empty,n)}between(t,e,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let r=this.chunkPos[n],s=this.chunk[n];if(e>=r&&t<=r+s.length&&!1===s.between(r,t-r,e-r,i))return}this.nextLayer.between(t,e,i)}}iter(t=0){return $a.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return $a.from(t).goto(e)}static compare(t,e,i,n,r=-1){let s=t.filter((t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=r)),o=e.filter((t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=r)),l=Qa(s,o,i),a=new Da(s,l,r),h=new Da(o,l,r);i.iterGaps(((t,e,i)=>Ea(a,t,h,e,i,n))),i.empty&&0==i.length&&Ea(a,0,h,0,0,n)}static eq(t,e,i=0,n){null==n&&(n=1e9);let r=t.filter((t=>!t.isEmpty&&e.indexOf(t)<0)),s=e.filter((e=>!e.isEmpty&&t.indexOf(e)<0));if(r.length!=s.length)return!1;if(!r.length)return!0;let o=Qa(r,s),l=new Da(r,o,0).goto(i),a=new Da(s,o,0).goto(i);for(;;){if(l.to!=a.to||!Na(l.active,a.active)||l.point&&(!a.point||!l.point.eq(a.point)))return!1;if(l.to>n)return!0;l.next(),a.next()}}static spans(t,e,i,n,r=-1){let s=new Da(t,null,r).goto(e),o=e,l=s.openStart;for(;;){let t=Math.min(s.to,i);if(s.point?(n.point(o,t,s.point,s.activeForPoint(s.to),l,s.pointRank),l=s.openEnd(t)+(s.to>t?1:0)):t>o&&(n.span(o,t,s.active,l),l=s.openEnd(t)),s.to>i)break;o=s.to,s.next()}return l}static of(t,e=!1){let i=new Ma;for(let n of t instanceof Ca?[t]:e?function(t){if(t.length>1)for(let e=t[0],i=1;i<t.length;i++){let n=t[i];if(Aa(e,n)>0)return t.slice().sort(Aa);e=n}return t}(t):t)i.add(n.from,n.to,n.value);return i.finish()}}Pa.empty=new Pa([],[],null,-1),Pa.empty.nextLayer=Pa.empty;class Ma{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(t){this.chunks.push(new Ta(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}add(t,e,i){this.addInner(t,e,i)||(this.nextLayer||(this.nextLayer=new Ma)).add(t,e,i)}addInner(t,e,i){let n=t-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(t-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(n<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=i,this.lastFrom=t,this.lastTo=e,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let i=e.value.length-1;return this.last=e.value[i],this.lastFrom=e.from[i]+t,this.lastTo=e.to[i]+t,!0}finish(){return this.finishInner(Pa.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return t;let e=Pa.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function Qa(t,e,i){let n=new Map;for(let e of t)for(let t=0;t<e.chunk.length;t++)e.chunk[t].maxPoint<=0&&n.set(e.chunk[t],e.chunkPos[t]);let r=new Set;for(let t of e)for(let e=0;e<t.chunk.length;e++){let s=n.get(t.chunk[e]);null==s||(i?i.mapPos(s):s)!=t.chunkPos[e]||(null==i?void 0:i.touchesRange(s,s+t.chunk[e].length))||r.add(t.chunk[e])}return r}class Ra{constructor(t,e,i,n=0){this.layer=t,this.skip=e,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,i){for(;this.chunkIndex<this.layer.chunk.length;){let e=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(e)||this.layer.chunkEnd(this.chunkIndex)<t||e.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],i=t+e.from[this.rangeIndex];if(this.from=i,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class $a{constructor(t){this.heap=t}static from(t,e=null,i=-1){let n=[];for(let r=0;r<t.length;r++)for(let s=t[r];!s.isEmpty;s=s.nextLayer)s.maxPoint>=i&&n.push(new Ra(s,e,i,r));return 1==n.length?n[0]:new $a(n)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let i of this.heap)i.goto(t,e);for(let t=this.heap.length>>1;t>=0;t--)_a(this.heap,t);return this.next(),this}forward(t,e){for(let i of this.heap)i.forward(t,e);for(let t=this.heap.length>>1;t>=0;t--)_a(this.heap,t);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),_a(this.heap,0)}}}function _a(t,e){for(let i=t[e];;){let n=1+(e<<1);if(n>=t.length)break;let r=t[n];if(n+1<t.length&&r.compare(t[n+1])>=0&&(r=t[n+1],n++),i.compare(r)<0)break;t[n]=i,t[e]=r,e=n}}class Da{constructor(t,e,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=$a.from(t,e,i)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){Ba(this.active,t),Ba(this.activeTo,t),Ba(this.activeRank,t),this.minActive=za(this.active,this.activeTo)}addActive(t){let e=0,{value:i,to:n,rank:r}=this.cursor;for(;e<this.activeRank.length&&this.activeRank[e]<=r;)e++;Ia(this.active,e,i),Ia(this.activeTo,e,n),Ia(this.activeRank,e,r),t&&Ia(t,e,this.cursor.from),this.minActive=za(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let i=this.openStart<0?[]:null,n=0;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>t){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),i&&Ba(i,r)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let r=this.cursor.value;if(r.point){if(!(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.from<t&&(n=1),this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(i),this.cursor.next()}}}if(i){let e=0;for(;e<i.length&&i[e]<t;)e++;this.openStart=e+n}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>t||this.activeTo[i]==t&&this.active[i].endSide>=this.point.endSide)&&e.push(this.active[i]);return e.reverse()}openEnd(t){let e=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>t;i--)e++;return e}}function Ea(t,e,i,n,r,s){t.goto(e),i.goto(n);let o=n+r,l=n,a=n-e;for(;;){let e=t.to+a-i.to||t.endSide-i.endSide,n=e<0?t.to+a:i.to,r=Math.min(n,o);if(t.point||i.point?t.point&&i.point&&(t.point==i.point||t.point.eq(i.point))&&Na(t.activeForPoint(t.to+a),i.activeForPoint(i.to))||s.comparePoint(l,r,t.point,i.point):r>l&&!Na(t.active,i.active)&&s.compareRange(l,r,t.active,i.active),n>o)break;l=n,e<=0&&t.next(),e>=0&&i.next()}}function Na(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!=e[i]&&!t[i].eq(e[i]))return!1;return!0}function Ba(t,e){for(let i=e,n=t.length-1;i<n;i++)t[i]=t[i+1];t.pop()}function Ia(t,e,i){for(let i=t.length-1;i>=e;i--)t[i+1]=t[i];t[e]=i}function za(t,e){let i=-1,n=1e9;for(let r=0;r<e.length;r++)(e[r]-n||t[r].endSide-t[i].endSide)<0&&(i=r,n=e[r]);return i}function La(t,e,i,n){for(let n=0,r=0;;){if(r>=e)return n;if(n==t.length)break;r+=9==t.charCodeAt(n)?i-r%i:1,n=dl(t,n)}return!0===n?-1:t.length}function Wa(t){let e;return e=11==t.nodeType?t.getSelection?t:t.ownerDocument:t,e.getSelection()}function Va(t,e){return!!e&&(t==e||t.contains(1!=e.nodeType?e.parentNode:e))}function ja(t,e){if(!e.anchorNode)return!1;try{return Va(t,e.anchorNode)}catch(t){return!1}}function qa(t){return 3==t.nodeType?ih(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function Ha(t,e,i,n){return!!i&&(Fa(t,e,i,n,-1)||Fa(t,e,i,n,1))}function Xa(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function Fa(t,e,i,n,r){for(;;){if(t==i&&e==n)return!0;if(e==(r<0?0:Za(t))){if("DIV"==t.nodeName)return!1;let i=t.parentNode;if(!i||1!=i.nodeType)return!1;e=Xa(t)+(r<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[e+(r<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;e=r<0?Za(t):0}}}function Za(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}const Ga={left:0,right:0,top:0,bottom:0};function Ua(t,e){let i=e?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function Ya(t){return{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}class Ka{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){this.set(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let Ja,th=null;function eh(t){if(t.setActive)return t.setActive();if(th)return t.focus(th);let e=[];for(let i=t;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==th?{get preventScroll(){return th={preventScroll:!0},!0}}:void 0),!th){th=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],r=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=r&&(i.scrollLeft=r)}}}function ih(t,e,i=e){let n=Ja||(Ja=document.createRange());return n.setEnd(t,i),n.setStart(t,e),n}function nh(t,e,i){let n={key:e,code:e,keyCode:i,which:i,cancelable:!0},r=new KeyboardEvent("keydown",n);r.synthetic=!0,t.dispatchEvent(r);let s=new KeyboardEvent("keyup",n);return s.synthetic=!0,t.dispatchEvent(s),r.defaultPrevented||s.defaultPrevented}function rh(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}class sh{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new sh(t.parentNode,Xa(t),e)}static after(t,e){return new sh(t.parentNode,Xa(t)+1,e)}}const oh=[];class lh{constructor(){this.parent=null,this.dom=null,this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}coordsAt(t,e){return null}sync(t){if(2&this.dirty){let e,i=this.dom,n=null;for(let r of this.children){if(r.dirty){if(!r.dom&&(e=n?n.nextSibling:i.firstChild)){let t=lh.get(e);t&&(t.parent||t.constructor!=r.constructor)||r.reuseDOM(e)}r.sync(t),r.dirty=0}if(e=n?n.nextSibling:i.firstChild,t&&!t.written&&t.node==i&&e!=r.dom&&(t.written=!0),r.dom.parentNode==i)for(;e&&e!=r.dom;)e=ah(e);else i.insertBefore(r.dom,e);n=r.dom}for(e=n?n.nextSibling:i.firstChild,e&&t&&t.node==i&&(t.written=!0);e;)e=ah(e)}else if(1&this.dirty)for(let e of this.children)e.dirty&&(e.sync(t),e.dirty=0)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=0==Za(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==n&&e.firstChild!=e.lastChild&&(n=t==e.firstChild?-1:1),t=e}i=n<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!lh.get(i);)i=i.nextSibling;if(!i)return this.length;for(let t=0,e=0;;t++){let n=this.children[t];if(n.dom==i)return e;e+=n.length+n.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,r=-1,s=-1,o=-1;for(let l=0,a=i,h=i;l<this.children.length;l++){let i=this.children[l],c=a+i.length;if(a<t&&c>e)return i.domBoundsAround(t,e,a);if(c>=t&&-1==n&&(n=l,r=a),a>e&&i.dom.parentNode==this.dom){s=l,o=h;break}h=c,a=c+i.breakAfter}return{from:r,to:o<0?i+this.length:o,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:s<this.children.length&&s>=0?this.children[s].dom:null}}markDirty(t=!1){this.dirty|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.dirty|=2),1&e.dirty)return;e.dirty|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.dirty&&this.markParentsDirty(!0))}setDOM(t){this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=oh){this.markDirty();for(let i=t;i<e;i++){let t=this.children[i];t.parent==this&&t.destroy()}this.children.splice(t,e-t,...i);for(let t=0;t<i.length;t++)i[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new hh(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}merge(t,e,i,n,r,s){return!1}become(t){return!1}getSide(){return 0}destroy(){this.parent=null}}function ah(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}lh.prototype.breakAfter=0;class hh{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function ch(t,e,i,n,r,s,o,l,a){let{children:h}=t,c=h.length?h[e]:null,u=s.length?s[s.length-1]:null,f=u?u.breakAfter:o;if(!(e==n&&c&&!o&&!f&&s.length<2&&c.merge(i,r,s.length?u:null,0==i,l,a))){if(n<h.length){let t=h[n];t&&r<t.length?(e==n&&(t=t.split(r),r=0),!f&&u&&t.merge(0,r,u,!0,0,a)?s[s.length-1]=t:(r&&t.merge(0,r,null,!1,0,a),s.push(t))):(null==t?void 0:t.breakAfter)&&(u?u.breakAfter=1:o=1),n++}for(c&&(c.breakAfter=o,i>0&&(!o&&s.length&&c.merge(i,c.length,s[0],!1,l,0)?c.breakAfter=s.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,l,0),e++));e<n&&s.length;)if(h[n-1].become(s[s.length-1]))n--,s.pop(),a=s.length?0:l;else{if(!h[e].become(s[0]))break;e++,s.shift(),l=s.length?0:a}!s.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,l,a)&&e--,(e<n||s.length)&&t.replaceChildren(e,n,s)}}function uh(t,e,i,n,r,s){let o=t.childCursor(),{i:l,off:a}=o.findPos(i,1),{i:h,off:c}=o.findPos(e,-1),u=e-i;for(let t of n)u+=t.length;t.length+=u,ch(t,h,c,l,a,n,0,r,s)}let fh="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},dh="undefined"!=typeof document?document:{documentElement:{style:{}}};const ph=/Edge\/(\d+)/.exec(fh.userAgent),gh=/MSIE \d/.test(fh.userAgent),mh=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(fh.userAgent),bh=!!(gh||mh||ph),Oh=!bh&&/gecko\/(\d+)/i.test(fh.userAgent),vh=!bh&&/Chrome\/(\d+)/.exec(fh.userAgent),wh="webkitFontSmoothing"in dh.documentElement.style,yh=!bh&&/Apple Computer/.test(fh.vendor),xh=yh&&(/Mobile\/\w+/.test(fh.userAgent)||fh.maxTouchPoints>2);var kh={mac:xh||/Mac/.test(fh.platform),windows:/Win/.test(fh.platform),linux:/Linux|X11/.test(fh.platform),ie:bh,ie_version:gh?dh.documentMode||6:mh?+mh[1]:ph?+ph[1]:0,gecko:Oh,gecko_version:Oh?+(/Firefox\/(\d+)/.exec(fh.userAgent)||[0,0])[1]:0,chrome:!!vh,chrome_version:vh?+vh[1]:0,ios:xh,android:/Android\b/.test(fh.userAgent),webkit:wh,safari:yh,webkit_version:wh?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=dh.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class Sh extends lh{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){3==t.nodeType&&this.createDOM(t)}merge(t,e,i){return(!i||i instanceof Sh&&!(this.length-(e-t)+i.length>256))&&(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new Sh(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new sh(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return Ah(this.dom,t,e)}}class Ch extends lh{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let t of e)t.setParent(this)}setAttrs(t){if(rh(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.dirty|=6)}sync(t){this.dom?4&this.dirty&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t)}merge(t,e,i,n,r,s){return(!i||!(!(i instanceof Ch&&i.mark.eq(this.mark))||t&&r<=0||e<this.length&&s<=0))&&(uh(this,t,e,i?i.children:[],r-1,s-1),this.markDirty(),!0)}split(t){let e=[],i=0,n=-1,r=0;for(let s of this.children){let o=i+s.length;o>t&&e.push(i<t?s.split(t-i):s),n<0&&i>=t&&(n=r),i=o,r++}let s=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new Ch(this.mark,e,s)}domAtPos(t){return $h(this.dom,this.children,t)}coordsAt(t,e){return Dh(this,t,e)}}function Ah(t,e,i){let n=t.nodeValue.length;e>n&&(e=n);let r=e,s=e,o=0;0==e&&i<0||e==n&&i>=0?kh.chrome||kh.gecko||(e?(r--,o=1):s<n&&(s++,o=-1)):i<0?r--:s<n&&s++;let l=ih(t,r,s).getClientRects();if(!l.length)return Ga;let a=l[(o?o<0:i>=0)?0:l.length-1];return kh.safari&&!o&&0==a.width&&(a=Array.prototype.find.call(l,(t=>t.width))||a),o?Ua(a,o<0):a||null}class Th extends lh{constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}static create(t,e,i){return new(t.customView||Th)(t,e,i)}split(t){let e=Th.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(t,e,i,n,r,s){return!(i&&(!(i instanceof Th&&this.widget.compare(i.widget))||t>0&&r<=0||e<this.length&&s<=0))&&(this.length=t+(i?i.length:0)+(this.length-e),!0)}become(t){return t.length==this.length&&t instanceof Th&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.eq(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return el.empty;let t=this;for(;t.parent;)t=t.parent;let e=t.editorView,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):el.empty}domAtPos(t){return 0==t?sh.before(this.dom):sh.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.dom.getClientRects(),n=null;if(!i.length)return Ga;for(let e=t>0?i.length-1:0;n=i[e],!(t>0?0==e:e==i.length-1||n.top<n.bottom);e+=t>0?-1:1);return 0==t&&e>0||t==this.length&&e<=0?n:Ua(n,0==t)}get isEditable(){return!1}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Ph extends Th{domAtPos(t){let{topView:e,text:i}=this.widget;return e?Mh(t,0,e,i,((t,e)=>t.domAtPos(e)),(t=>new sh(i,Math.min(t,i.nodeValue.length)))):new sh(i,Math.min(t,i.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(t,e){let{topView:i,text:n}=this.widget;return i?Qh(t,e,i,n):Math.min(e,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(t,e){let{topView:i,text:n}=this.widget;return i?Mh(t,e,i,n,((t,e,i)=>t.coordsAt(e,i)),((t,e)=>Ah(n,t,e))):Ah(n,t,e)}destroy(){var t;super.destroy(),null===(t=this.widget.topView)||void 0===t||t.destroy()}get isEditable(){return!0}}function Mh(t,e,i,n,r,s){if(i instanceof Ch){for(let o of i.children){let i=Va(o.dom,n),l=i?n.nodeValue.length:o.length;if(t<l||t==l&&o.getSide()<=0)return i?Mh(t,e,o,n,r,s):r(o,t,e);t-=l}return r(i,i.length,-1)}return i.dom==n?s(t,e):r(i,t,e)}function Qh(t,e,i,n){if(i instanceof Ch)for(let r of i.children){let i=0,s=Va(r.dom,n);if(Va(r.dom,t))return i+(s?Qh(t,e,r,n):r.localPosFromDOM(t,e));i+=s?n.nodeValue.length:r.length}else if(i.dom==n)return Math.min(e,n.nodeValue.length);return i.localPosFromDOM(t,e)}class Rh extends lh{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof Rh&&t.side==this.side}split(){return new Rh(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return sh.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){let e=this.dom.getBoundingClientRect(),i=function(t,e){let i=t.parent,n=i?i.children.indexOf(t):-1;for(;i&&n>=0;)if(e<0?n>0:n<i.children.length){let t=i.children[n+e];if(t instanceof Sh){let i=t.coordsAt(e<0?t.length:0,e);if(i)return i}n+=e}else{if(!(i instanceof Ch&&i.parent)){let t=i.dom.lastChild;if(t&&"BR"==t.nodeName)return t.getClientRects()[0];break}n=i.parent.children.indexOf(i)+(e<0?0:1),i=i.parent}return}(this,this.side>0?-1:1);return i&&i.top<e.bottom&&i.bottom>e.top?{left:e.left,right:e.right,top:i.top,bottom:i.bottom}:e}get overrideDOMText(){return el.empty}}function $h(t,e,i){let n=0;for(let r=0;n<e.length;n++){let s=e[n],o=r+s.length;if(!(o==r&&s.getSide()<=0)){if(i>r&&i<o&&s.dom.parentNode==t)return s.domAtPos(i-r);if(i<=r)break;r=o}}for(;n>0;n--){let i=e[n-1].dom;if(i.parentNode==t)return sh.after(i)}return new sh(t,0)}function _h(t,e,i){let n,{children:r}=t;i>0&&e instanceof Ch&&r.length&&(n=r[r.length-1])instanceof Ch&&n.mark.eq(e.mark)?_h(n,e.children[0],i-1):(r.push(e),e.setParent(t)),t.length+=e.length}function Dh(t,e,i){for(let n=0,r=0;r<t.children.length;r++){let s,o=t.children[r],l=n+o.length;if((i<=0||l==t.length||o.getSide()>0?l>=e:l>e)&&(e<l||r+1==t.children.length||(s=t.children[r+1]).length||s.getSide()>0)){let t=0;if(l==n){if(o.getSide()<=0)continue;t=i=-o.getSide()}let r=o.coordsAt(Math.max(0,e-n),i);return t&&r?Ua(r,i<0):r}n=l}let n=t.dom.lastChild;if(!n)return t.dom.getBoundingClientRect();let r=qa(n);return r[r.length-1]||null}function Eh(t,e){for(let i in t)"class"==i&&e.class?e.class+=" "+t.class:"style"==i&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}function Nh(t,e){if(t==e)return!0;if(!t||!e)return!1;let i=Object.keys(t),n=Object.keys(e);if(i.length!=n.length)return!1;for(let r of i)if(-1==n.indexOf(r)||t[r]!==e[r])return!1;return!0}function Bh(t,e,i){let n=null;if(e)for(let r in e)i&&r in i||t.removeAttribute(n=r);if(i)for(let r in i)e&&e[r]==i[r]||t.setAttribute(n=r,i[r]);return!!n}Sh.prototype.children=Th.prototype.children=Rh.prototype.children=oh;class Ih{eq(t){return!1}updateDOM(t){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}ignoreEvent(t){return!0}get customView(){return null}destroy(t){}}var zh=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(zh||(zh={}));class Lh extends Sa{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new Wh(t)}static widget(t){let e=t.side||0,i=!!t.block;return e+=i?e>0?3e8:-4e8:e>0?1e8:-1e8,new jh(t,e,e,i,t.widget||null,!1)}static replace(t){let e,i,n=!!t.block;if(t.isBlockGap)e=-5e8,i=4e8;else{let{start:r,end:s}=qh(t,n);e=(r?n?-3e8:-1:5e8)-1,i=1+(s?n?2e8:1:-6e8)}return new jh(t,e,i,n,t.widget||null,!0)}static line(t){return new Vh(t)}static set(t,e=!1){return Pa.of(t,e)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}Lh.none=Pa.empty;class Wh extends Lh{constructor(t){let{start:e,end:i}=qh(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){return this==t||t instanceof Wh&&this.tagName==t.tagName&&this.class==t.class&&Nh(this.attrs,t.attrs)}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}Wh.prototype.point=!1;class Vh extends Lh{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof Vh&&Nh(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}Vh.prototype.mapMode=xl.TrackBefore,Vh.prototype.point=!0;class jh extends Lh{constructor(t,e,i,n,r,s){super(e,i,r,t),this.block=n,this.isReplace=s,this.mapMode=n?e<=0?xl.TrackBefore:xl.TrackAfter:xl.TrackDel}get type(){return this.startSide<this.endSide?zh.WidgetRange:this.startSide<=0?zh.WidgetBefore:zh.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(t){return t instanceof jh&&(e=this.widget,i=t.widget,e==i||!!(e&&i&&e.compare(i)))&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide;var e,i}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}function qh(t,e=!1){let{inclusiveStart:i,inclusiveEnd:n}=t;return null==i&&(i=t.inclusive),null==n&&(n=t.inclusive),{start:null!=i?i:e,end:null!=n?n:e}}function Hh(t,e,i,n=0){let r=i.length-1;r>=0&&i[r]+n>=t?i[r]=Math.max(i[r],e):i.push(t,e)}jh.prototype.point=!0;class Xh extends lh{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,r,s){if(i){if(!(i instanceof Xh))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),uh(this,t,e,i?i.children:[],r,s),!0}split(t){let e=new Xh;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let t=i;t<this.children.length;t++)e.append(this.children[t],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){Nh(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){_h(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=Eh(e,this.attrs||{})),i&&(this.attrs=Eh({class:i},this.attrs||{}))}domAtPos(t){return $h(this.dom,this.children,t)}reuseDOM(t){"DIV"==t.nodeName&&(this.setDOM(t),this.dirty|=6)}sync(t){var e;this.dom?4&this.dirty&&(rh(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(Bh(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t);let i=this.dom.lastChild;for(;i&&lh.get(i)instanceof Ch;)i=i.lastChild;if(!(i&&this.length&&("BR"==i.nodeName||0!=(null===(e=lh.get(i))||void 0===e?void 0:e.isEditable)||kh.ios&&this.children.some((t=>t instanceof Sh))))){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t=0;for(let e of this.children){if(!(e instanceof Sh))return null;let i=qa(e.dom);if(1!=i.length)return null;t+=i[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length}}coordsAt(t,e){return Dh(this,t,e)}become(t){return!1}get type(){return zh.Text}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let r=t.children[i],s=n+r.length;if(s>=e){if(r instanceof Xh)return r;if(s>e)break}n=s+r.breakAfter}return null}}class Fh extends lh{constructor(t,e,i){super(),this.widget=t,this.length=e,this.type=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,r,s){return!(i&&(!(i instanceof Fh&&this.widget.compare(i.widget))||t>0&&r<=0||e<this.length&&s<=0))&&(this.length=t+(i?i.length:0)+(this.length-e),!0)}domAtPos(t){return 0==t?sh.before(this.dom):sh.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new Fh(this.widget,e,this.type);return i.breakAfter=this.breakAfter,i}get children(){return oh}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):el.empty}domBoundsAround(){return null}become(t){return t instanceof Fh&&t.type==this.type&&t.widget.constructor==this.widget.constructor&&(t.widget.eq(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Zh{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof Fh&&t.type==zh.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new Xh),this.atCursorPos=!0),this.curLine}flushBuffer(t){this.pendingBuffer&&(this.curLine.append(Gh(new Rh(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer([]),this.curLine=null,this.content.push(t)}finish(t){t?this.pendingBuffer=0:this.flushBuffer([]),this.posCovered()||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:i,done:n}=this.cursor.next(this.skip);if(this.skip=0,n)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer([]),this.curLine=null,t--;continue}this.text=e,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(0,i)),this.getLine().append(Gh(new Sh(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,r,s){if(this.disallowBlockEffectsFor[s]&&i instanceof jh){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=e-t;if(i instanceof jh)if(i.block){let{type:t}=i;t!=zh.WidgetAfter||this.posCovered()||this.getLine(),this.addBlockWidget(new Fh(i.widget||new Uh("div"),o,t))}else{let s=Th.create(i.widget||new Uh("span"),o,i.startSide),l=this.atCursorPos&&!s.isEditable&&r<=n.length&&(t<e||i.startSide>0),a=!s.isEditable&&(t<e||i.startSide<=0),h=this.getLine();2!=this.pendingBuffer||l||(this.pendingBuffer=0),this.flushBuffer(n),l&&(h.append(Gh(new Rh(1),n),r),r=n.length+Math.max(0,r-n.length)),h.append(Gh(s,n),r),this.atCursorPos=a,this.pendingBuffer=a?t<e?1:2:0}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=r)}static build(t,e,i,n,r){let s=new Zh(t,e,i,r);return s.openEnd=Pa.spans(n,e,i,s),s.openStart<0&&(s.openStart=s.openEnd),s.finish(s.openEnd),s}}function Gh(t,e){for(let i of e)t=new Ch(i,[t],t.length);return t}class Uh extends Ih{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}}const Yh=El.define(),Kh=El.define(),Jh=El.define(),tc=El.define(),ec=El.define(),ic=El.define(),nc=El.define({combine:t=>t.some((t=>t))});class rc{constructor(t,e="nearest",i="nearest",n=5,r=5){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=r}map(t){return t.empty?this:new rc(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin)}}const sc=ua.define({map:(t,e)=>t.map(e)});function oc(t,e,i){let n=t.facet(tc);n.length?n[0](e):window.onerror?window.onerror(String(e),i,void 0,void 0,e):i?console.error(i+":",e):console.error(e)}const lc=El.define({combine:t=>!t.length||t[0]});let ac=0;const hc=El.define();class cc{constructor(t,e,i,n){this.id=t,this.create=e,this.domEventHandlers=i,this.extension=n(this)}static define(t,e){const{eventHandlers:i,provide:n,decorations:r}=e||{};return new cc(ac++,t,i,(t=>{let e=[hc.of(t)];return r&&e.push(pc.of((e=>{let i=e.plugin(t);return i?r(i):Lh.none}))),n&&e.push(n(t)),e}))}static fromClass(t,e){return cc.define((e=>new t(e)),e)}}class uc{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(e){if(oc(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){oc(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null===(e=this.value)||void 0===e?void 0:e.destroy)try{this.value.destroy()}catch(e){oc(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const fc=El.define(),dc=El.define(),pc=El.define(),gc=El.define(),mc=El.define(),bc=El.define();class Oc{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new Oc(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(0==e.length)return t;let i=[];for(let n=0,r=0,s=0,o=0;;n++){let l=n==t.length?null:t[n],a=s-o,h=l?l.fromB:1e9;for(;r<e.length&&e[r]<h;){let t=e[r],n=e[r+1],s=Math.max(o,t),l=Math.min(h,n);if(s<=l&&new Oc(s+a,l+a,s,l).addToSet(i),n>h)break;r+=2}if(!l)return i;new Oc(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),s=l.toA,o=l.toB}}}class vc{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=Sl.empty(this.startState.doc.length);for(let t of i)this.changes=this.changes.compose(t.changes);let n=[];this.changes.iterChangedRanges(((t,e,i,r)=>n.push(new Oc(t,e,i,r)))),this.changedRanges=n;let r=t.hasFocus;r!=t.inputState.notifiedFocused&&(t.inputState.notifiedFocused=r,this.flags|=1)}static create(t,e,i){return new vc(t,e,i)}get viewportChanged(){return(4&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(10&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((t=>t.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}var wc=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(wc||(wc={}));const yc=wc.LTR,xc=wc.RTL;function kc(t){let e=[];for(let i=0;i<t.length;i++)e.push(1<<+t[i]);return e}const Sc=kc("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Cc=kc("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Ac=Object.create(null),Tc=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),i=t.charCodeAt(1);Ac[e]=i,Ac[i]=-e}const Pc=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;class Mc{constructor(t,e,i){this.from=t,this.to=e,this.level=i}get dir(){return this.level%2?xc:yc}side(t,e){return this.dir==e==t?this.to:this.from}static find(t,e,i,n){let r=-1;for(let s=0;s<t.length;s++){let o=t[s];if(o.from<=e&&o.to>=e){if(o.level==i)return s;(r<0||(0!=n?n<0?o.from<e:o.to>e:t[r].level>o.level))&&(r=s)}}if(r<0)throw new RangeError("Index out of range");return r}}const Qc=[];function Rc(t){return[new Mc(0,t,0)]}let $c="";function _c(t,e,i,n,r){var s;let o=n.head-t.from,l=-1;if(0==o){if(!r||!t.length)return null;e[0].level!=i&&(o=e[0].side(!1,i),l=0)}else if(o==t.length){if(r)return null;let t=e[e.length-1];t.level!=i&&(o=t.side(!0,i),l=e.length-1)}l<0&&(l=Mc.find(e,o,null!==(s=n.bidiLevel)&&void 0!==s?s:-1,n.assoc));let a=e[l];o==a.side(r,i)&&(a=e[l+=r?1:-1],o=a.side(!r,i));let h=r==(a.dir==i),c=dl(t.text,o,h);if($c=t.text.slice(Math.min(o,c),Math.max(o,c)),c!=a.side(r,i))return $l.cursor(c+t.from,h?-1:1,a.level);let u=l==(r?e.length-1:0)?null:e[l+(r?1:-1)];return u||a.level==i?u&&u.level<a.level?$l.cursor(u.side(!r,i)+t.from,r?1:-1,u.level):$l.cursor(c+t.from,r?-1:1,a.level):$l.cursor(r?t.to:t.from,r?-1:1,i)}const Dc="￿";class Ec{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(ka.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Dc}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n),this.readNode(n);let t=n.nextSibling;if(t==e)break;let r=lh.get(n),s=lh.get(t);(r&&s?r.breakAfter:(r?r.breakAfter:Nc(n))||Nc(t)&&("BR"!=n.nodeName||n.cmIgnore))&&this.lineBreak(),n=t}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let r,s=-1,o=1;if(this.lineSeparator?(s=e.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(r=n.exec(e))&&(s=r.index,o=r[0].length),this.append(e.slice(i,s<0?e.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let e of this.points)e.node==t&&e.pos>this.text.length&&(e.pos-=o-1);i=s+o}}readNode(t){if(t.cmIgnore)return;let e=lh.get(t),i=e&&e.overrideDOMText;if(null!=i){this.findPointInside(t,i.length);for(let t=i.iter();!t.next().done;)t.lineBreak?this.lineBreak():this.append(t.value)}else 3==t.nodeType?this.readTextNode(t):"BR"==t.nodeName?t.nextSibling&&this.lineBreak():1==t.nodeType&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(3==t.nodeType?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+Math.min(e,i.offset))}}function Nc(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}class Bc{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class Ic extends lh{constructor(t){super(),this.view=t,this.compositionDeco=Lh.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new Xh],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Oc(0,0,0,t.state.doc.length)],0)}get root(){return this.view.root}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(t){let e=t.changedRanges;this.minWidth>0&&e.length&&(e.every((({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo))?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=Lh.none:(t.transactions.length||this.dirty)&&(this.compositionDeco=function(t,e){let i=Lc(t);if(!i)return Lh.none;let{from:n,to:r,node:s,text:o}=i,l=e.mapPos(n,1),a=Math.max(l,e.mapPos(r,-1)),{state:h}=t,c=3==s.nodeType?s.nodeValue:new Ec([],h).readRange(s.firstChild,null).text;if(a-l<c.length)if(h.doc.sliceString(l,Math.min(h.doc.length,l+c.length),Dc)==c)a=l+c.length;else{if(h.doc.sliceString(Math.max(0,a-c.length),a,Dc)!=c)return Lh.none;l=a-c.length}else if(h.doc.sliceString(l,a,Dc)!=c)return Lh.none;let u=lh.get(s);u instanceof Ph?u=u.widget.topView:u&&(u.parent=null);return Lh.set(Lh.replace({widget:new Wc(s,o,u),inclusive:!0}).range(l,a))}(this.view,t.changes)),(kh.ie||kh.chrome)&&!this.compositionDeco.size&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let i=function(t,e,i){let n=new jc;return Pa.compare(t,e,i,n),n.changes}(this.decorations,this.updateDeco(),t.changes);return e=Oc.extendWithRanges(e,i),(0!=this.dirty||0!=e.length)&&(this.updateInner(e,t.startState.doc.length),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e);let{observer:i}=this.view;i.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let t=kh.chrome||kh.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(t),this.dirty=0,t&&(t.written||i.selectionRange.focusNode!=t.node)&&(this.forceSelection=!0),this.dom.style.height=""}));let n=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let t of this.children)t instanceof Fh&&t.widget instanceof zc&&n.push(t.dom);i.updateGaps(n)}updateChildren(t,e){let i=this.childCursor(e);for(let e=t.length-1;;e--){let n=e>=0?t[e]:null;if(!n)break;let{fromA:r,toA:s,fromB:o,toB:l}=n,{content:a,breakAtStart:h,openStart:c,openEnd:u}=Zh.build(this.view.state.doc,o,l,this.decorations,this.dynamicDecorationMap),{i:f,off:d}=i.findPos(s,1),{i:p,off:g}=i.findPos(r,-1);ch(this,p,g,f,d,a,h,c,u)}}updateSelection(t=!1,e=!1){if(t&&this.view.observer.readSelectionRange(),!e&&!this.mayControlSelection()||kh.ios&&this.view.inputState.rapidCompositionStart)return;let i=this.forceSelection;this.forceSelection=!1;let n=this.view.state.selection.main,r=this.domAtPos(n.anchor),s=n.empty?r:this.domAtPos(n.head);if(kh.gecko&&n.empty&&(1==(o=r).node.nodeType&&o.node.firstChild&&(0==o.offset||"false"==o.node.childNodes[o.offset-1].contentEditable)&&(o.offset==o.node.childNodes.length||"false"==o.node.childNodes[o.offset].contentEditable))){let t=document.createTextNode("");this.view.observer.ignore((()=>r.node.insertBefore(t,r.node.childNodes[r.offset]||null))),r=s=new sh(t,0),i=!0}var o;let l=this.view.observer.selectionRange;!i&&l.focusNode&&Ha(r.node,r.offset,l.anchorNode,l.anchorOffset)&&Ha(s.node,s.offset,l.focusNode,l.focusOffset)||(this.view.observer.ignore((()=>{kh.android&&kh.chrome&&this.dom.contains(l.focusNode)&&function(t,e){for(let i=t;i&&i!=e;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}(l.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let t=Wa(this.root);if(n.empty){if(kh.gecko){let t=(e=r.node,i=r.offset,1!=e.nodeType?0:(i&&"false"==e.childNodes[i-1].contentEditable?1:0)|(i<e.childNodes.length&&"false"==e.childNodes[i].contentEditable?2:0));if(t&&3!=t){let e=Vc(r.node,r.offset,1==t?1:-1);e&&(r=new sh(e,1==t?0:e.nodeValue.length))}}t.collapse(r.node,r.offset),null!=n.bidiLevel&&null!=l.cursorBidiLevel&&(l.cursorBidiLevel=n.bidiLevel)}else if(t.extend)t.collapse(r.node,r.offset),t.extend(s.node,s.offset);else{let e=document.createRange();n.anchor>n.head&&([r,s]=[s,r]),e.setEnd(s.node,s.offset),e.setStart(r.node,r.offset),t.removeAllRanges(),t.addRange(e)}var e,i})),this.view.observer.setSelectionRange(r,s)),this.impreciseAnchor=r.precise?null:new sh(l.anchorNode,l.anchorOffset),this.impreciseHead=s.precise?null:new sh(l.focusNode,l.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let t=this.view.state.selection.main,e=Wa(this.root);if(!t.empty||!t.assoc||!e.modify)return;let i=Xh.find(this,t.head);if(!i)return;let n=i.posAtStart;if(t.head==n||t.head==n+i.length)return;let r=this.coordsAt(t.head,-1),s=this.coordsAt(t.head,1);if(!r||!s||r.bottom>s.top)return;let o=this.domAtPos(t.head+t.assoc);e.collapse(o.node,o.offset),e.modify("move",t.assoc<0?"forward":"backward","lineboundary")}mayControlSelection(){return this.view.state.facet(lc)?this.root.activeElement==this.dom:ja(this.dom,this.view.observer.selectionRange)}nearest(t){for(let e=t;e;){let t=lh.get(e);if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(i<t.length||t instanceof Xh)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){for(let i=this.length,n=this.children.length-1;;n--){let r=this.children[n],s=i-r.breakAfter-r.length;if(t>s||t==s&&r.type!=zh.WidgetBefore&&r.type!=zh.WidgetAfter&&(!n||2==e||this.children[n-1].breakAfter||this.children[n-1].type==zh.WidgetBefore&&e>-2))return r.coordsAt(t-s,e);i=s}}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,r=this.view.contentDOM.clientWidth,s=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,l=this.view.textDirection==wc.LTR;for(let t=0,a=0;a<this.children.length;a++){let h=this.children[a],c=t+h.length;if(c>n)break;if(t>=i){let i=h.dom.getBoundingClientRect();if(e.push(i.height),s){let e=h.dom.lastChild,n=e?qa(e):[];if(n.length){let e=n[n.length-1],s=l?e.right-i.left:i.right-e.left;s>o&&(o=s,this.minWidth=r,this.minWidthFrom=t,this.minWidthTo=c)}}}t=c+h.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return"rtl"==getComputedStyle(this.children[e].dom).direction?wc.RTL:wc.LTR}measureTextSize(){for(let t of this.children)if(t instanceof Xh){let e=t.measureTextSize();if(e)return e}let t,e,i=document.createElement("div");return i.className="cm-line",i.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(i);let n=qa(i.firstChild)[0];t=i.getBoundingClientRect().height,e=n?n.width/27:7,i.remove()})),{lineHeight:t,charWidth:e}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new hh(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let r=n==e.viewports.length?null:e.viewports[n],s=r?r.from-1:this.length;if(s>i){let n=e.lineBlockAt(s).bottom-e.lineBlockAt(i).top;t.push(Lh.replace({widget:new zc(n),block:!0,inclusive:!0,isBlockGap:!0}).range(i,s))}if(!r)break;i=r.to+1}return Lh.set(t)}updateDeco(){let t=this.view.state.facet(pc).map(((t,e)=>(this.dynamicDecorationMap[e]="function"==typeof t)?t(this.view):t));for(let e=t.length;e<t.length+3;e++)this.dynamicDecorationMap[e]=!1;return this.decorations=[...t,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(t){let e,{range:i}=t,n=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1);if(!n)return;!i.empty&&(e=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(n={left:Math.min(n.left,e.left),top:Math.min(n.top,e.top),right:Math.max(n.right,e.right),bottom:Math.max(n.bottom,e.bottom)});let r=0,s=0,o=0,l=0;for(let t of this.view.state.facet(mc).map((t=>t(this.view))))if(t){let{left:e,right:i,top:n,bottom:a}=t;null!=e&&(r=Math.max(r,e)),null!=i&&(s=Math.max(s,i)),null!=n&&(o=Math.max(o,n)),null!=a&&(l=Math.max(l,a))}let a={left:n.left-r,top:n.top-o,right:n.right+s,bottom:n.bottom+l};!function(t,e,i,n,r,s,o,l){let a=t.ownerDocument,h=a.defaultView;for(let c=t;c;)if(1==c.nodeType){let t,u=c==a.body;if(u)t=Ya(h);else{if(c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.parentNode;continue}let e=c.getBoundingClientRect();t={left:e.left,right:e.left+c.clientWidth,top:e.top,bottom:e.top+c.clientHeight}}let f=0,d=0;if("nearest"==r)e.top<t.top?(d=-(t.top-e.top+o),i>0&&e.bottom>t.bottom+d&&(d=e.bottom-t.bottom+d+o)):e.bottom>t.bottom&&(d=e.bottom-t.bottom+o,i<0&&e.top-d<t.top&&(d=-(t.top+d-e.top+o)));else{let n=e.bottom-e.top,s=t.bottom-t.top;d=("center"==r&&n<=s?e.top+n/2-s/2:"start"==r||"center"==r&&i<0?e.top-o:e.bottom-s+o)-t.top}if("nearest"==n?e.left<t.left?(f=-(t.left-e.left+s),i>0&&e.right>t.right+f&&(f=e.right-t.right+f+s)):e.right>t.right&&(f=e.right-t.right+s,i<0&&e.left<t.left+f&&(f=-(t.left+f-e.left+s))):f=("center"==n?e.left+(e.right-e.left)/2-(t.right-t.left)/2:"start"==n==l?e.left-s:e.right-(t.right-t.left)+s)-t.left,f||d)if(u)h.scrollBy(f,d);else{if(d){let t=c.scrollTop;c.scrollTop+=d,d=c.scrollTop-t}if(f){let t=c.scrollLeft;c.scrollLeft+=f,f=c.scrollLeft-t}e={left:e.left-f,top:e.top-d,right:e.right-f,bottom:e.bottom-d}}if(u)break;c=c.assignedSlot||c.parentNode,n=r="nearest"}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,a,i.head<i.anchor?-1:1,t.x,t.y,t.xMargin,t.yMargin,this.view.textDirection==wc.LTR)}}class zc extends Ih{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function Lc(t){let e=t.observer.selectionRange,i=e.focusNode&&Vc(e.focusNode,e.focusOffset,0);if(!i)return null;let n=t.docView.nearest(i);if(!n)return null;if(n instanceof Xh){let t=i;for(;t.parentNode!=n.dom;)t=t.parentNode;let e=t.previousSibling;for(;e&&!lh.get(e);)e=e.previousSibling;let r=e?lh.get(e).posAtEnd:n.posAtStart;return{from:r,to:r,node:t,text:i}}{for(;;){let{parent:t}=n;if(!t)return null;if(t instanceof Xh)break;n=t}let t=n.posAtStart;return{from:t,to:t+n.length,node:n.dom,text:i}}}class Wc extends Ih{constructor(t,e,i){super(),this.top=t,this.text=e,this.topView=i}eq(t){return this.top==t.top&&this.text==t.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return Ph}}function Vc(t,e,i){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0&&i<=0)e=Za(t=t.childNodes[e-1]);else{if(!(1==t.nodeType&&e<t.childNodes.length&&i>=0))return null;t=t.childNodes[e],e=0}}}class jc{constructor(){this.changes=[]}compareRange(t,e){Hh(t,e,this.changes)}comparePoint(t,e){Hh(t,e,this.changes)}}function qc(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function Hc(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function Xc(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function Fc(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function Zc(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function Gc(t,e,i){let n,r,s,o,l,a,h,c;for(let u=t.firstChild;u;u=u.nextSibling){let t=qa(u);for(let f=0;f<t.length;f++){let d=t[f];r&&Xc(r,d)&&(d=Fc(Zc(d,r.bottom),r.top));let p=qc(e,d),g=Hc(i,d);if(0==p&&0==g)return 3==u.nodeType?Uc(u,e,i):Gc(u,e,i);(!n||o>g||o==g&&s>p)&&(n=u,r=d,s=p,o=g),0==p?i>d.bottom&&(!h||h.bottom<d.bottom)?(l=u,h=d):i<d.top&&(!c||c.top>d.top)&&(a=u,c=d):h&&Xc(h,d)?h=Zc(h,d.bottom):c&&Xc(c,d)&&(c=Fc(c,d.top))}}if(h&&h.bottom>=i?(n=l,r=h):c&&c.top<=i&&(n=a,r=c),!n)return{node:t,offset:0};let u=Math.max(r.left,Math.min(r.right,e));return 3==n.nodeType?Uc(n,u,i):s||"true"!=n.contentEditable?{node:t,offset:Array.prototype.indexOf.call(t.childNodes,n)+(e>=(r.left+r.right)/2?1:0)}:Gc(n,u,i)}function Uc(t,e,i){let n=t.nodeValue.length,r=-1,s=1e9,o=0;for(let l=0;l<n;l++){let n=ih(t,l,l+1).getClientRects();for(let a=0;a<n.length;a++){let h=n[a];if(h.top==h.bottom)continue;o||(o=e-h.left);let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&c<s){let i=e>=(h.left+h.right)/2,n=i;if(kh.chrome||kh.gecko){ih(t,l).getBoundingClientRect().left==h.right&&(n=!i)}if(c<=0)return{node:t,offset:l+(n?1:0)};r=l+(n?1:0),s=c}}}return{node:t,offset:r>-1?r:o>0?t.nodeValue.length:0}}function Yc(t,{x:e,y:i},n,r=-1){var s;let o,l=t.contentDOM.getBoundingClientRect(),a=l.top+t.viewState.paddingTop,{docHeight:h}=t.viewState,c=i-a;if(c<0)return 0;if(c>h)return t.state.doc.length;for(let e=t.defaultLineHeight/2,i=!1;o=t.elementAtHeight(c),o.type!=zh.Text;)for(;c=r>0?o.bottom+e:o.top-e,!(c>=0&&c<=h);){if(i)return n?null:0;i=!0,r=-r}i=a+c;let u=o.from;if(u<t.viewport.from)return 0==t.viewport.from?0:n?null:Kc(t,l,o,e,i);if(u>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:n?null:Kc(t,l,o,e,i);let f=t.dom.ownerDocument,d=t.root.elementFromPoint?t.root:f,p=d.elementFromPoint(e,i);p&&!t.contentDOM.contains(p)&&(p=null),p||(e=Math.max(l.left+1,Math.min(l.right-1,e)),p=d.elementFromPoint(e,i),p&&!t.contentDOM.contains(p)&&(p=null));let g,m=-1;if(p&&0!=(null===(s=t.docView.nearest(p))||void 0===s?void 0:s.isEditable))if(f.caretPositionFromPoint){let t=f.caretPositionFromPoint(e,i);t&&({offsetNode:g,offset:m}=t)}else if(f.caretRangeFromPoint){let t=f.caretRangeFromPoint(e,i);t&&(({startContainer:g,startOffset:m}=t),kh.safari&&function(t,e,i){let n;if(3!=t.nodeType||e!=(n=t.nodeValue.length))return!1;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return ih(t,n-1,n).getBoundingClientRect().left>i}(g,m,e)&&(g=void 0))}if(!g||!t.docView.dom.contains(g)){let n=Xh.find(t.docView,u);if(!n)return c>o.top+o.height/2?o.to:o.from;({node:g,offset:m}=Gc(n.dom,e,i))}return t.docView.posFromDOM(g,m)}function Kc(t,e,i,n,r){let s=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&i.height>1.5*t.defaultLineHeight){s+=Math.floor((r-i.top)/t.defaultLineHeight)*t.viewState.heightOracle.lineLength}let o=t.state.sliceDoc(i.from,i.to);return i.from+La(o,s,t.state.tabSize)}function Jc(t,e,i,n){let r=t.state.doc.lineAt(e.head),s=t.bidiSpans(r),o=t.textDirectionAt(r.from);for(let l=e,a=null;;){let e=_c(r,s,o,l,i),h=$c;if(!e){if(r.number==(i?t.state.doc.lines:1))return l;h="\n",r=t.state.doc.line(r.number+(i?1:-1)),s=t.bidiSpans(r),e=$l.cursor(i?r.from:r.to)}if(a){if(!a(h))return l}else{if(!n)return e;a=n(h)}l=e}}function tu(t,e,i){let n=t.state.facet(gc).map((e=>e(t)));for(;;){let t=!1;for(let r of n)r.between(i.from-1,i.from+1,((n,r,s)=>{i.from>n&&i.from<r&&(i=e.from>i.from?$l.cursor(n,1):$l.cursor(r,-1),t=!0)}));if(!t)return i}}class eu{constructor(t){this.lastKeyCode=0,this.lastKeyTime=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.rapidCompositionStart=!1,this.mouseSelection=null;for(let e in ou){let i=ou[e];t.contentDOM.addEventListener(e,(n=>{su(t,n)&&!this.ignoreDuringComposition(n)&&("keydown"==e&&this.keydown(t,n)||(this.mustFlushObserver(n)&&t.observer.forceFlush(),this.runCustomHandlers(e,t,n)?n.preventDefault():i(t,n)))})),this.registeredEvents.push(e)}kh.chrome&&kh.chrome_version>=102&&t.scrollDOM.addEventListener("wheel",(()=>{this.chromeScrollHack<0?t.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout((()=>{this.chromeScrollHack=-1,t.contentDOM.style.pointerEvents=""}),100)}),{passive:!0}),this.notifiedFocused=t.hasFocus,kh.safari&&t.contentDOM.addEventListener("input",(()=>null))}setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}ensureHandlers(t,e){var i;let n;this.customHandlers=[];for(let r of e)if(n=null===(i=r.update(t).spec)||void 0===i?void 0:i.domEventHandlers){this.customHandlers.push({plugin:r.value,handlers:n});for(let e in n)this.registeredEvents.indexOf(e)<0&&"scroll"!=e&&(this.registeredEvents.push(e),t.contentDOM.addEventListener(e,(i=>{su(t,i)&&this.runCustomHandlers(e,t,i)&&i.preventDefault()})))}}runCustomHandlers(t,e,i){for(let n of this.customHandlers){let r=n.handlers[t];if(r)try{if(r.call(n.plugin,i,e)||i.defaultPrevented)return!0}catch(t){oc(e.state,t)}}return!1}runScrollHandlers(t,e){for(let i of this.customHandlers){let n=i.handlers.scroll;if(n)try{n.call(i.plugin,e,t)}catch(e){oc(t.state,e)}}}keydown(t,e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),9==e.keyCode&&Date.now()<this.lastEscPress+2e3)return!0;if(kh.android&&kh.chrome&&!e.synthetic&&(13==e.keyCode||8==e.keyCode))return t.observer.delayAndroidKey(e.key,e.keyCode),!0;let i;return!(!kh.ios||!(i=iu.find((t=>t.keyCode==e.keyCode)))||e.ctrlKey||e.altKey||e.metaKey||e.synthetic)&&(this.pendingIOSKey=i,setTimeout((()=>this.flushIOSKey(t)),250),!0)}flushIOSKey(t){let e=this.pendingIOSKey;return!!e&&(this.pendingIOSKey=void 0,nh(t.contentDOM,e.key,e.keyCode))}ignoreDuringComposition(t){return!!/^key/.test(t.type)&&(this.composing>0||!!(kh.safari&&Date.now()-this.compositionEndedAt<100)&&(this.compositionEndedAt=0,!0))}mustFlushObserver(t){return"keydown"==t.type&&229!=t.keyCode||"compositionend"==t.type&&!kh.ios}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.mouseSelection&&this.mouseSelection.update(t),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const iu=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],nu=[16,17,18,20,91,92,224,225];class ru{constructor(t,e,i,n){this.view=t,this.style=i,this.mustSelect=n,this.lastEvent=e;let r=t.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(ka.allowMultipleSelections)&&function(t,e){let i=t.state.facet(Yh);return i.length?i[0](e):kh.mac?e.metaKey:e.ctrlKey}(t,e),this.dragMove=function(t,e){let i=t.state.facet(Kh);return i.length?i[0](e):kh.mac?!e.altKey:!e.ctrlKey}(t,e),this.dragging=!(!function(t,e){let{main:i}=t.state.selection;if(i.empty)return!1;let n=Wa(t.root);if(0==n.rangeCount)return!0;let r=n.getRangeAt(0).getClientRects();for(let t=0;t<r.length;t++){let i=r[t];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}(t,e)||1!=vu(e))&&null,!1===this.dragging&&(e.preventDefault(),this.select(e))}move(t){if(0==t.buttons)return this.destroy();!1===this.dragging&&this.select(this.lastEvent=t)}up(t){null==this.dragging&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}select(t){let e=this.style.get(t,this.extend,this.multiple);!this.mustSelect&&e.eq(this.view.state.selection)&&e.main.assoc==this.view.state.selection.main.assoc||this.view.dispatch({selection:e,userEvent:"select.pointer",scrollIntoView:!0}),this.mustSelect=!1}update(t){t.docChanged&&this.dragging&&(this.dragging=this.dragging.map(t.changes)),this.style.update(t)&&setTimeout((()=>this.select(this.lastEvent)),20)}}function su(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i,n=e.target;n!=t.contentDOM;n=n.parentNode)if(!n||11==n.nodeType||(i=lh.get(n))&&i.ignoreEvent(e))return!1;return!0}const ou=Object.create(null),lu=kh.ie&&kh.ie_version<15||kh.ios&&kh.webkit_version<604;function au(t,e){let i,{state:n}=t,r=1,s=n.toText(e),o=s.lines==n.selection.ranges.length;if(null!=yu&&n.selection.ranges.every((t=>t.empty))&&yu==s.toString()){let t=-1;i=n.changeByRange((i=>{let l=n.doc.lineAt(i.from);if(l.from==t)return{range:i};t=l.from;let a=n.toText((o?s.line(r++).text:e)+n.lineBreak);return{changes:{from:l.from,insert:a},range:$l.cursor(i.from+a.length)}}))}else i=o?n.changeByRange((t=>{let e=s.line(r++);return{changes:{from:t.from,to:t.to,insert:e.text},range:$l.cursor(t.from+e.length)}})):n.replaceSelection(s);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}ou.keydown=(t,e)=>{t.inputState.setSelectionOrigin("select"),27==e.keyCode?t.inputState.lastEscPress=Date.now():nu.indexOf(e.keyCode)<0&&(t.inputState.lastEscPress=0)};let hu=0;function cu(t,e,i,n){if(1==n)return $l.cursor(e,i);if(2==n)return function(t,e,i=1){let n=t.charCategorizer(e),r=t.doc.lineAt(e),s=e-r.from;if(0==r.length)return $l.cursor(e);0==s?i=1:s==r.length&&(i=-1);let o=s,l=s;i<0?o=dl(r.text,s,!1):l=dl(r.text,s);let a=n(r.text.slice(o,l));for(;o>0;){let t=dl(r.text,o,!1);if(n(r.text.slice(t,o))!=a)break;o=t}for(;l<r.length;){let t=dl(r.text,l);if(n(r.text.slice(l,t))!=a)break;l=t}return $l.range(o+r.from,l+r.from)}(t.state,e,i);{let i=Xh.find(t.docView,e),n=t.state.doc.lineAt(i?i.posAtEnd:e),r=i?i.posAtStart:n.from,s=i?i.posAtEnd:n.to;return s<t.state.doc.length&&s==n.to&&s++,$l.range(r,s)}}ou.touchstart=(t,e)=>{hu=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},ou.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")},ou.mousedown=(t,e)=>{if(t.observer.flush(),hu>Date.now()-2e3&&1==vu(e))return;let i=null;for(let n of t.state.facet(Jh))if(i=n(t,e),i)break;if(i||0!=e.button||(i=function(t,e){let i=pu(t,e),n=vu(e),r=t.state.selection,s=i,o=e;return{update(t){t.docChanged&&(i&&(i.pos=t.changes.mapPos(i.pos)),r=r.map(t.changes),o=null)},get(e,l,a){let h;if(o&&e.clientX==o.clientX&&e.clientY==o.clientY?h=s:(h=s=pu(t,e),o=e),!h||!i)return r;let c=cu(t,h.pos,h.bias,n);if(i.pos!=h.pos&&!l){let e=cu(t,i.pos,i.bias,n),r=Math.min(e.from,c.from),s=Math.max(e.to,c.to);c=r<c.from?$l.range(r,s):$l.range(s,r)}return l?r.replaceRange(r.main.extend(c.from,c.to)):a?r.addRange(c):$l.create([c])}}}(t,e)),i){let n=t.root.activeElement!=t.contentDOM;n&&t.observer.ignore((()=>eh(t.contentDOM))),t.inputState.startMouseSelection(new ru(t,e,i,n))}};let uu=(t,e)=>t>=e.top&&t<=e.bottom,fu=(t,e,i)=>uu(e,i)&&t>=i.left&&t<=i.right;function du(t,e,i,n){let r=Xh.find(t.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(0==s)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&fu(i,n,o))return-1;let l=r.coordsAt(s,1);return l&&fu(i,n,l)?1:o&&uu(n,o)?-1:1}function pu(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:du(t,i,e.clientX,e.clientY)}}const gu=kh.ie&&kh.ie_version<=11;let mu=null,bu=0,Ou=0;function vu(t){if(!gu)return t.detail;let e=mu,i=Ou;return mu=t,Ou=Date.now(),bu=!e||i>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(bu+1)%3:1}function wu(t,e,i,n){if(!i)return;let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:s}=t.inputState,o=n&&s&&s.dragging&&s.dragMove?{from:s.dragging.from,to:s.dragging.to}:null,l={from:r,insert:i},a=t.state.changes(o?[o,l]:l);t.focus(),t.dispatch({changes:a,selection:{anchor:a.mapPos(r,-1),head:a.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"})}ou.dragstart=(t,e)=>{let{selection:{main:i}}=t.state,{mouseSelection:n}=t.inputState;n&&(n.dragging=i),e.dataTransfer&&(e.dataTransfer.setData("Text",t.state.sliceDoc(i.from,i.to)),e.dataTransfer.effectAllowed="copyMove")},ou.drop=(t,e)=>{if(!e.dataTransfer)return;if(t.state.readOnly)return e.preventDefault();let i=e.dataTransfer.files;if(i&&i.length){e.preventDefault();let n=Array(i.length),r=0,s=()=>{++r==i.length&&wu(t,e,n.filter((t=>null!=t)).join(t.state.lineBreak),!1)};for(let t=0;t<i.length;t++){let e=new FileReader;e.onerror=s,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(n[t]=e.result),s()},e.readAsText(i[t])}}else wu(t,e,e.dataTransfer.getData("Text"),!0)},ou.paste=(t,e)=>{if(t.state.readOnly)return e.preventDefault();t.observer.flush();let i=lu?null:e.clipboardData;i?(au(t,i.getData("text/plain")),e.preventDefault()):function(t){let e=t.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((()=>{t.focus(),i.remove(),au(t,i.value)}),50)}(t)};let yu=null;function xu(t){setTimeout((()=>{t.hasFocus!=t.inputState.notifiedFocused&&t.update([])}),10)}function ku(t,e){if(t.docView.compositionDeco.size){t.inputState.rapidCompositionStart=e;try{t.update([])}finally{t.inputState.rapidCompositionStart=!1}}}ou.copy=ou.cut=(t,e)=>{let{text:i,ranges:n,linewise:r}=function(t){let e=[],i=[],n=!1;for(let n of t.selection.ranges)n.empty||(e.push(t.sliceDoc(n.from,n.to)),i.push(n));if(!e.length){let r=-1;for(let{from:n}of t.selection.ranges){let s=t.doc.lineAt(n);s.number>r&&(e.push(s.text),i.push({from:s.from,to:Math.min(t.doc.length,s.to+1)})),r=s.number}n=!0}return{text:e.join(t.lineBreak),ranges:i,linewise:n}}(t.state);if(!i&&!r)return;yu=r?i:null;let s=lu?null:e.clipboardData;s?(e.preventDefault(),s.clearData(),s.setData("text/plain",i)):function(t,e){let i=t.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout((()=>{n.remove(),t.focus()}),50)}(t,i),"cut"!=e.type||t.state.readOnly||t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"})},ou.focus=xu,ou.blur=t=>{t.observer.clearSelectionRange(),xu(t)},ou.compositionstart=ou.compositionupdate=t=>{null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0,t.docView.compositionDeco.size&&(t.observer.flush(),ku(t,!0)))},ou.compositionend=t=>{t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionFirstChange=null,setTimeout((()=>{t.inputState.composing<0&&ku(t,!1)}),50)},ou.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()},ou.beforeinput=(t,e)=>{var i;let n;if(kh.chrome&&kh.android&&(n=iu.find((t=>t.inputType==e.inputType)))&&(t.observer.delayAndroidKey(n.key,n.keyCode),"Backspace"==n.key||"Delete"==n.key)){let e=(null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0;setTimeout((()=>{var i;((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>e+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())}),100)}};const Su=["pre-wrap","normal","pre-line","break-spaces"];class Cu{constructor(){this.doc=el.empty,this.lineWrapping=!1,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength)),this.lineHeight*i}heightForLine(t){if(!this.lineWrapping)return this.lineHeight;return(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return Su.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(10*n)]||(e=!0,this.heightSamples[Math.floor(10*n)]=!0)}return e}refresh(t,e,i,n,r){let s=Su.indexOf(t)>-1,o=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=s;if(this.lineWrapping=s,this.lineHeight=e,this.charWidth=i,this.lineLength=n,o){this.heightSamples={};for(let t=0;t<r.length;t++){let e=r[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return o}}class Au{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class Tu{constructor(t,e,i,n,r){this.from=t,this.length=e,this.top=i,this.height=n,this.type=r}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(t){let e=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(t.type)?t.type:[t]);return new Tu(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var Pu=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(Pu||(Pu={}));const Mu=.001;class Qu{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t,e){this.height!=e&&(Math.abs(this.height-e)>Mu&&(t.heightChanged=!0),this.height=e)}replace(t,e,i){return Qu.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let r=this;for(let s=n.length-1;s>=0;s--){let{fromA:o,toA:l,fromB:a,toB:h}=n[s],c=r.lineAt(o,Pu.ByPosNoHeight,e,0,0),u=c.to>=l?c:r.lineAt(l,Pu.ByPosNoHeight,e,0,0);for(h+=u.to-l,l=u.to;s>0&&c.from<=n[s-1].toA;)o=n[s-1].fromA,a=n[s-1].fromB,s--,o<c.from&&(c=r.lineAt(o,Pu.ByPosNoHeight,e,0,0));a+=c.from-o,o=c.from;let f=Nu.build(i,t,a,h);r=r.replace(o,l,f)}return r.updateHeight(i,0)}static empty(){return new $u(0,0)}static of(t){if(1==t.length)return t[0];let e=0,i=t.length,n=0,r=0;for(;;)if(e==i)if(n>2*r){let r=t[e-1];r.break?t.splice(--e,1,r.left,null,r.right):t.splice(--e,1,r.left,r.right),i+=1+r.break,n-=r.size}else{if(!(r>2*n))break;{let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,r-=e.size}}else if(n<r){let i=t[e++];i&&(n+=i.size)}else{let e=t[--i];e&&(r+=e.size)}let s=0;return null==t[e-1]?(s=1,e--):null==t[e]&&(s=1,i++),new Du(Qu.of(t.slice(0,e)),s,Qu.of(t.slice(i)))}}Qu.prototype.size=1;class Ru extends Qu{constructor(t,e,i){super(t,e),this.type=i}blockAt(t,e,i,n){return new Tu(n,this.length,i,this.height,this.type)}lineAt(t,e,i,n,r){return this.blockAt(0,i,n,r)}forEachLine(t,e,i,n,r,s){t<=r+this.length&&e>=r&&s(this.blockAt(0,i,n,r))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(t,n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class $u extends Ru{constructor(t,e){super(t,e,zh.Text),this.collapsed=0,this.widgetHeight=0}replace(t,e,i){let n=i[0];return 1==i.length&&(n instanceof $u||n instanceof _u&&4&n.flags)&&Math.abs(this.length-n.length)<10?(n instanceof _u?n=new $u(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):Qu.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(t,n.heights[n.index++]):(i||this.outdated)&&this.setHeight(t,Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class _u extends Qu{constructor(t){super(t,0)}lines(t,e){let i=t.lineAt(e).number,n=t.lineAt(e+this.length).number;return{firstLine:i,lastLine:n,lineHeight:this.height/(n-i+1)}}blockAt(t,e,i,n){let{firstLine:r,lastLine:s,lineHeight:o}=this.lines(e,n),l=Math.max(0,Math.min(s-r,Math.floor((t-i)/o))),{from:a,length:h}=e.line(r+l);return new Tu(a,h,i+o*l,o,zh.Text)}lineAt(t,e,i,n,r){if(e==Pu.ByHeight)return this.blockAt(t,i,n,r);if(e==Pu.ByPosNoHeight){let{from:e,to:n}=i.lineAt(t);return new Tu(e,n-e,0,0,zh.Text)}let{firstLine:s,lineHeight:o}=this.lines(i,r),{from:l,length:a,number:h}=i.lineAt(t);return new Tu(l,a,n+o*(h-s),o,zh.Text)}forEachLine(t,e,i,n,r,s){let{firstLine:o,lineHeight:l}=this.lines(i,r);for(let a=Math.max(t,r),h=Math.min(r+this.length,e);a<=h;){let e=i.lineAt(a);a==t&&(n+=l*(e.number-o)),s(new Tu(e.from,e.length,n,l,zh.Text)),n+=l,a=e.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let t=i[i.length-1];t instanceof _u?i[i.length-1]=new _u(t.length+n):i.push(null,new _u(n-1))}if(t>0){let e=i[0];e instanceof _u?i[0]=new _u(t+e.length):i.unshift(new _u(t-1),null)}return Qu.of(i)}decomposeLeft(t,e){e.push(new _u(t-1),null)}decomposeRight(t,e){e.push(null,new _u(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let r=e+this.length;if(n&&n.from<=e+this.length&&n.more){let i=[],s=Math.max(e,n.from),o=-1,l=t.heightChanged;for(n.from>e&&i.push(new _u(n.from-e-1).updateHeight(t,e));s<=r&&n.more;){let e=t.doc.lineAt(s).length;i.length&&i.push(null);let r=n.heights[n.index++];-1==o?o=r:Math.abs(r-o)>=Mu&&(o=-2);let l=new $u(e,r);l.outdated=!1,i.push(l),s+=e+1}s<=r&&i.push(null,new _u(r-s).updateHeight(t,s));let a=Qu.of(i);return t.heightChanged=l||o<0||Math.abs(a.height-this.height)>=Mu||Math.abs(o-this.lines(t.doc,e).lineHeight)>=Mu,a}return(i||this.outdated)&&(this.setHeight(t,t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class Du extends Qu{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return 1&this.flags}blockAt(t,e,i,n){let r=i+this.left.height;return t<r?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,r,n+this.left.length+this.break)}lineAt(t,e,i,n,r){let s=n+this.left.height,o=r+this.left.length+this.break,l=e==Pu.ByHeight?t<s:t<o,a=l?this.left.lineAt(t,e,i,n,r):this.right.lineAt(t,e,i,s,o);if(this.break||(l?a.to<o:a.from>o))return a;let h=e==Pu.ByPosNoHeight?Pu.ByPosNoHeight:Pu.ByPos;return l?a.join(this.right.lineAt(o,h,i,s,o)):this.left.lineAt(o,h,i,n,r).join(a)}forEachLine(t,e,i,n,r,s){let o=n+this.left.height,l=r+this.left.length+this.break;if(this.break)t<l&&this.left.forEachLine(t,e,i,n,r,s),e>=l&&this.right.forEachLine(t,e,i,o,l,s);else{let a=this.lineAt(l,Pu.ByPos,i,n,r);t<a.from&&this.left.forEachLine(t,a.from-1,i,n,r,s),a.to>=t&&a.from<=e&&s(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,o,l,s)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let r=[];t>0&&this.decomposeLeft(t,r);let s=r.length;for(let t of i)r.push(t);if(t>0&&Eu(r,s-1),e<this.length){let t=r.length;this.decomposeRight(e,r),Eu(r,t)}return Qu.of(r)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?Qu.of(this.break?[t,null,e]:[t,e]):(this.left=t,this.right=e,this.height=t.height+e.height,this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:r,right:s}=this,o=e+r.length+this.break,l=null;return n&&n.from<=e+r.length&&n.more?l=r=r.updateHeight(t,e,i,n):r.updateHeight(t,e,i),n&&n.from<=o+s.length&&n.more?l=s=s.updateHeight(t,o,i,n):s.updateHeight(t,o,i),l?this.balanced(r,s):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Eu(t,e){let i,n;null==t[e]&&(i=t[e-1])instanceof _u&&(n=t[e+1])instanceof _u&&t.splice(e-1,3,new _u(i.length+1+n.length))}class Nu{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof $u?i.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new $u(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0;n<0&&(n=this.oracle.lineHeight);let r=e-t;i.block?this.addBlock(new Ru(r,n,i.type)):(r||n>=5)&&this.addLineDeco(n,r)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new $u(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new _u(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof $u)return t;let e=new $u(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine(),t.type!=zh.WidgetAfter||this.isCovered||this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,t.type!=zh.WidgetBefore&&(this.covering=t)}addLineDeco(t,e){let i=this.ensureLine();i.length+=e,i.collapsed+=e,i.widgetHeight=Math.max(i.widgetHeight,t),this.writtenTo=this.pos=this.pos+e}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof $u||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new $u(0,-1));let i=t;for(let t of this.nodes)t instanceof $u&&t.updateHeight(this.oracle,i),i+=t?t.length:1;return this.nodes}static build(t,e,i,n){let r=new Nu(i,t);return Pa.spans(e,i,n,r,0),r.finish(i)}}class Bu{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&Hh(t,e,this.changes,5)}}function Iu(t,e){let i=t.getBoundingClientRect(),n=Math.max(0,i.left),r=Math.min(innerWidth,i.right),s=Math.max(0,i.top),o=Math.min(innerHeight,i.bottom),l=t.ownerDocument.body;for(let e=t.parentNode;e&&e!=l;)if(1==e.nodeType){let t=e,i=window.getComputedStyle(t);if((t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)&&"visible"!=i.overflow){let e=t.getBoundingClientRect();n=Math.max(n,e.left),r=Math.min(r,e.right),s=Math.max(s,e.top),o=Math.min(o,e.bottom)}e="absolute"==i.position||"fixed"==i.position?t.offsetParent:t.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{left:n-i.left,right:Math.max(n,r)-i.left,top:s-(i.top+e),bottom:Math.max(s,o)-(i.top+e)}}function zu(t,e){let i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class Lu{constructor(t,e,i){this.from=t,this.to=e,this.size=i}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],r=e[i];if(n.from!=r.from||n.to!=r.to||n.size!=r.size)return!1}return!0}draw(t){return Lh.replace({widget:new Wu(this.size,t)}).range(this.from,this.to)}}class Wu extends Ih{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class Vu{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.heightOracle=new Cu,this.scaler=Gu,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=wc.RTL,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1,this.stateDeco=t.facet(pc).filter((t=>"function"!=typeof t)),this.heightMap=Qu.empty().applyChanges(this.stateDeco,el.empty,this.heightOracle.setDoc(t.doc),[new Oc(0,0,0,t.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Lh.set(this.lineGaps.map((t=>t.draw(!1)))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some((({from:t,to:e})=>n>=t&&n<=e))){let{from:e,to:i}=this.lineBlockAt(n);t.push(new ju(e,i))}}this.viewports=t.sort(((t,e)=>t.from-e.from)),this.scaler=this.heightMap.height<=7e6?Gu:new Uu(this.heightOracle.doc,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,(t=>{this.viewportLines.push(1==this.scaler.scale?t:Yu(t,this.scaler))}))}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(pc).filter((t=>"function"!=typeof t));let n=t.changedRanges,r=Oc.extendWithRanges(n,function(t,e,i){let n=new Bu;return Pa.compare(t,e,i,n,0),n.changes}(i,this.stateDeco,t?t.changes:Sl.empty(this.state.doc.length))),s=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),r),this.heightMap.height!=s&&(t.flags|=2);let o=r.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<o.from||e.range.head>o.to)||!this.viewportIsAppropriate(o))&&(o=this.getViewport(0,e));let l=!t.changes.empty||2&t.flags||o.from!=this.viewport.from||o.to!=this.viewport.to;this.viewport=o,this.updateForViewport(),l&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,r=i.whiteSpace;this.defaultTextDirection="rtl"==i.direction?wc.RTL:wc.LTR;let s=this.heightOracle.mustRefreshForWrapping(r),o=s||this.mustMeasureContent||this.contentDOMHeight!=e.clientHeight;this.contentDOMHeight=e.clientHeight,this.mustMeasureContent=!1;let l=0,a=0,h=parseInt(i.paddingTop)||0,c=parseInt(i.paddingBottom)||0;this.paddingTop==h&&this.paddingBottom==c||(this.paddingTop=h,this.paddingBottom=c,l|=10),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(o=!0),this.editorWidth=t.scrollDOM.clientWidth,l|=8);let u=(this.printing?zu:Iu)(e,this.paddingTop),f=u.top-this.pixelViewport.top,d=u.bottom-this.pixelViewport.bottom;this.pixelViewport=u;let p=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(p!=this.inView&&(this.inView=p,p&&(o=!0)),!this.inView)return 0;let g=e.clientWidth;if(this.contentDOMWidth==g&&this.editorHeight==t.scrollDOM.clientHeight||(this.contentDOMWidth=g,this.editorHeight=t.scrollDOM.clientHeight,l|=8),o){let e=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(e)&&(s=!0),s||n.lineWrapping&&Math.abs(g-this.contentDOMWidth)>n.charWidth){let{lineHeight:i,charWidth:o}=t.docView.measureTextSize();s=n.refresh(r,i,o,g/o,e),s&&(t.docView.minWidth=0,l|=8)}f>0&&d>0?a=Math.max(f,d):f<0&&d<0&&(a=Math.min(f,d)),n.heightChanged=!1;for(let i of this.viewports){let r=i.from==this.viewport.from?e:t.docView.measureVisibleLineHeights(i);this.heightMap=this.heightMap.updateHeight(n,0,s,new Au(i.from,r))}n.heightChanged&&(l|=2)}let m=!this.viewportIsAppropriate(this.viewport,a)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return m&&(this.viewport=this.getViewport(a,this.scrollTarget)),this.updateForViewport(),(2&l||m)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(s?[]:this.lineGaps)),l|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),l}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,r=this.state.doc,{visibleTop:s,visibleBottom:o}=this,l=new ju(n.lineAt(s-1e3*i,Pu.ByHeight,r,0,0).from,n.lineAt(o+1e3*(1-i),Pu.ByHeight,r,0,0).to);if(e){let{head:t}=e.range;if(t<l.from||t>l.to){let i,s=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),o=n.lineAt(t,Pu.ByPos,r,0,0);i="center"==e.y?(o.top+o.bottom)/2-s/2:"start"==e.y||"nearest"==e.y&&t<l.from?o.top:o.bottom-s,l=new ju(n.lineAt(i-500,Pu.ByHeight,r,0,0).from,n.lineAt(i+s+500,Pu.ByHeight,r,0,0).to)}}return l}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new ju(this.heightMap.lineAt(i,Pu.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(n,Pu.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,Pu.ByPos,this.state.doc,0,0),{bottom:r}=this.heightMap.lineAt(e,Pu.ByPos,this.state.doc,0,0),{visibleTop:s,visibleBottom:o}=this;return(0==t||n<=s-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||r>=o+Math.max(10,Math.min(i,250)))&&n>s-2e3&&r<o+2e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new Lu(e.mapPos(n.from),e.mapPos(n.to),n.size));return i}ensureLineGaps(t){let e=[];if(this.defaultTextDirection!=wc.LTR)return e;for(let i of this.viewportLines){if(i.length<4e3)continue;let n,r,s=qu(i.from,i.to,this.stateDeco);if(s.total<4e3)continue;if(this.heightOracle.lineWrapping){let t=2e3/this.heightOracle.lineLength*this.heightOracle.lineHeight;n=Hu(s,(this.visibleTop-i.top-t)/i.height),r=Hu(s,(this.visibleBottom-i.top+t)/i.height)}else{let t=s.total*this.heightOracle.charWidth,e=2e3*this.heightOracle.charWidth;n=Hu(s,(this.pixelViewport.left-e)/t),r=Hu(s,(this.pixelViewport.right+e)/t)}let o=[];n>i.from&&o.push({from:i.from,to:n}),r<i.to&&o.push({from:r,to:i.to});let l=this.state.selection.main;l.from>=i.from&&l.from<=i.to&&Fu(o,l.from-10,l.from+10),!l.empty&&l.to>=i.from&&l.to<=i.to&&Fu(o,l.to-10,l.to+10);for(let{from:n,to:r}of o)r-n>1e3&&e.push(Zu(t,(t=>t.from>=i.from&&t.to<=i.to&&Math.abs(t.from-n)<1e3&&Math.abs(t.to-r)<1e3))||new Lu(n,r,this.gapSize(i,n,r,s)))}return e}gapSize(t,e,i,n){let r=Xu(n,i)-Xu(n,e);return this.heightOracle.lineWrapping?t.height*r:n.total*this.heightOracle.charWidth*r}updateLineGaps(t){Lu.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=Lh.set(t.map((t=>t.draw(this.heightOracle.lineWrapping)))))}computeVisibleRanges(){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let e=[];Pa.spans(t,this.viewport.from,this.viewport.to,{span(t,i){e.push({from:t,to:i})},point(){}},20);let i=e.length!=this.visibleRanges.length||this.visibleRanges.some(((t,i)=>t.from!=e[i].from||t.to!=e[i].to));return this.visibleRanges=e,i?4:0}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find((e=>e.from<=t&&e.to>=t))||Yu(this.heightMap.lineAt(t,Pu.ByPos,this.state.doc,0,0),this.scaler)}lineBlockAtHeight(t){return Yu(this.heightMap.lineAt(this.scaler.fromDOM(t),Pu.ByHeight,this.state.doc,0,0),this.scaler)}elementAtHeight(t){return Yu(this.heightMap.blockAt(this.scaler.fromDOM(t),this.state.doc,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class ju{constructor(t,e){this.from=t,this.to=e}}function qu(t,e,i){let n=[],r=t,s=0;return Pa.spans(i,t,e,{span(){},point(t,e){t>r&&(n.push({from:r,to:t}),s+=t-r),r=e}},20),r<e&&(n.push({from:r,to:e}),s+=e-r),{total:s,ranges:n}}function Hu({total:t,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let n=Math.floor(t*i);for(let t=0;;t++){let{from:i,to:r}=e[t],s=r-i;if(n<=s)return i+n;n-=s}}function Xu(t,e){let i=0;for(let{from:n,to:r}of t.ranges){if(e<=r){i+=e-n;break}i+=r-n}return i/t.total}function Fu(t,e,i){for(let n=0;n<t.length;n++){let r=t[n];if(r.from<i&&r.to>e){let s=[];r.from<e&&s.push({from:r.from,to:e}),r.to>i&&s.push({from:i,to:r.to}),t.splice(n,1,...s),n+=s.length-1}}}function Zu(t,e){for(let i of t)if(e(i))return i}const Gu={toDOM:t=>t,fromDOM:t=>t,scale:1};class Uu{constructor(t,e,i){let n=0,r=0,s=0;this.viewports=i.map((({from:i,to:r})=>{let s=e.lineAt(i,Pu.ByPos,t,0,0).top,o=e.lineAt(r,Pu.ByPos,t,0,0).bottom;return n+=o-s,{from:i,to:r,top:s,bottom:o,domTop:0,domBottom:0}})),this.scale=(7e6-n)/(e.height-n);for(let t of this.viewports)t.domTop=s+(t.top-r)*this.scale,s=t.domBottom=t.domTop+(t.bottom-t.top),r=t.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.top)return n+(t-i)*this.scale;if(t<=r.bottom)return r.domTop+(t-r.top);i=r.bottom,n=r.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.domTop)return i+(t-n)/this.scale;if(t<=r.domBottom)return r.top+(t-r.domTop);i=r.bottom,n=r.domBottom}}}function Yu(t,e){if(1==e.scale)return t;let i=e.toDOM(t.top),n=e.toDOM(t.bottom);return new Tu(t.from,t.length,i,n-i,Array.isArray(t.type)?t.type.map((t=>Yu(t,e))):t.type)}const Ku=El.define({combine:t=>t.join(" ")}),Ju=El.define({combine:t=>t.indexOf(!0)>-1}),tf=Je.newName(),ef=Je.newName(),nf=Je.newName(),rf={"&light":"."+ef,"&dark":"."+nf};function sf(t,e,i){return new Je(e,{finish:e=>/&/.test(e)?e.replace(/&\w*/,(e=>{if("&"==e)return t;if(!i||!i[e])throw new RangeError(`Unsupported selector: ${e}`);return i[e]})):t+" "+e})}const of=sf("."+tf,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere"},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},".cm-cursor, .cm-dropCursor":{position:"absolute",borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#f3f9ff"},"&dark .cm-activeLine":{backgroundColor:"#223039"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},rf),lf={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},af=kh.ie&&kh.ie_version<=11;class hf{constructor(t,e,i){this.view=t,this.onChange=e,this.onScrollChanged=i,this.active=!1,this.selectionRange=new Ka,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.scrollTargets=[],this.intersection=null,this.resize=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver((e=>{for(let t of e)this.queue.push(t);(kh.ie&&kh.ie_version<=11||kh.ios&&t.composing)&&e.some((t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length))?this.flushSoon():this.flush()})),af&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),window.addEventListener("resize",this.onResize=this.onResize.bind(this)),"function"==typeof ResizeObserver&&(this.resize=new ResizeObserver((()=>{this.view.docView.lastUpdate<Date.now()-75&&this.onResize()})),this.resize.observe(t.scrollDOM)),window.addEventListener("beforeprint",this.onPrint=this.onPrint.bind(this)),this.start(),window.addEventListener("scroll",this.onScroll=this.onScroll.bind(this)),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange(),this.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}onScroll(t){this.intersecting&&this.flush(!1),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500)}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some(((e,i)=>e!=t[i])))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:e}=this,i=this.selectionRange;if(e.state.facet(lc)?e.root.activeElement!=this.dom:!ja(e.dom,i))return;let n=i.anchorNode&&e.docView.nearest(i.anchorNode);n&&n.ignoreEvent(t)||((kh.ie&&kh.ie_version<=11||kh.android&&kh.chrome)&&!e.state.selection.main.empty&&i.focusNode&&Ha(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1))}readSelectionRange(){let{root:t}=this.view,e=Wa(t),i=kh.safari&&11==t.nodeType&&function(){let t=document.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}()==this.view.contentDOM&&function(t){let e=null;function i(t){t.preventDefault(),t.stopImmediatePropagation(),e=t.getTargetRanges()[0]}if(t.contentDOM.addEventListener("beforeinput",i,!0),document.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",i,!0),!e)return null;let n=e.startContainer,r=e.startOffset,s=e.endContainer,o=e.endOffset,l=t.docView.domAtPos(t.state.selection.main.anchor);Ha(l.node,l.offset,s,o)&&([n,r,s,o]=[s,o,n,r]);return{anchorNode:n,anchorOffset:r,focusNode:s,focusOffset:o}}(this.view)||e;return!this.selectionRange.eq(i)&&(this.selectionRange.setRange(i),this.selectionChanged=!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(1==i.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else{if(11!=i.nodeType)break;i=i.host}if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,lf),af&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),af&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){this.delayedAndroidKey||requestAnimationFrame((()=>{let t=this.delayedAndroidKey;this.delayedAndroidKey=null,this.delayedFlush=-1,this.flush()||nh(this.view.contentDOM,t.key,t.keyCode)})),this.delayedAndroidKey&&"Enter"!=t||(this.delayedAndroidKey={key:t,keyCode:e})}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=window.setTimeout((()=>{this.delayedFlush=-1,this.flush()}),20))}forceFlush(){this.delayedFlush>=0&&(window.clearTimeout(this.delayedFlush),this.delayedFlush=-1,this.flush())}processRecords(){let t=this.queue;for(let e of this.observer.takeRecords())t.push(e);t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let r of t){let t=this.readMutation(r);t&&(t.typeOver&&(n=!0),-1==e?({from:e,to:i}=t):(e=Math.min(t.from,e),i=Math.max(t.to,i)))}return{from:e,to:i,typeOver:n}}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return;t&&this.readSelectionRange();let{from:e,to:i,typeOver:n}=this.processRecords(),r=this.selectionChanged&&ja(this.dom,this.selectionRange);if(e<0&&!r)return;this.selectionChanged=!1;let s=this.view.state,o=this.onChange(e,i,n);return this.view.state==s&&this.view.update([]),o}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty("attributes"==t.type),"attributes"==t.type&&(e.dirty|=4),"childList"==t.type){let i=cf(e,t.previousSibling||t.target.previousSibling,-1),n=cf(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}return"characterData"==t.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}destroy(){var t,e,i;this.stop(),null===(t=this.intersection)||void 0===t||t.disconnect(),null===(e=this.gapIntersection)||void 0===e||e.disconnect(),null===(i=this.resize)||void 0===i||i.disconnect();for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onResize),window.removeEventListener("beforeprint",this.onPrint),this.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout)}}function cf(t,e,i){for(;e;){let n=lh.get(e);if(n&&n.parent==t)return n;let r=e.parentNode;e=r!=t.dom?r:i>0?e.nextSibling:e.previousSibling}return null}function uf(t,e,i,n){let r,s,o=t.state.selection.main;if(e>-1){let n=t.docView.domBoundsAround(e,i,0);if(!n||t.state.readOnly)return!1;let{from:l,to:a}=n,h=t.docView.impreciseHead||t.docView.impreciseAnchor?[]:function(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:i,anchorOffset:n,focusNode:r,focusOffset:s}=t.observer.selectionRange;i&&(e.push(new Bc(i,n)),r==i&&s==n||e.push(new Bc(r,s)));return e}(t),c=new Ec(h,t.state);c.readRange(n.startDOM,n.endDOM);let u=o.from,f=null;(8===t.inputState.lastKeyCode&&t.inputState.lastKeyTime>Date.now()-100||kh.android&&c.text.length<a-l)&&(u=o.to,f="end");let d=function(t,e,i,n){let r=Math.min(t.length,e.length),s=0;for(;s<r&&t.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==r&&t.length==e.length)return null;let o=t.length,l=e.length;for(;o>0&&l>0&&t.charCodeAt(o-1)==e.charCodeAt(l-1);)o--,l--;if("end"==n){i-=o+Math.max(0,s-Math.min(o,l))-s}if(o<s&&t.length<e.length){s-=i<=s&&i>=o?s-i:0,l=s+(l-o),o=s}else if(l<s){s-=i<=s&&i>=l?s-i:0,o=s+(o-l),l=s}return{from:s,toA:o,toB:l}}(t.state.doc.sliceString(l,a,Dc),c.text,u-l,f);d&&(kh.chrome&&13==t.inputState.lastKeyCode&&d.toB==d.from+2&&"￿￿"==c.text.slice(d.from,d.toB)&&d.toB--,r={from:l+d.from,to:l+d.toA,insert:el.of(c.text.slice(d.from,d.toB).split(Dc))}),s=function(t,e){if(0==t.length)return null;let i=t[0].pos,n=2==t.length?t[1].pos:i;return i>-1&&n>-1?$l.single(i+e,n+e):null}(h,l)}else if(t.hasFocus||!t.state.facet(lc)){let e=t.observer.selectionRange,{impreciseHead:i,impreciseAnchor:n}=t.docView,r=i&&i.node==e.focusNode&&i.offset==e.focusOffset||!Va(t.contentDOM,e.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),l=n&&n.node==e.anchorNode&&n.offset==e.anchorOffset||!Va(t.contentDOM,e.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(e.anchorNode,e.anchorOffset);r==o.head&&l==o.anchor||(s=$l.single(l,r))}if(!r&&!s)return!1;if(!r&&n&&!o.empty&&s&&s.main.empty?r={from:o.from,to:o.to,insert:t.state.doc.slice(o.from,o.to)}:r&&r.from>=o.from&&r.to<=o.to&&(r.from!=o.from||r.to!=o.to)&&o.to-o.from-(r.to-r.from)<=4?r={from:o.from,to:o.to,insert:t.state.doc.slice(o.from,r.from).append(r.insert).append(t.state.doc.slice(r.to,o.to))}:(kh.mac||kh.android)&&r&&r.from==r.to&&r.from==o.head-1&&"."==r.insert.toString()&&(r={from:o.from,to:o.to,insert:el.of([" "])}),r){let e=t.state;if(kh.ios&&t.inputState.flushIOSKey(t))return!0;if(kh.android&&(r.from==o.from&&r.to==o.to&&1==r.insert.length&&2==r.insert.lines&&nh(t.contentDOM,"Enter",13)||r.from==o.from-1&&r.to==o.to&&0==r.insert.length&&nh(t.contentDOM,"Backspace",8)||r.from==o.from&&r.to==o.to+1&&0==r.insert.length&&nh(t.contentDOM,"Delete",46)))return!0;let i,n=r.insert.toString();if(t.state.facet(ic).some((e=>e(t,r.from,r.to,n))))return!0;if(t.inputState.composing>=0&&t.inputState.composing++,r.from>=o.from&&r.to<=o.to&&r.to-r.from>=(o.to-o.from)/3&&(!s||s.main.empty&&s.main.from==r.from+r.insert.length)&&t.inputState.composing<0){let n=o.from<r.from?e.sliceDoc(o.from,r.from):"",s=o.to>r.to?e.sliceDoc(r.to,o.to):"";i=e.replaceSelection(t.state.toText(n+r.insert.sliceString(0,void 0,t.state.lineBreak)+s))}else{let n=e.changes(r),l=s&&!e.selection.main.eq(s.main)&&s.main.to<=n.newLength?s.main:void 0;if(e.selection.ranges.length>1&&t.inputState.composing>=0&&r.to<=o.to&&r.to>=o.to-10){let s=t.state.sliceDoc(r.from,r.to),a=Lc(t)||t.state.doc.lineAt(o.head),h=o.to-r.to,c=o.to-o.from;i=e.changeByRange((i=>{if(i.from==o.from&&i.to==o.to)return{changes:n,range:l||i.map(n)};let u=i.to-h,f=u-s.length;if(i.to-i.from!=c||t.state.sliceDoc(f,u)!=s||a&&i.to>=a.from&&i.from<=a.to)return{range:i};let d=e.changes({from:f,to:u,insert:r.insert}),p=i.to-o.to;return{changes:d,range:l?$l.range(Math.max(0,l.anchor+p),Math.max(0,l.head+p)):i.map(d)}}))}else i={changes:n,selection:l&&e.selection.replaceRange(l)}}let l="input.type";return t.composing&&(l+=".compose",t.inputState.compositionFirstChange&&(l+=".start",t.inputState.compositionFirstChange=!1)),t.dispatch(i,{scrollIntoView:!0,userEvent:l}),!0}if(s&&!s.main.eq(o)){let e=!1,i="select";return t.inputState.lastSelectionTime>Date.now()-50&&("select"==t.inputState.lastSelectionOrigin&&(e=!0),i=t.inputState.lastSelectionOrigin),t.dispatch({selection:s,scrollIntoView:e,userEvent:i}),!0}return!1}class ff{constructor(t={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: absolute; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=t.dispatch||(t=>this.update([t])),this.dispatch=this.dispatch.bind(this),this.root=t.root||function(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}(t.parent)||document,this.viewState=new Vu(t.state||ka.create()),this.plugins=this.state.facet(hc).map((t=>new uc(t)));for(let t of this.plugins)t.update(this);this.observer=new hf(this,((t,e,i)=>uf(this,t,e,i)),(t=>{this.inputState.runScrollHandlers(this,t),this.observer.intersecting&&this.measure()})),this.inputState=new eu(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new Ic(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),t.parent&&t.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}dispatch(...t){this._dispatch(1==t.length&&t[0]instanceof fa?t[0]:this.state.update(...t))}update(t){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e,i=!1,n=!1,r=this.state;for(let e of t){if(e.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=e.state}if(this.destroyed)return void(this.viewState.state=r);if(this.observer.clear(),r.facet(ka.phrases)!=this.state.facet(ka.phrases))return this.setState(r);e=vc.create(this,r,t);let s=this.viewState.scrollTarget;try{this.updateState=2;for(let e of t){if(s&&(s=s.map(e.changes)),e.scrollIntoView){let{main:t}=e.state.selection;s=new rc(t.empty?t:$l.cursor(t.head,t.head>t.anchor?-1:1))}for(let t of e.effects)t.is(sc)&&(s=t.value)}this.viewState.update(e,s),this.bidiCache=gf.update(this.bidiCache,e.changes),e.empty||(this.updatePlugins(e),this.inputState.update(e)),i=this.docView.update(e),this.state.facet(bc)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some((t=>t.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(e.startState.facet(Ku)!=e.state.facet(Ku)&&(this.viewState.mustMeasureContent=!0),(i||n||s||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!e.empty)for(let t of this.state.facet(ec))t(e)}setState(t){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=t);this.updateState=2;let e=this.hasFocus;try{for(let t of this.plugins)t.destroy(this);this.viewState=new Vu(t),this.plugins=t.facet(hc).map((t=>new uc(t))),this.pluginMap.clear();for(let t of this.plugins)t.update(this);this.docView=new Ic(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(hc),i=t.state.facet(hc);if(e!=i){let n=[];for(let r of i){let i=e.indexOf(r);if(i<0)n.push(new uc(r));else{let e=this.plugins[i];e.mustUpdate=t,n.push(e)}}for(let e of this.plugins)e.mustUpdate!=t&&e.destroy(this);this.plugins=n,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let e of this.plugins)e.mustUpdate=t;for(let t=0;t<this.plugins.length;t++)this.plugins[t].update(this)}measure(t=!0){if(this.destroyed)return;this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,t&&this.observer.flush();let e=null;try{for(let t=0;;t++){this.updateState=1;let i=this.viewport,n=this.viewState.measure(this);if(!n&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(t>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let r=[];4&n||([this.measureRequests,r]=[r,this.measureRequests]);let s=r.map((t=>{try{return t.read(this)}catch(t){return oc(this.state,t),pf}})),o=vc.create(this,this.state,[]),l=!1,a=!1;o.flags|=n,e?e.flags|=n:e=o,this.updateState=2,o.empty||(this.updatePlugins(o),this.inputState.update(o),this.updateAttrs(),l=this.docView.update(o));for(let t=0;t<r.length;t++)if(s[t]!=pf)try{let e=r[t];e.write&&e.write(s[t],this)}catch(t){oc(this.state,t)}if(this.viewState.scrollTarget&&(this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=!0),l&&this.docView.updateSelection(!0),this.viewport.from==i.from&&this.viewport.to==i.to&&!a&&0==this.measureRequests.length)break}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let t of this.state.facet(ec))t(e)}get themeClasses(){return tf+" "+(this.state.facet(Ju)?nf:ef)+" "+this.state.facet(Ku)}updateAttrs(){let t=mf(this,fc,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(lc)?"true":"false",class:"cm-content",style:`${kh.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),mf(this,dc,e);let i=this.observer.ignore((()=>{let i=Bh(this.contentDOM,this.contentAttrs,e),n=Bh(this.dom,this.editorAttrs,t);return i||n}));return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let t of i.effects)if(t.is(ff.announce)){e&&(this.announceDOM.textContent=""),e=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value}}mountStyles(){this.styleModules=this.state.facet(bc),Je.mount(this.root,this.styleModules.concat(of).reverse())}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=requestAnimationFrame((()=>this.measure()))),t){if(null!=t.key)for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key)return void(this.measureRequests[e]=t);this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find((e=>e.spec==t))||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return tu(this,t,Jc(this,t,e,i))}moveByGroup(t,e){return tu(this,t,Jc(this,t,e,(e=>function(t,e,i){let n=t.state.charCategorizer(e),r=n(i);return t=>{let e=n(t);return r==va.Space&&(r=e),r==e}}(this,t.head,e))))}moveToLineBoundary(t,e,i=!0){return function(t,e,i,n){let r=t.state.doc.lineAt(e.head),s=n&&t.lineWrapping?t.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head):null;if(s){let e=t.dom.getBoundingClientRect(),n=t.textDirectionAt(r.from),o=t.posAtCoords({x:i==(n==wc.LTR)?e.right-1:e.left+1,y:(s.top+s.bottom)/2});if(null!=o)return $l.cursor(o,i?-1:1)}let o=Xh.find(t.docView,e.head),l=o?i?o.posAtEnd:o.posAtStart:i?r.to:r.from;return $l.cursor(l,i?-1:1)}(this,t,e,i)}moveVertically(t,e,i){return tu(this,t,function(t,e,i,n){let r=e.head,s=i?1:-1;if(r==(i?t.state.doc.length:0))return $l.cursor(r,e.assoc);let o,l=e.goalColumn,a=t.contentDOM.getBoundingClientRect(),h=t.coordsAtPos(r),c=t.documentTop;if(h)null==l&&(l=h.left-a.left),o=s<0?h.top:h.bottom;else{let e=t.viewState.lineBlockAt(r);null==l&&(l=Math.min(a.right-a.left,t.defaultCharacterWidth*(r-e.from))),o=(s<0?e.top:e.bottom)+c}let u=a.left+l,f=null!=n?n:t.defaultLineHeight>>1;for(let i=0;;i+=10){let n=o+(f+i)*s,h=Yc(t,{x:u,y:n},!1,s);if(n<a.top||n>a.bottom||(s<0?h<r:h>r))return $l.cursor(h,e.assoc,void 0,l)}}(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),Yc(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),r=this.bidiSpans(n);return Ua(i,r[Mc.find(r,t-n.from,-1,e)].dir==wc.LTR==e>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(nc)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>df)return Rc(t.length);let e=this.textDirectionAt(t.from);for(let i of this.bidiCache)if(i.from==t.from&&i.dir==e)return i.order;let i=function(t,e){let i=t.length,n=e==yc?1:2,r=e==yc?2:1;if(!t||1==n&&!Pc.test(t))return Rc(i);for(let e=0,r=n,o=n;e<i;e++){let i=(s=t.charCodeAt(e))<=247?Sc[s]:1424<=s&&s<=1524?2:1536<=s&&s<=1785?Cc[s-1536]:1774<=s&&s<=2220?4:8192<=s&&s<=8203||8204==s?256:1;512==i?i=r:8==i&&4==o&&(i=16),Qc[e]=4==i?2:i,7&i&&(o=i),r=i}var s;for(let t=0,e=n,r=n;t<i;t++){let n=Qc[t];if(128==n)t<i-1&&e==Qc[t+1]&&24&e?n=Qc[t]=e:Qc[t]=256;else if(64==n){let n=t+1;for(;n<i&&64==Qc[n];)n++;let s=t&&8==e||n<i&&8==Qc[n]?1==r?1:8:256;for(let e=t;e<n;e++)Qc[e]=s;t=n-1}else 8==n&&1==r&&(Qc[t]=1);e=n,7&n&&(r=n)}for(let e,s,o,l=0,a=0,h=0;l<i;l++)if(s=Ac[e=t.charCodeAt(l)])if(s<0){for(let t=a-3;t>=0;t-=3)if(Tc[t+1]==-s){let e=Tc[t+2],i=2&e?n:4&e?1&e?r:n:0;i&&(Qc[l]=Qc[Tc[t]]=i),a=t;break}}else{if(189==Tc.length)break;Tc[a++]=l,Tc[a++]=e,Tc[a++]=h}else if(2==(o=Qc[l])||1==o){let t=o==n;h=t?0:1;for(let e=a-3;e>=0;e-=3){let i=Tc[e+2];if(2&i)break;if(t)Tc[e+2]|=2;else{if(4&i)break;Tc[e+2]|=4}}}for(let t=0;t<i;t++)if(256==Qc[t]){let e=t+1;for(;e<i&&256==Qc[e];)e++;let r=1==(t?Qc[t-1]:n),s=r==(1==(e<i?Qc[e]:n))?r?1:2:n;for(let i=t;i<e;i++)Qc[i]=s;t=e-1}let o=[];if(1==n)for(let t=0;t<i;){let e=t,n=1!=Qc[t++];for(;t<i&&n==(1!=Qc[t]);)t++;if(n)for(let i=t;i>e;){let t=i,n=2!=Qc[--i];for(;i>e&&n==(2!=Qc[i-1]);)i--;o.push(new Mc(i,t,n?2:1))}else o.push(new Mc(e,t,0))}else for(let t=0;t<i;){let e=t,n=2==Qc[t++];for(;t<i&&n==(2==Qc[t]);)t++;o.push(new Mc(e,t,n?1:2))}return o}(t.text,e);return this.bidiCache.push(new gf(t.from,t.to,e,i)),i}get hasFocus(){var t;return(document.hasFocus()||kh.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{eh(this.contentDOM),this.docView.updateSelection()}))}destroy(){for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return sc.of(new rc("number"==typeof t?$l.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}static domEventHandlers(t){return cc.define((()=>({})),{eventHandlers:t})}static theme(t,e){let i=Je.newName(),n=[Ku.of(i),bc.of(sf(`.${i}`,t))];return e&&e.dark&&n.push(Ju.of(!0)),n}static baseTheme(t){return Zl.lowest(bc.of(sf("."+tf,t,rf)))}}ff.styleModule=bc,ff.inputHandler=ic,ff.perLineTextDirection=nc,ff.exceptionSink=tc,ff.updateListener=ec,ff.editable=lc,ff.mouseSelectionStyle=Jh,ff.dragMovesSelection=Kh,ff.clickAddsSelectionRange=Yh,ff.decorations=pc,ff.atomicRanges=gc,ff.scrollMargins=mc,ff.darkTheme=Ju,ff.contentAttributes=dc,ff.editorAttributes=fc,ff.lineWrapping=ff.contentAttributes.of({class:"cm-lineWrapping"}),ff.announce=ua.define();const df=4096,pf={};class gf{constructor(t,e,i,n){this.from=t,this.to=e,this.dir=i,this.order=n}static update(t,e){if(e.empty)return t;let i=[],n=t.length?t[t.length-1].dir:wc.LTR;for(let r=Math.max(0,t.length-10);r<t.length;r++){let s=t[r];s.dir!=n||e.touchesRange(s.from,s.to)||i.push(new gf(e.mapPos(s.from,1),e.mapPos(s.to,-1),s.dir,s.order))}return i}}function mf(t,e,i){for(let n=t.state.facet(e),r=n.length-1;r>=0;r--){let e=n[r],s="function"==typeof e?e(t):e;s&&Eh(s,i)}return i}const bf=!kh.ios;const Of={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};bf&&(Of[".cm-line"].caretColor="transparent !important");class vf extends Sa{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}vf.prototype.elementClass="",vf.prototype.toDOM=void 0,vf.prototype.mapMode=xl.TrackBefore,vf.prototype.startSide=vf.prototype.endSide=-1,vf.prototype.point=!0;const wf=1024;let yf=0;class xf{constructor(t,e){this.from=t,this.to=e}}class kf{constructor(t={}){this.id=yf++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=Cf.match(t)),e=>{let i=t(e);return void 0===i?null:[this,i]}}}kf.closedBy=new kf({deserialize:t=>t.split(" ")}),kf.openedBy=new kf({deserialize:t=>t.split(" ")}),kf.group=new kf({deserialize:t=>t.split(" ")}),kf.contextHash=new kf({perNode:!0}),kf.lookAhead=new kf({perNode:!0}),kf.mounted=new kf({perNode:!0});const Sf=Object.create(null);class Cf{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):Sf,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),n=new Cf(t.name||"",e,t.id,i);if(t.props)for(let i of t.props)if(Array.isArray(i)||(i=i(n)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[i[0].id]=i[1]}return n}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop(kf.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return t=>{for(let i=t.prop(kf.group),n=-1;n<(i?i.length:0);n++){let r=e[n<0?t.name:i[n]];if(r)return r}}}}Cf.none=new Cf("",Object.create(null),0,8);const Af=new WeakMap,Tf=new WeakMap;var Pf;!function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"}(Pf||(Pf={}));class Mf{constructor(t,e,i,n,r){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,r&&r.length){this.props=Object.create(null);for(let[t,e]of r)this.props["number"==typeof t?t:t.id]=e}}toString(){let t=this.prop(kf.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let i=t.toString();i&&(e&&(e+=","),e+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new Lf(this.topNode,t)}cursorAt(t,e=0,i=0){let n=Af.get(this)||this.topNode,r=new Lf(n);return r.moveTo(t,e),Af.set(this,r._tree),r}get topNode(){return new Ef(this,0,0,null)}resolve(t,e=0){let i=Df(Af.get(this)||this.topNode,t,e,!1);return Af.set(this,i),i}resolveInner(t,e=0){let i=Df(Tf.get(this)||this.topNode,t,e,!0);return Tf.set(this,i),i}iterate(t){let{enter:e,leave:i,from:n=0,to:r=this.length}=t;for(let s=this.cursor((t.mode||0)|Pf.IncludeAnonymous);;){let t=!1;if(s.from<=r&&s.to>=n&&(s.type.isAnonymous||!1!==e(s))){if(s.firstChild())continue;t=!0}for(;t&&i&&!s.type.isAnonymous&&i(s),!s.nextSibling();){if(!s.parent())return;t=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:qf(Cf.none,this.children,this.positions,0,this.children.length,0,this.length,((t,e,i)=>new Mf(this.type,t,e,i,this.propValues)),t.makeTree||((t,e,i)=>new Mf(Cf.none,t,e,i)))}static build(t){return function(t){var e;let{buffer:i,nodeSet:n,maxBufferLength:r=wf,reused:s=[],minRepeatType:o=n.types.length}=t,l=Array.isArray(i)?new Qf(i,i.length):i,a=n.types,h=0,c=0;function u(t,e,i,b,O){let{id:v,start:w,end:y,size:x}=l,k=c;for(;x<0;){if(l.next(),-1==x){let e=s[v];return i.push(e),void b.push(w-t)}if(-3==x)return void(h=v);if(-4==x)return void(c=v);throw new RangeError(`Unrecognized record size: ${x}`)}let S,C,A=a[v],T=w-t;if(y-w<=r&&(C=g(l.pos-e,O))){let e=new Uint16Array(C.size-C.skip),i=l.pos-C.size,r=e.length;for(;l.pos>i;)r=m(C.start,e,r);S=new Rf(e,y-C.start,n),T=C.start-t}else{let t=l.pos-x;l.next();let e=[],i=[],n=v>=o?v:-1,s=0,a=y;for(;l.pos>t;)n>=0&&l.id==n&&l.size>=0?(l.end<=a-r&&(d(e,i,w,s,l.end,a,n,k),s=e.length,a=l.end),l.next()):u(w,t,e,i,n);if(n>=0&&s>0&&s<e.length&&d(e,i,w,s,w,a,n,k),e.reverse(),i.reverse(),n>-1&&s>0){let t=f(A);S=qf(A,e,i,0,e.length,0,y-w,t,t)}else S=p(A,e,i,y-w,k-y)}i.push(S),b.push(T)}function f(t){return(e,i,n)=>{let r,s,o=0,l=e.length-1;if(l>=0&&(r=e[l])instanceof Mf){if(!l&&r.type==t&&r.length==n)return r;(s=r.prop(kf.lookAhead))&&(o=i[l]+r.length+s)}return p(t,e,i,n,o)}}function d(t,e,i,r,s,o,l,a){let h=[],c=[];for(;t.length>r;)h.push(t.pop()),c.push(e.pop()+i-s);t.push(p(n.types[l],h,c,o-s,a-o)),e.push(s-i)}function p(t,e,i,n,r=0,s){if(h){let t=[kf.contextHash,h];s=s?[t].concat(s):[t]}if(r>25){let t=[kf.lookAhead,r];s=s?[t].concat(s):[t]}return new Mf(t,e,i,n,s)}function g(t,e){let i=l.fork(),n=0,s=0,a=0,h=i.end-r,c={size:0,start:0,skip:0};t:for(let r=i.pos-t;i.pos>r;){let t=i.size;if(i.id==e&&t>=0){c.size=n,c.start=s,c.skip=a,a+=4,n+=4,i.next();continue}let l=i.pos-t;if(t<0||l<r||i.start<h)break;let u=i.id>=o?4:0,f=i.start;for(i.next();i.pos>l;){if(i.size<0){if(-3!=i.size)break t;u+=4}else i.id>=o&&(u+=4);i.next()}s=f,n+=t,a+=u}return(e<0||n==t)&&(c.size=n,c.start=s,c.skip=a),c.size>4?c:void 0}function m(t,e,i){let{id:n,start:r,end:s,size:a}=l;if(l.next(),a>=0&&n<o){let o=i;if(a>4){let n=l.pos-(a-4);for(;l.pos>n;)i=m(t,e,i)}e[--i]=o,e[--i]=s-t,e[--i]=r-t,e[--i]=n}else-3==a?h=n:-4==a&&(c=n);return i}let b=[],O=[];for(;l.pos>0;)u(t.start||0,t.bufferStart||0,b,O,-1);let v=null!==(e=t.length)&&void 0!==e?e:b.length?O[0]+b[0].length:0;return new Mf(a[t.topID],b.reverse(),O.reverse(),v)}(t)}}Mf.empty=new Mf(Cf.none,[],[],0);class Qf{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Qf(this.buffer,this.index)}}class Rf{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return Cf.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],r=n.name;if(/\W/.test(r)&&!n.isError&&(r=JSON.stringify(r)),i==(t+=4))return r;let s=[];for(;t<i;)s.push(this.childString(t)),t=this.buffer[t+3];return r+"("+s.join(",")+")"}findChild(t,e,i,n,r){let{buffer:s}=this,o=-1;for(let l=t;l!=e&&!($f(r,n,s[l+1],s[l+2])&&(o=l,i>0));l=s[l+3]);return o}slice(t,e,i,n){let r=this.buffer,s=new Uint16Array(e-t);for(let n=t,o=0;n<e;)s[o++]=r[n++],s[o++]=r[n++]-i,s[o++]=r[n++]-i,s[o++]=r[n++]-t;return new Rf(s,n-i,this.set)}}function $f(t,e,i,n){switch(t){case-2:return i<e;case-1:return n>=e&&i<e;case 0:return i<e&&n>e;case 1:return i<=e&&n>e;case 2:return n>e;case 4:return!0}}function _f(t,e){let i=t.childBefore(e);for(;i;){let e=i.lastChild;if(!e||e.to!=i.to)break;e.type.isError&&e.from==e.to?(t=i,i=e.prevSibling):i=e}return t}function Df(t,e,i,n){for(var r;t.from==t.to||(i<1?t.from>=e:t.from>e)||(i>-1?t.to<=e:t.to<e);){let e=!n&&t instanceof Ef&&t.index<0?null:t.parent;if(!e)return t;t=e}let s=n?0:Pf.IgnoreOverlays;if(n)for(let n=t,o=n.parent;o;n=o,o=n.parent)n instanceof Ef&&n.index<0&&(null===(r=o.enter(e,i,s))||void 0===r?void 0:r.from)!=n.from&&(t=o);for(;;){let n=t.enter(e,i,s);if(!n)return t;t=n}}class Ef{constructor(t,e,i,n){this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,r=0){for(let s=this;;){for(let{children:o,positions:l}=s._tree,a=e>0?o.length:-1;t!=a;t+=e){let a=o[t],h=l[t]+s.from;if($f(n,i,h,h+a.length))if(a instanceof Rf){if(r&Pf.ExcludeBuffers)continue;let o=a.findChild(0,a.buffer.length,e,i-h,n);if(o>-1)return new zf(new If(s,a,t,h),null,o)}else if(r&Pf.IncludeAnonymous||!a.type.isAnonymous||Wf(a)){let o;if(!(r&Pf.IgnoreMounts)&&a.props&&(o=a.prop(kf.mounted))&&!o.overlay)return new Ef(o.tree,h,t,s);let l=new Ef(a,h,t,s);return r&Pf.IncludeAnonymous||!l.type.isAnonymous?l:l.nextChild(e<0?a.children.length-1:0,e,i,n)}}if(r&Pf.IncludeAnonymous||!s.type.isAnonymous)return null;if(t=s.index>=0?s.index+e:e<0?-1:s._parent._tree.children.length,s=s._parent,!s)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&Pf.IgnoreOverlays)&&(n=this._tree.prop(kf.mounted))&&n.overlay){let i=t-this.from;for(let{from:t,to:r}of n.overlay)if((e>0?t<=i:t<i)&&(e<0?r>=i:r>i))return new Ef(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new Lf(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return Df(this,t,e,!1)}resolveInner(t,e=0){return Df(this,t,e,!0)}enterUnfinishedNodesBefore(t){return _f(this,t)}getChild(t,e=null,i=null){let n=Nf(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return Nf(this,t,e,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return Bf(this,t)}}function Nf(t,e,i,n){let r=t.cursor(),s=[];if(!r.firstChild())return s;if(null!=i)for(;!r.type.is(i);)if(!r.nextSibling())return s;for(;;){if(null!=n&&r.type.is(n))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return null==n?s:[]}}function Bf(t,e,i=e.length-1){for(let n=t.parent;i>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[i]&&e[i]!=n.name)return!1;i--}}return!0}class If{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class zf{constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(t,e,i){let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return r<0?null:new zf(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&Pf.ExcludeBuffers)return null;let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new zf(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new zf(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new zf(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new Lf(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,r=i.buffer[this.index+3];if(r>n){let s=i.buffer[this.index+1],o=i.buffer[this.index+2];t.push(i.slice(n,r,s,o)),e.push(0)}return new Mf(this.type,t,e,this.to-this.from)}resolve(t,e=0){return Df(this,t,e,!1)}resolveInner(t,e=0){return Df(this,t,e,!0)}enterUnfinishedNodesBefore(t){return _f(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let n=Nf(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return Nf(this,t,e,i)}get node(){return this}matchContext(t){return Bf(this,t)}}class Lf{constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof Ef)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}get name(){return this.type.name}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return!!t&&(t instanceof Ef?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?!(i&Pf.ExcludeBuffers)&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Pf.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&Pf.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let t=i<0?0:this.stack[i]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(t)}return i<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(n.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;({index:e,_parent:i}=i))if(e>-1)for(let n=e+t,r=t<0?-1:i._tree.children.length;n!=r;n+=t){let t=i._tree.children[n];if(this.mode&Pf.IncludeAnonymous||t instanceof Rf||!t.type.isAnonymous||Wf(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,r=this.stack.length;r>=0;){for(let s=t;s;s=s._parent)if(s.index==n){if(n==this.index)return s;e=s,i=r+1;break t}n=this.stack[--r]}for(let t=i;t<this.stack.length;t++)e=new zf(this.buffer,e,this.stack[t]);return this.bufferNode=new zf(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||!1!==t(this)){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;n&&e&&e(this),n=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return Bf(this.node,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,r=this.stack.length-1;n>=0;r--){if(r<0)return Bf(this.node,t,n);let s=i[e.buffer[this.stack[r]]];if(!s.isAnonymous){if(t[n]&&t[n]!=s.name)return!1;n--}}return!0}}function Wf(t){return t.children.some((t=>t instanceof Rf||!t.type.isAnonymous||Wf(t)))}const Vf=new WeakMap;function jf(t,e){if(!t.isAnonymous||e instanceof Rf||e.type!=t)return 1;let i=Vf.get(e);if(null==i){i=1;for(let n of e.children){if(n.type!=t||!(n instanceof Mf)){i=1;break}i+=jf(t,n)}Vf.set(e,i)}return i}function qf(t,e,i,n,r,s,o,l,a){let h=0;for(let i=n;i<r;i++)h+=jf(t,e[i]);let c=Math.ceil(1.5*h/8),u=[],f=[];return function e(i,n,r,o,l){for(let h=r;h<o;){let r=h,d=n[h],p=jf(t,i[h]);for(h++;h<o;h++){let e=jf(t,i[h]);if(p+e>=c)break;p+=e}if(h==r+1){if(p>c){let t=i[r];e(t.children,t.positions,0,t.children.length,n[r]+l);continue}u.push(i[r])}else{let e=n[h-1]+i[h-1].length-d;u.push(qf(t,i,n,r,h,d,e,null,a))}f.push(d+l-s)}}(e,i,n,r,0),(l||a)(u,f,o)}class Hf{constructor(t,e,i,n,r=!1,s=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(r?1:0)|(s?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(t,e=[],i=!1){let n=[new Hf(0,t.length,t,0,!1,i)];for(let i of e)i.to>t.length&&n.push(i);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],r=1,s=t.length?t[0]:null;for(let o=0,l=0,a=0;;o++){let h=o<e.length?e[o]:null,c=h?h.fromA:1e9;if(c-l>=i)for(;s&&s.from<c;){let e=s;if(l>=e.from||c<=e.to||a){let t=Math.max(e.from,l)-a,i=Math.min(e.to,c)-a;e=t>=i?null:new Hf(t,i,e.tree,e.offset+a,o>0,!!h)}if(e&&n.push(e),s.to>c)break;s=r<t.length?t[r++]:null}if(!h)break;l=h.toA,a=h.toA-h.toB}return n}}class Xf{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new kf({perNode:!0});class Ff{constructor(){}lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,i){let n=[];return this.decompose(0,t,n,2),i.length&&i.decompose(0,i.length,n,3),this.decompose(e,this.length,n,1),Gf.from(n,this.length-(e-t)+i.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){let i=[];return this.decompose(t,e,i,0),Gf.from(i,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),i=this.length-this.scanIdentical(t,-1),n=new Kf(this),r=new Kf(t);for(let t=e,s=e;;){if(n.next(t),r.next(t),t=0,n.lineBreak!=r.lineBreak||n.done!=r.done||n.value!=r.value)return!1;if(s+=n.value.length,n.done||s>=i)return!0}}iter(t=1){return new Kf(this,t)}iterRange(t,e=this.length){return new Jf(this,t,e)}iterLines(t,e){let i;if(null==t)i=this.iter();else{null==e&&(e=this.lines+1);let n=this.line(t).from;i=this.iterRange(n,Math.max(n,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new td(i)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}static of(t){if(0==t.length)throw new RangeError("A document must have at least one line");return 1!=t.length||t[0]?t.length<=32?new Zf(t):Gf.from(Zf.split(t,[])):Ff.empty}}class Zf extends Ff{constructor(t,e=function(t){let e=-1;for(let i of t)e+=i.length+1;return e}(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,i,n){for(let r=0;;r++){let s=this.text[r],o=n+s.length;if((e?i:o)>=t)return new ed(n,o,i,s);n=o+1,i++}}decompose(t,e,i,n){let r=t<=0&&e>=this.length?this:new Zf(Yf(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(1&n){let t=i.pop(),e=Uf(r.text,t.text.slice(),0,r.length);if(e.length<=32)i.push(new Zf(e,t.length+r.length));else{let t=e.length>>1;i.push(new Zf(e.slice(0,t)),new Zf(e.slice(t)))}}else i.push(r)}replace(t,e,i){if(!(i instanceof Zf))return super.replace(t,e,i);let n=Uf(this.text,Uf(i.text,Yf(this.text,0,t)),e),r=this.length+i.length-(e-t);return n.length<=32?new Zf(n,r):Gf.from(Zf.split(n,[]),r)}sliceString(t,e=this.length,i="\n"){let n="";for(let r=0,s=0;r<=e&&s<this.text.length;s++){let o=this.text[s],l=r+o.length;r>t&&s&&(n+=i),t<l&&e>r&&(n+=o.slice(Math.max(0,t-r),e-r)),r=l+1}return n}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let i=[],n=-1;for(let r of t)i.push(r),n+=r.length+1,32==i.length&&(e.push(new Zf(i,n)),i=[],n=-1);return n>-1&&e.push(new Zf(i,n)),e}}class Gf extends Ff{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let e of t)this.lines+=e.lines}lineInner(t,e,i,n){for(let r=0;;r++){let s=this.children[r],o=n+s.length,l=i+s.lines-1;if((e?l:o)>=t)return s.lineInner(t,e,i,n);n=o+1,i=l+1}}decompose(t,e,i,n){for(let r=0,s=0;s<=e&&r<this.children.length;r++){let o=this.children[r],l=s+o.length;if(t<=l&&e>=s){let r=n&((s<=t?1:0)|(l>=e?2:0));s>=t&&l<=e&&!r?i.push(o):o.decompose(t-s,e-s,i,r)}s=l+1}}replace(t,e,i){if(i.lines<this.lines)for(let n=0,r=0;n<this.children.length;n++){let s=this.children[n],o=r+s.length;if(t>=r&&e<=o){let l=s.replace(t-r,e-r,i),a=this.lines-s.lines+l.lines;if(l.lines<a>>4&&l.lines>a>>6){let r=this.children.slice();return r[n]=l,new Gf(r,this.length-(e-t)+i.length)}return super.replace(r,o,l)}r=o+1}return super.replace(t,e,i)}sliceString(t,e=this.length,i="\n"){let n="";for(let r=0,s=0;r<this.children.length&&s<=e;r++){let o=this.children[r],l=s+o.length;s>t&&r&&(n+=i),t<l&&e>s&&(n+=o.sliceString(t-s,e-s,i)),s=l+1}return n}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof Gf))return 0;let i=0,[n,r,s,o]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;n+=e,r+=e){if(n==s||r==o)return i;let l=this.children[n],a=t.children[r];if(l!=a)return i+l.scanIdentical(a,e);i+=l.length+1}}static from(t,e=t.reduce(((t,e)=>t+e.length+1),-1)){let i=0;for(let e of t)i+=e.lines;if(i<32){let i=[];for(let e of t)e.flatten(i);return new Zf(i,e)}let n=Math.max(32,i>>5),r=n<<1,s=n>>1,o=[],l=0,a=-1,h=[];function c(t){let e;if(t.lines>r&&t instanceof Gf)for(let e of t.children)c(e);else t.lines>s&&(l>s||!l)?(u(),o.push(t)):t instanceof Zf&&l&&(e=h[h.length-1])instanceof Zf&&t.lines+e.lines<=32?(l+=t.lines,a+=t.length+1,h[h.length-1]=new Zf(e.text.concat(t.text),e.length+1+t.length)):(l+t.lines>n&&u(),l+=t.lines,a+=t.length+1,h.push(t))}function u(){0!=l&&(o.push(1==h.length?h[0]:Gf.from(h,a)),a=-1,l=h.length=0)}for(let e of t)c(e);return u(),1==o.length?o[0]:new Gf(o,e)}}function Uf(t,e,i=0,n=1e9){for(let r=0,s=0,o=!0;s<t.length&&r<=n;s++){let l=t[s],a=r+l.length;a>=i&&(a>n&&(l=l.slice(0,n-r)),r<i&&(l=l.slice(i-r)),o?(e[e.length-1]+=l,o=!1):e.push(l)),r=a+1}return e}function Yf(t,e,i){return Uf(t,[""],e,i)}Ff.empty=new Zf([""],0);class Kf{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof Zf?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,n=this.nodes[i],r=this.offsets[i],s=r>>1,o=n instanceof Zf?n.text.length:n.children.length;if(s==(e>0?o:0)){if(0==i)return this.done=!0,this.value="",this;e>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&r)==(e>0?0:1)){if(this.offsets[i]+=e,0==t)return this.lineBreak=!0,this.value="\n",this;t--}else if(n instanceof Zf){let r=n.text[s+(e<0?-1:0)];if(this.offsets[i]+=e,r.length>Math.max(0,t))return this.value=0==t?r:e>0?r.slice(t):r.slice(0,r.length-t),this;t-=r.length}else{let r=n.children[s+(e<0?-1:0)];t>r.length?(t-=r.length,this.offsets[i]+=e):(e<0&&this.offsets[i]--,this.nodes.push(r),this.offsets.push(e>0?1:(r instanceof Zf?r.text.length:r.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class Jf{constructor(t,e,i){this.value="",this.done=!1,this.cursor=new Kf(t,e>i?-1:1),this.pos=e>i?t.length:0,this.from=Math.min(e,i),this.to=Math.max(e,i)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let i=e<0?this.pos-this.from:this.to-this.pos;t>i&&(t=i),i-=t;let{value:n}=this.cursor.next(t);return this.pos+=(n.length+t)*e,this.value=n.length<=i?n:e<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class td{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:i,value:n}=this.inner.next(t);return e?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(Ff.prototype[Symbol.iterator]=function(){return this.iter()},Kf.prototype[Symbol.iterator]=Jf.prototype[Symbol.iterator]=td.prototype[Symbol.iterator]=function(){return this});class ed{constructor(t,e,i,n){this.from=t,this.to=e,this.number=i,this.text=n}get length(){return this.to-this.from}}let id="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((t=>t?parseInt(t,36):1));for(let t=1;t<id.length;t++)id[t]+=id[t-1];function nd(t){for(let e=1;e<id.length;e+=2)if(id[e]>t)return id[e-1]<=t;return!1}function rd(t){return t>=127462&&t<=127487}function sd(t,e,i=!0,n=!0){return(i?od:ld)(t,e,n)}function od(t,e,i){if(e==t.length)return e;e&&ad(t.charCodeAt(e))&&hd(t.charCodeAt(e-1))&&e--;let n=cd(t,e);for(e+=ud(n);e<t.length;){let r=cd(t,e);if(8205==n||8205==r||i&&nd(r))e+=ud(r),n=r;else{if(!rd(r))break;{let i=0,n=e-2;for(;n>=0&&rd(cd(t,n));)i++,n-=2;if(i%2==0)break;e+=2}}}return e}function ld(t,e,i){for(;e>0;){let n=od(t,e-2,i);if(n<e)return n;e--}return 0}function ad(t){return t>=56320&&t<57344}function hd(t){return t>=55296&&t<56320}function cd(t,e){let i=t.charCodeAt(e);if(!hd(i)||e+1==t.length)return i;let n=t.charCodeAt(e+1);return ad(n)?n-56320+(i-55296<<10)+65536:i}function ud(t){return t<65536?1:2}const fd=/\r\n?|\n/;var dd=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(dd||(dd={}));class pd{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e+1];t+=i<0?this.sections[e]:i}return t}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(t){for(let e=0,i=0,n=0;e<this.sections.length;){let r=this.sections[e++],s=this.sections[e++];s<0?(t(i,n,r),n+=r):n+=s,i+=r}}iterChangedRanges(t,e=!1){Od(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];n<0?t.push(i,n):t.push(n,i)}return new pd(t)}composeDesc(t){return this.empty?t:t.empty?this:wd(this,t)}mapDesc(t,e=!1){return t.empty?this:vd(this,t,e)}mapPos(t,e=-1,i=dd.Simple){let n=0,r=0;for(let s=0;s<this.sections.length;){let o=this.sections[s++],l=this.sections[s++],a=n+o;if(l<0){if(a>t)return r+(t-n);r+=o}else{if(i!=dd.Simple&&a>=t&&(i==dd.TrackDel&&n<t&&a>t||i==dd.TrackBefore&&n<t||i==dd.TrackAfter&&a>t))return null;if(a>t||a==t&&e<0&&!o)return t==n||e<0?r:r+l;r+=l}n=a}if(t>n)throw new RangeError(`Position ${t} is out of range for changeset of length ${n}`);return r}touchesRange(t,e=t){for(let i=0,n=0;i<this.sections.length&&n<=e;){let r=n+this.sections[i++];if(this.sections[i++]>=0&&n<=e&&r>=t)return!(n<t&&r>e)||"cover";n=r}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+i+(n>=0?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some((t=>"number"!=typeof t)))throw new RangeError("Invalid JSON representation of ChangeDesc");return new pd(t)}static create(t){return new pd(t)}}class gd extends pd{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return Od(this,((e,i,n,r,s)=>t=t.replace(n,n+(i-e),s)),!1),t}mapDesc(t,e=!1){return vd(this,t,e,!0)}invert(t){let e=this.sections.slice(),i=[];for(let n=0,r=0;n<e.length;n+=2){let s=e[n],o=e[n+1];if(o>=0){e[n]=o,e[n+1]=s;let l=n>>1;for(;i.length<l;)i.push(Ff.empty);i.push(s?t.slice(r,r+s):Ff.empty)}r+=s}return new gd(e,i)}compose(t){return this.empty?t:t.empty?this:wd(this,t,!0)}map(t,e=!1){return t.empty?this:vd(this,t,e,!0)}iterChanges(t,e=!1){Od(this,t,e)}get desc(){return pd.create(this.sections)}filter(t){let e=[],i=[],n=[],r=new yd(this);t:for(let s=0,o=0;;){let l=s==t.length?1e9:t[s++];for(;o<l||o==l&&0==r.len;){if(r.done)break t;let t=Math.min(r.len,l-o);md(n,t,-1);let s=-1==r.ins?-1:0==r.off?r.ins:0;md(e,t,s),s>0&&bd(i,e,r.text),r.forward(t),o+=t}let a=t[s++];for(;o<a;){if(r.done)break t;let t=Math.min(r.len,a-o);md(e,t,-1),md(n,t,-1==r.ins?-1:0==r.off?r.ins:0),r.forward(t),o+=t}}return{changes:new gd(e,i),filtered:pd.create(n)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e],n=this.sections[e+1];n<0?t.push(i):0==n?t.push([i]):t.push([i].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,i){let n=[],r=[],s=0,o=null;function l(t=!1){if(!t&&!n.length)return;s<e&&md(n,e-s,-1);let i=new gd(n,r);o=o?o.compose(i.map(o)):i,n=[],r=[],s=0}return function t(a){if(Array.isArray(a))for(let e of a)t(e);else if(a instanceof gd){if(a.length!=e)throw new RangeError(`Mismatched change set length (got ${a.length}, expected ${e})`);l(),o=o?o.compose(a.map(o)):a}else{let{from:t,to:o=t,insert:h}=a;if(t>o||t<0||o>e)throw new RangeError(`Invalid change range ${t} to ${o} (in doc of length ${e})`);let c=h?"string"==typeof h?Ff.of(h.split(i||fd)):h:Ff.empty,u=c.length;if(t==o&&0==u)return;t<s&&l(),t>s&&md(n,t-s,-1),md(n,o-t,u),bd(r,n,c),s=o}}(t),l(!o),o}static empty(t){return new gd(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],i=[];for(let n=0;n<t.length;n++){let r=t[n];if("number"==typeof r)e.push(r,-1);else{if(!Array.isArray(r)||"number"!=typeof r[0]||r.some(((t,e)=>e&&"string"!=typeof t)))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==r.length)e.push(r[0],0);else{for(;i.length<n;)i.push(Ff.empty);i[n]=Ff.of(r.slice(1)),e.push(r[0],i[n].length)}}}return new gd(e,i)}static createSet(t,e){return new gd(t,e)}}function md(t,e,i,n=!1){if(0==e&&i<=0)return;let r=t.length-2;r>=0&&i<=0&&i==t[r+1]?t[r]+=e:0==e&&0==t[r]?t[r+1]+=i:n?(t[r]+=e,t[r+1]+=i):t.push(e,i)}function bd(t,e,i){if(0==i.length)return;let n=e.length-2>>1;if(n<t.length)t[t.length-1]=t[t.length-1].append(i);else{for(;t.length<n;)t.push(Ff.empty);t.push(i)}}function Od(t,e,i){let n=t.inserted;for(let r=0,s=0,o=0;o<t.sections.length;){let l=t.sections[o++],a=t.sections[o++];if(a<0)r+=l,s+=l;else{let h=r,c=s,u=Ff.empty;for(;h+=l,c+=a,a&&n&&(u=u.append(n[o-2>>1])),!(i||o==t.sections.length||t.sections[o+1]<0);)l=t.sections[o++],a=t.sections[o++];e(r,h,s,c,u),r=h,s=c}}}function vd(t,e,i,n=!1){let r=[],s=n?[]:null,o=new yd(t),l=new yd(e);for(let t=0,e=0;;)if(-1==o.ins)t+=o.len,o.next();else if(-1==l.ins&&e<t){let i=Math.min(l.len,t-e);l.forward(i),md(r,i,-1),e+=i}else if(l.ins>=0&&(o.done||e<t||e==t&&(l.len<o.len||l.len==o.len&&!i))){for(md(r,l.ins,-1);t>e&&!o.done&&t+o.len<e+l.len;)t+=o.len,o.next();e+=l.len,l.next()}else{if(!(o.ins>=0)){if(o.done&&l.done)return s?gd.createSet(r,s):pd.create(r);throw new Error("Mismatched change set lengths")}{let i=0,n=t+o.len;for(;;)if(l.ins>=0&&e>t&&e+l.len<n)i+=l.ins,e+=l.len,l.next();else{if(!(-1==l.ins&&e<n))break;{let t=Math.min(l.len,n-e);i+=t,l.forward(t),e+=t}}md(r,i,o.ins),s&&bd(s,r,o.text),t=n,o.next()}}}function wd(t,e,i=!1){let n=[],r=i?[]:null,s=new yd(t),o=new yd(e);for(let t=!1;;){if(s.done&&o.done)return r?gd.createSet(n,r):pd.create(n);if(0==s.ins)md(n,s.len,0,t),s.next();else if(0!=o.len||o.done){if(s.done||o.done)throw new Error("Mismatched change set lengths");{let e=Math.min(s.len2,o.len),i=n.length;if(-1==s.ins){let i=-1==o.ins?-1:o.off?0:o.ins;md(n,e,i,t),r&&i&&bd(r,n,o.text)}else-1==o.ins?(md(n,s.off?0:s.len,e,t),r&&bd(r,n,s.textBit(e))):(md(n,s.off?0:s.len,o.off?0:o.ins,t),r&&!o.off&&bd(r,n,o.text));t=(s.ins>e||o.ins>=0&&o.len>e)&&(t||n.length>i),s.forward2(e),o.forward(e)}}else md(n,0,o.ins,t),r&&bd(r,n,o.text),o.next()}}class yd{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?Ff.empty:t[e]}textBit(t){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length&&!t?Ff.empty:e[i].slice(this.off,null==t?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){-1==this.ins?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class xd{constructor(t,e,i){this.from=t,this.to=e,this.flags=i}get anchor(){return 16&this.flags?this.to:this.from}get head(){return 16&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 4&this.flags?-1:8&this.flags?1:0}get bidiLevel(){let t=3&this.flags;return 3==t?null:t}get goalColumn(){let t=this.flags>>5;return 33554431==t?void 0:t}map(t,e=-1){let i,n;return this.empty?i=n=t.mapPos(this.from,e):(i=t.mapPos(this.from,1),n=t.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new xd(i,n,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return kd.range(t,e);let i=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return kd.range(this.anchor,i)}eq(t){return this.anchor==t.anchor&&this.head==t.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||"number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid JSON representation for SelectionRange");return kd.range(t.anchor,t.head)}static create(t,e,i){return new xd(t,e,i)}}class kd{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:kd.create(this.ranges.map((i=>i.map(t,e))),this.mainIndex)}eq(t){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let e=0;e<this.ranges.length;e++)if(!this.ranges[e].eq(t.ranges[e]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new kd([this.main],0)}addRange(t,e=!0){return kd.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let i=this.ranges.slice();return i[e]=t,kd.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map((t=>t.toJSON())),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||"number"!=typeof t.main||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new kd(t.ranges.map((t=>xd.fromJSON(t))),t.main)}static single(t,e=t){return new kd([kd.range(t,e)],0)}static create(t,e=0){if(0==t.length)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<t.length;n++){let r=t[n];if(r.empty?r.from<=i:r.from<i)return kd.normalized(t.slice(),e);i=r.to}return new kd(t,e)}static cursor(t,e=0,i,n){return xd.create(t,t,(0==e?0:e<0?4:8)|(null==i?3:Math.min(2,i))|(null!=n?n:33554431)<<5)}static range(t,e,i){let n=(null!=i?i:33554431)<<5;return e<t?xd.create(e,t,24|n):xd.create(t,e,n|(e>t?4:0))}static normalized(t,e=0){let i=t[e];t.sort(((t,e)=>t.from-e.from)),e=t.indexOf(i);for(let i=1;i<t.length;i++){let n=t[i],r=t[i-1];if(n.empty?n.from<=r.to:n.from<r.to){let s=r.from,o=Math.max(n.to,r.to);i<=e&&e--,t.splice(--i,2,n.anchor>n.head?kd.range(o,s):kd.range(s,o))}}return new kd(t,e)}}function Sd(t,e){for(let i of t.ranges)if(i.to>e)throw new RangeError("Selection points outside of document")}let Cd=0;class Ad{constructor(t,e,i,n,r){this.combine=t,this.compareInput=e,this.compare=i,this.isStatic=n,this.extensions=r,this.id=Cd++,this.default=t([])}static define(t={}){return new Ad(t.combine||(t=>t),t.compareInput||((t,e)=>t===e),t.compare||(t.combine?(t,e)=>t===e:Td),!!t.static,t.enables)}of(t){return new Pd([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Pd(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Pd(t,this,2,e)}from(t,e){return e||(e=t=>t),this.compute([t],(i=>e(i.field(t))))}}function Td(t,e){return t==e||t.length==e.length&&t.every(((t,i)=>t===e[i]))}class Pd{constructor(t,e,i,n){this.dependencies=t,this.facet=e,this.type=i,this.value=n,this.id=Cd++}dynamicSlot(t){var e;let i=this.value,n=this.facet.compareInput,r=this.id,s=t[r]>>1,o=2==this.type,l=!1,a=!1,h=[];for(let i of this.dependencies)"doc"==i?l=!0:"selection"==i?a=!0:0==(1&(null!==(e=t[i.id])&&void 0!==e?e:1))&&h.push(t[i.id]);return{create:t=>(t.values[s]=i(t),1),update(t,e){if(l&&e.docChanged||a&&(e.docChanged||e.selection)||Qd(t,h)){let e=i(t);if(o?!Md(e,t.values[s],n):!n(e,t.values[s]))return t.values[s]=e,1}return 0},reconfigure:(t,e)=>{let l=i(t),a=e.config.address[r];if(null!=a){let i=Hd(e,a);if(this.dependencies.every((i=>i instanceof Ad?e.facet(i)===t.facet(i):!(i instanceof _d)||e.field(i,!1)==t.field(i,!1)))||(o?Md(l,i,n):n(l,i)))return t.values[s]=i,0}return t.values[s]=l,1}}}}function Md(t,e,i){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1;return!0}function Qd(t,e){let i=!1;for(let n of e)1&qd(t,n)&&(i=!0);return i}function Rd(t,e,i){let n=i.map((e=>t[e.id])),r=i.map((t=>t.type)),s=n.filter((t=>!(1&t))),o=t[e.id]>>1;function l(t){let i=[];for(let e=0;e<n.length;e++){let s=Hd(t,n[e]);if(2==r[e])for(let t of s)i.push(t);else i.push(s)}return e.combine(i)}return{create(t){for(let e of n)qd(t,e);return t.values[o]=l(t),1},update(t,i){if(!Qd(t,s))return 0;let n=l(t);return e.compare(n,t.values[o])?0:(t.values[o]=n,1)},reconfigure(t,r){let s=Qd(t,n),a=r.config.facets[e.id],h=r.facet(e);if(a&&!s&&Td(i,a))return t.values[o]=h,0;let c=l(t);return e.compare(c,h)?(t.values[o]=h,0):(t.values[o]=c,1)}}}const $d=Ad.define({static:!0});class _d{constructor(t,e,i,n,r){this.id=t,this.createF=e,this.updateF=i,this.compareF=n,this.spec=r,this.provides=void 0}static define(t){let e=new _d(Cd++,t.create,t.update,t.compare||((t,e)=>t===e),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet($d).find((t=>t.field==this));return((null==e?void 0:e.create)||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:t=>(t.values[e]=this.create(t),1),update:(t,i)=>{let n=t.values[e],r=this.updateF(n,i);return this.compareF(n,r)?0:(t.values[e]=r,1)},reconfigure:(t,i)=>null!=i.config.address[this.id]?(t.values[e]=i.field(this),0):(t.values[e]=this.create(t),1)}}init(t){return[this,$d.of({field:this,create:t})]}get extension(){return this}}const Dd=4,Ed=3,Nd=2,Bd=1;function Id(t){return e=>new Ld(e,t)}const zd={highest:Id(0),high:Id(Bd),default:Id(Nd),low:Id(Ed),lowest:Id(Dd)};class Ld{constructor(t,e){this.inner=t,this.prec=e}}class Wd{of(t){return new Vd(this,t)}reconfigure(t){return Wd.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class Vd{constructor(t,e){this.compartment=t,this.inner=e}}class jd{constructor(t,e,i,n,r,s){for(this.base=t,this.compartments=e,this.dynamicSlots=i,this.address=n,this.staticValues=r,this.facets=s,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return null==e?t.default:this.staticValues[e>>1]}static resolve(t,e,i){let n=[],r=Object.create(null),s=new Map;for(let i of function(t,e,i){let n=[[],[],[],[],[]],r=new Map;function s(t,o){let l=r.get(t);if(null!=l){if(l<=o)return;let e=n[l].indexOf(t);e>-1&&n[l].splice(e,1),t instanceof Vd&&i.delete(t.compartment)}if(r.set(t,o),Array.isArray(t))for(let e of t)s(e,o);else if(t instanceof Vd){if(i.has(t.compartment))throw new RangeError("Duplicate use of compartment in extensions");let n=e.get(t.compartment)||t.inner;i.set(t.compartment,n),s(n,o)}else if(t instanceof Ld)s(t.inner,t.prec);else if(t instanceof _d)n[o].push(t),t.provides&&s(t.provides,o);else if(t instanceof Pd)n[o].push(t),t.facet.extensions&&s(t.facet.extensions,o);else{let e=t.extension;if(!e)throw new Error(`Unrecognized extension value in extension set (${t}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(e,o)}}return s(t,Nd),n.reduce(((t,e)=>t.concat(e)))}(t,e,s))i instanceof _d?n.push(i):(r[i.facet.id]||(r[i.facet.id]=[])).push(i);let o=Object.create(null),l=[],a=[];for(let t of n)o[t.id]=a.length<<1,a.push((e=>t.slot(e)));let h=null==i?void 0:i.config.facets;for(let t in r){let e=r[t],n=e[0].facet,s=h&&h[t]||[];if(e.every((t=>0==t.type)))if(o[n.id]=l.length<<1|1,Td(s,e))l.push(i.facet(n));else{let t=n.combine(e.map((t=>t.value)));l.push(i&&n.compare(t,i.facet(n))?i.facet(n):t)}else{for(let t of e)0==t.type?(o[t.id]=l.length<<1|1,l.push(t.value)):(o[t.id]=a.length<<1,a.push((e=>t.dynamicSlot(e))));o[n.id]=a.length<<1,a.push((t=>Rd(t,n,e)))}}let c=a.map((t=>t(o)));return new jd(t,s,c,o,l,r)}}function qd(t,e){if(1&e)return 2;let i=e>>1,n=t.status[i];if(4==n)throw new Error("Cyclic dependency between fields and/or facets");if(2&n)return n;t.status[i]=4;let r=t.computeSlot(t,t.config.dynamicSlots[i]);return t.status[i]=2|r}function Hd(t,e){return 1&e?t.config.staticValues[e>>1]:t.values[e>>1]}const Xd=Ad.define(),Fd=Ad.define({combine:t=>t.some((t=>t)),static:!0}),Zd=Ad.define({combine:t=>t.length?t[0]:void 0,static:!0}),Gd=Ad.define(),Ud=Ad.define(),Yd=Ad.define(),Kd=Ad.define({combine:t=>!!t.length&&t[0]});class Jd{constructor(t,e){this.type=t,this.value=e}static define(){return new tp}}class tp{of(t){return new Jd(this,t)}}class ep{constructor(t){this.map=t}of(t){return new ip(this,t)}}class ip{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return void 0===e?void 0:e==this.value?this:new ip(this.type,e)}is(t){return this.type==t}static define(t={}){return new ep(t.map||(t=>t))}static mapEffects(t,e){if(!t.length)return t;let i=[];for(let n of t){let t=n.map(e);t&&i.push(t)}return i}}ip.reconfigure=ip.define(),ip.appendConfig=ip.define();class np{constructor(t,e,i,n,r,s){this.startState=t,this.changes=e,this.selection=i,this.effects=n,this.annotations=r,this.scrollIntoView=s,this._doc=null,this._state=null,i&&Sd(i,e.newLength),r.some((t=>t.type==np.time))||(this.annotations=r.concat(np.time.of(Date.now())))}static create(t,e,i,n,r,s){return new np(t,e,i,n,r,s)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(np.userEvent);return!(!e||!(e==t||e.length>t.length&&e.slice(0,t.length)==t&&"."==e[t.length]))}}function rp(t,e){let i=[];for(let n=0,r=0;;){let s,o;if(n<t.length&&(r==e.length||e[r]>=t[n]))s=t[n++],o=t[n++];else{if(!(r<e.length))return i;s=e[r++],o=e[r++]}!i.length||i[i.length-1]<s?i.push(s,o):i[i.length-1]<o&&(i[i.length-1]=o)}}function sp(t,e,i){var n;let r,s,o;return i?(r=e.changes,s=gd.empty(e.changes.length),o=t.changes.compose(e.changes)):(r=e.changes.map(t.changes),s=t.changes.mapDesc(e.changes,!0),o=t.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):null===(n=t.selection)||void 0===n?void 0:n.map(r),effects:ip.mapEffects(t.effects,r).concat(ip.mapEffects(e.effects,s)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function op(t,e,i){let n=e.selection,r=hp(e.annotations);return e.userEvent&&(r=r.concat(np.userEvent.of(e.userEvent))),{changes:e.changes instanceof gd?e.changes:gd.of(e.changes||[],i,t.facet(Zd)),selection:n&&(n instanceof kd?n:kd.single(n.anchor,n.head)),effects:hp(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function lp(t,e,i){let n=op(t,e.length?e[0]:{},t.doc.length);e.length&&!1===e[0].filter&&(i=!1);for(let r=1;r<e.length;r++){!1===e[r].filter&&(i=!1);let s=!!e[r].sequential;n=sp(n,op(t,e[r],s?n.changes.newLength:t.doc.length),s)}let r=np.create(t,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return function(t){let e=t.startState,i=e.facet(Yd),n=t;for(let r=i.length-1;r>=0;r--){let s=i[r](t);s&&Object.keys(s).length&&(n=sp(t,op(e,s,t.changes.newLength),!0))}return n==t?t:np.create(e,t.changes,t.selection,n.effects,n.annotations,n.scrollIntoView)}(i?function(t){let e=t.startState,i=!0;for(let n of e.facet(Gd)){let e=n(t);if(!1===e){i=!1;break}Array.isArray(e)&&(i=!0===i?e:rp(i,e))}if(!0!==i){let n,r;if(!1===i)r=t.changes.invertedDesc,n=gd.empty(e.doc.length);else{let e=t.changes.filter(i);n=e.changes,r=e.filtered.invertedDesc}t=np.create(e,n,t.selection&&t.selection.map(r),ip.mapEffects(t.effects,r),t.annotations,t.scrollIntoView)}let n=e.facet(Ud);for(let i=n.length-1;i>=0;i--){let r=n[i](t);t=r instanceof np?r:Array.isArray(r)&&1==r.length&&r[0]instanceof np?r[0]:lp(e,hp(r),!1)}return t}(r):r)}np.time=Jd.define(),np.userEvent=Jd.define(),np.addToHistory=Jd.define(),np.remote=Jd.define();const ap=[];function hp(t){return null==t?ap:Array.isArray(t)?t:[t]}var cp=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(cp||(cp={}));const up=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let fp;try{fp=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(t){}function dp(t){return e=>{if(!/\S/.test(e))return cp.Space;if(function(t){if(fp)return fp.test(t);for(let e=0;e<t.length;e++){let i=t[e];if(/\w/.test(i)||i>""&&(i.toUpperCase()!=i.toLowerCase()||up.test(i)))return!0}return!1}(e))return cp.Word;for(let i=0;i<t.length;i++)if(e.indexOf(t[i])>-1)return cp.Word;return cp.Other}}class pp{constructor(t,e,i,n,r,s){this.config=t,this.doc=e,this.selection=i,this.values=n,this.status=t.statusTemplate.slice(),this.computeSlot=r,s&&(s._state=this);for(let t=0;t<this.config.dynamicSlots.length;t++)qd(this,t<<1);this.computeSlot=null}field(t,e=!0){let i=this.config.address[t.id];if(null!=i)return qd(this,i),Hd(this,i);if(e)throw new RangeError("Field is not present in this state")}update(...t){return lp(this,t,!0)}applyTransaction(t){let e,i=this.config,{base:n,compartments:r}=i;for(let e of t.effects)e.is(Wd.reconfigure)?(i&&(r=new Map,i.compartments.forEach(((t,e)=>r.set(e,t))),i=null),r.set(e.value.compartment,e.value.extension)):e.is(ip.reconfigure)?(i=null,n=e.value):e.is(ip.appendConfig)&&(i=null,n=hp(n).concat(e.value));if(i)e=t.startState.values.slice();else{i=jd.resolve(n,r,this);let t=new pp(i,this.doc,this.selection,i.dynamicSlots.map((()=>null)),((t,e)=>e.reconfigure(t,this)),null);e=t.values}new pp(i,t.newDoc,t.newSelection,e,((e,i)=>i.update(e,t)),t)}replaceSelection(t){return"string"==typeof t&&(t=this.toText(t)),this.changeByRange((e=>({changes:{from:e.from,to:e.to,insert:t},range:kd.cursor(e.from+t.length)})))}changeByRange(t){let e=this.selection,i=t(e.ranges[0]),n=this.changes(i.changes),r=[i.range],s=hp(i.effects);for(let i=1;i<e.ranges.length;i++){let o=t(e.ranges[i]),l=this.changes(o.changes),a=l.map(n);for(let t=0;t<i;t++)r[t]=r[t].map(a);let h=n.mapDesc(l,!0);r.push(o.range.map(h)),n=n.compose(a),s=ip.mapEffects(s,a).concat(ip.mapEffects(hp(o.effects),h))}return{changes:n,selection:kd.create(r,e.mainIndex),effects:s}}changes(t=[]){return t instanceof gd?t:gd.of(t,this.doc.length,this.facet(pp.lineSeparator))}toText(t){return Ff.of(t.split(this.facet(pp.lineSeparator)||fd))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return null==e?t.default:(qd(this,e),Hd(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let i in t){let n=t[i];n instanceof _d&&(e[i]=n.spec.toJSON(this.field(t[i]),this))}return e}static fromJSON(t,e={},i){if(!t||"string"!=typeof t.doc)throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i)for(let e in i){let r=i[e],s=t[e];n.push(r.init((t=>r.spec.fromJSON(s,t))))}return pp.create({doc:t.doc,selection:kd.fromJSON(t.selection),extensions:e.extensions?n.concat([e.extensions]):n})}static create(t={}){let e=jd.resolve(t.extensions||[],new Map),i=t.doc instanceof Ff?t.doc:Ff.of((t.doc||"").split(e.staticFacet(pp.lineSeparator)||fd)),n=t.selection?t.selection instanceof kd?t.selection:kd.single(t.selection.anchor,t.selection.head):kd.single(0);return Sd(n,i.length),e.staticFacet(Fd)||(n=n.asSingle()),new pp(e,i,n,e.dynamicSlots.map((()=>null)),((t,e)=>e.create(t)),null)}get tabSize(){return this.facet(pp.tabSize)}get lineBreak(){return this.facet(pp.lineSeparator)||"\n"}get readOnly(){return this.facet(Kd)}phrase(t,...e){for(let e of this.facet(pp.phrases))if(Object.prototype.hasOwnProperty.call(e,t)){t=e[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,((t,i)=>{if("$"==i)return"$";let n=+(i||1);return n>e.length?t:e[n-1]}))),t}languageDataAt(t,e,i=-1){let n=[];for(let r of this.facet(Xd))for(let s of r(this,e,i))Object.prototype.hasOwnProperty.call(s,t)&&n.push(s[t]);return n}charCategorizer(t){return dp(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:i,length:n}=this.doc.lineAt(t),r=this.charCategorizer(t),s=t-i,o=t-i;for(;s>0;){let t=sd(e,s,!1);if(r(e.slice(t,s))!=cp.Word)break;s=t}for(;o<n;){let t=sd(e,o);if(r(e.slice(o,t))!=cp.Word)break;o=t}return s==o?null:kd.range(s+i,o+i)}}function gp(t,e,i={}){let n={};for(let e of t)for(let t of Object.keys(e)){let r=e[t],s=n[t];if(void 0===s)n[t]=r;else if(s===r||void 0===r);else{if(!Object.hasOwnProperty.call(i,t))throw new Error("Config merge conflict for field "+t);n[t]=i[t](s,r)}}for(let t in e)void 0===n[t]&&(n[t]=e[t]);return n}pp.allowMultipleSelections=Fd,pp.tabSize=Ad.define({combine:t=>t.length?t[0]:4}),pp.lineSeparator=Zd,pp.readOnly=Kd,pp.phrases=Ad.define({compare(t,e){let i=Object.keys(t),n=Object.keys(e);return i.length==n.length&&i.every((i=>t[i]==e[i]))}}),pp.languageData=Xd,pp.changeFilter=Gd,pp.transactionFilter=Ud,pp.transactionExtender=Yd,Wd.reconfigure=ip.define();class mp{eq(t){return this==t}range(t,e=t){return bp.create(t,e,this)}}mp.prototype.startSide=mp.prototype.endSide=0,mp.prototype.point=!1,mp.prototype.mapMode=dd.TrackDel;class bp{constructor(t,e,i){this.from=t,this.to=e,this.value=i}static create(t,e,i){return new bp(t,e,i)}}function Op(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class vp{constructor(t,e,i,n){this.from=t,this.to=e,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(t,e,i,n=0){let r=i?this.to:this.from;for(let s=n,o=r.length;;){if(s==o)return s;let n=s+o>>1,l=r[n]-t||(i?this.value[n].endSide:this.value[n].startSide)-e;if(n==s)return l>=0?s:o;l>=0?o=n:s=n+1}}between(t,e,i,n){for(let r=this.findIndex(e,-1e9,!0),s=this.findIndex(i,1e9,!1,r);r<s;r++)if(!1===n(this.from[r]+t,this.to[r]+t,this.value[r]))return!1}map(t,e){let i=[],n=[],r=[],s=-1,o=-1;for(let l=0;l<this.value.length;l++){let a,h,c=this.value[l],u=this.from[l]+t,f=this.to[l]+t;if(u==f){let t=e.mapPos(u,c.startSide,c.mapMode);if(null==t)continue;if(a=h=t,c.startSide!=c.endSide&&(h=e.mapPos(u,c.endSide),h<a))continue}else if(a=e.mapPos(u,c.startSide),h=e.mapPos(f,c.endSide),a>h||a==h&&c.startSide>0&&c.endSide<=0)continue;(h-a||c.endSide-c.startSide)<0||(s<0&&(s=a),c.point&&(o=Math.max(o,h-a)),i.push(c),n.push(a-s),r.push(h-s))}return{mapped:i.length?new vp(n,r,i,o):null,pos:s}}}class wp{constructor(t,e,i,n){this.chunkPos=t,this.chunk=e,this.nextLayer=i,this.maxPoint=n}static create(t,e,i,n){return new wp(t,e,i,n)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:i=!1,filterFrom:n=0,filterTo:r=this.length}=t,s=t.filter;if(0==e.length&&!s)return this;if(i&&(e=e.slice().sort(Op)),this.isEmpty)return e.length?wp.of(e):this;let o=new kp(this,null,-1).goto(0),l=0,a=[],h=new yp;for(;o.value||l<e.length;)if(l<e.length&&(o.from-e[l].from||o.startSide-e[l].value.startSide)>=0){let t=e[l++];h.addInner(t.from,t.to,t.value)||a.push(t)}else 1==o.rangeIndex&&o.chunkIndex<this.chunk.length&&(l==e.length||this.chunkEnd(o.chunkIndex)<e[l].from)&&(!s||n>this.chunkEnd(o.chunkIndex)||r<this.chunkPos[o.chunkIndex])&&h.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!s||n>o.to||r<o.from||s(o.from,o.to,o.value))&&(h.addInner(o.from,o.to,o.value)||a.push(bp.create(o.from,o.to,o.value))),o.next());return h.finishInner(this.nextLayer.isEmpty&&!a.length?wp.empty:this.nextLayer.update({add:a,filter:s,filterFrom:n,filterTo:r}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],i=[],n=-1;for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r],l=t.touchesRange(s,s+o.length);if(!1===l)n=Math.max(n,o.maxPoint),e.push(o),i.push(t.mapPos(s));else if(!0===l){let{mapped:r,pos:l}=o.map(s,t);r&&(n=Math.max(n,r.maxPoint),e.push(r),i.push(l))}}let r=this.nextLayer.map(t);return 0==e.length?r:new wp(i,e,r||wp.empty,n)}between(t,e,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let r=this.chunkPos[n],s=this.chunk[n];if(e>=r&&t<=r+s.length&&!1===s.between(r,t-r,e-r,i))return}this.nextLayer.between(t,e,i)}}iter(t=0){return Sp.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return Sp.from(t).goto(e)}static compare(t,e,i,n,r=-1){let s=t.filter((t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=r)),o=e.filter((t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=r)),l=xp(s,o,i),a=new Ap(s,l,r),h=new Ap(o,l,r);i.iterGaps(((t,e,i)=>Tp(a,t,h,e,i,n))),i.empty&&0==i.length&&Tp(a,0,h,0,0,n)}static eq(t,e,i=0,n){null==n&&(n=1e9);let r=t.filter((t=>!t.isEmpty&&e.indexOf(t)<0)),s=e.filter((e=>!e.isEmpty&&t.indexOf(e)<0));if(r.length!=s.length)return!1;if(!r.length)return!0;let o=xp(r,s),l=new Ap(r,o,0).goto(i),a=new Ap(s,o,0).goto(i);for(;;){if(l.to!=a.to||!Pp(l.active,a.active)||l.point&&(!a.point||!l.point.eq(a.point)))return!1;if(l.to>n)return!0;l.next(),a.next()}}static spans(t,e,i,n,r=-1){let s=new Ap(t,null,r).goto(e),o=e,l=s.openStart;for(;;){let t=Math.min(s.to,i);if(s.point?(n.point(o,t,s.point,s.activeForPoint(s.to),l,s.pointRank),l=s.openEnd(t)+(s.to>t?1:0)):t>o&&(n.span(o,t,s.active,l),l=s.openEnd(t)),s.to>i)break;o=s.to,s.next()}return l}static of(t,e=!1){let i=new yp;for(let n of t instanceof bp?[t]:e?function(t){if(t.length>1)for(let e=t[0],i=1;i<t.length;i++){let n=t[i];if(Op(e,n)>0)return t.slice().sort(Op);e=n}return t}(t):t)i.add(n.from,n.to,n.value);return i.finish()}}wp.empty=new wp([],[],null,-1),wp.empty.nextLayer=wp.empty;class yp{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(t){this.chunks.push(new vp(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}add(t,e,i){this.addInner(t,e,i)||(this.nextLayer||(this.nextLayer=new yp)).add(t,e,i)}addInner(t,e,i){let n=t-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(t-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(n<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=i,this.lastFrom=t,this.lastTo=e,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let i=e.value.length-1;return this.last=e.value[i],this.lastFrom=e.from[i]+t,this.lastTo=e.to[i]+t,!0}finish(){return this.finishInner(wp.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return t;let e=wp.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function xp(t,e,i){let n=new Map;for(let e of t)for(let t=0;t<e.chunk.length;t++)e.chunk[t].maxPoint<=0&&n.set(e.chunk[t],e.chunkPos[t]);let r=new Set;for(let t of e)for(let e=0;e<t.chunk.length;e++){let s=n.get(t.chunk[e]);null==s||(i?i.mapPos(s):s)!=t.chunkPos[e]||(null==i?void 0:i.touchesRange(s,s+t.chunk[e].length))||r.add(t.chunk[e])}return r}class kp{constructor(t,e,i,n=0){this.layer=t,this.skip=e,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,i){for(;this.chunkIndex<this.layer.chunk.length;){let e=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(e)||this.layer.chunkEnd(this.chunkIndex)<t||e.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],i=t+e.from[this.rangeIndex];if(this.from=i,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class Sp{constructor(t){this.heap=t}static from(t,e=null,i=-1){let n=[];for(let r=0;r<t.length;r++)for(let s=t[r];!s.isEmpty;s=s.nextLayer)s.maxPoint>=i&&n.push(new kp(s,e,i,r));return 1==n.length?n[0]:new Sp(n)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let i of this.heap)i.goto(t,e);for(let t=this.heap.length>>1;t>=0;t--)Cp(this.heap,t);return this.next(),this}forward(t,e){for(let i of this.heap)i.forward(t,e);for(let t=this.heap.length>>1;t>=0;t--)Cp(this.heap,t);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),Cp(this.heap,0)}}}function Cp(t,e){for(let i=t[e];;){let n=1+(e<<1);if(n>=t.length)break;let r=t[n];if(n+1<t.length&&r.compare(t[n+1])>=0&&(r=t[n+1],n++),i.compare(r)<0)break;t[n]=i,t[e]=r,e=n}}class Ap{constructor(t,e,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Sp.from(t,e,i)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){Mp(this.active,t),Mp(this.activeTo,t),Mp(this.activeRank,t),this.minActive=Rp(this.active,this.activeTo)}addActive(t){let e=0,{value:i,to:n,rank:r}=this.cursor;for(;e<this.activeRank.length&&this.activeRank[e]<=r;)e++;Qp(this.active,e,i),Qp(this.activeTo,e,n),Qp(this.activeRank,e,r),t&&Qp(t,e,this.cursor.from),this.minActive=Rp(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let i=this.openStart<0?[]:null,n=0;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>t){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),i&&Mp(i,r)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let r=this.cursor.value;if(r.point){if(!(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.from<t&&(n=1),this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(i),this.cursor.next()}}}if(i){let e=0;for(;e<i.length&&i[e]<t;)e++;this.openStart=e+n}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>t||this.activeTo[i]==t&&this.active[i].endSide>=this.point.endSide)&&e.push(this.active[i]);return e.reverse()}openEnd(t){let e=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>t;i--)e++;return e}}function Tp(t,e,i,n,r,s){t.goto(e),i.goto(n);let o=n+r,l=n,a=n-e;for(;;){let e=t.to+a-i.to||t.endSide-i.endSide,n=e<0?t.to+a:i.to,r=Math.min(n,o);if(t.point||i.point?t.point&&i.point&&(t.point==i.point||t.point.eq(i.point))&&Pp(t.activeForPoint(t.to+a),i.activeForPoint(i.to))||s.comparePoint(l,r,t.point,i.point):r>l&&!Pp(t.active,i.active)&&s.compareRange(l,r,t.active,i.active),n>o)break;l=n,e<=0&&t.next(),e>=0&&i.next()}}function Pp(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!=e[i]&&!t[i].eq(e[i]))return!1;return!0}function Mp(t,e){for(let i=e,n=t.length-1;i<n;i++)t[i]=t[i+1];t.pop()}function Qp(t,e,i){for(let i=t.length-1;i>=e;i--)t[i+1]=t[i];t[e]=i}function Rp(t,e){let i=-1,n=1e9;for(let r=0;r<e.length;r++)(e[r]-n||t[r].endSide-t[i].endSide)<0&&(i=r,n=e[r]);return i}function $p(t){let e;return e=11==t.nodeType?t.getSelection?t:t.ownerDocument:t,e.getSelection()}function _p(t,e){return!!e&&(t==e||t.contains(1!=e.nodeType?e.parentNode:e))}function Dp(t,e){if(!e.anchorNode)return!1;try{return _p(t,e.anchorNode)}catch(t){return!1}}function Ep(t){return 3==t.nodeType?Fp(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function Np(t,e,i,n){return!!i&&(Ip(t,e,i,n,-1)||Ip(t,e,i,n,1))}function Bp(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function Ip(t,e,i,n,r){for(;;){if(t==i&&e==n)return!0;if(e==(r<0?0:zp(t))){if("DIV"==t.nodeName)return!1;let i=t.parentNode;if(!i||1!=i.nodeType)return!1;e=Bp(t)+(r<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[e+(r<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;e=r<0?zp(t):0}}}function zp(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}const Lp={left:0,right:0,top:0,bottom:0};function Wp(t,e){let i=e?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function Vp(t){return{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}class jp{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){this.set(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let qp,Hp=null;function Xp(t){if(t.setActive)return t.setActive();if(Hp)return t.focus(Hp);let e=[];for(let i=t;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==Hp?{get preventScroll(){return Hp={preventScroll:!0},!0}}:void 0),!Hp){Hp=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],r=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=r&&(i.scrollLeft=r)}}}function Fp(t,e,i=e){let n=qp||(qp=document.createRange());return n.setEnd(t,i),n.setStart(t,e),n}function Zp(t,e,i){let n={key:e,code:e,keyCode:i,which:i,cancelable:!0},r=new KeyboardEvent("keydown",n);r.synthetic=!0,t.dispatchEvent(r);let s=new KeyboardEvent("keyup",n);return s.synthetic=!0,t.dispatchEvent(s),r.defaultPrevented||s.defaultPrevented}function Gp(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}class Up{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new Up(t.parentNode,Bp(t),e)}static after(t,e){return new Up(t.parentNode,Bp(t)+1,e)}}const Yp=[];class Kp{constructor(){this.parent=null,this.dom=null,this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}coordsAt(t,e){return null}sync(t){if(2&this.dirty){let e,i=this.dom,n=null;for(let r of this.children){if(r.dirty){if(!r.dom&&(e=n?n.nextSibling:i.firstChild)){let t=Kp.get(e);t&&(t.parent||t.constructor!=r.constructor)||r.reuseDOM(e)}r.sync(t),r.dirty=0}if(e=n?n.nextSibling:i.firstChild,t&&!t.written&&t.node==i&&e!=r.dom&&(t.written=!0),r.dom.parentNode==i)for(;e&&e!=r.dom;)e=Jp(e);else i.insertBefore(r.dom,e);n=r.dom}for(e=n?n.nextSibling:i.firstChild,e&&t&&t.node==i&&(t.written=!0);e;)e=Jp(e)}else if(1&this.dirty)for(let e of this.children)e.dirty&&(e.sync(t),e.dirty=0)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=0==zp(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==n&&e.firstChild!=e.lastChild&&(n=t==e.firstChild?-1:1),t=e}i=n<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!Kp.get(i);)i=i.nextSibling;if(!i)return this.length;for(let t=0,e=0;;t++){let n=this.children[t];if(n.dom==i)return e;e+=n.length+n.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,r=-1,s=-1,o=-1;for(let l=0,a=i,h=i;l<this.children.length;l++){let i=this.children[l],c=a+i.length;if(a<t&&c>e)return i.domBoundsAround(t,e,a);if(c>=t&&-1==n&&(n=l,r=a),a>e&&i.dom.parentNode==this.dom){s=l,o=h;break}h=c,a=c+i.breakAfter}return{from:r,to:o<0?i+this.length:o,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:s<this.children.length&&s>=0?this.children[s].dom:null}}markDirty(t=!1){this.dirty|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.dirty|=2),1&e.dirty)return;e.dirty|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.dirty&&this.markParentsDirty(!0))}setDOM(t){this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=Yp){this.markDirty();for(let i=t;i<e;i++){let t=this.children[i];t.parent==this&&t.destroy()}this.children.splice(t,e-t,...i);for(let t=0;t<i.length;t++)i[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new tg(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}merge(t,e,i,n,r,s){return!1}become(t){return!1}getSide(){return 0}destroy(){this.parent=null}}function Jp(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}Kp.prototype.breakAfter=0;class tg{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function eg(t,e,i,n,r,s,o,l,a){let{children:h}=t,c=h.length?h[e]:null,u=s.length?s[s.length-1]:null,f=u?u.breakAfter:o;if(!(e==n&&c&&!o&&!f&&s.length<2&&c.merge(i,r,s.length?u:null,0==i,l,a))){if(n<h.length){let t=h[n];t&&r<t.length?(e==n&&(t=t.split(r),r=0),!f&&u&&t.merge(0,r,u,!0,0,a)?s[s.length-1]=t:(r&&t.merge(0,r,null,!1,0,a),s.push(t))):(null==t?void 0:t.breakAfter)&&(u?u.breakAfter=1:o=1),n++}for(c&&(c.breakAfter=o,i>0&&(!o&&s.length&&c.merge(i,c.length,s[0],!1,l,0)?c.breakAfter=s.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,l,0),e++));e<n&&s.length;)if(h[n-1].become(s[s.length-1]))n--,s.pop(),a=s.length?0:l;else{if(!h[e].become(s[0]))break;e++,s.shift(),l=s.length?0:a}!s.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,l,a)&&e--,(e<n||s.length)&&t.replaceChildren(e,n,s)}}function ig(t,e,i,n,r,s){let o=t.childCursor(),{i:l,off:a}=o.findPos(i,1),{i:h,off:c}=o.findPos(e,-1),u=e-i;for(let t of n)u+=t.length;t.length+=u,eg(t,h,c,l,a,n,0,r,s)}let ng="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},rg="undefined"!=typeof document?document:{documentElement:{style:{}}};const sg=/Edge\/(\d+)/.exec(ng.userAgent),og=/MSIE \d/.test(ng.userAgent),lg=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ng.userAgent),ag=!!(og||lg||sg),hg=!ag&&/gecko\/(\d+)/i.test(ng.userAgent),cg=!ag&&/Chrome\/(\d+)/.exec(ng.userAgent),ug="webkitFontSmoothing"in rg.documentElement.style,fg=!ag&&/Apple Computer/.test(ng.vendor),dg=fg&&(/Mobile\/\w+/.test(ng.userAgent)||ng.maxTouchPoints>2);var pg={mac:dg||/Mac/.test(ng.platform),windows:/Win/.test(ng.platform),linux:/Linux|X11/.test(ng.platform),ie:ag,ie_version:og?rg.documentMode||6:lg?+lg[1]:sg?+sg[1]:0,gecko:hg,gecko_version:hg?+(/Firefox\/(\d+)/.exec(ng.userAgent)||[0,0])[1]:0,chrome:!!cg,chrome_version:cg?+cg[1]:0,ios:dg,android:/Android\b/.test(ng.userAgent),webkit:ug,safari:fg,webkit_version:ug?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=rg.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class gg extends Kp{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){3==t.nodeType&&this.createDOM(t)}merge(t,e,i){return(!i||i instanceof gg&&!(this.length-(e-t)+i.length>256))&&(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new gg(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new Up(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return bg(this.dom,t,e)}}class mg extends Kp{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let t of e)t.setParent(this)}setAttrs(t){if(Gp(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.dirty|=6)}sync(t){this.dom?4&this.dirty&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t)}merge(t,e,i,n,r,s){return(!i||!(!(i instanceof mg&&i.mark.eq(this.mark))||t&&r<=0||e<this.length&&s<=0))&&(ig(this,t,e,i?i.children:[],r-1,s-1),this.markDirty(),!0)}split(t){let e=[],i=0,n=-1,r=0;for(let s of this.children){let o=i+s.length;o>t&&e.push(i<t?s.split(t-i):s),n<0&&i>=t&&(n=r),i=o,r++}let s=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new mg(this.mark,e,s)}domAtPos(t){return kg(this.dom,this.children,t)}coordsAt(t,e){return Cg(this,t,e)}}function bg(t,e,i){let n=t.nodeValue.length;e>n&&(e=n);let r=e,s=e,o=0;0==e&&i<0||e==n&&i>=0?pg.chrome||pg.gecko||(e?(r--,o=1):s<n&&(s++,o=-1)):i<0?r--:s<n&&s++;let l=Fp(t,r,s).getClientRects();if(!l.length)return Lp;let a=l[(o?o<0:i>=0)?0:l.length-1];return pg.safari&&!o&&0==a.width&&(a=Array.prototype.find.call(l,(t=>t.width))||a),o?Wp(a,o<0):a||null}class Og extends Kp{constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}static create(t,e,i){return new(t.customView||Og)(t,e,i)}split(t){let e=Og.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(t,e,i,n,r,s){return!(i&&(!(i instanceof Og&&this.widget.compare(i.widget))||t>0&&r<=0||e<this.length&&s<=0))&&(this.length=t+(i?i.length:0)+(this.length-e),!0)}become(t){return t.length==this.length&&t instanceof Og&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.eq(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return Ff.empty;let t=this;for(;t.parent;)t=t.parent;let e=t.editorView,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):Ff.empty}domAtPos(t){return 0==t?Up.before(this.dom):Up.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.dom.getClientRects(),n=null;if(!i.length)return Lp;for(let e=t>0?i.length-1:0;n=i[e],!(t>0?0==e:e==i.length-1||n.top<n.bottom);e+=t>0?-1:1);return 0==t&&e>0||t==this.length&&e<=0?n:Wp(n,0==t)}get isEditable(){return!1}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class vg extends Og{domAtPos(t){let{topView:e,text:i}=this.widget;return e?wg(t,0,e,i,((t,e)=>t.domAtPos(e)),(t=>new Up(i,Math.min(t,i.nodeValue.length)))):new Up(i,Math.min(t,i.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(t,e){let{topView:i,text:n}=this.widget;return i?yg(t,e,i,n):Math.min(e,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(t,e){let{topView:i,text:n}=this.widget;return i?wg(t,e,i,n,((t,e,i)=>t.coordsAt(e,i)),((t,e)=>bg(n,t,e))):bg(n,t,e)}destroy(){var t;super.destroy(),null===(t=this.widget.topView)||void 0===t||t.destroy()}get isEditable(){return!0}}function wg(t,e,i,n,r,s){if(i instanceof mg){for(let o of i.children){let i=_p(o.dom,n),l=i?n.nodeValue.length:o.length;if(t<l||t==l&&o.getSide()<=0)return i?wg(t,e,o,n,r,s):r(o,t,e);t-=l}return r(i,i.length,-1)}return i.dom==n?s(t,e):r(i,t,e)}function yg(t,e,i,n){if(i instanceof mg)for(let r of i.children){let i=0,s=_p(r.dom,n);if(_p(r.dom,t))return i+(s?yg(t,e,r,n):r.localPosFromDOM(t,e));i+=s?n.nodeValue.length:r.length}else if(i.dom==n)return Math.min(e,n.nodeValue.length);return i.localPosFromDOM(t,e)}class xg extends Kp{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof xg&&t.side==this.side}split(){return new xg(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return Up.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){let e=this.dom.getBoundingClientRect(),i=function(t,e){let i=t.parent,n=i?i.children.indexOf(t):-1;for(;i&&n>=0;)if(e<0?n>0:n<i.children.length){let t=i.children[n+e];if(t instanceof gg){let i=t.coordsAt(e<0?t.length:0,e);if(i)return i}n+=e}else{if(!(i instanceof mg&&i.parent)){let t=i.dom.lastChild;if(t&&"BR"==t.nodeName)return t.getClientRects()[0];break}n=i.parent.children.indexOf(i)+(e<0?0:1),i=i.parent}return}(this,this.side>0?-1:1);return i&&i.top<e.bottom&&i.bottom>e.top?{left:e.left,right:e.right,top:i.top,bottom:i.bottom}:e}get overrideDOMText(){return Ff.empty}}function kg(t,e,i){let n=0;for(let r=0;n<e.length;n++){let s=e[n],o=r+s.length;if(!(o==r&&s.getSide()<=0)){if(i>r&&i<o&&s.dom.parentNode==t)return s.domAtPos(i-r);if(i<=r)break;r=o}}for(;n>0;n--){let i=e[n-1].dom;if(i.parentNode==t)return Up.after(i)}return new Up(t,0)}function Sg(t,e,i){let n,{children:r}=t;i>0&&e instanceof mg&&r.length&&(n=r[r.length-1])instanceof mg&&n.mark.eq(e.mark)?Sg(n,e.children[0],i-1):(r.push(e),e.setParent(t)),t.length+=e.length}function Cg(t,e,i){for(let n=0,r=0;r<t.children.length;r++){let s,o=t.children[r],l=n+o.length;if((i<=0||l==t.length||o.getSide()>0?l>=e:l>e)&&(e<l||r+1==t.children.length||(s=t.children[r+1]).length||s.getSide()>0)){let t=0;if(l==n){if(o.getSide()<=0)continue;t=i=-o.getSide()}let r=o.coordsAt(Math.max(0,e-n),i);return t&&r?Wp(r,i<0):r}n=l}let n=t.dom.lastChild;if(!n)return t.dom.getBoundingClientRect();let r=Ep(n);return r[r.length-1]||null}function Ag(t,e){for(let i in t)"class"==i&&e.class?e.class+=" "+t.class:"style"==i&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}function Tg(t,e){if(t==e)return!0;if(!t||!e)return!1;let i=Object.keys(t),n=Object.keys(e);if(i.length!=n.length)return!1;for(let r of i)if(-1==n.indexOf(r)||t[r]!==e[r])return!1;return!0}function Pg(t,e,i){let n=null;if(e)for(let r in e)i&&r in i||t.removeAttribute(n=r);if(i)for(let r in i)e&&e[r]==i[r]||t.setAttribute(n=r,i[r]);return!!n}gg.prototype.children=Og.prototype.children=xg.prototype.children=Yp;class Mg{eq(t){return!1}updateDOM(t){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}ignoreEvent(t){return!0}get customView(){return null}destroy(t){}}var Qg=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(Qg||(Qg={}));class Rg extends mp{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new $g(t)}static widget(t){let e=t.side||0,i=!!t.block;return e+=i?e>0?3e8:-4e8:e>0?1e8:-1e8,new Dg(t,e,e,i,t.widget||null,!1)}static replace(t){let e,i,n=!!t.block;if(t.isBlockGap)e=-5e8,i=4e8;else{let{start:r,end:s}=Eg(t,n);e=(r?n?-3e8:-1:5e8)-1,i=1+(s?n?2e8:1:-6e8)}return new Dg(t,e,i,n,t.widget||null,!0)}static line(t){return new _g(t)}static set(t,e=!1){return wp.of(t,e)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}Rg.none=wp.empty;class $g extends Rg{constructor(t){let{start:e,end:i}=Eg(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){return this==t||t instanceof $g&&this.tagName==t.tagName&&this.class==t.class&&Tg(this.attrs,t.attrs)}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}$g.prototype.point=!1;class _g extends Rg{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof _g&&Tg(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}_g.prototype.mapMode=dd.TrackBefore,_g.prototype.point=!0;class Dg extends Rg{constructor(t,e,i,n,r,s){super(e,i,r,t),this.block=n,this.isReplace=s,this.mapMode=n?e<=0?dd.TrackBefore:dd.TrackAfter:dd.TrackDel}get type(){return this.startSide<this.endSide?Qg.WidgetRange:this.startSide<=0?Qg.WidgetBefore:Qg.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(t){return t instanceof Dg&&(e=this.widget,i=t.widget,e==i||!!(e&&i&&e.compare(i)))&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide;var e,i}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}function Eg(t,e=!1){let{inclusiveStart:i,inclusiveEnd:n}=t;return null==i&&(i=t.inclusive),null==n&&(n=t.inclusive),{start:null!=i?i:e,end:null!=n?n:e}}function Ng(t,e,i,n=0){let r=i.length-1;r>=0&&i[r]+n>=t?i[r]=Math.max(i[r],e):i.push(t,e)}Dg.prototype.point=!0;class Bg extends Kp{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,r,s){if(i){if(!(i instanceof Bg))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),ig(this,t,e,i?i.children:[],r,s),!0}split(t){let e=new Bg;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let t=i;t<this.children.length;t++)e.append(this.children[t],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){Tg(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){Sg(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=Ag(e,this.attrs||{})),i&&(this.attrs=Ag({class:i},this.attrs||{}))}domAtPos(t){return kg(this.dom,this.children,t)}reuseDOM(t){"DIV"==t.nodeName&&(this.setDOM(t),this.dirty|=6)}sync(t){var e;this.dom?4&this.dirty&&(Gp(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(Pg(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t);let i=this.dom.lastChild;for(;i&&Kp.get(i)instanceof mg;)i=i.lastChild;if(!(i&&this.length&&("BR"==i.nodeName||0!=(null===(e=Kp.get(i))||void 0===e?void 0:e.isEditable)||pg.ios&&this.children.some((t=>t instanceof gg))))){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t=0;for(let e of this.children){if(!(e instanceof gg))return null;let i=Ep(e.dom);if(1!=i.length)return null;t+=i[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length}}coordsAt(t,e){return Cg(this,t,e)}become(t){return!1}get type(){return Qg.Text}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let r=t.children[i],s=n+r.length;if(s>=e){if(r instanceof Bg)return r;if(s>e)break}n=s+r.breakAfter}return null}}class Ig extends Kp{constructor(t,e,i){super(),this.widget=t,this.length=e,this.type=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,r,s){return!(i&&(!(i instanceof Ig&&this.widget.compare(i.widget))||t>0&&r<=0||e<this.length&&s<=0))&&(this.length=t+(i?i.length:0)+(this.length-e),!0)}domAtPos(t){return 0==t?Up.before(this.dom):Up.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new Ig(this.widget,e,this.type);return i.breakAfter=this.breakAfter,i}get children(){return Yp}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Ff.empty}domBoundsAround(){return null}become(t){return t instanceof Ig&&t.type==this.type&&t.widget.constructor==this.widget.constructor&&(t.widget.eq(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class zg{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof Ig&&t.type==Qg.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new Bg),this.atCursorPos=!0),this.curLine}flushBuffer(t){this.pendingBuffer&&(this.curLine.append(Lg(new xg(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer([]),this.curLine=null,this.content.push(t)}finish(t){t?this.pendingBuffer=0:this.flushBuffer([]),this.posCovered()||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:i,done:n}=this.cursor.next(this.skip);if(this.skip=0,n)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer([]),this.curLine=null,t--;continue}this.text=e,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(0,i)),this.getLine().append(Lg(new gg(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,r,s){if(this.disallowBlockEffectsFor[s]&&i instanceof Dg){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=e-t;if(i instanceof Dg)if(i.block){let{type:t}=i;t!=Qg.WidgetAfter||this.posCovered()||this.getLine(),this.addBlockWidget(new Ig(i.widget||new Wg("div"),o,t))}else{let s=Og.create(i.widget||new Wg("span"),o,i.startSide),l=this.atCursorPos&&!s.isEditable&&r<=n.length&&(t<e||i.startSide>0),a=!s.isEditable&&(t<e||i.startSide<=0),h=this.getLine();2!=this.pendingBuffer||l||(this.pendingBuffer=0),this.flushBuffer(n),l&&(h.append(Lg(new xg(1),n),r),r=n.length+Math.max(0,r-n.length)),h.append(Lg(s,n),r),this.atCursorPos=a,this.pendingBuffer=a?t<e?1:2:0}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=r)}static build(t,e,i,n,r){let s=new zg(t,e,i,r);return s.openEnd=wp.spans(n,e,i,s),s.openStart<0&&(s.openStart=s.openEnd),s.finish(s.openEnd),s}}function Lg(t,e){for(let i of e)t=new mg(i,[t],t.length);return t}class Wg extends Mg{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}}const Vg=Ad.define(),jg=Ad.define(),qg=Ad.define(),Hg=Ad.define(),Xg=Ad.define(),Fg=Ad.define(),Zg=Ad.define({combine:t=>t.some((t=>t))});class Gg{constructor(t,e="nearest",i="nearest",n=5,r=5){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=r}map(t){return t.empty?this:new Gg(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin)}}const Ug=ip.define({map:(t,e)=>t.map(e)});function Yg(t,e,i){let n=t.facet(Hg);n.length?n[0](e):window.onerror?window.onerror(String(e),i,void 0,void 0,e):i?console.error(i+":",e):console.error(e)}const Kg=Ad.define({combine:t=>!t.length||t[0]});let Jg=0;const tm=Ad.define();class em{constructor(t,e,i,n){this.id=t,this.create=e,this.domEventHandlers=i,this.extension=n(this)}static define(t,e){const{eventHandlers:i,provide:n,decorations:r}=e||{};return new em(Jg++,t,i,(t=>{let e=[tm.of(t)];return r&&e.push(sm.of((e=>{let i=e.plugin(t);return i?r(i):Rg.none}))),n&&e.push(n(t)),e}))}static fromClass(t,e){return em.define((e=>new t(e)),e)}}class im{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(e){if(Yg(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){Yg(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null===(e=this.value)||void 0===e?void 0:e.destroy)try{this.value.destroy()}catch(e){Yg(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const nm=Ad.define(),rm=Ad.define(),sm=Ad.define(),om=Ad.define(),lm=Ad.define(),am=Ad.define();class hm{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new hm(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(0==e.length)return t;let i=[];for(let n=0,r=0,s=0,o=0;;n++){let l=n==t.length?null:t[n],a=s-o,h=l?l.fromB:1e9;for(;r<e.length&&e[r]<h;){let t=e[r],n=e[r+1],s=Math.max(o,t),l=Math.min(h,n);if(s<=l&&new hm(s+a,l+a,s,l).addToSet(i),n>h)break;r+=2}if(!l)return i;new hm(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),s=l.toA,o=l.toB}}}class cm{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=gd.empty(this.startState.doc.length);for(let t of i)this.changes=this.changes.compose(t.changes);let n=[];this.changes.iterChangedRanges(((t,e,i,r)=>n.push(new hm(t,e,i,r)))),this.changedRanges=n;let r=t.hasFocus;r!=t.inputState.notifiedFocused&&(t.inputState.notifiedFocused=r,this.flags|=1)}static create(t,e,i){return new cm(t,e,i)}get viewportChanged(){return(4&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(10&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((t=>t.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}var um=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(um||(um={}));const fm=um.LTR,dm=um.RTL;function pm(t){let e=[];for(let i=0;i<t.length;i++)e.push(1<<+t[i]);return e}const gm=pm("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),mm=pm("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),bm=Object.create(null),Om=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),i=t.charCodeAt(1);bm[e]=i,bm[i]=-e}const vm=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;class wm{constructor(t,e,i){this.from=t,this.to=e,this.level=i}get dir(){return this.level%2?dm:fm}side(t,e){return this.dir==e==t?this.to:this.from}static find(t,e,i,n){let r=-1;for(let s=0;s<t.length;s++){let o=t[s];if(o.from<=e&&o.to>=e){if(o.level==i)return s;(r<0||(0!=n?n<0?o.from<e:o.to>e:t[r].level>o.level))&&(r=s)}}if(r<0)throw new RangeError("Index out of range");return r}}const ym=[];function xm(t){return[new wm(0,t,0)]}let km="";function Sm(t,e,i,n,r){var s;let o=n.head-t.from,l=-1;if(0==o){if(!r||!t.length)return null;e[0].level!=i&&(o=e[0].side(!1,i),l=0)}else if(o==t.length){if(r)return null;let t=e[e.length-1];t.level!=i&&(o=t.side(!0,i),l=e.length-1)}l<0&&(l=wm.find(e,o,null!==(s=n.bidiLevel)&&void 0!==s?s:-1,n.assoc));let a=e[l];o==a.side(r,i)&&(a=e[l+=r?1:-1],o=a.side(!r,i));let h=r==(a.dir==i),c=sd(t.text,o,h);if(km=t.text.slice(Math.min(o,c),Math.max(o,c)),c!=a.side(r,i))return kd.cursor(c+t.from,h?-1:1,a.level);let u=l==(r?e.length-1:0)?null:e[l+(r?1:-1)];return u||a.level==i?u&&u.level<a.level?kd.cursor(u.side(!r,i)+t.from,r?1:-1,u.level):kd.cursor(c+t.from,r?-1:1,a.level):kd.cursor(r?t.to:t.from,r?-1:1,i)}const Cm="￿";class Am{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(pp.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Cm}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n),this.readNode(n);let t=n.nextSibling;if(t==e)break;let r=Kp.get(n),s=Kp.get(t);(r&&s?r.breakAfter:(r?r.breakAfter:Tm(n))||Tm(t)&&("BR"!=n.nodeName||n.cmIgnore))&&this.lineBreak(),n=t}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let r,s=-1,o=1;if(this.lineSeparator?(s=e.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(r=n.exec(e))&&(s=r.index,o=r[0].length),this.append(e.slice(i,s<0?e.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let e of this.points)e.node==t&&e.pos>this.text.length&&(e.pos-=o-1);i=s+o}}readNode(t){if(t.cmIgnore)return;let e=Kp.get(t),i=e&&e.overrideDOMText;if(null!=i){this.findPointInside(t,i.length);for(let t=i.iter();!t.next().done;)t.lineBreak?this.lineBreak():this.append(t.value)}else 3==t.nodeType?this.readTextNode(t):"BR"==t.nodeName?t.nextSibling&&this.lineBreak():1==t.nodeType&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(3==t.nodeType?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+Math.min(e,i.offset))}}function Tm(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}class Pm{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class Mm extends Kp{constructor(t){super(),this.view=t,this.compositionDeco=Rg.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new Bg],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new hm(0,0,0,t.state.doc.length)],0)}get root(){return this.view.root}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(t){let e=t.changedRanges;this.minWidth>0&&e.length&&(e.every((({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo))?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=Rg.none:(t.transactions.length||this.dirty)&&(this.compositionDeco=function(t,e){let i=Rm(t);if(!i)return Rg.none;let{from:n,to:r,node:s,text:o}=i,l=e.mapPos(n,1),a=Math.max(l,e.mapPos(r,-1)),{state:h}=t,c=3==s.nodeType?s.nodeValue:new Am([],h).readRange(s.firstChild,null).text;if(a-l<c.length)if(h.doc.sliceString(l,Math.min(h.doc.length,l+c.length),Cm)==c)a=l+c.length;else{if(h.doc.sliceString(Math.max(0,a-c.length),a,Cm)!=c)return Rg.none;l=a-c.length}else if(h.doc.sliceString(l,a,Cm)!=c)return Rg.none;let u=Kp.get(s);u instanceof vg?u=u.widget.topView:u&&(u.parent=null);return Rg.set(Rg.replace({widget:new $m(s,o,u),inclusive:!0}).range(l,a))}(this.view,t.changes)),(pg.ie||pg.chrome)&&!this.compositionDeco.size&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let i=function(t,e,i){let n=new Dm;return wp.compare(t,e,i,n),n.changes}(this.decorations,this.updateDeco(),t.changes);return e=hm.extendWithRanges(e,i),(0!=this.dirty||0!=e.length)&&(this.updateInner(e,t.startState.doc.length),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e);let{observer:i}=this.view;i.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let t=pg.chrome||pg.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(t),this.dirty=0,t&&(t.written||i.selectionRange.focusNode!=t.node)&&(this.forceSelection=!0),this.dom.style.height=""}));let n=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let t of this.children)t instanceof Ig&&t.widget instanceof Qm&&n.push(t.dom);i.updateGaps(n)}updateChildren(t,e){let i=this.childCursor(e);for(let e=t.length-1;;e--){let n=e>=0?t[e]:null;if(!n)break;let{fromA:r,toA:s,fromB:o,toB:l}=n,{content:a,breakAtStart:h,openStart:c,openEnd:u}=zg.build(this.view.state.doc,o,l,this.decorations,this.dynamicDecorationMap),{i:f,off:d}=i.findPos(s,1),{i:p,off:g}=i.findPos(r,-1);eg(this,p,g,f,d,a,h,c,u)}}updateSelection(t=!1,e=!1){if(t&&this.view.observer.readSelectionRange(),!e&&!this.mayControlSelection()||pg.ios&&this.view.inputState.rapidCompositionStart)return;let i=this.forceSelection;this.forceSelection=!1;let n=this.view.state.selection.main,r=this.domAtPos(n.anchor),s=n.empty?r:this.domAtPos(n.head);if(pg.gecko&&n.empty&&(1==(o=r).node.nodeType&&o.node.firstChild&&(0==o.offset||"false"==o.node.childNodes[o.offset-1].contentEditable)&&(o.offset==o.node.childNodes.length||"false"==o.node.childNodes[o.offset].contentEditable))){let t=document.createTextNode("");this.view.observer.ignore((()=>r.node.insertBefore(t,r.node.childNodes[r.offset]||null))),r=s=new Up(t,0),i=!0}var o;let l=this.view.observer.selectionRange;!i&&l.focusNode&&Np(r.node,r.offset,l.anchorNode,l.anchorOffset)&&Np(s.node,s.offset,l.focusNode,l.focusOffset)||(this.view.observer.ignore((()=>{pg.android&&pg.chrome&&this.dom.contains(l.focusNode)&&function(t,e){for(let i=t;i&&i!=e;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}(l.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let t=$p(this.root);if(n.empty){if(pg.gecko){let t=(e=r.node,i=r.offset,1!=e.nodeType?0:(i&&"false"==e.childNodes[i-1].contentEditable?1:0)|(i<e.childNodes.length&&"false"==e.childNodes[i].contentEditable?2:0));if(t&&3!=t){let e=_m(r.node,r.offset,1==t?1:-1);e&&(r=new Up(e,1==t?0:e.nodeValue.length))}}t.collapse(r.node,r.offset),null!=n.bidiLevel&&null!=l.cursorBidiLevel&&(l.cursorBidiLevel=n.bidiLevel)}else if(t.extend)t.collapse(r.node,r.offset),t.extend(s.node,s.offset);else{let e=document.createRange();n.anchor>n.head&&([r,s]=[s,r]),e.setEnd(s.node,s.offset),e.setStart(r.node,r.offset),t.removeAllRanges(),t.addRange(e)}var e,i})),this.view.observer.setSelectionRange(r,s)),this.impreciseAnchor=r.precise?null:new Up(l.anchorNode,l.anchorOffset),this.impreciseHead=s.precise?null:new Up(l.focusNode,l.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let t=this.view.state.selection.main,e=$p(this.root);if(!t.empty||!t.assoc||!e.modify)return;let i=Bg.find(this,t.head);if(!i)return;let n=i.posAtStart;if(t.head==n||t.head==n+i.length)return;let r=this.coordsAt(t.head,-1),s=this.coordsAt(t.head,1);if(!r||!s||r.bottom>s.top)return;let o=this.domAtPos(t.head+t.assoc);e.collapse(o.node,o.offset),e.modify("move",t.assoc<0?"forward":"backward","lineboundary")}mayControlSelection(){return this.view.state.facet(Kg)?this.root.activeElement==this.dom:Dp(this.dom,this.view.observer.selectionRange)}nearest(t){for(let e=t;e;){let t=Kp.get(e);if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(i<t.length||t instanceof Bg)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){for(let i=this.length,n=this.children.length-1;;n--){let r=this.children[n],s=i-r.breakAfter-r.length;if(t>s||t==s&&r.type!=Qg.WidgetBefore&&r.type!=Qg.WidgetAfter&&(!n||2==e||this.children[n-1].breakAfter||this.children[n-1].type==Qg.WidgetBefore&&e>-2))return r.coordsAt(t-s,e);i=s}}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,r=this.view.contentDOM.clientWidth,s=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,l=this.view.textDirection==um.LTR;for(let t=0,a=0;a<this.children.length;a++){let h=this.children[a],c=t+h.length;if(c>n)break;if(t>=i){let i=h.dom.getBoundingClientRect();if(e.push(i.height),s){let e=h.dom.lastChild,n=e?Ep(e):[];if(n.length){let e=n[n.length-1],s=l?e.right-i.left:i.right-e.left;s>o&&(o=s,this.minWidth=r,this.minWidthFrom=t,this.minWidthTo=c)}}}t=c+h.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return"rtl"==getComputedStyle(this.children[e].dom).direction?um.RTL:um.LTR}measureTextSize(){for(let t of this.children)if(t instanceof Bg){let e=t.measureTextSize();if(e)return e}let t,e,i=document.createElement("div");return i.className="cm-line",i.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(i);let n=Ep(i.firstChild)[0];t=i.getBoundingClientRect().height,e=n?n.width/27:7,i.remove()})),{lineHeight:t,charWidth:e}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new tg(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let r=n==e.viewports.length?null:e.viewports[n],s=r?r.from-1:this.length;if(s>i){let n=e.lineBlockAt(s).bottom-e.lineBlockAt(i).top;t.push(Rg.replace({widget:new Qm(n),block:!0,inclusive:!0,isBlockGap:!0}).range(i,s))}if(!r)break;i=r.to+1}return Rg.set(t)}updateDeco(){let t=this.view.state.facet(sm).map(((t,e)=>(this.dynamicDecorationMap[e]="function"==typeof t)?t(this.view):t));for(let e=t.length;e<t.length+3;e++)this.dynamicDecorationMap[e]=!1;return this.decorations=[...t,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(t){let e,{range:i}=t,n=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1);if(!n)return;!i.empty&&(e=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(n={left:Math.min(n.left,e.left),top:Math.min(n.top,e.top),right:Math.max(n.right,e.right),bottom:Math.max(n.bottom,e.bottom)});let r=0,s=0,o=0,l=0;for(let t of this.view.state.facet(lm).map((t=>t(this.view))))if(t){let{left:e,right:i,top:n,bottom:a}=t;null!=e&&(r=Math.max(r,e)),null!=i&&(s=Math.max(s,i)),null!=n&&(o=Math.max(o,n)),null!=a&&(l=Math.max(l,a))}let a={left:n.left-r,top:n.top-o,right:n.right+s,bottom:n.bottom+l};!function(t,e,i,n,r,s,o,l){let a=t.ownerDocument,h=a.defaultView;for(let c=t;c;)if(1==c.nodeType){let t,u=c==a.body;if(u)t=Vp(h);else{if(c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.parentNode;continue}let e=c.getBoundingClientRect();t={left:e.left,right:e.left+c.clientWidth,top:e.top,bottom:e.top+c.clientHeight}}let f=0,d=0;if("nearest"==r)e.top<t.top?(d=-(t.top-e.top+o),i>0&&e.bottom>t.bottom+d&&(d=e.bottom-t.bottom+d+o)):e.bottom>t.bottom&&(d=e.bottom-t.bottom+o,i<0&&e.top-d<t.top&&(d=-(t.top+d-e.top+o)));else{let n=e.bottom-e.top,s=t.bottom-t.top;d=("center"==r&&n<=s?e.top+n/2-s/2:"start"==r||"center"==r&&i<0?e.top-o:e.bottom-s+o)-t.top}if("nearest"==n?e.left<t.left?(f=-(t.left-e.left+s),i>0&&e.right>t.right+f&&(f=e.right-t.right+f+s)):e.right>t.right&&(f=e.right-t.right+s,i<0&&e.left<t.left+f&&(f=-(t.left+f-e.left+s))):f=("center"==n?e.left+(e.right-e.left)/2-(t.right-t.left)/2:"start"==n==l?e.left-s:e.right-(t.right-t.left)+s)-t.left,f||d)if(u)h.scrollBy(f,d);else{if(d){let t=c.scrollTop;c.scrollTop+=d,d=c.scrollTop-t}if(f){let t=c.scrollLeft;c.scrollLeft+=f,f=c.scrollLeft-t}e={left:e.left-f,top:e.top-d,right:e.right-f,bottom:e.bottom-d}}if(u)break;c=c.assignedSlot||c.parentNode,n=r="nearest"}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,a,i.head<i.anchor?-1:1,t.x,t.y,t.xMargin,t.yMargin,this.view.textDirection==um.LTR)}}class Qm extends Mg{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function Rm(t){let e=t.observer.selectionRange,i=e.focusNode&&_m(e.focusNode,e.focusOffset,0);if(!i)return null;let n=t.docView.nearest(i);if(!n)return null;if(n instanceof Bg){let t=i;for(;t.parentNode!=n.dom;)t=t.parentNode;let e=t.previousSibling;for(;e&&!Kp.get(e);)e=e.previousSibling;let r=e?Kp.get(e).posAtEnd:n.posAtStart;return{from:r,to:r,node:t,text:i}}{for(;;){let{parent:t}=n;if(!t)return null;if(t instanceof Bg)break;n=t}let t=n.posAtStart;return{from:t,to:t+n.length,node:n.dom,text:i}}}class $m extends Mg{constructor(t,e,i){super(),this.top=t,this.text=e,this.topView=i}eq(t){return this.top==t.top&&this.text==t.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return vg}}function _m(t,e,i){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0&&i<=0)e=zp(t=t.childNodes[e-1]);else{if(!(1==t.nodeType&&e<t.childNodes.length&&i>=0))return null;t=t.childNodes[e],e=0}}}class Dm{constructor(){this.changes=[]}compareRange(t,e){Ng(t,e,this.changes)}comparePoint(t,e){Ng(t,e,this.changes)}}function Em(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function Nm(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function Bm(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function Im(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function zm(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function Lm(t,e,i){let n,r,s,o,l,a,h,c;for(let u=t.firstChild;u;u=u.nextSibling){let t=Ep(u);for(let f=0;f<t.length;f++){let d=t[f];r&&Bm(r,d)&&(d=Im(zm(d,r.bottom),r.top));let p=Em(e,d),g=Nm(i,d);if(0==p&&0==g)return 3==u.nodeType?Wm(u,e,i):Lm(u,e,i);(!n||o>g||o==g&&s>p)&&(n=u,r=d,s=p,o=g),0==p?i>d.bottom&&(!h||h.bottom<d.bottom)?(l=u,h=d):i<d.top&&(!c||c.top>d.top)&&(a=u,c=d):h&&Bm(h,d)?h=zm(h,d.bottom):c&&Bm(c,d)&&(c=Im(c,d.top))}}if(h&&h.bottom>=i?(n=l,r=h):c&&c.top<=i&&(n=a,r=c),!n)return{node:t,offset:0};let u=Math.max(r.left,Math.min(r.right,e));return 3==n.nodeType?Wm(n,u,i):s||"true"!=n.contentEditable?{node:t,offset:Array.prototype.indexOf.call(t.childNodes,n)+(e>=(r.left+r.right)/2?1:0)}:Lm(n,u,i)}function Wm(t,e,i){let n=t.nodeValue.length,r=-1,s=1e9,o=0;for(let l=0;l<n;l++){let n=Fp(t,l,l+1).getClientRects();for(let a=0;a<n.length;a++){let h=n[a];if(h.top==h.bottom)continue;o||(o=e-h.left);let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&c<s){let i=e>=(h.left+h.right)/2,n=i;if(pg.chrome||pg.gecko){Fp(t,l).getBoundingClientRect().left==h.right&&(n=!i)}if(c<=0)return{node:t,offset:l+(n?1:0)};r=l+(n?1:0),s=c}}}return{node:t,offset:r>-1?r:o>0?t.nodeValue.length:0}}function Vm(t,{x:e,y:i},n,r=-1){var s;let o,l=t.contentDOM.getBoundingClientRect(),a=l.top+t.viewState.paddingTop,{docHeight:h}=t.viewState,c=i-a;if(c<0)return 0;if(c>h)return t.state.doc.length;for(let e=t.defaultLineHeight/2,i=!1;o=t.elementAtHeight(c),o.type!=Qg.Text;)for(;c=r>0?o.bottom+e:o.top-e,!(c>=0&&c<=h);){if(i)return n?null:0;i=!0,r=-r}i=a+c;let u=o.from;if(u<t.viewport.from)return 0==t.viewport.from?0:n?null:jm(t,l,o,e,i);if(u>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:n?null:jm(t,l,o,e,i);let f=t.dom.ownerDocument,d=t.root.elementFromPoint?t.root:f,p=d.elementFromPoint(e,i);p&&!t.contentDOM.contains(p)&&(p=null),p||(e=Math.max(l.left+1,Math.min(l.right-1,e)),p=d.elementFromPoint(e,i),p&&!t.contentDOM.contains(p)&&(p=null));let g,m=-1;if(p&&0!=(null===(s=t.docView.nearest(p))||void 0===s?void 0:s.isEditable))if(f.caretPositionFromPoint){let t=f.caretPositionFromPoint(e,i);t&&({offsetNode:g,offset:m}=t)}else if(f.caretRangeFromPoint){let t=f.caretRangeFromPoint(e,i);t&&(({startContainer:g,startOffset:m}=t),pg.safari&&function(t,e,i){let n;if(3!=t.nodeType||e!=(n=t.nodeValue.length))return!1;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return Fp(t,n-1,n).getBoundingClientRect().left>i}(g,m,e)&&(g=void 0))}if(!g||!t.docView.dom.contains(g)){let n=Bg.find(t.docView,u);if(!n)return c>o.top+o.height/2?o.to:o.from;({node:g,offset:m}=Lm(n.dom,e,i))}return t.docView.posFromDOM(g,m)}function jm(t,e,i,n,r){let s=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&i.height>1.5*t.defaultLineHeight){s+=Math.floor((r-i.top)/t.defaultLineHeight)*t.viewState.heightOracle.lineLength}let o=t.state.sliceDoc(i.from,i.to);return i.from+function(t,e,i,n){for(let n=0,r=0;;){if(r>=e)return n;if(n==t.length)break;r+=9==t.charCodeAt(n)?i-r%i:1,n=sd(t,n)}return!0===n?-1:t.length}(o,s,t.state.tabSize)}function qm(t,e,i,n){let r=t.state.doc.lineAt(e.head),s=t.bidiSpans(r),o=t.textDirectionAt(r.from);for(let l=e,a=null;;){let e=Sm(r,s,o,l,i),h=km;if(!e){if(r.number==(i?t.state.doc.lines:1))return l;h="\n",r=t.state.doc.line(r.number+(i?1:-1)),s=t.bidiSpans(r),e=kd.cursor(i?r.from:r.to)}if(a){if(!a(h))return l}else{if(!n)return e;a=n(h)}l=e}}function Hm(t,e,i){let n=t.state.facet(om).map((e=>e(t)));for(;;){let t=!1;for(let r of n)r.between(i.from-1,i.from+1,((n,r,s)=>{i.from>n&&i.from<r&&(i=e.from>i.from?kd.cursor(n,1):kd.cursor(r,-1),t=!0)}));if(!t)return i}}class Xm{constructor(t){this.lastKeyCode=0,this.lastKeyTime=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.rapidCompositionStart=!1,this.mouseSelection=null;for(let e in Ym){let i=Ym[e];t.contentDOM.addEventListener(e,(n=>{Um(t,n)&&!this.ignoreDuringComposition(n)&&("keydown"==e&&this.keydown(t,n)||(this.mustFlushObserver(n)&&t.observer.forceFlush(),this.runCustomHandlers(e,t,n)?n.preventDefault():i(t,n)))})),this.registeredEvents.push(e)}pg.chrome&&pg.chrome_version>=102&&t.scrollDOM.addEventListener("wheel",(()=>{this.chromeScrollHack<0?t.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout((()=>{this.chromeScrollHack=-1,t.contentDOM.style.pointerEvents=""}),100)}),{passive:!0}),this.notifiedFocused=t.hasFocus,pg.safari&&t.contentDOM.addEventListener("input",(()=>null))}setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}ensureHandlers(t,e){var i;let n;this.customHandlers=[];for(let r of e)if(n=null===(i=r.update(t).spec)||void 0===i?void 0:i.domEventHandlers){this.customHandlers.push({plugin:r.value,handlers:n});for(let e in n)this.registeredEvents.indexOf(e)<0&&"scroll"!=e&&(this.registeredEvents.push(e),t.contentDOM.addEventListener(e,(i=>{Um(t,i)&&this.runCustomHandlers(e,t,i)&&i.preventDefault()})))}}runCustomHandlers(t,e,i){for(let n of this.customHandlers){let r=n.handlers[t];if(r)try{if(r.call(n.plugin,i,e)||i.defaultPrevented)return!0}catch(t){Yg(e.state,t)}}return!1}runScrollHandlers(t,e){for(let i of this.customHandlers){let n=i.handlers.scroll;if(n)try{n.call(i.plugin,e,t)}catch(e){Yg(t.state,e)}}}keydown(t,e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),9==e.keyCode&&Date.now()<this.lastEscPress+2e3)return!0;if(pg.android&&pg.chrome&&!e.synthetic&&(13==e.keyCode||8==e.keyCode))return t.observer.delayAndroidKey(e.key,e.keyCode),!0;let i;return!(!pg.ios||!(i=Fm.find((t=>t.keyCode==e.keyCode)))||e.ctrlKey||e.altKey||e.metaKey||e.synthetic)&&(this.pendingIOSKey=i,setTimeout((()=>this.flushIOSKey(t)),250),!0)}flushIOSKey(t){let e=this.pendingIOSKey;return!!e&&(this.pendingIOSKey=void 0,Zp(t.contentDOM,e.key,e.keyCode))}ignoreDuringComposition(t){return!!/^key/.test(t.type)&&(this.composing>0||!!(pg.safari&&Date.now()-this.compositionEndedAt<100)&&(this.compositionEndedAt=0,!0))}mustFlushObserver(t){return"keydown"==t.type&&229!=t.keyCode||"compositionend"==t.type&&!pg.ios}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.mouseSelection&&this.mouseSelection.update(t),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const Fm=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Zm=[16,17,18,20,91,92,224,225];class Gm{constructor(t,e,i,n){this.view=t,this.style=i,this.mustSelect=n,this.lastEvent=e;let r=t.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(pp.allowMultipleSelections)&&function(t,e){let i=t.state.facet(Vg);return i.length?i[0](e):pg.mac?e.metaKey:e.ctrlKey}(t,e),this.dragMove=function(t,e){let i=t.state.facet(jg);return i.length?i[0](e):pg.mac?!e.altKey:!e.ctrlKey}(t,e),this.dragging=!(!function(t,e){let{main:i}=t.state.selection;if(i.empty)return!1;let n=$p(t.root);if(0==n.rangeCount)return!0;let r=n.getRangeAt(0).getClientRects();for(let t=0;t<r.length;t++){let i=r[t];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}(t,e)||1!=cb(e))&&null,!1===this.dragging&&(e.preventDefault(),this.select(e))}move(t){if(0==t.buttons)return this.destroy();!1===this.dragging&&this.select(this.lastEvent=t)}up(t){null==this.dragging&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}select(t){let e=this.style.get(t,this.extend,this.multiple);!this.mustSelect&&e.eq(this.view.state.selection)&&e.main.assoc==this.view.state.selection.main.assoc||this.view.dispatch({selection:e,userEvent:"select.pointer",scrollIntoView:!0}),this.mustSelect=!1}update(t){t.docChanged&&this.dragging&&(this.dragging=this.dragging.map(t.changes)),this.style.update(t)&&setTimeout((()=>this.select(this.lastEvent)),20)}}function Um(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i,n=e.target;n!=t.contentDOM;n=n.parentNode)if(!n||11==n.nodeType||(i=Kp.get(n))&&i.ignoreEvent(e))return!1;return!0}const Ym=Object.create(null),Km=pg.ie&&pg.ie_version<15||pg.ios&&pg.webkit_version<604;function Jm(t,e){let i,{state:n}=t,r=1,s=n.toText(e),o=s.lines==n.selection.ranges.length;if(null!=fb&&n.selection.ranges.every((t=>t.empty))&&fb==s.toString()){let t=-1;i=n.changeByRange((i=>{let l=n.doc.lineAt(i.from);if(l.from==t)return{range:i};t=l.from;let a=n.toText((o?s.line(r++).text:e)+n.lineBreak);return{changes:{from:l.from,insert:a},range:kd.cursor(i.from+a.length)}}))}else i=o?n.changeByRange((t=>{let e=s.line(r++);return{changes:{from:t.from,to:t.to,insert:e.text},range:kd.cursor(t.from+e.length)}})):n.replaceSelection(s);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}Ym.keydown=(t,e)=>{t.inputState.setSelectionOrigin("select"),27==e.keyCode?t.inputState.lastEscPress=Date.now():Zm.indexOf(e.keyCode)<0&&(t.inputState.lastEscPress=0)};let tb=0;function eb(t,e,i,n){if(1==n)return kd.cursor(e,i);if(2==n)return function(t,e,i=1){let n=t.charCategorizer(e),r=t.doc.lineAt(e),s=e-r.from;if(0==r.length)return kd.cursor(e);0==s?i=1:s==r.length&&(i=-1);let o=s,l=s;i<0?o=sd(r.text,s,!1):l=sd(r.text,s);let a=n(r.text.slice(o,l));for(;o>0;){let t=sd(r.text,o,!1);if(n(r.text.slice(t,o))!=a)break;o=t}for(;l<r.length;){let t=sd(r.text,l);if(n(r.text.slice(l,t))!=a)break;l=t}return kd.range(o+r.from,l+r.from)}(t.state,e,i);{let i=Bg.find(t.docView,e),n=t.state.doc.lineAt(i?i.posAtEnd:e),r=i?i.posAtStart:n.from,s=i?i.posAtEnd:n.to;return s<t.state.doc.length&&s==n.to&&s++,kd.range(r,s)}}Ym.touchstart=(t,e)=>{tb=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},Ym.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")},Ym.mousedown=(t,e)=>{if(t.observer.flush(),tb>Date.now()-2e3&&1==cb(e))return;let i=null;for(let n of t.state.facet(qg))if(i=n(t,e),i)break;if(i||0!=e.button||(i=function(t,e){let i=sb(t,e),n=cb(e),r=t.state.selection,s=i,o=e;return{update(t){t.docChanged&&(i&&(i.pos=t.changes.mapPos(i.pos)),r=r.map(t.changes),o=null)},get(e,l,a){let h;if(o&&e.clientX==o.clientX&&e.clientY==o.clientY?h=s:(h=s=sb(t,e),o=e),!h||!i)return r;let c=eb(t,h.pos,h.bias,n);if(i.pos!=h.pos&&!l){let e=eb(t,i.pos,i.bias,n),r=Math.min(e.from,c.from),s=Math.max(e.to,c.to);c=r<c.from?kd.range(r,s):kd.range(s,r)}return l?r.replaceRange(r.main.extend(c.from,c.to)):a?r.addRange(c):kd.create([c])}}}(t,e)),i){let n=t.root.activeElement!=t.contentDOM;n&&t.observer.ignore((()=>Xp(t.contentDOM))),t.inputState.startMouseSelection(new Gm(t,e,i,n))}};let ib=(t,e)=>t>=e.top&&t<=e.bottom,nb=(t,e,i)=>ib(e,i)&&t>=i.left&&t<=i.right;function rb(t,e,i,n){let r=Bg.find(t.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(0==s)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&nb(i,n,o))return-1;let l=r.coordsAt(s,1);return l&&nb(i,n,l)?1:o&&ib(n,o)?-1:1}function sb(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:rb(t,i,e.clientX,e.clientY)}}const ob=pg.ie&&pg.ie_version<=11;let lb=null,ab=0,hb=0;function cb(t){if(!ob)return t.detail;let e=lb,i=hb;return lb=t,hb=Date.now(),ab=!e||i>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(ab+1)%3:1}function ub(t,e,i,n){if(!i)return;let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:s}=t.inputState,o=n&&s&&s.dragging&&s.dragMove?{from:s.dragging.from,to:s.dragging.to}:null,l={from:r,insert:i},a=t.state.changes(o?[o,l]:l);t.focus(),t.dispatch({changes:a,selection:{anchor:a.mapPos(r,-1),head:a.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"})}Ym.dragstart=(t,e)=>{let{selection:{main:i}}=t.state,{mouseSelection:n}=t.inputState;n&&(n.dragging=i),e.dataTransfer&&(e.dataTransfer.setData("Text",t.state.sliceDoc(i.from,i.to)),e.dataTransfer.effectAllowed="copyMove")},Ym.drop=(t,e)=>{if(!e.dataTransfer)return;if(t.state.readOnly)return e.preventDefault();let i=e.dataTransfer.files;if(i&&i.length){e.preventDefault();let n=Array(i.length),r=0,s=()=>{++r==i.length&&ub(t,e,n.filter((t=>null!=t)).join(t.state.lineBreak),!1)};for(let t=0;t<i.length;t++){let e=new FileReader;e.onerror=s,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(n[t]=e.result),s()},e.readAsText(i[t])}}else ub(t,e,e.dataTransfer.getData("Text"),!0)},Ym.paste=(t,e)=>{if(t.state.readOnly)return e.preventDefault();t.observer.flush();let i=Km?null:e.clipboardData;i?(Jm(t,i.getData("text/plain")),e.preventDefault()):function(t){let e=t.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((()=>{t.focus(),i.remove(),Jm(t,i.value)}),50)}(t)};let fb=null;function db(t){setTimeout((()=>{t.hasFocus!=t.inputState.notifiedFocused&&t.update([])}),10)}function pb(t,e){if(t.docView.compositionDeco.size){t.inputState.rapidCompositionStart=e;try{t.update([])}finally{t.inputState.rapidCompositionStart=!1}}}Ym.copy=Ym.cut=(t,e)=>{let{text:i,ranges:n,linewise:r}=function(t){let e=[],i=[],n=!1;for(let n of t.selection.ranges)n.empty||(e.push(t.sliceDoc(n.from,n.to)),i.push(n));if(!e.length){let r=-1;for(let{from:n}of t.selection.ranges){let s=t.doc.lineAt(n);s.number>r&&(e.push(s.text),i.push({from:s.from,to:Math.min(t.doc.length,s.to+1)})),r=s.number}n=!0}return{text:e.join(t.lineBreak),ranges:i,linewise:n}}(t.state);if(!i&&!r)return;fb=r?i:null;let s=Km?null:e.clipboardData;s?(e.preventDefault(),s.clearData(),s.setData("text/plain",i)):function(t,e){let i=t.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout((()=>{n.remove(),t.focus()}),50)}(t,i),"cut"!=e.type||t.state.readOnly||t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"})},Ym.focus=db,Ym.blur=t=>{t.observer.clearSelectionRange(),db(t)},Ym.compositionstart=Ym.compositionupdate=t=>{null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0,t.docView.compositionDeco.size&&(t.observer.flush(),pb(t,!0)))},Ym.compositionend=t=>{t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionFirstChange=null,setTimeout((()=>{t.inputState.composing<0&&pb(t,!1)}),50)},Ym.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()},Ym.beforeinput=(t,e)=>{var i;let n;if(pg.chrome&&pg.android&&(n=Fm.find((t=>t.inputType==e.inputType)))&&(t.observer.delayAndroidKey(n.key,n.keyCode),"Backspace"==n.key||"Delete"==n.key)){let e=(null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0;setTimeout((()=>{var i;((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>e+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())}),100)}};const gb=["pre-wrap","normal","pre-line","break-spaces"];class mb{constructor(){this.doc=Ff.empty,this.lineWrapping=!1,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength)),this.lineHeight*i}heightForLine(t){if(!this.lineWrapping)return this.lineHeight;return(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return gb.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(10*n)]||(e=!0,this.heightSamples[Math.floor(10*n)]=!0)}return e}refresh(t,e,i,n,r){let s=gb.indexOf(t)>-1,o=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=s;if(this.lineWrapping=s,this.lineHeight=e,this.charWidth=i,this.lineLength=n,o){this.heightSamples={};for(let t=0;t<r.length;t++){let e=r[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return o}}class bb{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class Ob{constructor(t,e,i,n,r){this.from=t,this.length=e,this.top=i,this.height=n,this.type=r}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(t){let e=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(t.type)?t.type:[t]);return new Ob(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var vb=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(vb||(vb={}));const wb=.001;class yb{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t,e){this.height!=e&&(Math.abs(this.height-e)>wb&&(t.heightChanged=!0),this.height=e)}replace(t,e,i){return yb.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let r=this;for(let s=n.length-1;s>=0;s--){let{fromA:o,toA:l,fromB:a,toB:h}=n[s],c=r.lineAt(o,vb.ByPosNoHeight,e,0,0),u=c.to>=l?c:r.lineAt(l,vb.ByPosNoHeight,e,0,0);for(h+=u.to-l,l=u.to;s>0&&c.from<=n[s-1].toA;)o=n[s-1].fromA,a=n[s-1].fromB,s--,o<c.from&&(c=r.lineAt(o,vb.ByPosNoHeight,e,0,0));a+=c.from-o,o=c.from;let f=Tb.build(i,t,a,h);r=r.replace(o,l,f)}return r.updateHeight(i,0)}static empty(){return new kb(0,0)}static of(t){if(1==t.length)return t[0];let e=0,i=t.length,n=0,r=0;for(;;)if(e==i)if(n>2*r){let r=t[e-1];r.break?t.splice(--e,1,r.left,null,r.right):t.splice(--e,1,r.left,r.right),i+=1+r.break,n-=r.size}else{if(!(r>2*n))break;{let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,r-=e.size}}else if(n<r){let i=t[e++];i&&(n+=i.size)}else{let e=t[--i];e&&(r+=e.size)}let s=0;return null==t[e-1]?(s=1,e--):null==t[e]&&(s=1,i++),new Cb(yb.of(t.slice(0,e)),s,yb.of(t.slice(i)))}}yb.prototype.size=1;class xb extends yb{constructor(t,e,i){super(t,e),this.type=i}blockAt(t,e,i,n){return new Ob(n,this.length,i,this.height,this.type)}lineAt(t,e,i,n,r){return this.blockAt(0,i,n,r)}forEachLine(t,e,i,n,r,s){t<=r+this.length&&e>=r&&s(this.blockAt(0,i,n,r))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(t,n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class kb extends xb{constructor(t,e){super(t,e,Qg.Text),this.collapsed=0,this.widgetHeight=0}replace(t,e,i){let n=i[0];return 1==i.length&&(n instanceof kb||n instanceof Sb&&4&n.flags)&&Math.abs(this.length-n.length)<10?(n instanceof Sb?n=new kb(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):yb.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(t,n.heights[n.index++]):(i||this.outdated)&&this.setHeight(t,Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Sb extends yb{constructor(t){super(t,0)}lines(t,e){let i=t.lineAt(e).number,n=t.lineAt(e+this.length).number;return{firstLine:i,lastLine:n,lineHeight:this.height/(n-i+1)}}blockAt(t,e,i,n){let{firstLine:r,lastLine:s,lineHeight:o}=this.lines(e,n),l=Math.max(0,Math.min(s-r,Math.floor((t-i)/o))),{from:a,length:h}=e.line(r+l);return new Ob(a,h,i+o*l,o,Qg.Text)}lineAt(t,e,i,n,r){if(e==vb.ByHeight)return this.blockAt(t,i,n,r);if(e==vb.ByPosNoHeight){let{from:e,to:n}=i.lineAt(t);return new Ob(e,n-e,0,0,Qg.Text)}let{firstLine:s,lineHeight:o}=this.lines(i,r),{from:l,length:a,number:h}=i.lineAt(t);return new Ob(l,a,n+o*(h-s),o,Qg.Text)}forEachLine(t,e,i,n,r,s){let{firstLine:o,lineHeight:l}=this.lines(i,r);for(let a=Math.max(t,r),h=Math.min(r+this.length,e);a<=h;){let e=i.lineAt(a);a==t&&(n+=l*(e.number-o)),s(new Ob(e.from,e.length,n,l,Qg.Text)),n+=l,a=e.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let t=i[i.length-1];t instanceof Sb?i[i.length-1]=new Sb(t.length+n):i.push(null,new Sb(n-1))}if(t>0){let e=i[0];e instanceof Sb?i[0]=new Sb(t+e.length):i.unshift(new Sb(t-1),null)}return yb.of(i)}decomposeLeft(t,e){e.push(new Sb(t-1),null)}decomposeRight(t,e){e.push(null,new Sb(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let r=e+this.length;if(n&&n.from<=e+this.length&&n.more){let i=[],s=Math.max(e,n.from),o=-1,l=t.heightChanged;for(n.from>e&&i.push(new Sb(n.from-e-1).updateHeight(t,e));s<=r&&n.more;){let e=t.doc.lineAt(s).length;i.length&&i.push(null);let r=n.heights[n.index++];-1==o?o=r:Math.abs(r-o)>=wb&&(o=-2);let l=new kb(e,r);l.outdated=!1,i.push(l),s+=e+1}s<=r&&i.push(null,new Sb(r-s).updateHeight(t,s));let a=yb.of(i);return t.heightChanged=l||o<0||Math.abs(a.height-this.height)>=wb||Math.abs(o-this.lines(t.doc,e).lineHeight)>=wb,a}return(i||this.outdated)&&(this.setHeight(t,t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class Cb extends yb{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return 1&this.flags}blockAt(t,e,i,n){let r=i+this.left.height;return t<r?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,r,n+this.left.length+this.break)}lineAt(t,e,i,n,r){let s=n+this.left.height,o=r+this.left.length+this.break,l=e==vb.ByHeight?t<s:t<o,a=l?this.left.lineAt(t,e,i,n,r):this.right.lineAt(t,e,i,s,o);if(this.break||(l?a.to<o:a.from>o))return a;let h=e==vb.ByPosNoHeight?vb.ByPosNoHeight:vb.ByPos;return l?a.join(this.right.lineAt(o,h,i,s,o)):this.left.lineAt(o,h,i,n,r).join(a)}forEachLine(t,e,i,n,r,s){let o=n+this.left.height,l=r+this.left.length+this.break;if(this.break)t<l&&this.left.forEachLine(t,e,i,n,r,s),e>=l&&this.right.forEachLine(t,e,i,o,l,s);else{let a=this.lineAt(l,vb.ByPos,i,n,r);t<a.from&&this.left.forEachLine(t,a.from-1,i,n,r,s),a.to>=t&&a.from<=e&&s(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,o,l,s)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let r=[];t>0&&this.decomposeLeft(t,r);let s=r.length;for(let t of i)r.push(t);if(t>0&&Ab(r,s-1),e<this.length){let t=r.length;this.decomposeRight(e,r),Ab(r,t)}return yb.of(r)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?yb.of(this.break?[t,null,e]:[t,e]):(this.left=t,this.right=e,this.height=t.height+e.height,this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:r,right:s}=this,o=e+r.length+this.break,l=null;return n&&n.from<=e+r.length&&n.more?l=r=r.updateHeight(t,e,i,n):r.updateHeight(t,e,i),n&&n.from<=o+s.length&&n.more?l=s=s.updateHeight(t,o,i,n):s.updateHeight(t,o,i),l?this.balanced(r,s):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Ab(t,e){let i,n;null==t[e]&&(i=t[e-1])instanceof Sb&&(n=t[e+1])instanceof Sb&&t.splice(e-1,3,new Sb(i.length+1+n.length))}class Tb{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof kb?i.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new kb(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0;n<0&&(n=this.oracle.lineHeight);let r=e-t;i.block?this.addBlock(new xb(r,n,i.type)):(r||n>=5)&&this.addLineDeco(n,r)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new kb(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new Sb(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof kb)return t;let e=new kb(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine(),t.type!=Qg.WidgetAfter||this.isCovered||this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,t.type!=Qg.WidgetBefore&&(this.covering=t)}addLineDeco(t,e){let i=this.ensureLine();i.length+=e,i.collapsed+=e,i.widgetHeight=Math.max(i.widgetHeight,t),this.writtenTo=this.pos=this.pos+e}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof kb||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new kb(0,-1));let i=t;for(let t of this.nodes)t instanceof kb&&t.updateHeight(this.oracle,i),i+=t?t.length:1;return this.nodes}static build(t,e,i,n){let r=new Tb(i,t);return wp.spans(e,i,n,r,0),r.finish(i)}}class Pb{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&Ng(t,e,this.changes,5)}}function Mb(t,e){let i=t.getBoundingClientRect(),n=Math.max(0,i.left),r=Math.min(innerWidth,i.right),s=Math.max(0,i.top),o=Math.min(innerHeight,i.bottom),l=t.ownerDocument.body;for(let e=t.parentNode;e&&e!=l;)if(1==e.nodeType){let t=e,i=window.getComputedStyle(t);if((t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)&&"visible"!=i.overflow){let e=t.getBoundingClientRect();n=Math.max(n,e.left),r=Math.min(r,e.right),s=Math.max(s,e.top),o=Math.min(o,e.bottom)}e="absolute"==i.position||"fixed"==i.position?t.offsetParent:t.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{left:n-i.left,right:Math.max(n,r)-i.left,top:s-(i.top+e),bottom:Math.max(s,o)-(i.top+e)}}function Qb(t,e){let i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class Rb{constructor(t,e,i){this.from=t,this.to=e,this.size=i}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],r=e[i];if(n.from!=r.from||n.to!=r.to||n.size!=r.size)return!1}return!0}draw(t){return Rg.replace({widget:new $b(this.size,t)}).range(this.from,this.to)}}class $b extends Mg{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class _b{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.heightOracle=new mb,this.scaler=Lb,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=um.RTL,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1,this.stateDeco=t.facet(sm).filter((t=>"function"!=typeof t)),this.heightMap=yb.empty().applyChanges(this.stateDeco,Ff.empty,this.heightOracle.setDoc(t.doc),[new hm(0,0,0,t.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Rg.set(this.lineGaps.map((t=>t.draw(!1)))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some((({from:t,to:e})=>n>=t&&n<=e))){let{from:e,to:i}=this.lineBlockAt(n);t.push(new Db(e,i))}}this.viewports=t.sort(((t,e)=>t.from-e.from)),this.scaler=this.heightMap.height<=7e6?Lb:new Wb(this.heightOracle.doc,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,(t=>{this.viewportLines.push(1==this.scaler.scale?t:Vb(t,this.scaler))}))}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(sm).filter((t=>"function"!=typeof t));let n=t.changedRanges,r=hm.extendWithRanges(n,function(t,e,i){let n=new Pb;return wp.compare(t,e,i,n,0),n.changes}(i,this.stateDeco,t?t.changes:gd.empty(this.state.doc.length))),s=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),r),this.heightMap.height!=s&&(t.flags|=2);let o=r.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<o.from||e.range.head>o.to)||!this.viewportIsAppropriate(o))&&(o=this.getViewport(0,e));let l=!t.changes.empty||2&t.flags||o.from!=this.viewport.from||o.to!=this.viewport.to;this.viewport=o,this.updateForViewport(),l&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,r=i.whiteSpace;this.defaultTextDirection="rtl"==i.direction?um.RTL:um.LTR;let s=this.heightOracle.mustRefreshForWrapping(r),o=s||this.mustMeasureContent||this.contentDOMHeight!=e.clientHeight;this.contentDOMHeight=e.clientHeight,this.mustMeasureContent=!1;let l=0,a=0,h=parseInt(i.paddingTop)||0,c=parseInt(i.paddingBottom)||0;this.paddingTop==h&&this.paddingBottom==c||(this.paddingTop=h,this.paddingBottom=c,l|=10),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(o=!0),this.editorWidth=t.scrollDOM.clientWidth,l|=8);let u=(this.printing?Qb:Mb)(e,this.paddingTop),f=u.top-this.pixelViewport.top,d=u.bottom-this.pixelViewport.bottom;this.pixelViewport=u;let p=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(p!=this.inView&&(this.inView=p,p&&(o=!0)),!this.inView)return 0;let g=e.clientWidth;if(this.contentDOMWidth==g&&this.editorHeight==t.scrollDOM.clientHeight||(this.contentDOMWidth=g,this.editorHeight=t.scrollDOM.clientHeight,l|=8),o){let e=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(e)&&(s=!0),s||n.lineWrapping&&Math.abs(g-this.contentDOMWidth)>n.charWidth){let{lineHeight:i,charWidth:o}=t.docView.measureTextSize();s=n.refresh(r,i,o,g/o,e),s&&(t.docView.minWidth=0,l|=8)}f>0&&d>0?a=Math.max(f,d):f<0&&d<0&&(a=Math.min(f,d)),n.heightChanged=!1;for(let i of this.viewports){let r=i.from==this.viewport.from?e:t.docView.measureVisibleLineHeights(i);this.heightMap=this.heightMap.updateHeight(n,0,s,new bb(i.from,r))}n.heightChanged&&(l|=2)}let m=!this.viewportIsAppropriate(this.viewport,a)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return m&&(this.viewport=this.getViewport(a,this.scrollTarget)),this.updateForViewport(),(2&l||m)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(s?[]:this.lineGaps)),l|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),l}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,r=this.state.doc,{visibleTop:s,visibleBottom:o}=this,l=new Db(n.lineAt(s-1e3*i,vb.ByHeight,r,0,0).from,n.lineAt(o+1e3*(1-i),vb.ByHeight,r,0,0).to);if(e){let{head:t}=e.range;if(t<l.from||t>l.to){let i,s=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),o=n.lineAt(t,vb.ByPos,r,0,0);i="center"==e.y?(o.top+o.bottom)/2-s/2:"start"==e.y||"nearest"==e.y&&t<l.from?o.top:o.bottom-s,l=new Db(n.lineAt(i-500,vb.ByHeight,r,0,0).from,n.lineAt(i+s+500,vb.ByHeight,r,0,0).to)}}return l}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new Db(this.heightMap.lineAt(i,vb.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(n,vb.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,vb.ByPos,this.state.doc,0,0),{bottom:r}=this.heightMap.lineAt(e,vb.ByPos,this.state.doc,0,0),{visibleTop:s,visibleBottom:o}=this;return(0==t||n<=s-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||r>=o+Math.max(10,Math.min(i,250)))&&n>s-2e3&&r<o+2e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new Rb(e.mapPos(n.from),e.mapPos(n.to),n.size));return i}ensureLineGaps(t){let e=[];if(this.defaultTextDirection!=um.LTR)return e;for(let i of this.viewportLines){if(i.length<4e3)continue;let n,r,s=Eb(i.from,i.to,this.stateDeco);if(s.total<4e3)continue;if(this.heightOracle.lineWrapping){let t=2e3/this.heightOracle.lineLength*this.heightOracle.lineHeight;n=Nb(s,(this.visibleTop-i.top-t)/i.height),r=Nb(s,(this.visibleBottom-i.top+t)/i.height)}else{let t=s.total*this.heightOracle.charWidth,e=2e3*this.heightOracle.charWidth;n=Nb(s,(this.pixelViewport.left-e)/t),r=Nb(s,(this.pixelViewport.right+e)/t)}let o=[];n>i.from&&o.push({from:i.from,to:n}),r<i.to&&o.push({from:r,to:i.to});let l=this.state.selection.main;l.from>=i.from&&l.from<=i.to&&Ib(o,l.from-10,l.from+10),!l.empty&&l.to>=i.from&&l.to<=i.to&&Ib(o,l.to-10,l.to+10);for(let{from:n,to:r}of o)r-n>1e3&&e.push(zb(t,(t=>t.from>=i.from&&t.to<=i.to&&Math.abs(t.from-n)<1e3&&Math.abs(t.to-r)<1e3))||new Rb(n,r,this.gapSize(i,n,r,s)))}return e}gapSize(t,e,i,n){let r=Bb(n,i)-Bb(n,e);return this.heightOracle.lineWrapping?t.height*r:n.total*this.heightOracle.charWidth*r}updateLineGaps(t){Rb.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=Rg.set(t.map((t=>t.draw(this.heightOracle.lineWrapping)))))}computeVisibleRanges(){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let e=[];wp.spans(t,this.viewport.from,this.viewport.to,{span(t,i){e.push({from:t,to:i})},point(){}},20);let i=e.length!=this.visibleRanges.length||this.visibleRanges.some(((t,i)=>t.from!=e[i].from||t.to!=e[i].to));return this.visibleRanges=e,i?4:0}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find((e=>e.from<=t&&e.to>=t))||Vb(this.heightMap.lineAt(t,vb.ByPos,this.state.doc,0,0),this.scaler)}lineBlockAtHeight(t){return Vb(this.heightMap.lineAt(this.scaler.fromDOM(t),vb.ByHeight,this.state.doc,0,0),this.scaler)}elementAtHeight(t){return Vb(this.heightMap.blockAt(this.scaler.fromDOM(t),this.state.doc,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Db{constructor(t,e){this.from=t,this.to=e}}function Eb(t,e,i){let n=[],r=t,s=0;return wp.spans(i,t,e,{span(){},point(t,e){t>r&&(n.push({from:r,to:t}),s+=t-r),r=e}},20),r<e&&(n.push({from:r,to:e}),s+=e-r),{total:s,ranges:n}}function Nb({total:t,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let n=Math.floor(t*i);for(let t=0;;t++){let{from:i,to:r}=e[t],s=r-i;if(n<=s)return i+n;n-=s}}function Bb(t,e){let i=0;for(let{from:n,to:r}of t.ranges){if(e<=r){i+=e-n;break}i+=r-n}return i/t.total}function Ib(t,e,i){for(let n=0;n<t.length;n++){let r=t[n];if(r.from<i&&r.to>e){let s=[];r.from<e&&s.push({from:r.from,to:e}),r.to>i&&s.push({from:i,to:r.to}),t.splice(n,1,...s),n+=s.length-1}}}function zb(t,e){for(let i of t)if(e(i))return i}const Lb={toDOM:t=>t,fromDOM:t=>t,scale:1};class Wb{constructor(t,e,i){let n=0,r=0,s=0;this.viewports=i.map((({from:i,to:r})=>{let s=e.lineAt(i,vb.ByPos,t,0,0).top,o=e.lineAt(r,vb.ByPos,t,0,0).bottom;return n+=o-s,{from:i,to:r,top:s,bottom:o,domTop:0,domBottom:0}})),this.scale=(7e6-n)/(e.height-n);for(let t of this.viewports)t.domTop=s+(t.top-r)*this.scale,s=t.domBottom=t.domTop+(t.bottom-t.top),r=t.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.top)return n+(t-i)*this.scale;if(t<=r.bottom)return r.domTop+(t-r.top);i=r.bottom,n=r.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.domTop)return i+(t-n)/this.scale;if(t<=r.domBottom)return r.top+(t-r.domTop);i=r.bottom,n=r.domBottom}}}function Vb(t,e){if(1==e.scale)return t;let i=e.toDOM(t.top),n=e.toDOM(t.bottom);return new Ob(t.from,t.length,i,n-i,Array.isArray(t.type)?t.type.map((t=>Vb(t,e))):t.type)}const jb=Ad.define({combine:t=>t.join(" ")}),qb=Ad.define({combine:t=>t.indexOf(!0)>-1}),Hb=Je.newName(),Xb=Je.newName(),Fb=Je.newName(),Zb={"&light":"."+Xb,"&dark":"."+Fb};function Gb(t,e,i){return new Je(e,{finish:e=>/&/.test(e)?e.replace(/&\w*/,(e=>{if("&"==e)return t;if(!i||!i[e])throw new RangeError(`Unsupported selector: ${e}`);return i[e]})):t+" "+e})}const Ub=Gb("."+Hb,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere"},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},".cm-cursor, .cm-dropCursor":{position:"absolute",borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#f3f9ff"},"&dark .cm-activeLine":{backgroundColor:"#223039"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Zb),Yb={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Kb=pg.ie&&pg.ie_version<=11;class Jb{constructor(t,e,i){this.view=t,this.onChange=e,this.onScrollChanged=i,this.active=!1,this.selectionRange=new jp,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.scrollTargets=[],this.intersection=null,this.resize=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver((e=>{for(let t of e)this.queue.push(t);(pg.ie&&pg.ie_version<=11||pg.ios&&t.composing)&&e.some((t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length))?this.flushSoon():this.flush()})),Kb&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),window.addEventListener("resize",this.onResize=this.onResize.bind(this)),"function"==typeof ResizeObserver&&(this.resize=new ResizeObserver((()=>{this.view.docView.lastUpdate<Date.now()-75&&this.onResize()})),this.resize.observe(t.scrollDOM)),window.addEventListener("beforeprint",this.onPrint=this.onPrint.bind(this)),this.start(),window.addEventListener("scroll",this.onScroll=this.onScroll.bind(this)),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange(),this.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}onScroll(t){this.intersecting&&this.flush(!1),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500)}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some(((e,i)=>e!=t[i])))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:e}=this,i=this.selectionRange;if(e.state.facet(Kg)?e.root.activeElement!=this.dom:!Dp(e.dom,i))return;let n=i.anchorNode&&e.docView.nearest(i.anchorNode);n&&n.ignoreEvent(t)||((pg.ie&&pg.ie_version<=11||pg.android&&pg.chrome)&&!e.state.selection.main.empty&&i.focusNode&&Np(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1))}readSelectionRange(){let{root:t}=this.view,e=$p(t),i=pg.safari&&11==t.nodeType&&function(){let t=document.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}()==this.view.contentDOM&&function(t){let e=null;function i(t){t.preventDefault(),t.stopImmediatePropagation(),e=t.getTargetRanges()[0]}if(t.contentDOM.addEventListener("beforeinput",i,!0),document.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",i,!0),!e)return null;let n=e.startContainer,r=e.startOffset,s=e.endContainer,o=e.endOffset,l=t.docView.domAtPos(t.state.selection.main.anchor);Np(l.node,l.offset,s,o)&&([n,r,s,o]=[s,o,n,r]);return{anchorNode:n,anchorOffset:r,focusNode:s,focusOffset:o}}(this.view)||e;return!this.selectionRange.eq(i)&&(this.selectionRange.setRange(i),this.selectionChanged=!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(1==i.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else{if(11!=i.nodeType)break;i=i.host}if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Yb),Kb&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Kb&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){this.delayedAndroidKey||requestAnimationFrame((()=>{let t=this.delayedAndroidKey;this.delayedAndroidKey=null,this.delayedFlush=-1,this.flush()||Zp(this.view.contentDOM,t.key,t.keyCode)})),this.delayedAndroidKey&&"Enter"!=t||(this.delayedAndroidKey={key:t,keyCode:e})}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=window.setTimeout((()=>{this.delayedFlush=-1,this.flush()}),20))}forceFlush(){this.delayedFlush>=0&&(window.clearTimeout(this.delayedFlush),this.delayedFlush=-1,this.flush())}processRecords(){let t=this.queue;for(let e of this.observer.takeRecords())t.push(e);t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let r of t){let t=this.readMutation(r);t&&(t.typeOver&&(n=!0),-1==e?({from:e,to:i}=t):(e=Math.min(t.from,e),i=Math.max(t.to,i)))}return{from:e,to:i,typeOver:n}}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return;t&&this.readSelectionRange();let{from:e,to:i,typeOver:n}=this.processRecords(),r=this.selectionChanged&&Dp(this.dom,this.selectionRange);if(e<0&&!r)return;this.selectionChanged=!1;let s=this.view.state,o=this.onChange(e,i,n);return this.view.state==s&&this.view.update([]),o}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty("attributes"==t.type),"attributes"==t.type&&(e.dirty|=4),"childList"==t.type){let i=tO(e,t.previousSibling||t.target.previousSibling,-1),n=tO(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}return"characterData"==t.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}destroy(){var t,e,i;this.stop(),null===(t=this.intersection)||void 0===t||t.disconnect(),null===(e=this.gapIntersection)||void 0===e||e.disconnect(),null===(i=this.resize)||void 0===i||i.disconnect();for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onResize),window.removeEventListener("beforeprint",this.onPrint),this.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout)}}function tO(t,e,i){for(;e;){let n=Kp.get(e);if(n&&n.parent==t)return n;let r=e.parentNode;e=r!=t.dom?r:i>0?e.nextSibling:e.previousSibling}return null}function eO(t,e,i,n){let r,s,o=t.state.selection.main;if(e>-1){let n=t.docView.domBoundsAround(e,i,0);if(!n||t.state.readOnly)return!1;let{from:l,to:a}=n,h=t.docView.impreciseHead||t.docView.impreciseAnchor?[]:function(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:i,anchorOffset:n,focusNode:r,focusOffset:s}=t.observer.selectionRange;i&&(e.push(new Pm(i,n)),r==i&&s==n||e.push(new Pm(r,s)));return e}(t),c=new Am(h,t.state);c.readRange(n.startDOM,n.endDOM);let u=o.from,f=null;(8===t.inputState.lastKeyCode&&t.inputState.lastKeyTime>Date.now()-100||pg.android&&c.text.length<a-l)&&(u=o.to,f="end");let d=function(t,e,i,n){let r=Math.min(t.length,e.length),s=0;for(;s<r&&t.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==r&&t.length==e.length)return null;let o=t.length,l=e.length;for(;o>0&&l>0&&t.charCodeAt(o-1)==e.charCodeAt(l-1);)o--,l--;if("end"==n){i-=o+Math.max(0,s-Math.min(o,l))-s}if(o<s&&t.length<e.length){s-=i<=s&&i>=o?s-i:0,l=s+(l-o),o=s}else if(l<s){s-=i<=s&&i>=l?s-i:0,o=s+(o-l),l=s}return{from:s,toA:o,toB:l}}(t.state.doc.sliceString(l,a,Cm),c.text,u-l,f);d&&(pg.chrome&&13==t.inputState.lastKeyCode&&d.toB==d.from+2&&"￿￿"==c.text.slice(d.from,d.toB)&&d.toB--,r={from:l+d.from,to:l+d.toA,insert:Ff.of(c.text.slice(d.from,d.toB).split(Cm))}),s=function(t,e){if(0==t.length)return null;let i=t[0].pos,n=2==t.length?t[1].pos:i;return i>-1&&n>-1?kd.single(i+e,n+e):null}(h,l)}else if(t.hasFocus||!t.state.facet(Kg)){let e=t.observer.selectionRange,{impreciseHead:i,impreciseAnchor:n}=t.docView,r=i&&i.node==e.focusNode&&i.offset==e.focusOffset||!_p(t.contentDOM,e.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),l=n&&n.node==e.anchorNode&&n.offset==e.anchorOffset||!_p(t.contentDOM,e.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(e.anchorNode,e.anchorOffset);r==o.head&&l==o.anchor||(s=kd.single(l,r))}if(!r&&!s)return!1;if(!r&&n&&!o.empty&&s&&s.main.empty?r={from:o.from,to:o.to,insert:t.state.doc.slice(o.from,o.to)}:r&&r.from>=o.from&&r.to<=o.to&&(r.from!=o.from||r.to!=o.to)&&o.to-o.from-(r.to-r.from)<=4?r={from:o.from,to:o.to,insert:t.state.doc.slice(o.from,r.from).append(r.insert).append(t.state.doc.slice(r.to,o.to))}:(pg.mac||pg.android)&&r&&r.from==r.to&&r.from==o.head-1&&"."==r.insert.toString()&&(r={from:o.from,to:o.to,insert:Ff.of([" "])}),r){let e=t.state;if(pg.ios&&t.inputState.flushIOSKey(t))return!0;if(pg.android&&(r.from==o.from&&r.to==o.to&&1==r.insert.length&&2==r.insert.lines&&Zp(t.contentDOM,"Enter",13)||r.from==o.from-1&&r.to==o.to&&0==r.insert.length&&Zp(t.contentDOM,"Backspace",8)||r.from==o.from&&r.to==o.to+1&&0==r.insert.length&&Zp(t.contentDOM,"Delete",46)))return!0;let i,n=r.insert.toString();if(t.state.facet(Fg).some((e=>e(t,r.from,r.to,n))))return!0;if(t.inputState.composing>=0&&t.inputState.composing++,r.from>=o.from&&r.to<=o.to&&r.to-r.from>=(o.to-o.from)/3&&(!s||s.main.empty&&s.main.from==r.from+r.insert.length)&&t.inputState.composing<0){let n=o.from<r.from?e.sliceDoc(o.from,r.from):"",s=o.to>r.to?e.sliceDoc(r.to,o.to):"";i=e.replaceSelection(t.state.toText(n+r.insert.sliceString(0,void 0,t.state.lineBreak)+s))}else{let n=e.changes(r),l=s&&!e.selection.main.eq(s.main)&&s.main.to<=n.newLength?s.main:void 0;if(e.selection.ranges.length>1&&t.inputState.composing>=0&&r.to<=o.to&&r.to>=o.to-10){let s=t.state.sliceDoc(r.from,r.to),a=Rm(t)||t.state.doc.lineAt(o.head),h=o.to-r.to,c=o.to-o.from;i=e.changeByRange((i=>{if(i.from==o.from&&i.to==o.to)return{changes:n,range:l||i.map(n)};let u=i.to-h,f=u-s.length;if(i.to-i.from!=c||t.state.sliceDoc(f,u)!=s||a&&i.to>=a.from&&i.from<=a.to)return{range:i};let d=e.changes({from:f,to:u,insert:r.insert}),p=i.to-o.to;return{changes:d,range:l?kd.range(Math.max(0,l.anchor+p),Math.max(0,l.head+p)):i.map(d)}}))}else i={changes:n,selection:l&&e.selection.replaceRange(l)}}let l="input.type";return t.composing&&(l+=".compose",t.inputState.compositionFirstChange&&(l+=".start",t.inputState.compositionFirstChange=!1)),t.dispatch(i,{scrollIntoView:!0,userEvent:l}),!0}if(s&&!s.main.eq(o)){let e=!1,i="select";return t.inputState.lastSelectionTime>Date.now()-50&&("select"==t.inputState.lastSelectionOrigin&&(e=!0),i=t.inputState.lastSelectionOrigin),t.dispatch({selection:s,scrollIntoView:e,userEvent:i}),!0}return!1}class iO{constructor(t={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: absolute; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=t.dispatch||(t=>this.update([t])),this.dispatch=this.dispatch.bind(this),this.root=t.root||function(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}(t.parent)||document,this.viewState=new _b(t.state||pp.create()),this.plugins=this.state.facet(tm).map((t=>new im(t)));for(let t of this.plugins)t.update(this);this.observer=new Jb(this,((t,e,i)=>eO(this,t,e,i)),(t=>{this.inputState.runScrollHandlers(this,t),this.observer.intersecting&&this.measure()})),this.inputState=new Xm(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new Mm(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),t.parent&&t.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}dispatch(...t){this._dispatch(1==t.length&&t[0]instanceof np?t[0]:this.state.update(...t))}update(t){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e,i=!1,n=!1,r=this.state;for(let e of t){if(e.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=e.state}if(this.destroyed)return void(this.viewState.state=r);if(this.observer.clear(),r.facet(pp.phrases)!=this.state.facet(pp.phrases))return this.setState(r);e=cm.create(this,r,t);let s=this.viewState.scrollTarget;try{this.updateState=2;for(let e of t){if(s&&(s=s.map(e.changes)),e.scrollIntoView){let{main:t}=e.state.selection;s=new Gg(t.empty?t:kd.cursor(t.head,t.head>t.anchor?-1:1))}for(let t of e.effects)t.is(Ug)&&(s=t.value)}this.viewState.update(e,s),this.bidiCache=sO.update(this.bidiCache,e.changes),e.empty||(this.updatePlugins(e),this.inputState.update(e)),i=this.docView.update(e),this.state.facet(am)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some((t=>t.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(e.startState.facet(jb)!=e.state.facet(jb)&&(this.viewState.mustMeasureContent=!0),(i||n||s||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!e.empty)for(let t of this.state.facet(Xg))t(e)}setState(t){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=t);this.updateState=2;let e=this.hasFocus;try{for(let t of this.plugins)t.destroy(this);this.viewState=new _b(t),this.plugins=t.facet(tm).map((t=>new im(t))),this.pluginMap.clear();for(let t of this.plugins)t.update(this);this.docView=new Mm(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(tm),i=t.state.facet(tm);if(e!=i){let n=[];for(let r of i){let i=e.indexOf(r);if(i<0)n.push(new im(r));else{let e=this.plugins[i];e.mustUpdate=t,n.push(e)}}for(let e of this.plugins)e.mustUpdate!=t&&e.destroy(this);this.plugins=n,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let e of this.plugins)e.mustUpdate=t;for(let t=0;t<this.plugins.length;t++)this.plugins[t].update(this)}measure(t=!0){if(this.destroyed)return;this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,t&&this.observer.flush();let e=null;try{for(let t=0;;t++){this.updateState=1;let i=this.viewport,n=this.viewState.measure(this);if(!n&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(t>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let r=[];4&n||([this.measureRequests,r]=[r,this.measureRequests]);let s=r.map((t=>{try{return t.read(this)}catch(t){return Yg(this.state,t),rO}})),o=cm.create(this,this.state,[]),l=!1,a=!1;o.flags|=n,e?e.flags|=n:e=o,this.updateState=2,o.empty||(this.updatePlugins(o),this.inputState.update(o),this.updateAttrs(),l=this.docView.update(o));for(let t=0;t<r.length;t++)if(s[t]!=rO)try{let e=r[t];e.write&&e.write(s[t],this)}catch(t){Yg(this.state,t)}if(this.viewState.scrollTarget&&(this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=!0),l&&this.docView.updateSelection(!0),this.viewport.from==i.from&&this.viewport.to==i.to&&!a&&0==this.measureRequests.length)break}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let t of this.state.facet(Xg))t(e)}get themeClasses(){return Hb+" "+(this.state.facet(qb)?Fb:Xb)+" "+this.state.facet(jb)}updateAttrs(){let t=oO(this,nm,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Kg)?"true":"false",class:"cm-content",style:`${pg.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),oO(this,rm,e);let i=this.observer.ignore((()=>{let i=Pg(this.contentDOM,this.contentAttrs,e),n=Pg(this.dom,this.editorAttrs,t);return i||n}));return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let t of i.effects)if(t.is(iO.announce)){e&&(this.announceDOM.textContent=""),e=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value}}mountStyles(){this.styleModules=this.state.facet(am),Je.mount(this.root,this.styleModules.concat(Ub).reverse())}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=requestAnimationFrame((()=>this.measure()))),t){if(null!=t.key)for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key)return void(this.measureRequests[e]=t);this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find((e=>e.spec==t))||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return Hm(this,t,qm(this,t,e,i))}moveByGroup(t,e){return Hm(this,t,qm(this,t,e,(e=>function(t,e,i){let n=t.state.charCategorizer(e),r=n(i);return t=>{let e=n(t);return r==cp.Space&&(r=e),r==e}}(this,t.head,e))))}moveToLineBoundary(t,e,i=!0){return function(t,e,i,n){let r=t.state.doc.lineAt(e.head),s=n&&t.lineWrapping?t.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head):null;if(s){let e=t.dom.getBoundingClientRect(),n=t.textDirectionAt(r.from),o=t.posAtCoords({x:i==(n==um.LTR)?e.right-1:e.left+1,y:(s.top+s.bottom)/2});if(null!=o)return kd.cursor(o,i?-1:1)}let o=Bg.find(t.docView,e.head),l=o?i?o.posAtEnd:o.posAtStart:i?r.to:r.from;return kd.cursor(l,i?-1:1)}(this,t,e,i)}moveVertically(t,e,i){return Hm(this,t,function(t,e,i,n){let r=e.head,s=i?1:-1;if(r==(i?t.state.doc.length:0))return kd.cursor(r,e.assoc);let o,l=e.goalColumn,a=t.contentDOM.getBoundingClientRect(),h=t.coordsAtPos(r),c=t.documentTop;if(h)null==l&&(l=h.left-a.left),o=s<0?h.top:h.bottom;else{let e=t.viewState.lineBlockAt(r);null==l&&(l=Math.min(a.right-a.left,t.defaultCharacterWidth*(r-e.from))),o=(s<0?e.top:e.bottom)+c}let u=a.left+l,f=null!=n?n:t.defaultLineHeight>>1;for(let i=0;;i+=10){let n=o+(f+i)*s,h=Vm(t,{x:u,y:n},!1,s);if(n<a.top||n>a.bottom||(s<0?h<r:h>r))return kd.cursor(h,e.assoc,void 0,l)}}(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),Vm(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),r=this.bidiSpans(n);return Wp(i,r[wm.find(r,t-n.from,-1,e)].dir==um.LTR==e>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(Zg)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>nO)return xm(t.length);let e=this.textDirectionAt(t.from);for(let i of this.bidiCache)if(i.from==t.from&&i.dir==e)return i.order;let i=function(t,e){let i=t.length,n=e==fm?1:2,r=e==fm?2:1;if(!t||1==n&&!vm.test(t))return xm(i);for(let e=0,r=n,o=n;e<i;e++){let i=(s=t.charCodeAt(e))<=247?gm[s]:1424<=s&&s<=1524?2:1536<=s&&s<=1785?mm[s-1536]:1774<=s&&s<=2220?4:8192<=s&&s<=8203||8204==s?256:1;512==i?i=r:8==i&&4==o&&(i=16),ym[e]=4==i?2:i,7&i&&(o=i),r=i}var s;for(let t=0,e=n,r=n;t<i;t++){let n=ym[t];if(128==n)t<i-1&&e==ym[t+1]&&24&e?n=ym[t]=e:ym[t]=256;else if(64==n){let n=t+1;for(;n<i&&64==ym[n];)n++;let s=t&&8==e||n<i&&8==ym[n]?1==r?1:8:256;for(let e=t;e<n;e++)ym[e]=s;t=n-1}else 8==n&&1==r&&(ym[t]=1);e=n,7&n&&(r=n)}for(let e,s,o,l=0,a=0,h=0;l<i;l++)if(s=bm[e=t.charCodeAt(l)])if(s<0){for(let t=a-3;t>=0;t-=3)if(Om[t+1]==-s){let e=Om[t+2],i=2&e?n:4&e?1&e?r:n:0;i&&(ym[l]=ym[Om[t]]=i),a=t;break}}else{if(189==Om.length)break;Om[a++]=l,Om[a++]=e,Om[a++]=h}else if(2==(o=ym[l])||1==o){let t=o==n;h=t?0:1;for(let e=a-3;e>=0;e-=3){let i=Om[e+2];if(2&i)break;if(t)Om[e+2]|=2;else{if(4&i)break;Om[e+2]|=4}}}for(let t=0;t<i;t++)if(256==ym[t]){let e=t+1;for(;e<i&&256==ym[e];)e++;let r=1==(t?ym[t-1]:n),s=r==(1==(e<i?ym[e]:n))?r?1:2:n;for(let i=t;i<e;i++)ym[i]=s;t=e-1}let o=[];if(1==n)for(let t=0;t<i;){let e=t,n=1!=ym[t++];for(;t<i&&n==(1!=ym[t]);)t++;if(n)for(let i=t;i>e;){let t=i,n=2!=ym[--i];for(;i>e&&n==(2!=ym[i-1]);)i--;o.push(new wm(i,t,n?2:1))}else o.push(new wm(e,t,0))}else for(let t=0;t<i;){let e=t,n=2==ym[t++];for(;t<i&&n==(2==ym[t]);)t++;o.push(new wm(e,t,n?1:2))}return o}(t.text,e);return this.bidiCache.push(new sO(t.from,t.to,e,i)),i}get hasFocus(){var t;return(document.hasFocus()||pg.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{Xp(this.contentDOM),this.docView.updateSelection()}))}destroy(){for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return Ug.of(new Gg("number"==typeof t?kd.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}static domEventHandlers(t){return em.define((()=>({})),{eventHandlers:t})}static theme(t,e){let i=Je.newName(),n=[jb.of(i),am.of(Gb(`.${i}`,t))];return e&&e.dark&&n.push(qb.of(!0)),n}static baseTheme(t){return zd.lowest(am.of(Gb("."+Hb,t,Zb)))}}iO.styleModule=am,iO.inputHandler=Fg,iO.perLineTextDirection=Zg,iO.exceptionSink=Hg,iO.updateListener=Xg,iO.editable=Kg,iO.mouseSelectionStyle=qg,iO.dragMovesSelection=jg,iO.clickAddsSelectionRange=Vg,iO.decorations=sm,iO.atomicRanges=om,iO.scrollMargins=lm,iO.darkTheme=qb,iO.contentAttributes=rm,iO.editorAttributes=nm,iO.lineWrapping=iO.contentAttributes.of({class:"cm-lineWrapping"}),iO.announce=ip.define();const nO=4096,rO={};class sO{constructor(t,e,i,n){this.from=t,this.to=e,this.dir=i,this.order=n}static update(t,e){if(e.empty)return t;let i=[],n=t.length?t[t.length-1].dir:um.LTR;for(let r=Math.max(0,t.length-10);r<t.length;r++){let s=t[r];s.dir!=n||e.touchesRange(s.from,s.to)||i.push(new sO(e.mapPos(s.from,1),e.mapPos(s.to,-1),s.dir,s.order))}return i}}function oO(t,e,i){for(let n=t.state.facet(e),r=n.length-1;r>=0;r--){let e=n[r],s="function"==typeof e?e(t):e;s&&Ag(s,i)}return i}class lO extends mp{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}lO.prototype.elementClass="",lO.prototype.toDOM=void 0,lO.prototype.mapMode=dd.TrackBefore,lO.prototype.startSide=lO.prototype.endSide=-1,lO.prototype.point=!0;const aO=Ad.define(),hO={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>wp.empty,lineMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},cO=Ad.define();function uO(t){return[dO(),cO.of(Object.assign(Object.assign({},hO),t))]}const fO=Ad.define({combine:t=>t.some((t=>t))});function dO(t){let e=[pO];return t&&!1===t.fixed&&e.push(fO.of(!0)),e}const pO=em.fromClass(class{constructor(t){this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=t.state.facet(cO).map((e=>new OO(t,e)));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!t.state.facet(fO),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}update(t){if(this.updateGutters(t)){let e=this.prevViewport,i=t.view.viewport,n=Math.min(e.to,i.to)-Math.max(e.from,i.from);this.syncGutters(n<.8*(i.to-i.from))}t.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(fO)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&this.dom.remove();let i=wp.iter(this.view.state.facet(aO),this.view.viewport.from),n=[],r=this.gutters.map((t=>new bO(t,this.view.viewport,-this.view.documentPadding.top)));for(let t of this.view.viewportLineBlocks){let e;if(Array.isArray(t.type)){for(let i of t.type)if(i.type==Qg.Text){e=i;break}}else e=t.type==Qg.Text?t:void 0;if(e){n.length&&(n=[]),mO(i,n,t.from);for(let t of r)t.line(this.view,e,n)}}for(let t of r)t.finish();t&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(t){let e=t.startState.facet(cO),i=t.state.facet(cO),n=t.docChanged||t.heightChanged||t.viewportChanged||!wp.eq(t.startState.facet(aO),t.state.facet(aO),t.view.viewport.from,t.view.viewport.to);if(e==i)for(let e of this.gutters)e.update(t)&&(n=!0);else{n=!0;let r=[];for(let n of i){let i=e.indexOf(n);i<0?r.push(new OO(this.view,n)):(this.gutters[i].update(t),r.push(this.gutters[i]))}for(let t of this.gutters)t.dom.remove(),r.indexOf(t)<0&&t.destroy();for(let t of r)this.dom.appendChild(t.dom);this.gutters=r}return n}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove()}},{provide:t=>iO.scrollMargins.of((e=>{let i=e.plugin(t);return i&&0!=i.gutters.length&&i.fixed?e.textDirection==um.LTR?{left:i.dom.offsetWidth}:{right:i.dom.offsetWidth}:null}))});function gO(t){return Array.isArray(t)?t:[t]}function mO(t,e,i){for(;t.value&&t.from<=i;)t.from==i&&e.push(t.value),t.next()}class bO{constructor(t,e,i){this.gutter=t,this.height=i,this.localMarkers=[],this.i=0,this.cursor=wp.iter(t.markers,e.from)}line(t,e,i){this.localMarkers.length&&(this.localMarkers=[]),mO(this.cursor,this.localMarkers,e.from);let n=i.length?this.localMarkers.concat(i):this.localMarkers,r=this.gutter.config.lineMarker(t,e,n);r&&n.unshift(r);let s=this.gutter;if(0==n.length&&!s.config.renderEmptyElements)return;let o=e.top-this.height;if(this.i==s.elements.length){let i=new vO(t,e.height,o,n);s.elements.push(i),s.dom.appendChild(i.dom)}else s.elements[this.i].update(t,e.height,o,n);this.height=e.bottom,this.i++}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let e=t.elements.pop();t.dom.removeChild(e.dom),e.destroy()}}}class OO{constructor(t,e){this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in e.domEventHandlers)this.dom.addEventListener(i,(n=>{let r=t.lineBlockAtHeight(n.clientY-t.documentTop);e.domEventHandlers[i](t,r,n)&&n.preventDefault()}));this.markers=gO(e.markers(t)),e.initialSpacer&&(this.spacer=new vO(t,0,0,[e.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let e=this.markers;if(this.markers=gO(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let e=this.config.updateSpacer(this.spacer.markers[0],t);e!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[e])}let i=t.view.viewport;return!wp.eq(this.markers,e,i.from,i.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(t)}destroy(){for(let t of this.elements)t.destroy()}}class vO{constructor(t,e,i,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,e,i,n)}update(t,e,i,n){this.height!=e&&(this.dom.style.height=(this.height=e)+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),function(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!t[i].compare(e[i]))return!1;return!0}(this.markers,n)||this.setMarkers(t,n)}setMarkers(t,e){let i="cm-gutterElement",n=this.dom.firstChild;for(let r=0,s=0;;){let o=s,l=r<e.length?e[r++]:null,a=!1;if(l){let t=l.elementClass;t&&(i+=" "+t);for(let t=s;t<this.markers.length;t++)if(this.markers[t].compare(l)){o=t,a=!0;break}}else o=this.markers.length;for(;s<o;){let t=this.markers[s++];if(t.toDOM){t.destroy(n);let e=n.nextSibling;n.remove(),n=e}}if(!l)break;l.toDOM&&(a?n=n.nextSibling:this.dom.insertBefore(l.toDOM(t),n)),a&&s++}this.dom.className=i,this.markers=e}destroy(){this.setMarkers(null,[])}}let wO=0;class yO{constructor(t,e,i){this.set=t,this.base=e,this.modified=i,this.id=wO++}static define(t){if(null==t?void 0:t.base)throw new Error("Can not derive from a modified tag");let e=new yO([],null,[]);if(e.set.push(e),t)for(let i of t.set)e.set.push(i);return e}static defineModifier(){let t=new kO;return e=>e.modified.indexOf(t)>-1?e:kO.get(e.base||e,e.modified.concat(t).sort(((t,e)=>t.id-e.id)))}}let xO=0;class kO{constructor(){this.instances=[],this.id=xO++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find((i=>{return i.base==t&&(n=e,r=i.modified,n.length==r.length&&n.every(((t,e)=>t==r[e])));var n,r}));if(i)return i;let n=[],r=new yO(n,t,e);for(let t of e)t.instances.push(r);let s=SO(e);for(let e of t.set)for(let t of s)n.push(kO.get(e,t));return r}}function SO(t){let e=[t];for(let i=0;i<t.length;i++)for(let n of SO(t.slice(0,i).concat(t.slice(i+1))))e.push(n);return e}function CO(t){let e=Object.create(null);for(let i in t){let n=t[i];Array.isArray(n)||(n=[n]);for(let t of i.split(" "))if(t){let i=[],r=2,s=t;for(let e=0;;){if("..."==s&&e>0&&e+3==t.length){r=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!n)throw new RangeError("Invalid path: "+t);if(i.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),e+=n[0].length,e==t.length)break;let o=t[e++];if(e==t.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+t);s=t.slice(e)}let o=i.length-1,l=i[o];if(!l)throw new RangeError("Invalid path: "+t);let a=new TO(n,r,o>0?i.slice(0,o):null);e[l]=a.sort(e[l])}}return AO.add(e)}const AO=new kf;class TO{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}function PO(t,e){let i=Object.create(null);for(let e of t)if(Array.isArray(e.tag))for(let t of e.tag)i[t.id]=e.class;else i[e.tag.id]=e.class;let{scope:n,all:r=null}=e||{};return{style:t=>{let e=r;for(let n of t)for(let t of n.set){let n=i[t.id];if(n){e=e?e+" "+n:n;break}}return e},scope:n}}function MO(t,e){let i=null;for(let n of t){let t=n.style(e);t&&(i=i?i+" "+t:t)}return i}function QO(t,e,i,n=0,r=t.length){let s=new RO(n,Array.isArray(e)?e:[e],i);s.highlightRange(t.cursor(),n,r,"",s.highlighters),s.flush(r)}class RO{constructor(t,e,i){this.at=t,this.highlighters=e,this.span=i,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,i,n,r){let{type:s,from:o,to:l}=t;if(o>=i||l<=e)return;s.isTop&&(r=this.highlighters.filter((t=>!t.scope||t.scope(s))));let a=n,h=s.prop(AO),c=!1;for(;h;){if(!h.context||t.matchContext(h.context)){let t=MO(r,h.tags);t&&(a&&(a+=" "),a+=t,1==h.mode?n+=(n?" ":"")+t:0==h.mode&&(c=!0));break}h=h.next}if(this.startSpan(t.from,a),c)return;let u=t.tree&&t.tree.prop(kf.mounted);if(u&&u.overlay){let s=t.node.enter(u.overlay[0].from+o,1),h=this.highlighters.filter((t=>!t.scope||t.scope(u.tree.type))),c=t.firstChild();for(let f=0,d=o;;f++){let p=f<u.overlay.length?u.overlay[f]:null,g=p?p.from+o:l,m=Math.max(e,d),b=Math.min(i,g);if(m<b&&c)for(;t.from<b&&(this.highlightRange(t,m,b,n,r),this.startSpan(Math.min(i,t.to),a),!(t.to>=g)&&t.nextSibling()););if(!p||g>i)break;d=p.to+o,d>e&&(this.highlightRange(s.cursor(),Math.max(e,p.from+o),Math.min(i,d),n,h),this.startSpan(d,a))}c&&t.parent()}else if(t.firstChild()){do{if(!(t.to<=e)){if(t.from>=i)break;this.highlightRange(t,e,i,n,r),this.startSpan(Math.min(i,t.to),a)}}while(t.nextSibling());t.parent()}}}const $O=yO.define,_O=$O(),DO=$O(),EO=$O(DO),NO=$O(DO),BO=$O(),IO=$O(BO),zO=$O(BO),LO=$O(),WO=$O(LO),VO=$O(),jO=$O(),qO=$O(),HO=$O(qO),XO=$O(),FO={comment:_O,lineComment:$O(_O),blockComment:$O(_O),docComment:$O(_O),name:DO,variableName:$O(DO),typeName:EO,tagName:$O(EO),propertyName:NO,attributeName:$O(NO),className:$O(DO),labelName:$O(DO),namespace:$O(DO),macroName:$O(DO),literal:BO,string:IO,docString:$O(IO),character:$O(IO),attributeValue:$O(IO),number:zO,integer:$O(zO),float:$O(zO),bool:$O(BO),regexp:$O(BO),escape:$O(BO),color:$O(BO),url:$O(BO),keyword:VO,self:$O(VO),null:$O(VO),atom:$O(VO),unit:$O(VO),modifier:$O(VO),operatorKeyword:$O(VO),controlKeyword:$O(VO),definitionKeyword:$O(VO),moduleKeyword:$O(VO),operator:jO,derefOperator:$O(jO),arithmeticOperator:$O(jO),logicOperator:$O(jO),bitwiseOperator:$O(jO),compareOperator:$O(jO),updateOperator:$O(jO),definitionOperator:$O(jO),typeOperator:$O(jO),controlOperator:$O(jO),punctuation:qO,separator:$O(qO),bracket:HO,angleBracket:$O(HO),squareBracket:$O(HO),paren:$O(HO),brace:$O(HO),content:LO,heading:WO,heading1:$O(WO),heading2:$O(WO),heading3:$O(WO),heading4:$O(WO),heading5:$O(WO),heading6:$O(WO),contentSeparator:$O(LO),list:$O(LO),quote:$O(LO),emphasis:$O(LO),strong:$O(LO),link:$O(LO),monospace:$O(LO),strikethrough:$O(LO),inserted:$O(),deleted:$O(),changed:$O(),invalid:$O(),meta:XO,documentMeta:$O(XO),annotation:$O(XO),processingInstruction:$O(XO),definition:yO.defineModifier(),constant:yO.defineModifier(),function:yO.defineModifier(),standard:yO.defineModifier(),local:yO.defineModifier(),special:yO.defineModifier()};var ZO;PO([{tag:FO.link,class:"tok-link"},{tag:FO.heading,class:"tok-heading"},{tag:FO.emphasis,class:"tok-emphasis"},{tag:FO.strong,class:"tok-strong"},{tag:FO.keyword,class:"tok-keyword"},{tag:FO.atom,class:"tok-atom"},{tag:FO.bool,class:"tok-bool"},{tag:FO.url,class:"tok-url"},{tag:FO.labelName,class:"tok-labelName"},{tag:FO.inserted,class:"tok-inserted"},{tag:FO.deleted,class:"tok-deleted"},{tag:FO.literal,class:"tok-literal"},{tag:FO.string,class:"tok-string"},{tag:FO.number,class:"tok-number"},{tag:[FO.regexp,FO.escape,FO.special(FO.string)],class:"tok-string2"},{tag:FO.variableName,class:"tok-variableName"},{tag:FO.local(FO.variableName),class:"tok-variableName tok-local"},{tag:FO.definition(FO.variableName),class:"tok-variableName tok-definition"},{tag:FO.special(FO.variableName),class:"tok-variableName2"},{tag:FO.definition(FO.propertyName),class:"tok-propertyName tok-definition"},{tag:FO.typeName,class:"tok-typeName"},{tag:FO.namespace,class:"tok-namespace"},{tag:FO.className,class:"tok-className"},{tag:FO.macroName,class:"tok-macroName"},{tag:FO.propertyName,class:"tok-propertyName"},{tag:FO.operator,class:"tok-operator"},{tag:FO.comment,class:"tok-comment"},{tag:FO.meta,class:"tok-meta"},{tag:FO.invalid,class:"tok-invalid"},{tag:FO.punctuation,class:"tok-punctuation"}]);const GO=new kf;class UO{constructor(t,e,i=[]){this.data=t,pp.prototype.hasOwnProperty("tree")||Object.defineProperty(pp.prototype,"tree",{get(){return KO(this)}}),this.parser=e,this.extension=[lv.of(this),pp.languageData.of(((t,e,i)=>t.facet(YO(t,e,i))))].concat(i)}isActiveAt(t,e,i=-1){return YO(t,e,i)==this.data}findRegions(t){let e=t.facet(lv);if((null==e?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let i=[],n=(t,e)=>{if(t.prop(GO)==this.data)return void i.push({from:e,to:e+t.length});let r=t.prop(kf.mounted);if(r){if(r.tree.prop(GO)==this.data){if(r.overlay)for(let t of r.overlay)i.push({from:t.from+e,to:t.to+e});else i.push({from:e,to:e+t.length});return}if(r.overlay){let t=i.length;if(n(r.tree,r.overlay[0].from+e),i.length>t)return}}for(let i=0;i<t.children.length;i++){let r=t.children[i];r instanceof Mf&&n(r,t.positions[i]+e)}};return n(KO(t),0),i}get allowsNesting(){return!0}}function YO(t,e,i){let n=t.facet(lv);if(!n)return null;let r=n.data;if(n.allowsNesting)for(let n=KO(t).topNode;n;n=n.enter(e,i,Pf.ExcludeBuffers))r=n.type.prop(GO)||r;return r}function KO(t){let e=t.field(UO.state,!1);return e?e.tree:Mf.empty}UO.setState=ip.define();class JO{constructor(t,e=t.length){this.doc=t,this.length=e,this.cursorPos=0,this.string="",this.cursor=t.iter()}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-i,e-i)}}let tv=null;class ev{constructor(t,e,i=[],n,r,s,o,l){this.parser=t,this.state=e,this.fragments=i,this.tree=n,this.treeLen=r,this.viewport=s,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(t,e,i){return new ev(t,e,[],Mf.empty,0,i,[],null)}startParse(){return this.parser.startParse(new JO(this.state.doc),this.fragments)}work(t,e){return null!=e&&e>=this.state.doc.length&&(e=void 0),this.tree!=Mf.empty&&this.isDone(null!=e?e:this.state.doc.length)?(this.takeTree(),!0):this.withContext((()=>{var i;if("number"==typeof t){let e=Date.now()+t;t=()=>Date.now()>e}for(this.parse||(this.parse=this.startParse()),null!=e&&(null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n){if(this.fragments=this.withoutTempSkipped(Hf.addTree(n,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(i=this.parse.stoppedAt)&&void 0!==i?i:this.state.doc.length,this.tree=n,this.parse=null,!(this.treeLen<(null!=e?e:this.state.doc.length)))return!0;this.parse=this.startParse()}if(t())return!1}}))}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext((()=>{for(;!(e=this.parse.advance()););})),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(Hf.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=tv;tv=this;try{return t()}finally{tv=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=iv(t,e.from,e.to);return t}changes(t,e){let{fragments:i,tree:n,treeLen:r,viewport:s,skipped:o}=this;if(this.takeTree(),!t.empty){let e=[];if(t.iterChangedRanges(((t,i,n,r)=>e.push({fromA:t,toA:i,fromB:n,toB:r}))),i=Hf.applyChanges(i,e),n=Mf.empty,r=0,s={from:t.mapPos(s.from,-1),to:t.mapPos(s.to,1)},this.skipped.length){o=[];for(let e of this.skipped){let i=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);i<n&&o.push({from:i,to:n})}}}return new ev(this.parser,e,i,n,r,s,o,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let e=0;e<this.skipped.length;e++){let{from:i,to:n}=this.skipped[e];i<t.to&&n>t.from&&(this.fragments=iv(this.fragments,i,n),this.skipped.splice(e--,1))}return!(this.skipped.length>=e)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends class{startParse(t,e,i){return"string"==typeof t&&(t=new Xf(t)),i=i?i.length?i.map((t=>new xf(t.from,t.to))):[new xf(0,0)]:[new xf(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let t=n.advance();if(t)return t}}}{createParse(e,i,n){let r=n[0].from,s=n[n.length-1].to;return{parsedPos:r,advance(){let e=tv;if(e){for(let t of n)e.tempSkipped.push(t);t&&(e.scheduleOn=e.scheduleOn?Promise.all([e.scheduleOn,t]):t)}return this.parsedPos=s,new Mf(Cf.none,[],[],s-r)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&0==e[0].from&&e[0].to>=t}static get(){return tv}}function iv(t,e,i){return Hf.applyChanges(t,[{fromA:e,toA:i,fromB:e,toB:i}])}class nv{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,i)||e.takeTree(),new nv(e)}static init(t){let e=Math.min(3e3,t.doc.length),i=ev.create(t.facet(lv).parser,t,{from:0,to:e});return i.work(20,e)||i.takeTree(),new nv(i)}}UO.state=_d.define({create:nv.init,update(t,e){for(let t of e.effects)if(t.is(UO.setState))return t.value;return e.startState.facet(lv)!=e.state.facet(lv)?nv.init(e.state):t.apply(e)}});let rv=t=>{let e=setTimeout((()=>t()),500);return()=>clearTimeout(e)};"undefined"!=typeof requestIdleCallback&&(rv=t=>{let e=-1,i=setTimeout((()=>{e=requestIdleCallback(t,{timeout:400})}),100);return()=>e<0?clearTimeout(i):cancelIdleCallback(e)});const sv="undefined"!=typeof navigator&&(null===(ZO=navigator.scheduling)||void 0===ZO?void 0:ZO.isInputPending)?()=>navigator.scheduling.isInputPending():null,ov=em.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(UO.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),t.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(UO.state);e.tree==e.context.tree&&e.context.isDone(t.doc.length)||(this.working=rv(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,r=i.field(UO.state);if(r.tree==r.context.tree&&r.context.isDone(n+1e5))return;let s=Date.now()+Math.min(this.chunkBudget,100,t&&!sv?Math.max(25,t.timeRemaining()-5):1e9),o=r.context.treeLen<n&&i.doc.length>n+1e3,l=r.context.work((()=>sv&&sv()||Date.now()>s),n+(o?0:1e5));this.chunkBudget-=Date.now()-e,(l||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:UO.setState.of(new nv(r.context))})),this.chunkBudget>0&&(!l||o)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then((()=>this.scheduleWork())).catch((t=>Yg(this.view.state,t))).then((()=>this.workScheduled--)),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),lv=Ad.define({combine:t=>t.length?t[0]:null,enables:[UO.state,ov]}),av=Ad.define(),hv=Ad.define({combine:t=>{if(!t.length)return"  ";if(!/^(?: +|\t+)$/.test(t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return t[0]}});function cv(t){let e=t.facet(hv);return 9==e.charCodeAt(0)?t.tabSize*e.length:e.length}function uv(t,e){let i="",n=t.tabSize;if(9==t.facet(hv).charCodeAt(0))for(;e>=n;)i+="\t",e-=n;for(let t=0;t<e;t++)i+=" ";return i}function fv(t,e){t instanceof pp&&(t=new dv(t));for(let i of t.state.facet(av)){let n=i(t,e);if(null!=n)return n}let i=KO(t.state);return i?function(t,e,i){return mv(e.resolveInner(i).enterUnfinishedNodesBefore(i),i,t)}(t,i,e):null}class dv{constructor(t,e={}){this.state=t,this.options=e,this.unit=cv(t)}lineAt(t,e=1){let i=this.state.doc.lineAt(t),{simulateBreak:n,simulateDoubleBreak:r}=this.options;return null!=n&&n>=i.from&&n<=i.to?r&&n==t?{text:"",from:t}:(e<0?n<t:n<=t)?{text:i.text.slice(n-i.from),from:n}:{text:i.text.slice(0,n-i.from),from:i.from}:i}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:i,from:n}=this.lineAt(t,e);return i.slice(t-n,Math.min(i.length,t+100-n))}column(t,e=1){let{text:i,from:n}=this.lineAt(t,e),r=this.countColumn(i,t-n),s=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return s>-1&&(r+=s-this.countColumn(i,i.search(/\S|$/))),r}countColumn(t,e=t.length){return function(t,e,i=t.length){let n=0;for(let r=0;r<i;)9==t.charCodeAt(r)?(n+=e-n%e,r++):(n++,r=sd(t,r));return n}(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:i,from:n}=this.lineAt(t,e),r=this.options.overrideIndentation;if(r){let t=r(n);if(t>-1)return t}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const pv=new kf;function gv(t){let e=t.type.prop(pv);if(e)return e;let i,n=t.firstChild;if(n&&(i=n.type.prop(kf.closedBy))){let e=t.lastChild,n=e&&i.indexOf(e.name)>-1;return t=>function(t,e,i,n,r){let s=t.textAfter,o=s.match(/^\s*/)[0].length,l=n&&s.slice(o,o+n.length)==n||r==t.pos+o,a=e?function(t){let e=t.node,i=e.childAfter(e.from),n=e.lastChild;if(!i)return null;let r=t.options.simulateBreak,s=t.state.doc.lineAt(i.from),o=null==r||r<=s.from?s.to:Math.min(s.to,r);for(let t=i.to;;){let r=e.childAfter(t);if(!r||r==n)return null;if(!r.type.isSkipped)return r.from<o?i:null;t=r.to}}(t):null;return a?l?t.column(a.from):t.column(a.to):t.baseIndent+(l?0:t.unit*i)}(t,!0,1,void 0,n&&!function(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}(t)?e.from:void 0)}return null==t.parent?bv:null}function mv(t,e,i){for(;t;t=t.parent){let n=gv(t);if(n)return n(Ov.create(i,e,t))}return null}function bv(){return 0}class Ov extends dv{constructor(t,e,i){super(t.state,t.options),this.base=t,this.pos=e,this.node=i}static create(t,e,i){return new Ov(t,e,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let t=this.state.doc.lineAt(this.node.from);for(;;){let e=this.node.resolve(t.from);for(;e.parent&&e.parent.from==e.from;)e=e.parent;if(vv(e,this.node))break;t=this.state.doc.lineAt(e.from)}return this.lineIndent(t.from)}continue(){let t=this.node.parent;return t?mv(t,this.pos,this.base):0}}function vv(t,e){for(let i=e;i;i=i.parent)if(t==i)return!0;return!1}function wv(){return pp.transactionFilter.of((t=>{if(!t.docChanged||!t.isUserEvent("input.type")&&!t.isUserEvent("input.complete"))return t;let e=t.startState.languageDataAt("indentOnInput",t.startState.selection.main.head);if(!e.length)return t;let i=t.newDoc,{head:n}=t.newSelection.main,r=i.lineAt(n);if(n>r.from+200)return t;let s=i.sliceString(r.from,n);if(!e.some((t=>t.test(s))))return t;let{state:o}=t,l=-1,a=[];for(let{head:t}of o.selection.ranges){let e=o.doc.lineAt(t);if(e.from==l)continue;l=e.from;let i=fv(o,e.from);if(null==i)continue;let n=/^\s*/.exec(e.text)[0],r=uv(o,i);n!=r&&a.push({from:e.from,to:e.from+n.length,insert:r})}return a.length?[t,{changes:a,sequential:!0}]:t}))}const yv=Ad.define(),xv=new kf;function kv(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}function Sv(t,e,i){for(let n of t.facet(yv)){let r=n(t,e,i);if(r)return r}return function(t,e,i){let n=KO(t);if(n.length<i)return null;let r=null;for(let s=n.resolveInner(i);s;s=s.parent){if(s.to<=i||s.from>i)continue;if(r&&s.from<e)break;let o=s.type.prop(xv);if(o&&(s.to<n.length-50||n.length==t.doc.length||!kv(s))){let n=o(s,t);n&&n.from<=i&&n.from>=e&&n.to>i&&(r=n)}}return r}(t,e,i)}function Cv(t,e){let i=e.mapPos(t.from,1),n=e.mapPos(t.to,-1);return i>=n?void 0:{from:i,to:n}}const Av=ip.define({map:Cv}),Tv=ip.define({map:Cv});function Pv(t){let e=[];for(let{head:i}of t.state.selection.ranges)e.some((t=>t.from<=i&&t.to>=i))||e.push(t.lineBlockAt(i));return e}const Mv=_d.define({create:()=>Rg.none,update(t,e){t=t.map(e.changes);for(let i of e.effects)i.is(Av)&&!Rv(t,i.value.from,i.value.to)?t=t.update({add:[Iv.range(i.value.from,i.value.to)]}):i.is(Tv)&&(t=t.update({filter:(t,e)=>i.value.from!=t||i.value.to!=e,filterFrom:i.value.from,filterTo:i.value.to}));if(e.selection){let i=!1,{head:n}=e.selection.main;t.between(n,n,((t,e)=>{t<n&&e>n&&(i=!0)})),i&&(t=t.update({filterFrom:n,filterTo:n,filter:(t,e)=>e<=n||t>=n}))}return t},provide:t=>iO.decorations.from(t)});function Qv(t,e,i){var n;let r=null;return null===(n=t.field(Mv,!1))||void 0===n||n.between(e,i,((t,e)=>{(!r||r.from>t)&&(r={from:t,to:e})})),r}function Rv(t,e,i){let n=!1;return t.between(e,e,((t,r)=>{t==e&&r==i&&(n=!0)})),n}function $v(t,e){return t.field(Mv,!1)?e:e.concat(ip.appendConfig.of(Bv()))}function _v(t,e,i=!0){let n=t.state.doc.lineAt(e.from).number,r=t.state.doc.lineAt(e.to).number;return iO.announce.of(`${t.state.phrase(i?"Folded lines":"Unfolded lines")} ${n} ${t.state.phrase("to")} ${r}.`)}const Dv=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:t=>{for(let e of Pv(t)){let i=Sv(t.state,e.from,e.to);if(i)return t.dispatch({effects:$v(t.state,[Av.of(i),_v(t,i)])}),!0}return!1}},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:t=>{if(!t.state.field(Mv,!1))return!1;let e=[];for(let i of Pv(t)){let n=Qv(t.state,i.from,i.to);n&&e.push(Tv.of(n),_v(t,n,!1))}return e.length&&t.dispatch({effects:e}),e.length>0}},{key:"Ctrl-Alt-[",run:t=>{let{state:e}=t,i=[];for(let n=0;n<e.doc.length;){let r=t.lineBlockAt(n),s=Sv(e,r.from,r.to);s&&i.push(Av.of(s)),n=(s?t.lineBlockAt(s.to):r).to+1}return i.length&&t.dispatch({effects:$v(t.state,i)}),!!i.length}},{key:"Ctrl-Alt-]",run:t=>{let e=t.state.field(Mv,!1);if(!e||!e.size)return!1;let i=[];return e.between(0,t.state.doc.length,((t,e)=>{i.push(Tv.of({from:t,to:e}))})),t.dispatch({effects:i}),!0}}],Ev={placeholderDOM:null,placeholderText:"…"},Nv=Ad.define({combine:t=>gp(t,Ev)});function Bv(t){let e=[Mv,Vv];return t&&e.push(Nv.of(t)),e}const Iv=Rg.replace({widget:new class extends Mg{toDOM(t){let{state:e}=t,i=e.facet(Nv),n=e=>{let i=t.lineBlockAt(t.posAtDOM(e.target)),n=Qv(t.state,i.from,i.to);n&&t.dispatch({effects:Tv.of(n)}),e.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(t,n);let r=document.createElement("span");return r.textContent=i.placeholderText,r.setAttribute("aria-label",e.phrase("folded code")),r.title=e.phrase("unfold"),r.className="cm-foldPlaceholder",r.onclick=n,r}}}),zv={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{}};class Lv extends lO{constructor(t,e){super(),this.config=t,this.open=e}eq(t){return this.config==t.config&&this.open==t.open}toDOM(t){if(this.config.markerDOM)return this.config.markerDOM(this.open);let e=document.createElement("span");return e.textContent=this.open?this.config.openText:this.config.closedText,e.title=t.state.phrase(this.open?"Fold line":"Unfold line"),e}}function Wv(t={}){let e=Object.assign(Object.assign({},zv),t),i=new Lv(e,!0),n=new Lv(e,!1),r=em.fromClass(class{constructor(t){this.from=t.viewport.from,this.markers=this.buildMarkers(t)}update(t){(t.docChanged||t.viewportChanged||t.startState.facet(lv)!=t.state.facet(lv)||t.startState.field(Mv,!1)!=t.state.field(Mv,!1)||KO(t.startState)!=KO(t.state))&&(this.markers=this.buildMarkers(t.view))}buildMarkers(t){let e=new yp;for(let r of t.viewportLineBlocks){let s=Qv(t.state,r.from,r.to)?n:Sv(t.state,r.from,r.to)?i:null;s&&e.add(r.from,r.from,s)}return e.finish()}}),{domEventHandlers:s}=e;return[r,uO({class:"cm-foldGutter",markers(t){var e;return(null===(e=t.plugin(r))||void 0===e?void 0:e.markers)||wp.empty},initialSpacer:()=>new Lv(e,!1),domEventHandlers:Object.assign(Object.assign({},s),{click:(t,e,i)=>{if(s.click&&s.click(t,e,i))return!0;let n=Qv(t.state,e.from,e.to);if(n)return t.dispatch({effects:Tv.of(n)}),!0;let r=Sv(t.state,e.from,e.to);return!!r&&(t.dispatch({effects:Av.of(r)}),!0)}})}),Bv()]}const Vv=iO.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class jv{constructor(t,e){let i;function n(t){let e=Je.newName();return(i||(i=Object.create(null)))["."+e]=t,e}const r="string"==typeof e.all?e.all:e.all?n(e.all):void 0,s=e.scope;this.scope=s instanceof UO?t=>t.prop(GO)==s.data:s?t=>t==s:void 0,this.style=PO(t.map((t=>({tag:t.tag,class:t.class||n(Object.assign({},t,{tag:null}))}))),{all:r}).style,this.module=i?new Je(i):null,this.themeType=e.themeType}static define(t,e){return new jv(t,e||{})}}const qv=Ad.define(),Hv=Ad.define({combine:t=>t.length?[t[0]]:null});function Xv(t){let e=t.facet(qv);return e.length?e:t.facet(Hv)}function Fv(t,e){let i,n=[Gv];return t instanceof jv&&(t.module&&n.push(iO.styleModule.of(t.module)),i=t.themeType),(null==e?void 0:e.fallback)?n.push(Hv.of(t)):i?n.push(qv.computeN([iO.darkTheme],(e=>e.facet(iO.darkTheme)==("dark"==i)?[t]:[]))):n.push(qv.of(t)),n}class Zv{constructor(t){this.markCache=Object.create(null),this.tree=KO(t.state),this.decorations=this.buildDeco(t,Xv(t.state))}update(t){let e=KO(t.state),i=Xv(t.state),n=i!=Xv(t.startState);e.length<t.view.viewport.to&&!n&&e.type==this.tree.type?this.decorations=this.decorations.map(t.changes):(e!=this.tree||t.viewportChanged||n)&&(this.tree=e,this.decorations=this.buildDeco(t.view,i))}buildDeco(t,e){if(!e||!this.tree.length)return Rg.none;let i=new yp;for(let{from:n,to:r}of t.visibleRanges)QO(this.tree,e,((t,e,n)=>{i.add(t,e,this.markCache[n]||(this.markCache[n]=Rg.mark({class:n})))}),n,r);return i.finish()}}const Gv=zd.high(em.fromClass(Zv,{decorations:t=>t.decorations})),Uv=jv.define([{tag:FO.meta,color:"#7a757a"},{tag:FO.link,textDecoration:"underline"},{tag:FO.heading,textDecoration:"underline",fontWeight:"bold"},{tag:FO.emphasis,fontStyle:"italic"},{tag:FO.strong,fontWeight:"bold"},{tag:FO.strikethrough,textDecoration:"line-through"},{tag:FO.keyword,color:"#708"},{tag:[FO.atom,FO.bool,FO.url,FO.contentSeparator,FO.labelName],color:"#219"},{tag:[FO.literal,FO.inserted],color:"#164"},{tag:[FO.string,FO.deleted],color:"#a11"},{tag:[FO.regexp,FO.escape,FO.special(FO.string)],color:"#e40"},{tag:FO.definition(FO.variableName),color:"#00f"},{tag:FO.local(FO.variableName),color:"#30a"},{tag:[FO.typeName,FO.namespace],color:"#085"},{tag:FO.className,color:"#167"},{tag:[FO.special(FO.variableName),FO.macroName],color:"#256"},{tag:FO.definition(FO.propertyName),color:"#00c"},{tag:FO.comment,color:"#940"},{tag:FO.invalid,color:"#f00"}]),Yv=iO.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Kv="()[]{}",Jv=Ad.define({combine:t=>gp(t,{afterCursor:!0,brackets:Kv,maxScanDistance:1e4,renderMatch:iw})}),tw=Rg.mark({class:"cm-matchingBracket"}),ew=Rg.mark({class:"cm-nonmatchingBracket"});function iw(t){let e=[],i=t.matched?tw:ew;return e.push(i.range(t.start.from,t.start.to)),t.end&&e.push(i.range(t.end.from,t.end.to)),e}const nw=_d.define({create:()=>Rg.none,update(t,e){if(!e.docChanged&&!e.selection)return t;let i=[],n=e.state.facet(Jv);for(let t of e.state.selection.ranges){if(!t.empty)continue;let r=lw(e.state,t.head,-1,n)||t.head>0&&lw(e.state,t.head-1,1,n)||n.afterCursor&&(lw(e.state,t.head,1,n)||t.head<e.state.doc.length&&lw(e.state,t.head+1,-1,n));r&&(i=i.concat(n.renderMatch(r,e.state)))}return Rg.set(i,!0)},provide:t=>iO.decorations.from(t)}),rw=[nw,Yv];function sw(t={}){return[Jv.of(t),rw]}function ow(t,e,i){let n=t.prop(e<0?kf.openedBy:kf.closedBy);if(n)return n;if(1==t.name.length){let n=i.indexOf(t.name);if(n>-1&&n%2==(e<0?1:0))return[i[n+e]]}return null}function lw(t,e,i,n={}){let r=n.maxScanDistance||1e4,s=n.brackets||Kv,o=KO(t),l=o.resolveInner(e,i);for(let n=l;n;n=n.parent){let r=ow(n.type,i,s);if(r&&n.from<n.to)return aw(t,e,i,n,r,s)}return function(t,e,i,n,r,s,o){let l=i<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),a=o.indexOf(l);if(a<0||a%2==0!=i>0)return null;let h={from:i<0?e-1:e,to:i>0?e+1:e},c=t.doc.iterRange(e,i>0?t.doc.length:0),u=0;for(let t=0;!c.next().done&&t<=s;){let s=c.value;i<0&&(t+=s.length);let l=e+t*i;for(let t=i>0?0:s.length-1,e=i>0?s.length:-1;t!=e;t+=i){let e=o.indexOf(s[t]);if(!(e<0||n.resolve(l+t,1).type!=r))if(e%2==0==i>0)u++;else{if(1==u)return{start:h,end:{from:l+t,to:l+t+1},matched:e>>1==a>>1};u--}}i>0&&(t+=s.length)}return c.done?{start:h,matched:!1}:null}(t,e,i,o,l.type,r,s)}function aw(t,e,i,n,r,s){let o=n.parent,l={from:n.from,to:n.to},a=0,h=null==o?void 0:o.cursor();if(h&&(i<0?h.childBefore(n.from):h.childAfter(n.to)))do{if(i<0?h.to<=n.from:h.from>=n.to){if(0==a&&r.indexOf(h.type.name)>-1&&h.from<h.to)return{start:l,end:{from:h.from,to:h.to},matched:!0};if(ow(h.type,i,s))a++;else if(ow(h.type,-i,s)&&(a--,0==a))return{start:l,end:h.from==h.to?void 0:{from:h.from,to:h.to},matched:!1}}}while(i<0?h.prevSibling():h.nextSibling());return{start:l,matched:!1}}const hw=Object.create(null),cw=[Cf.none],uw=[],fw=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","typeName"],["attribute","propertyName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])fw[t]=pw(hw,e);function dw(t,e){uw.indexOf(t)>-1||(uw.push(t),console.warn(e))}function pw(t,e){let i=null;for(let n of e.split(".")){let e=t[n]||FO[n];e?"function"==typeof e?i?i=e(i):dw(n,`Modifier ${n} used at start of tag`):i?dw(n,`Tag ${n} used as modifier`):i=e:dw(n,`Unknown highlighting tag ${n}`)}if(!i)return 0;let n=e.replace(/ /g,"_"),r=Cf.define({id:cw.length,name:n,props:[CO({[n]:i})]});return cw.push(r),r.id}const gw=aa.define(),mw=El.define();class bw{constructor(t,e,i,n,r){this.changes=t,this.effects=e,this.mapped=i,this.startSelection=n,this.selectionsAfter=r}setSelAfter(t){return new bw(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var t,e,i;return{changes:null===(t=this.changes)||void 0===t?void 0:t.toJSON(),mapped:null===(e=this.mapped)||void 0===e?void 0:e.toJSON(),startSelection:null===(i=this.startSelection)||void 0===i?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map((t=>t.toJSON()))}}static fromJSON(t){return new bw(t.changes&&Sl.fromJSON(t.changes),[],t.mapped&&kl.fromJSON(t.mapped),t.startSelection&&$l.fromJSON(t.startSelection),t.selectionsAfter.map($l.fromJSON))}static fromTransaction(t,e){let i=ww;for(let e of t.startState.facet(mw)){let n=e(t);n.length&&(i=i.concat(n))}return!i.length&&t.changes.empty?null:new bw(t.changes.invert(t.startState.doc),i,void 0,e||t.startState.selection,ww)}static selection(t){return new bw(void 0,ww,void 0,void 0,t)}}function Ow(t,e,i,n){let r=e+1>i+20?e-i-1:0,s=t.slice(r,e);return s.push(n),s}function vw(t,e){return t.length?e.length?t.concat(e):t:e}const ww=[];function yw(t,e){if(t.length){let i=t[t.length-1],n=i.selectionsAfter.slice(Math.max(0,i.selectionsAfter.length-200));return n.length&&n[n.length-1].eq(e)?t:(n.push(e),Ow(t,t.length-1,1e9,i.setSelAfter(n)))}return[bw.selection([e])]}function xw(t){let e=t[t.length-1],i=t.slice();return i[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),i}function kw(t,e){if(!t.length)return t;let i=t.length,n=ww;for(;i;){let r=Sw(t[i-1],e,n);if(r.changes&&!r.changes.empty||r.effects.length){let e=t.slice(0,i);return e[i-1]=r,e}e=r.mapped,i--,n=r.selectionsAfter}return n.length?[bw.selection(n)]:ww}function Sw(t,e,i){let n=vw(t.selectionsAfter.length?t.selectionsAfter.map((t=>t.map(e))):ww,i);if(!t.changes)return bw.selection(n);let r=t.changes.map(e),s=e.mapDesc(t.changes,!0),o=t.mapped?t.mapped.composeDesc(s):s;return new bw(r,ua.mapEffects(t.effects,e),o,t.startSelection.map(s),n)}const Cw=/^(input\.type|delete)($|\.)/;class Aw{constructor(t,e,i=0,n){this.done=t,this.undone=e,this.prevTime=i,this.prevUserEvent=n}isolate(){return this.prevTime?new Aw(this.done,this.undone):this}addChanges(t,e,i,n,r){let s=this.done,o=s[s.length-1];return s=o&&o.changes&&!o.changes.empty&&t.changes&&(!i||Cw.test(i))&&(!o.selectionsAfter.length&&e-this.prevTime<n&&function(t,e){let i=[],n=!1;return t.iterChangedRanges(((t,e)=>i.push(t,e))),e.iterChangedRanges(((t,e,r,s)=>{for(let t=0;t<i.length;){let e=i[t++],o=i[t++];s>=e&&r<=o&&(n=!0)}})),n}(o.changes,t.changes)||"input.type.compose"==i)?Ow(s,s.length-1,r,new bw(t.changes.compose(o.changes),vw(t.effects,o.effects),o.mapped,o.startSelection,ww)):Ow(s,s.length,r,t),new Aw(s,ww,e,i)}addSelection(t,e,i,n){let r=this.done.length?this.done[this.done.length-1].selectionsAfter:ww;return r.length>0&&e-this.prevTime<n&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&(s=r[r.length-1],o=t,s.ranges.length==o.ranges.length&&0===s.ranges.filter(((t,e)=>t.empty!=o.ranges[e].empty)).length)?this:new Aw(yw(this.done,t),this.undone,e,i);var s,o}addMapping(t){return new Aw(kw(this.done,t),kw(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,e,i){let n=0==t?this.done:this.undone;if(0==n.length)return null;let r=n[n.length-1];if(i&&r.selectionsAfter.length)return e.update({selection:r.selectionsAfter[r.selectionsAfter.length-1],annotations:gw.of({side:t,rest:xw(n)}),userEvent:0==t?"select.undo":"select.redo",scrollIntoView:!0});if(r.changes){let i=1==n.length?ww:n.slice(0,n.length-1);return r.mapped&&(i=kw(i,r.mapped)),e.update({changes:r.changes,selection:r.startSelection,effects:r.effects,annotations:gw.of({side:t,rest:i}),filter:!1,userEvent:0==t?"undo":"redo",scrollIntoView:!0})}return null}}Aw.empty=new Aw(ww,ww);function Tw(){var t=arguments[0];"string"==typeof t&&(t=document.createElement(t));var e=1,i=arguments[1];if(i&&"object"==typeof i&&null==i.nodeType&&!Array.isArray(i)){for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var r=i[n];"string"==typeof r?t.setAttribute(n,r):null!=r&&(t[n]=r)}e++}for(;e<arguments.length;e++)Pw(t,arguments[e]);return t}function Pw(t,e){if("string"==typeof e)t.appendChild(document.createTextNode(e));else if(null==e);else if(null!=e.nodeType)t.appendChild(e);else{if(!Array.isArray(e))throw new RangeError("Unsupported child node: "+e);for(var i=0;i<e.length;i++)Pw(t,e[i])}}const Mw="function"==typeof String.prototype.normalize?t=>t.normalize("NFKD"):t=>t;class Qw{constructor(t,e,i=0,n=t.length,r){this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=t.iterRange(i,n),this.bufferStart=i,this.normalize=r?t=>r(Mw(t)):Mw,this.query=this.normalize(e)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Ol(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let t=this.peek();if(t<0)return this.done=!0,this;let e=vl(t),i=this.bufferStart+this.bufferPos;this.bufferPos+=wl(t);let n=this.normalize(e);for(let t=0,r=i;;t++){let s=n.charCodeAt(t),o=this.match(s,r);if(o)return this.value=o,this;if(t==n.length-1)break;r==i&&t<e.length&&e.charCodeAt(t)==s&&r++}}}match(t,e){let i=null;for(let n=0;n<this.matches.length;n+=2){let r=this.matches[n],s=!1;this.query.charCodeAt(r)==t&&(r==this.query.length-1?i={from:this.matches[n+1],to:e+1}:(this.matches[n]++,s=!0)),s||(this.matches.splice(n,2),n-=2)}return this.query.charCodeAt(0)==t&&(1==this.query.length?i={from:e,to:e+1}:this.matches.push(1,e)),i}}"undefined"!=typeof Symbol&&(Qw.prototype[Symbol.iterator]=function(){return this});const Rw={from:-1,to:-1,match:/.*/.exec("")},$w="gm"+(null==/x/.unicode?"":"u");class _w{constructor(t,e,i,n=0,r=t.length){if(this.to=r,this.curLine="",this.done=!1,this.value=Rw,/\\[sWDnr]|\n|\r|\[\^/.test(e))return new Nw(t,e,i,n,r);this.re=new RegExp(e,$w+((null==i?void 0:i.ignoreCase)?"i":"")),this.iter=t.iter();let s=t.lineAt(n);this.curLineStart=s.from,this.matchPos=n,this.getLine(this.curLineStart)}getLine(t){this.iter.next(t),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let t=this.matchPos-this.curLineStart;;){this.re.lastIndex=t;let e=this.matchPos<=this.to&&this.re.exec(this.curLine);if(e){let i=this.curLineStart+e.index,n=i+e[0].length;if(this.matchPos=n+(i==n?1:0),i==this.curLine.length&&this.nextLine(),i<n||i>this.value.to)return this.value={from:i,to:n,match:e},this;t=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),t=0}}}}const Dw=new WeakMap;class Ew{constructor(t,e){this.from=t,this.text=e}get to(){return this.from+this.text.length}static get(t,e,i){let n=Dw.get(t);if(!n||n.from>=i||n.to<=e){let n=new Ew(e,t.sliceString(e,i));return Dw.set(t,n),n}if(n.from==e&&n.to==i)return n;let{text:r,from:s}=n;return s>e&&(r=t.sliceString(e,s)+r,s=e),n.to<i&&(r+=t.sliceString(n.to,i)),Dw.set(t,new Ew(s,r)),new Ew(e,r.slice(e-s,i-s))}}class Nw{constructor(t,e,i,n,r){this.text=t,this.to=r,this.done=!1,this.value=Rw,this.matchPos=n,this.re=new RegExp(e,$w+((null==i?void 0:i.ignoreCase)?"i":"")),this.flat=Ew.get(t,n,this.chunkEnd(n+5e3))}chunkEnd(t){return t>=this.to?this.to:this.text.lineAt(t).to}next(){for(;;){let t=this.re.lastIndex=this.matchPos-this.flat.from,e=this.re.exec(this.flat.text);if(e&&!e[0]&&e.index==t&&(this.re.lastIndex=t+1,e=this.re.exec(this.flat.text)),e&&this.flat.to<this.to&&e.index+e[0].length>this.flat.text.length-10&&(e=null),e){let t=this.flat.from+e.index,i=t+e[0].length;return this.value={from:t,to:i,match:e},this.matchPos=i+(t==i?1:0),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Ew.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}"undefined"!=typeof Symbol&&(_w.prototype[Symbol.iterator]=Nw.prototype[Symbol.iterator]=function(){return this});class Bw{constructor(){}lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,i){let n=[];return this.decompose(0,t,n,2),i.length&&i.decompose(0,i.length,n,3),this.decompose(e,this.length,n,1),zw.from(n,this.length-(e-t)+i.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){let i=[];return this.decompose(t,e,i,0),zw.from(i,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),i=this.length-this.scanIdentical(t,-1),n=new Vw(this),r=new Vw(t);for(let t=e,s=e;;){if(n.next(t),r.next(t),t=0,n.lineBreak!=r.lineBreak||n.done!=r.done||n.value!=r.value)return!1;if(s+=n.value.length,n.done||s>=i)return!0}}iter(t=1){return new Vw(this,t)}iterRange(t,e=this.length){return new jw(this,t,e)}iterLines(t,e){let i;if(null==t)i=this.iter();else{null==e&&(e=this.lines+1);let n=this.line(t).from;i=this.iterRange(n,Math.max(n,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new qw(i)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}static of(t){if(0==t.length)throw new RangeError("A document must have at least one line");return 1!=t.length||t[0]?t.length<=32?new Iw(t):zw.from(Iw.split(t,[])):Bw.empty}}class Iw extends Bw{constructor(t,e=function(t){let e=-1;for(let i of t)e+=i.length+1;return e}(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,i,n){for(let r=0;;r++){let s=this.text[r],o=n+s.length;if((e?i:o)>=t)return new Hw(n,o,i,s);n=o+1,i++}}decompose(t,e,i,n){let r=t<=0&&e>=this.length?this:new Iw(Ww(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(1&n){let t=i.pop(),e=Lw(r.text,t.text.slice(),0,r.length);if(e.length<=32)i.push(new Iw(e,t.length+r.length));else{let t=e.length>>1;i.push(new Iw(e.slice(0,t)),new Iw(e.slice(t)))}}else i.push(r)}replace(t,e,i){if(!(i instanceof Iw))return super.replace(t,e,i);let n=Lw(this.text,Lw(i.text,Ww(this.text,0,t)),e),r=this.length+i.length-(e-t);return n.length<=32?new Iw(n,r):zw.from(Iw.split(n,[]),r)}sliceString(t,e=this.length,i="\n"){let n="";for(let r=0,s=0;r<=e&&s<this.text.length;s++){let o=this.text[s],l=r+o.length;r>t&&s&&(n+=i),t<l&&e>r&&(n+=o.slice(Math.max(0,t-r),e-r)),r=l+1}return n}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let i=[],n=-1;for(let r of t)i.push(r),n+=r.length+1,32==i.length&&(e.push(new Iw(i,n)),i=[],n=-1);return n>-1&&e.push(new Iw(i,n)),e}}class zw extends Bw{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let e of t)this.lines+=e.lines}lineInner(t,e,i,n){for(let r=0;;r++){let s=this.children[r],o=n+s.length,l=i+s.lines-1;if((e?l:o)>=t)return s.lineInner(t,e,i,n);n=o+1,i=l+1}}decompose(t,e,i,n){for(let r=0,s=0;s<=e&&r<this.children.length;r++){let o=this.children[r],l=s+o.length;if(t<=l&&e>=s){let r=n&((s<=t?1:0)|(l>=e?2:0));s>=t&&l<=e&&!r?i.push(o):o.decompose(t-s,e-s,i,r)}s=l+1}}replace(t,e,i){if(i.lines<this.lines)for(let n=0,r=0;n<this.children.length;n++){let s=this.children[n],o=r+s.length;if(t>=r&&e<=o){let l=s.replace(t-r,e-r,i),a=this.lines-s.lines+l.lines;if(l.lines<a>>4&&l.lines>a>>6){let r=this.children.slice();return r[n]=l,new zw(r,this.length-(e-t)+i.length)}return super.replace(r,o,l)}r=o+1}return super.replace(t,e,i)}sliceString(t,e=this.length,i="\n"){let n="";for(let r=0,s=0;r<this.children.length&&s<=e;r++){let o=this.children[r],l=s+o.length;s>t&&r&&(n+=i),t<l&&e>s&&(n+=o.sliceString(t-s,e-s,i)),s=l+1}return n}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof zw))return 0;let i=0,[n,r,s,o]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;n+=e,r+=e){if(n==s||r==o)return i;let l=this.children[n],a=t.children[r];if(l!=a)return i+l.scanIdentical(a,e);i+=l.length+1}}static from(t,e=t.reduce(((t,e)=>t+e.length+1),-1)){let i=0;for(let e of t)i+=e.lines;if(i<32){let i=[];for(let e of t)e.flatten(i);return new Iw(i,e)}let n=Math.max(32,i>>5),r=n<<1,s=n>>1,o=[],l=0,a=-1,h=[];function c(t){let e;if(t.lines>r&&t instanceof zw)for(let e of t.children)c(e);else t.lines>s&&(l>s||!l)?(u(),o.push(t)):t instanceof Iw&&l&&(e=h[h.length-1])instanceof Iw&&t.lines+e.lines<=32?(l+=t.lines,a+=t.length+1,h[h.length-1]=new Iw(e.text.concat(t.text),e.length+1+t.length)):(l+t.lines>n&&u(),l+=t.lines,a+=t.length+1,h.push(t))}function u(){0!=l&&(o.push(1==h.length?h[0]:zw.from(h,a)),a=-1,l=h.length=0)}for(let e of t)c(e);return u(),1==o.length?o[0]:new zw(o,e)}}function Lw(t,e,i=0,n=1e9){for(let r=0,s=0,o=!0;s<t.length&&r<=n;s++){let l=t[s],a=r+l.length;a>=i&&(a>n&&(l=l.slice(0,n-r)),r<i&&(l=l.slice(i-r)),o?(e[e.length-1]+=l,o=!1):e.push(l)),r=a+1}return e}function Ww(t,e,i){return Lw(t,[""],e,i)}Bw.empty=new Iw([""],0);class Vw{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof Iw?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,n=this.nodes[i],r=this.offsets[i],s=r>>1,o=n instanceof Iw?n.text.length:n.children.length;if(s==(e>0?o:0)){if(0==i)return this.done=!0,this.value="",this;e>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&r)==(e>0?0:1)){if(this.offsets[i]+=e,0==t)return this.lineBreak=!0,this.value="\n",this;t--}else if(n instanceof Iw){let r=n.text[s+(e<0?-1:0)];if(this.offsets[i]+=e,r.length>Math.max(0,t))return this.value=0==t?r:e>0?r.slice(t):r.slice(0,r.length-t),this;t-=r.length}else{let r=n.children[s+(e<0?-1:0)];t>r.length?(t-=r.length,this.offsets[i]+=e):(e<0&&this.offsets[i]--,this.nodes.push(r),this.offsets.push(e>0?1:(r instanceof Iw?r.text.length:r.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class jw{constructor(t,e,i){this.value="",this.done=!1,this.cursor=new Vw(t,e>i?-1:1),this.pos=e>i?t.length:0,this.from=Math.min(e,i),this.to=Math.max(e,i)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let i=e<0?this.pos-this.from:this.to-this.pos;t>i&&(t=i),i-=t;let{value:n}=this.cursor.next(t);return this.pos+=(n.length+t)*e,this.value=n.length<=i?n:e<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class qw{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:i,value:n}=this.inner.next(t);return e?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(Bw.prototype[Symbol.iterator]=function(){return this.iter()},Vw.prototype[Symbol.iterator]=jw.prototype[Symbol.iterator]=qw.prototype[Symbol.iterator]=function(){return this});class Hw{constructor(t,e,i,n){this.from=t,this.to=e,this.number=i,this.text=n}get length(){return this.to-this.from}}let Xw="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((t=>t?parseInt(t,36):1));for(let t=1;t<Xw.length;t++)Xw[t]+=Xw[t-1];function Fw(t){for(let e=1;e<Xw.length;e+=2)if(Xw[e]>t)return Xw[e-1]<=t;return!1}function Zw(t){return t>=127462&&t<=127487}function Gw(t,e,i=!0,n=!0){return(i?Uw:Yw)(t,e,n)}function Uw(t,e,i){if(e==t.length)return e;e&&Kw(t.charCodeAt(e))&&Jw(t.charCodeAt(e-1))&&e--;let n=ty(t,e);for(e+=iy(n);e<t.length;){let r=ty(t,e);if(8205==n||8205==r||i&&Fw(r))e+=iy(r),n=r;else{if(!Zw(r))break;{let i=0,n=e-2;for(;n>=0&&Zw(ty(t,n));)i++,n-=2;if(i%2==0)break;e+=2}}}return e}function Yw(t,e,i){for(;e>0;){let n=Uw(t,e-2,i);if(n<e)return n;e--}return 0}function Kw(t){return t>=56320&&t<57344}function Jw(t){return t>=55296&&t<56320}function ty(t,e){let i=t.charCodeAt(e);if(!Jw(i)||e+1==t.length)return i;let n=t.charCodeAt(e+1);return Kw(n)?n-56320+(i-55296<<10)+65536:i}function ey(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}function iy(t){return t<65536?1:2}const ny=/\r\n?|\n/;var ry=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(ry||(ry={}));class sy{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e+1];t+=i<0?this.sections[e]:i}return t}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(t){for(let e=0,i=0,n=0;e<this.sections.length;){let r=this.sections[e++],s=this.sections[e++];s<0?(t(i,n,r),n+=r):n+=s,i+=r}}iterChangedRanges(t,e=!1){hy(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];n<0?t.push(i,n):t.push(n,i)}return new sy(t)}composeDesc(t){return this.empty?t:t.empty?this:uy(this,t)}mapDesc(t,e=!1){return t.empty?this:cy(this,t,e)}mapPos(t,e=-1,i=ry.Simple){let n=0,r=0;for(let s=0;s<this.sections.length;){let o=this.sections[s++],l=this.sections[s++],a=n+o;if(l<0){if(a>t)return r+(t-n);r+=o}else{if(i!=ry.Simple&&a>=t&&(i==ry.TrackDel&&n<t&&a>t||i==ry.TrackBefore&&n<t||i==ry.TrackAfter&&a>t))return null;if(a>t||a==t&&e<0&&!o)return t==n||e<0?r:r+l;r+=l}n=a}if(t>n)throw new RangeError(`Position ${t} is out of range for changeset of length ${n}`);return r}touchesRange(t,e=t){for(let i=0,n=0;i<this.sections.length&&n<=e;){let r=n+this.sections[i++];if(this.sections[i++]>=0&&n<=e&&r>=t)return!(n<t&&r>e)||"cover";n=r}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+i+(n>=0?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some((t=>"number"!=typeof t)))throw new RangeError("Invalid JSON representation of ChangeDesc");return new sy(t)}static create(t){return new sy(t)}}class oy extends sy{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return hy(this,((e,i,n,r,s)=>t=t.replace(n,n+(i-e),s)),!1),t}mapDesc(t,e=!1){return cy(this,t,e,!0)}invert(t){let e=this.sections.slice(),i=[];for(let n=0,r=0;n<e.length;n+=2){let s=e[n],o=e[n+1];if(o>=0){e[n]=o,e[n+1]=s;let l=n>>1;for(;i.length<l;)i.push(Bw.empty);i.push(s?t.slice(r,r+s):Bw.empty)}r+=s}return new oy(e,i)}compose(t){return this.empty?t:t.empty?this:uy(this,t,!0)}map(t,e=!1){return t.empty?this:cy(this,t,e,!0)}iterChanges(t,e=!1){hy(this,t,e)}get desc(){return sy.create(this.sections)}filter(t){let e=[],i=[],n=[],r=new fy(this);t:for(let s=0,o=0;;){let l=s==t.length?1e9:t[s++];for(;o<l||o==l&&0==r.len;){if(r.done)break t;let t=Math.min(r.len,l-o);ly(n,t,-1);let s=-1==r.ins?-1:0==r.off?r.ins:0;ly(e,t,s),s>0&&ay(i,e,r.text),r.forward(t),o+=t}let a=t[s++];for(;o<a;){if(r.done)break t;let t=Math.min(r.len,a-o);ly(e,t,-1),ly(n,t,-1==r.ins?-1:0==r.off?r.ins:0),r.forward(t),o+=t}}return{changes:new oy(e,i),filtered:sy.create(n)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e],n=this.sections[e+1];n<0?t.push(i):0==n?t.push([i]):t.push([i].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,i){let n=[],r=[],s=0,o=null;function l(t=!1){if(!t&&!n.length)return;s<e&&ly(n,e-s,-1);let i=new oy(n,r);o=o?o.compose(i.map(o)):i,n=[],r=[],s=0}return function t(a){if(Array.isArray(a))for(let e of a)t(e);else if(a instanceof oy){if(a.length!=e)throw new RangeError(`Mismatched change set length (got ${a.length}, expected ${e})`);l(),o=o?o.compose(a.map(o)):a}else{let{from:t,to:o=t,insert:h}=a;if(t>o||t<0||o>e)throw new RangeError(`Invalid change range ${t} to ${o} (in doc of length ${e})`);let c=h?"string"==typeof h?Bw.of(h.split(i||ny)):h:Bw.empty,u=c.length;if(t==o&&0==u)return;t<s&&l(),t>s&&ly(n,t-s,-1),ly(n,o-t,u),ay(r,n,c),s=o}}(t),l(!o),o}static empty(t){return new oy(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],i=[];for(let n=0;n<t.length;n++){let r=t[n];if("number"==typeof r)e.push(r,-1);else{if(!Array.isArray(r)||"number"!=typeof r[0]||r.some(((t,e)=>e&&"string"!=typeof t)))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==r.length)e.push(r[0],0);else{for(;i.length<n;)i.push(Bw.empty);i[n]=Bw.of(r.slice(1)),e.push(r[0],i[n].length)}}}return new oy(e,i)}static createSet(t,e){return new oy(t,e)}}function ly(t,e,i,n=!1){if(0==e&&i<=0)return;let r=t.length-2;r>=0&&i<=0&&i==t[r+1]?t[r]+=e:0==e&&0==t[r]?t[r+1]+=i:n?(t[r]+=e,t[r+1]+=i):t.push(e,i)}function ay(t,e,i){if(0==i.length)return;let n=e.length-2>>1;if(n<t.length)t[t.length-1]=t[t.length-1].append(i);else{for(;t.length<n;)t.push(Bw.empty);t.push(i)}}function hy(t,e,i){let n=t.inserted;for(let r=0,s=0,o=0;o<t.sections.length;){let l=t.sections[o++],a=t.sections[o++];if(a<0)r+=l,s+=l;else{let h=r,c=s,u=Bw.empty;for(;h+=l,c+=a,a&&n&&(u=u.append(n[o-2>>1])),!(i||o==t.sections.length||t.sections[o+1]<0);)l=t.sections[o++],a=t.sections[o++];e(r,h,s,c,u),r=h,s=c}}}function cy(t,e,i,n=!1){let r=[],s=n?[]:null,o=new fy(t),l=new fy(e);for(let t=0,e=0;;)if(-1==o.ins)t+=o.len,o.next();else if(-1==l.ins&&e<t){let i=Math.min(l.len,t-e);l.forward(i),ly(r,i,-1),e+=i}else if(l.ins>=0&&(o.done||e<t||e==t&&(l.len<o.len||l.len==o.len&&!i))){for(ly(r,l.ins,-1);t>e&&!o.done&&t+o.len<e+l.len;)t+=o.len,o.next();e+=l.len,l.next()}else{if(!(o.ins>=0)){if(o.done&&l.done)return s?oy.createSet(r,s):sy.create(r);throw new Error("Mismatched change set lengths")}{let i=0,n=t+o.len;for(;;)if(l.ins>=0&&e>t&&e+l.len<n)i+=l.ins,e+=l.len,l.next();else{if(!(-1==l.ins&&e<n))break;{let t=Math.min(l.len,n-e);i+=t,l.forward(t),e+=t}}ly(r,i,o.ins),s&&ay(s,r,o.text),t=n,o.next()}}}function uy(t,e,i=!1){let n=[],r=i?[]:null,s=new fy(t),o=new fy(e);for(let t=!1;;){if(s.done&&o.done)return r?oy.createSet(n,r):sy.create(n);if(0==s.ins)ly(n,s.len,0,t),s.next();else if(0!=o.len||o.done){if(s.done||o.done)throw new Error("Mismatched change set lengths");{let e=Math.min(s.len2,o.len),i=n.length;if(-1==s.ins){let i=-1==o.ins?-1:o.off?0:o.ins;ly(n,e,i,t),r&&i&&ay(r,n,o.text)}else-1==o.ins?(ly(n,s.off?0:s.len,e,t),r&&ay(r,n,s.textBit(e))):(ly(n,s.off?0:s.len,o.off?0:o.ins,t),r&&!o.off&&ay(r,n,o.text));t=(s.ins>e||o.ins>=0&&o.len>e)&&(t||n.length>i),s.forward2(e),o.forward(e)}}else ly(n,0,o.ins,t),r&&ay(r,n,o.text),o.next()}}class fy{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?Bw.empty:t[e]}textBit(t){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length&&!t?Bw.empty:e[i].slice(this.off,null==t?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){-1==this.ins?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class dy{constructor(t,e,i){this.from=t,this.to=e,this.flags=i}get anchor(){return 16&this.flags?this.to:this.from}get head(){return 16&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 4&this.flags?-1:8&this.flags?1:0}get bidiLevel(){let t=3&this.flags;return 3==t?null:t}get goalColumn(){let t=this.flags>>5;return 33554431==t?void 0:t}map(t,e=-1){let i,n;return this.empty?i=n=t.mapPos(this.from,e):(i=t.mapPos(this.from,1),n=t.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new dy(i,n,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return py.range(t,e);let i=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return py.range(this.anchor,i)}eq(t){return this.anchor==t.anchor&&this.head==t.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||"number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid JSON representation for SelectionRange");return py.range(t.anchor,t.head)}static create(t,e,i){return new dy(t,e,i)}}class py{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:py.create(this.ranges.map((i=>i.map(t,e))),this.mainIndex)}eq(t){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let e=0;e<this.ranges.length;e++)if(!this.ranges[e].eq(t.ranges[e]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new py([this.main],0)}addRange(t,e=!0){return py.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let i=this.ranges.slice();return i[e]=t,py.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map((t=>t.toJSON())),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||"number"!=typeof t.main||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new py(t.ranges.map((t=>dy.fromJSON(t))),t.main)}static single(t,e=t){return new py([py.range(t,e)],0)}static create(t,e=0){if(0==t.length)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<t.length;n++){let r=t[n];if(r.empty?r.from<=i:r.from<i)return py.normalized(t.slice(),e);i=r.to}return new py(t,e)}static cursor(t,e=0,i,n){return dy.create(t,t,(0==e?0:e<0?4:8)|(null==i?3:Math.min(2,i))|(null!=n?n:33554431)<<5)}static range(t,e,i){let n=(null!=i?i:33554431)<<5;return e<t?dy.create(e,t,24|n):dy.create(t,e,n|(e>t?4:0))}static normalized(t,e=0){let i=t[e];t.sort(((t,e)=>t.from-e.from)),e=t.indexOf(i);for(let i=1;i<t.length;i++){let n=t[i],r=t[i-1];if(n.empty?n.from<=r.to:n.from<r.to){let s=r.from,o=Math.max(n.to,r.to);i<=e&&e--,t.splice(--i,2,n.anchor>n.head?py.range(o,s):py.range(s,o))}}return new py(t,e)}}function gy(t,e){for(let i of t.ranges)if(i.to>e)throw new RangeError("Selection points outside of document")}let my=0;class by{constructor(t,e,i,n,r){this.combine=t,this.compareInput=e,this.compare=i,this.isStatic=n,this.extensions=r,this.id=my++,this.default=t([])}static define(t={}){return new by(t.combine||(t=>t),t.compareInput||((t,e)=>t===e),t.compare||(t.combine?(t,e)=>t===e:Oy),!!t.static,t.enables)}of(t){return new vy([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new vy(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new vy(t,this,2,e)}from(t,e){return e||(e=t=>t),this.compute([t],(i=>e(i.field(t))))}}function Oy(t,e){return t==e||t.length==e.length&&t.every(((t,i)=>t===e[i]))}class vy{constructor(t,e,i,n){this.dependencies=t,this.facet=e,this.type=i,this.value=n,this.id=my++}dynamicSlot(t){var e;let i=this.value,n=this.facet.compareInput,r=this.id,s=t[r]>>1,o=2==this.type,l=!1,a=!1,h=[];for(let i of this.dependencies)"doc"==i?l=!0:"selection"==i?a=!0:0==(1&(null!==(e=t[i.id])&&void 0!==e?e:1))&&h.push(t[i.id]);return{create:t=>(t.values[s]=i(t),1),update(t,e){if(l&&e.docChanged||a&&(e.docChanged||e.selection)||yy(t,h)){let e=i(t);if(o?!wy(e,t.values[s],n):!n(e,t.values[s]))return t.values[s]=e,1}return 0},reconfigure:(t,e)=>{let l=i(t),a=e.config.address[r];if(null!=a){let i=Ny(e,a);if(this.dependencies.every((i=>i instanceof by?e.facet(i)===t.facet(i):!(i instanceof Sy)||e.field(i,!1)==t.field(i,!1)))||(o?wy(l,i,n):n(l,i)))return t.values[s]=i,0}return t.values[s]=l,1}}}}function wy(t,e,i){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1;return!0}function yy(t,e){let i=!1;for(let n of e)1&Ey(t,n)&&(i=!0);return i}function xy(t,e,i){let n=i.map((e=>t[e.id])),r=i.map((t=>t.type)),s=n.filter((t=>!(1&t))),o=t[e.id]>>1;function l(t){let i=[];for(let e=0;e<n.length;e++){let s=Ny(t,n[e]);if(2==r[e])for(let t of s)i.push(t);else i.push(s)}return e.combine(i)}return{create(t){for(let e of n)Ey(t,e);return t.values[o]=l(t),1},update(t,i){if(!yy(t,s))return 0;let n=l(t);return e.compare(n,t.values[o])?0:(t.values[o]=n,1)},reconfigure(t,r){let s=yy(t,n),a=r.config.facets[e.id],h=r.facet(e);if(a&&!s&&Oy(i,a))return t.values[o]=h,0;let c=l(t);return e.compare(c,h)?(t.values[o]=h,0):(t.values[o]=c,1)}}}const ky=by.define({static:!0});class Sy{constructor(t,e,i,n,r){this.id=t,this.createF=e,this.updateF=i,this.compareF=n,this.spec=r,this.provides=void 0}static define(t){let e=new Sy(my++,t.create,t.update,t.compare||((t,e)=>t===e),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(ky).find((t=>t.field==this));return((null==e?void 0:e.create)||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:t=>(t.values[e]=this.create(t),1),update:(t,i)=>{let n=t.values[e],r=this.updateF(n,i);return this.compareF(n,r)?0:(t.values[e]=r,1)},reconfigure:(t,i)=>null!=i.config.address[this.id]?(t.values[e]=i.field(this),0):(t.values[e]=this.create(t),1)}}init(t){return[this,ky.of({field:this,create:t})]}get extension(){return this}}const Cy=4,Ay=3,Ty=2,Py=1;function My(t){return e=>new Ry(e,t)}const Qy={highest:My(0),high:My(Py),default:My(Ty),low:My(Ay),lowest:My(Cy)};class Ry{constructor(t,e){this.inner=t,this.prec=e}}class $y{of(t){return new _y(this,t)}reconfigure(t){return $y.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class _y{constructor(t,e){this.compartment=t,this.inner=e}}class Dy{constructor(t,e,i,n,r,s){for(this.base=t,this.compartments=e,this.dynamicSlots=i,this.address=n,this.staticValues=r,this.facets=s,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return null==e?t.default:this.staticValues[e>>1]}static resolve(t,e,i){let n=[],r=Object.create(null),s=new Map;for(let i of function(t,e,i){let n=[[],[],[],[],[]],r=new Map;function s(t,o){let l=r.get(t);if(null!=l){if(l<=o)return;let e=n[l].indexOf(t);e>-1&&n[l].splice(e,1),t instanceof _y&&i.delete(t.compartment)}if(r.set(t,o),Array.isArray(t))for(let e of t)s(e,o);else if(t instanceof _y){if(i.has(t.compartment))throw new RangeError("Duplicate use of compartment in extensions");let n=e.get(t.compartment)||t.inner;i.set(t.compartment,n),s(n,o)}else if(t instanceof Ry)s(t.inner,t.prec);else if(t instanceof Sy)n[o].push(t),t.provides&&s(t.provides,o);else if(t instanceof vy)n[o].push(t),t.facet.extensions&&s(t.facet.extensions,o);else{let e=t.extension;if(!e)throw new Error(`Unrecognized extension value in extension set (${t}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(e,o)}}return s(t,Ty),n.reduce(((t,e)=>t.concat(e)))}(t,e,s))i instanceof Sy?n.push(i):(r[i.facet.id]||(r[i.facet.id]=[])).push(i);let o=Object.create(null),l=[],a=[];for(let t of n)o[t.id]=a.length<<1,a.push((e=>t.slot(e)));let h=null==i?void 0:i.config.facets;for(let t in r){let e=r[t],n=e[0].facet,s=h&&h[t]||[];if(e.every((t=>0==t.type)))if(o[n.id]=l.length<<1|1,Oy(s,e))l.push(i.facet(n));else{let t=n.combine(e.map((t=>t.value)));l.push(i&&n.compare(t,i.facet(n))?i.facet(n):t)}else{for(let t of e)0==t.type?(o[t.id]=l.length<<1|1,l.push(t.value)):(o[t.id]=a.length<<1,a.push((e=>t.dynamicSlot(e))));o[n.id]=a.length<<1,a.push((t=>xy(t,n,e)))}}let c=a.map((t=>t(o)));return new Dy(t,s,c,o,l,r)}}function Ey(t,e){if(1&e)return 2;let i=e>>1,n=t.status[i];if(4==n)throw new Error("Cyclic dependency between fields and/or facets");if(2&n)return n;t.status[i]=4;let r=t.computeSlot(t,t.config.dynamicSlots[i]);return t.status[i]=2|r}function Ny(t,e){return 1&e?t.config.staticValues[e>>1]:t.values[e>>1]}const By=by.define(),Iy=by.define({combine:t=>t.some((t=>t)),static:!0}),zy=by.define({combine:t=>t.length?t[0]:void 0,static:!0}),Ly=by.define(),Wy=by.define(),Vy=by.define(),jy=by.define({combine:t=>!!t.length&&t[0]});class qy{constructor(t,e){this.type=t,this.value=e}static define(){return new Hy}}class Hy{of(t){return new qy(this,t)}}class Xy{constructor(t){this.map=t}of(t){return new Fy(this,t)}}class Fy{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return void 0===e?void 0:e==this.value?this:new Fy(this.type,e)}is(t){return this.type==t}static define(t={}){return new Xy(t.map||(t=>t))}static mapEffects(t,e){if(!t.length)return t;let i=[];for(let n of t){let t=n.map(e);t&&i.push(t)}return i}}Fy.reconfigure=Fy.define(),Fy.appendConfig=Fy.define();class Zy{constructor(t,e,i,n,r,s){this.startState=t,this.changes=e,this.selection=i,this.effects=n,this.annotations=r,this.scrollIntoView=s,this._doc=null,this._state=null,i&&gy(i,e.newLength),r.some((t=>t.type==Zy.time))||(this.annotations=r.concat(Zy.time.of(Date.now())))}static create(t,e,i,n,r,s){return new Zy(t,e,i,n,r,s)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(Zy.userEvent);return!(!e||!(e==t||e.length>t.length&&e.slice(0,t.length)==t&&"."==e[t.length]))}}function Gy(t,e){let i=[];for(let n=0,r=0;;){let s,o;if(n<t.length&&(r==e.length||e[r]>=t[n]))s=t[n++],o=t[n++];else{if(!(r<e.length))return i;s=e[r++],o=e[r++]}!i.length||i[i.length-1]<s?i.push(s,o):i[i.length-1]<o&&(i[i.length-1]=o)}}function Uy(t,e,i){var n;let r,s,o;return i?(r=e.changes,s=oy.empty(e.changes.length),o=t.changes.compose(e.changes)):(r=e.changes.map(t.changes),s=t.changes.mapDesc(e.changes,!0),o=t.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):null===(n=t.selection)||void 0===n?void 0:n.map(r),effects:Fy.mapEffects(t.effects,r).concat(Fy.mapEffects(e.effects,s)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function Yy(t,e,i){let n=e.selection,r=tx(e.annotations);return e.userEvent&&(r=r.concat(Zy.userEvent.of(e.userEvent))),{changes:e.changes instanceof oy?e.changes:oy.of(e.changes||[],i,t.facet(zy)),selection:n&&(n instanceof py?n:py.single(n.anchor,n.head)),effects:tx(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function Ky(t,e,i){let n=Yy(t,e.length?e[0]:{},t.doc.length);e.length&&!1===e[0].filter&&(i=!1);for(let r=1;r<e.length;r++){!1===e[r].filter&&(i=!1);let s=!!e[r].sequential;n=Uy(n,Yy(t,e[r],s?n.changes.newLength:t.doc.length),s)}let r=Zy.create(t,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return function(t){let e=t.startState,i=e.facet(Vy),n=t;for(let r=i.length-1;r>=0;r--){let s=i[r](t);s&&Object.keys(s).length&&(n=Uy(t,Yy(e,s,t.changes.newLength),!0))}return n==t?t:Zy.create(e,t.changes,t.selection,n.effects,n.annotations,n.scrollIntoView)}(i?function(t){let e=t.startState,i=!0;for(let n of e.facet(Ly)){let e=n(t);if(!1===e){i=!1;break}Array.isArray(e)&&(i=!0===i?e:Gy(i,e))}if(!0!==i){let n,r;if(!1===i)r=t.changes.invertedDesc,n=oy.empty(e.doc.length);else{let e=t.changes.filter(i);n=e.changes,r=e.filtered.invertedDesc}t=Zy.create(e,n,t.selection&&t.selection.map(r),Fy.mapEffects(t.effects,r),t.annotations,t.scrollIntoView)}let n=e.facet(Wy);for(let i=n.length-1;i>=0;i--){let r=n[i](t);t=r instanceof Zy?r:Array.isArray(r)&&1==r.length&&r[0]instanceof Zy?r[0]:Ky(e,tx(r),!1)}return t}(r):r)}Zy.time=qy.define(),Zy.userEvent=qy.define(),Zy.addToHistory=qy.define(),Zy.remote=qy.define();const Jy=[];function tx(t){return null==t?Jy:Array.isArray(t)?t:[t]}var ex=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(ex||(ex={}));const ix=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let nx;try{nx=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(t){}function rx(t){return e=>{if(!/\S/.test(e))return ex.Space;if(function(t){if(nx)return nx.test(t);for(let e=0;e<t.length;e++){let i=t[e];if(/\w/.test(i)||i>""&&(i.toUpperCase()!=i.toLowerCase()||ix.test(i)))return!0}return!1}(e))return ex.Word;for(let i=0;i<t.length;i++)if(e.indexOf(t[i])>-1)return ex.Word;return ex.Other}}class sx{constructor(t,e,i,n,r,s){this.config=t,this.doc=e,this.selection=i,this.values=n,this.status=t.statusTemplate.slice(),this.computeSlot=r,s&&(s._state=this);for(let t=0;t<this.config.dynamicSlots.length;t++)Ey(this,t<<1);this.computeSlot=null}field(t,e=!0){let i=this.config.address[t.id];if(null!=i)return Ey(this,i),Ny(this,i);if(e)throw new RangeError("Field is not present in this state")}update(...t){return Ky(this,t,!0)}applyTransaction(t){let e,i=this.config,{base:n,compartments:r}=i;for(let e of t.effects)e.is($y.reconfigure)?(i&&(r=new Map,i.compartments.forEach(((t,e)=>r.set(e,t))),i=null),r.set(e.value.compartment,e.value.extension)):e.is(Fy.reconfigure)?(i=null,n=e.value):e.is(Fy.appendConfig)&&(i=null,n=tx(n).concat(e.value));if(i)e=t.startState.values.slice();else{i=Dy.resolve(n,r,this);let t=new sx(i,this.doc,this.selection,i.dynamicSlots.map((()=>null)),((t,e)=>e.reconfigure(t,this)),null);e=t.values}new sx(i,t.newDoc,t.newSelection,e,((e,i)=>i.update(e,t)),t)}replaceSelection(t){return"string"==typeof t&&(t=this.toText(t)),this.changeByRange((e=>({changes:{from:e.from,to:e.to,insert:t},range:py.cursor(e.from+t.length)})))}changeByRange(t){let e=this.selection,i=t(e.ranges[0]),n=this.changes(i.changes),r=[i.range],s=tx(i.effects);for(let i=1;i<e.ranges.length;i++){let o=t(e.ranges[i]),l=this.changes(o.changes),a=l.map(n);for(let t=0;t<i;t++)r[t]=r[t].map(a);let h=n.mapDesc(l,!0);r.push(o.range.map(h)),n=n.compose(a),s=Fy.mapEffects(s,a).concat(Fy.mapEffects(tx(o.effects),h))}return{changes:n,selection:py.create(r,e.mainIndex),effects:s}}changes(t=[]){return t instanceof oy?t:oy.of(t,this.doc.length,this.facet(sx.lineSeparator))}toText(t){return Bw.of(t.split(this.facet(sx.lineSeparator)||ny))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return null==e?t.default:(Ey(this,e),Ny(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let i in t){let n=t[i];n instanceof Sy&&(e[i]=n.spec.toJSON(this.field(t[i]),this))}return e}static fromJSON(t,e={},i){if(!t||"string"!=typeof t.doc)throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i)for(let e in i){let r=i[e],s=t[e];n.push(r.init((t=>r.spec.fromJSON(s,t))))}return sx.create({doc:t.doc,selection:py.fromJSON(t.selection),extensions:e.extensions?n.concat([e.extensions]):n})}static create(t={}){let e=Dy.resolve(t.extensions||[],new Map),i=t.doc instanceof Bw?t.doc:Bw.of((t.doc||"").split(e.staticFacet(sx.lineSeparator)||ny)),n=t.selection?t.selection instanceof py?t.selection:py.single(t.selection.anchor,t.selection.head):py.single(0);return gy(n,i.length),e.staticFacet(Iy)||(n=n.asSingle()),new sx(e,i,n,e.dynamicSlots.map((()=>null)),((t,e)=>e.create(t)),null)}get tabSize(){return this.facet(sx.tabSize)}get lineBreak(){return this.facet(sx.lineSeparator)||"\n"}get readOnly(){return this.facet(jy)}phrase(t,...e){for(let e of this.facet(sx.phrases))if(Object.prototype.hasOwnProperty.call(e,t)){t=e[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,((t,i)=>{if("$"==i)return"$";let n=+(i||1);return n>e.length?t:e[n-1]}))),t}languageDataAt(t,e,i=-1){let n=[];for(let r of this.facet(By))for(let s of r(this,e,i))Object.prototype.hasOwnProperty.call(s,t)&&n.push(s[t]);return n}charCategorizer(t){return rx(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:i,length:n}=this.doc.lineAt(t),r=this.charCategorizer(t),s=t-i,o=t-i;for(;s>0;){let t=Gw(e,s,!1);if(r(e.slice(t,s))!=ex.Word)break;s=t}for(;o<n;){let t=Gw(e,o);if(r(e.slice(o,t))!=ex.Word)break;o=t}return s==o?null:py.range(s+i,o+i)}}sx.allowMultipleSelections=Iy,sx.tabSize=by.define({combine:t=>t.length?t[0]:4}),sx.lineSeparator=zy,sx.readOnly=jy,sx.phrases=by.define({compare(t,e){let i=Object.keys(t),n=Object.keys(e);return i.length==n.length&&i.every((i=>t[i]==e[i]))}}),sx.languageData=By,sx.changeFilter=Ly,sx.transactionFilter=Wy,sx.transactionExtender=Vy,$y.reconfigure=Fy.define();class ox{eq(t){return this==t}range(t,e=t){return lx.create(t,e,this)}}ox.prototype.startSide=ox.prototype.endSide=0,ox.prototype.point=!1,ox.prototype.mapMode=ry.TrackDel;class lx{constructor(t,e,i){this.from=t,this.to=e,this.value=i}static create(t,e,i){return new lx(t,e,i)}}function ax(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class hx{constructor(t,e,i,n){this.from=t,this.to=e,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(t,e,i,n=0){let r=i?this.to:this.from;for(let s=n,o=r.length;;){if(s==o)return s;let n=s+o>>1,l=r[n]-t||(i?this.value[n].endSide:this.value[n].startSide)-e;if(n==s)return l>=0?s:o;l>=0?o=n:s=n+1}}between(t,e,i,n){for(let r=this.findIndex(e,-1e9,!0),s=this.findIndex(i,1e9,!1,r);r<s;r++)if(!1===n(this.from[r]+t,this.to[r]+t,this.value[r]))return!1}map(t,e){let i=[],n=[],r=[],s=-1,o=-1;for(let l=0;l<this.value.length;l++){let a,h,c=this.value[l],u=this.from[l]+t,f=this.to[l]+t;if(u==f){let t=e.mapPos(u,c.startSide,c.mapMode);if(null==t)continue;if(a=h=t,c.startSide!=c.endSide&&(h=e.mapPos(u,c.endSide),h<a))continue}else if(a=e.mapPos(u,c.startSide),h=e.mapPos(f,c.endSide),a>h||a==h&&c.startSide>0&&c.endSide<=0)continue;(h-a||c.endSide-c.startSide)<0||(s<0&&(s=a),c.point&&(o=Math.max(o,h-a)),i.push(c),n.push(a-s),r.push(h-s))}return{mapped:i.length?new hx(n,r,i,o):null,pos:s}}}class cx{constructor(t,e,i,n){this.chunkPos=t,this.chunk=e,this.nextLayer=i,this.maxPoint=n}static create(t,e,i,n){return new cx(t,e,i,n)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:i=!1,filterFrom:n=0,filterTo:r=this.length}=t,s=t.filter;if(0==e.length&&!s)return this;if(i&&(e=e.slice().sort(ax)),this.isEmpty)return e.length?cx.of(e):this;let o=new dx(this,null,-1).goto(0),l=0,a=[],h=new ux;for(;o.value||l<e.length;)if(l<e.length&&(o.from-e[l].from||o.startSide-e[l].value.startSide)>=0){let t=e[l++];h.addInner(t.from,t.to,t.value)||a.push(t)}else 1==o.rangeIndex&&o.chunkIndex<this.chunk.length&&(l==e.length||this.chunkEnd(o.chunkIndex)<e[l].from)&&(!s||n>this.chunkEnd(o.chunkIndex)||r<this.chunkPos[o.chunkIndex])&&h.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!s||n>o.to||r<o.from||s(o.from,o.to,o.value))&&(h.addInner(o.from,o.to,o.value)||a.push(lx.create(o.from,o.to,o.value))),o.next());return h.finishInner(this.nextLayer.isEmpty&&!a.length?cx.empty:this.nextLayer.update({add:a,filter:s,filterFrom:n,filterTo:r}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],i=[],n=-1;for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r],l=t.touchesRange(s,s+o.length);if(!1===l)n=Math.max(n,o.maxPoint),e.push(o),i.push(t.mapPos(s));else if(!0===l){let{mapped:r,pos:l}=o.map(s,t);r&&(n=Math.max(n,r.maxPoint),e.push(r),i.push(l))}}let r=this.nextLayer.map(t);return 0==e.length?r:new cx(i,e,r||cx.empty,n)}between(t,e,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let r=this.chunkPos[n],s=this.chunk[n];if(e>=r&&t<=r+s.length&&!1===s.between(r,t-r,e-r,i))return}this.nextLayer.between(t,e,i)}}iter(t=0){return px.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return px.from(t).goto(e)}static compare(t,e,i,n,r=-1){let s=t.filter((t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=r)),o=e.filter((t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=r)),l=fx(s,o,i),a=new mx(s,l,r),h=new mx(o,l,r);i.iterGaps(((t,e,i)=>bx(a,t,h,e,i,n))),i.empty&&0==i.length&&bx(a,0,h,0,0,n)}static eq(t,e,i=0,n){null==n&&(n=1e9);let r=t.filter((t=>!t.isEmpty&&e.indexOf(t)<0)),s=e.filter((e=>!e.isEmpty&&t.indexOf(e)<0));if(r.length!=s.length)return!1;if(!r.length)return!0;let o=fx(r,s),l=new mx(r,o,0).goto(i),a=new mx(s,o,0).goto(i);for(;;){if(l.to!=a.to||!Ox(l.active,a.active)||l.point&&(!a.point||!l.point.eq(a.point)))return!1;if(l.to>n)return!0;l.next(),a.next()}}static spans(t,e,i,n,r=-1){let s=new mx(t,null,r).goto(e),o=e,l=s.openStart;for(;;){let t=Math.min(s.to,i);if(s.point?(n.point(o,t,s.point,s.activeForPoint(s.to),l,s.pointRank),l=s.openEnd(t)+(s.to>t?1:0)):t>o&&(n.span(o,t,s.active,l),l=s.openEnd(t)),s.to>i)break;o=s.to,s.next()}return l}static of(t,e=!1){let i=new ux;for(let n of t instanceof lx?[t]:e?function(t){if(t.length>1)for(let e=t[0],i=1;i<t.length;i++){let n=t[i];if(ax(e,n)>0)return t.slice().sort(ax);e=n}return t}(t):t)i.add(n.from,n.to,n.value);return i.finish()}}cx.empty=new cx([],[],null,-1),cx.empty.nextLayer=cx.empty;class ux{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(t){this.chunks.push(new hx(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}add(t,e,i){this.addInner(t,e,i)||(this.nextLayer||(this.nextLayer=new ux)).add(t,e,i)}addInner(t,e,i){let n=t-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(t-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(n<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=i,this.lastFrom=t,this.lastTo=e,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let i=e.value.length-1;return this.last=e.value[i],this.lastFrom=e.from[i]+t,this.lastTo=e.to[i]+t,!0}finish(){return this.finishInner(cx.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return t;let e=cx.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function fx(t,e,i){let n=new Map;for(let e of t)for(let t=0;t<e.chunk.length;t++)e.chunk[t].maxPoint<=0&&n.set(e.chunk[t],e.chunkPos[t]);let r=new Set;for(let t of e)for(let e=0;e<t.chunk.length;e++){let s=n.get(t.chunk[e]);null==s||(i?i.mapPos(s):s)!=t.chunkPos[e]||(null==i?void 0:i.touchesRange(s,s+t.chunk[e].length))||r.add(t.chunk[e])}return r}class dx{constructor(t,e,i,n=0){this.layer=t,this.skip=e,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,i){for(;this.chunkIndex<this.layer.chunk.length;){let e=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(e)||this.layer.chunkEnd(this.chunkIndex)<t||e.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],i=t+e.from[this.rangeIndex];if(this.from=i,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class px{constructor(t){this.heap=t}static from(t,e=null,i=-1){let n=[];for(let r=0;r<t.length;r++)for(let s=t[r];!s.isEmpty;s=s.nextLayer)s.maxPoint>=i&&n.push(new dx(s,e,i,r));return 1==n.length?n[0]:new px(n)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let i of this.heap)i.goto(t,e);for(let t=this.heap.length>>1;t>=0;t--)gx(this.heap,t);return this.next(),this}forward(t,e){for(let i of this.heap)i.forward(t,e);for(let t=this.heap.length>>1;t>=0;t--)gx(this.heap,t);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),gx(this.heap,0)}}}function gx(t,e){for(let i=t[e];;){let n=1+(e<<1);if(n>=t.length)break;let r=t[n];if(n+1<t.length&&r.compare(t[n+1])>=0&&(r=t[n+1],n++),i.compare(r)<0)break;t[n]=i,t[e]=r,e=n}}class mx{constructor(t,e,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=px.from(t,e,i)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){vx(this.active,t),vx(this.activeTo,t),vx(this.activeRank,t),this.minActive=yx(this.active,this.activeTo)}addActive(t){let e=0,{value:i,to:n,rank:r}=this.cursor;for(;e<this.activeRank.length&&this.activeRank[e]<=r;)e++;wx(this.active,e,i),wx(this.activeTo,e,n),wx(this.activeRank,e,r),t&&wx(t,e,this.cursor.from),this.minActive=yx(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let i=this.openStart<0?[]:null,n=0;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>t){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),i&&vx(i,r)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let r=this.cursor.value;if(r.point){if(!(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.from<t&&(n=1),this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(i),this.cursor.next()}}}if(i){let e=0;for(;e<i.length&&i[e]<t;)e++;this.openStart=e+n}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>t||this.activeTo[i]==t&&this.active[i].endSide>=this.point.endSide)&&e.push(this.active[i]);return e.reverse()}openEnd(t){let e=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>t;i--)e++;return e}}function bx(t,e,i,n,r,s){t.goto(e),i.goto(n);let o=n+r,l=n,a=n-e;for(;;){let e=t.to+a-i.to||t.endSide-i.endSide,n=e<0?t.to+a:i.to,r=Math.min(n,o);if(t.point||i.point?t.point&&i.point&&(t.point==i.point||t.point.eq(i.point))&&Ox(t.activeForPoint(t.to+a),i.activeForPoint(i.to))||s.comparePoint(l,r,t.point,i.point):r>l&&!Ox(t.active,i.active)&&s.compareRange(l,r,t.active,i.active),n>o)break;l=n,e<=0&&t.next(),e>=0&&i.next()}}function Ox(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!=e[i]&&!t[i].eq(e[i]))return!1;return!0}function vx(t,e){for(let i=e,n=t.length-1;i<n;i++)t[i]=t[i+1];t.pop()}function wx(t,e,i){for(let i=t.length-1;i>=e;i--)t[i+1]=t[i];t[e]=i}function yx(t,e){let i=-1,n=1e9;for(let r=0;r<e.length;r++)(e[r]-n||t[r].endSide-t[i].endSide)<0&&(i=r,n=e[r]);return i}function xx(t){let e;return e=11==t.nodeType?t.getSelection?t:t.ownerDocument:t,e.getSelection()}function kx(t,e){return!!e&&(t==e||t.contains(1!=e.nodeType?e.parentNode:e))}function Sx(t,e){if(!e.anchorNode)return!1;try{return kx(t,e.anchorNode)}catch(t){return!1}}function Cx(t){return 3==t.nodeType?Bx(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function Ax(t,e,i,n){return!!i&&(Px(t,e,i,n,-1)||Px(t,e,i,n,1))}function Tx(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function Px(t,e,i,n,r){for(;;){if(t==i&&e==n)return!0;if(e==(r<0?0:Mx(t))){if("DIV"==t.nodeName)return!1;let i=t.parentNode;if(!i||1!=i.nodeType)return!1;e=Tx(t)+(r<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[e+(r<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;e=r<0?Mx(t):0}}}function Mx(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}const Qx={left:0,right:0,top:0,bottom:0};function Rx(t,e){let i=e?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function $x(t){return{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}class _x{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){this.set(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let Dx,Ex=null;function Nx(t){if(t.setActive)return t.setActive();if(Ex)return t.focus(Ex);let e=[];for(let i=t;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==Ex?{get preventScroll(){return Ex={preventScroll:!0},!0}}:void 0),!Ex){Ex=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],r=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=r&&(i.scrollLeft=r)}}}function Bx(t,e,i=e){let n=Dx||(Dx=document.createRange());return n.setEnd(t,i),n.setStart(t,e),n}function Ix(t,e,i){let n={key:e,code:e,keyCode:i,which:i,cancelable:!0},r=new KeyboardEvent("keydown",n);r.synthetic=!0,t.dispatchEvent(r);let s=new KeyboardEvent("keyup",n);return s.synthetic=!0,t.dispatchEvent(s),r.defaultPrevented||s.defaultPrevented}function zx(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}class Lx{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new Lx(t.parentNode,Tx(t),e)}static after(t,e){return new Lx(t.parentNode,Tx(t)+1,e)}}const Wx=[];class Vx{constructor(){this.parent=null,this.dom=null,this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}coordsAt(t,e){return null}sync(t){if(2&this.dirty){let e,i=this.dom,n=null;for(let r of this.children){if(r.dirty){if(!r.dom&&(e=n?n.nextSibling:i.firstChild)){let t=Vx.get(e);t&&(t.parent||t.constructor!=r.constructor)||r.reuseDOM(e)}r.sync(t),r.dirty=0}if(e=n?n.nextSibling:i.firstChild,t&&!t.written&&t.node==i&&e!=r.dom&&(t.written=!0),r.dom.parentNode==i)for(;e&&e!=r.dom;)e=jx(e);else i.insertBefore(r.dom,e);n=r.dom}for(e=n?n.nextSibling:i.firstChild,e&&t&&t.node==i&&(t.written=!0);e;)e=jx(e)}else if(1&this.dirty)for(let e of this.children)e.dirty&&(e.sync(t),e.dirty=0)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=0==Mx(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==n&&e.firstChild!=e.lastChild&&(n=t==e.firstChild?-1:1),t=e}i=n<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!Vx.get(i);)i=i.nextSibling;if(!i)return this.length;for(let t=0,e=0;;t++){let n=this.children[t];if(n.dom==i)return e;e+=n.length+n.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,r=-1,s=-1,o=-1;for(let l=0,a=i,h=i;l<this.children.length;l++){let i=this.children[l],c=a+i.length;if(a<t&&c>e)return i.domBoundsAround(t,e,a);if(c>=t&&-1==n&&(n=l,r=a),a>e&&i.dom.parentNode==this.dom){s=l,o=h;break}h=c,a=c+i.breakAfter}return{from:r,to:o<0?i+this.length:o,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:s<this.children.length&&s>=0?this.children[s].dom:null}}markDirty(t=!1){this.dirty|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.dirty|=2),1&e.dirty)return;e.dirty|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.dirty&&this.markParentsDirty(!0))}setDOM(t){this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=Wx){this.markDirty();for(let i=t;i<e;i++){let t=this.children[i];t.parent==this&&t.destroy()}this.children.splice(t,e-t,...i);for(let t=0;t<i.length;t++)i[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new qx(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}merge(t,e,i,n,r,s){return!1}become(t){return!1}getSide(){return 0}destroy(){this.parent=null}}function jx(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}Vx.prototype.breakAfter=0;class qx{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function Hx(t,e,i,n,r,s,o,l,a){let{children:h}=t,c=h.length?h[e]:null,u=s.length?s[s.length-1]:null,f=u?u.breakAfter:o;if(!(e==n&&c&&!o&&!f&&s.length<2&&c.merge(i,r,s.length?u:null,0==i,l,a))){if(n<h.length){let t=h[n];t&&r<t.length?(e==n&&(t=t.split(r),r=0),!f&&u&&t.merge(0,r,u,!0,0,a)?s[s.length-1]=t:(r&&t.merge(0,r,null,!1,0,a),s.push(t))):(null==t?void 0:t.breakAfter)&&(u?u.breakAfter=1:o=1),n++}for(c&&(c.breakAfter=o,i>0&&(!o&&s.length&&c.merge(i,c.length,s[0],!1,l,0)?c.breakAfter=s.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,l,0),e++));e<n&&s.length;)if(h[n-1].become(s[s.length-1]))n--,s.pop(),a=s.length?0:l;else{if(!h[e].become(s[0]))break;e++,s.shift(),l=s.length?0:a}!s.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,l,a)&&e--,(e<n||s.length)&&t.replaceChildren(e,n,s)}}function Xx(t,e,i,n,r,s){let o=t.childCursor(),{i:l,off:a}=o.findPos(i,1),{i:h,off:c}=o.findPos(e,-1),u=e-i;for(let t of n)u+=t.length;t.length+=u,Hx(t,h,c,l,a,n,0,r,s)}let Fx="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},Zx="undefined"!=typeof document?document:{documentElement:{style:{}}};const Gx=/Edge\/(\d+)/.exec(Fx.userAgent),Ux=/MSIE \d/.test(Fx.userAgent),Yx=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Fx.userAgent),Kx=!!(Ux||Yx||Gx),Jx=!Kx&&/gecko\/(\d+)/i.test(Fx.userAgent),tk=!Kx&&/Chrome\/(\d+)/.exec(Fx.userAgent),ek="webkitFontSmoothing"in Zx.documentElement.style,ik=!Kx&&/Apple Computer/.test(Fx.vendor),nk=ik&&(/Mobile\/\w+/.test(Fx.userAgent)||Fx.maxTouchPoints>2);var rk={mac:nk||/Mac/.test(Fx.platform),windows:/Win/.test(Fx.platform),linux:/Linux|X11/.test(Fx.platform),ie:Kx,ie_version:Ux?Zx.documentMode||6:Yx?+Yx[1]:Gx?+Gx[1]:0,gecko:Jx,gecko_version:Jx?+(/Firefox\/(\d+)/.exec(Fx.userAgent)||[0,0])[1]:0,chrome:!!tk,chrome_version:tk?+tk[1]:0,ios:nk,android:/Android\b/.test(Fx.userAgent),webkit:ek,safari:ik,webkit_version:ek?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=Zx.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class sk extends Vx{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){3==t.nodeType&&this.createDOM(t)}merge(t,e,i){return(!i||i instanceof sk&&!(this.length-(e-t)+i.length>256))&&(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new sk(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new Lx(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return lk(this.dom,t,e)}}class ok extends Vx{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let t of e)t.setParent(this)}setAttrs(t){if(zx(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.dirty|=6)}sync(t){this.dom?4&this.dirty&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t)}merge(t,e,i,n,r,s){return(!i||!(!(i instanceof ok&&i.mark.eq(this.mark))||t&&r<=0||e<this.length&&s<=0))&&(Xx(this,t,e,i?i.children:[],r-1,s-1),this.markDirty(),!0)}split(t){let e=[],i=0,n=-1,r=0;for(let s of this.children){let o=i+s.length;o>t&&e.push(i<t?s.split(t-i):s),n<0&&i>=t&&(n=r),i=o,r++}let s=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new ok(this.mark,e,s)}domAtPos(t){return dk(this.dom,this.children,t)}coordsAt(t,e){return gk(this,t,e)}}function lk(t,e,i){let n=t.nodeValue.length;e>n&&(e=n);let r=e,s=e,o=0;0==e&&i<0||e==n&&i>=0?rk.chrome||rk.gecko||(e?(r--,o=1):s<n&&(s++,o=-1)):i<0?r--:s<n&&s++;let l=Bx(t,r,s).getClientRects();if(!l.length)return Qx;let a=l[(o?o<0:i>=0)?0:l.length-1];return rk.safari&&!o&&0==a.width&&(a=Array.prototype.find.call(l,(t=>t.width))||a),o?Rx(a,o<0):a||null}class ak extends Vx{constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}static create(t,e,i){return new(t.customView||ak)(t,e,i)}split(t){let e=ak.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(t,e,i,n,r,s){return!(i&&(!(i instanceof ak&&this.widget.compare(i.widget))||t>0&&r<=0||e<this.length&&s<=0))&&(this.length=t+(i?i.length:0)+(this.length-e),!0)}become(t){return t.length==this.length&&t instanceof ak&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.eq(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return Bw.empty;let t=this;for(;t.parent;)t=t.parent;let e=t.editorView,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):Bw.empty}domAtPos(t){return 0==t?Lx.before(this.dom):Lx.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.dom.getClientRects(),n=null;if(!i.length)return Qx;for(let e=t>0?i.length-1:0;n=i[e],!(t>0?0==e:e==i.length-1||n.top<n.bottom);e+=t>0?-1:1);return 0==t&&e>0||t==this.length&&e<=0?n:Rx(n,0==t)}get isEditable(){return!1}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class hk extends ak{domAtPos(t){let{topView:e,text:i}=this.widget;return e?ck(t,0,e,i,((t,e)=>t.domAtPos(e)),(t=>new Lx(i,Math.min(t,i.nodeValue.length)))):new Lx(i,Math.min(t,i.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(t,e){let{topView:i,text:n}=this.widget;return i?uk(t,e,i,n):Math.min(e,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(t,e){let{topView:i,text:n}=this.widget;return i?ck(t,e,i,n,((t,e,i)=>t.coordsAt(e,i)),((t,e)=>lk(n,t,e))):lk(n,t,e)}destroy(){var t;super.destroy(),null===(t=this.widget.topView)||void 0===t||t.destroy()}get isEditable(){return!0}}function ck(t,e,i,n,r,s){if(i instanceof ok){for(let o of i.children){let i=kx(o.dom,n),l=i?n.nodeValue.length:o.length;if(t<l||t==l&&o.getSide()<=0)return i?ck(t,e,o,n,r,s):r(o,t,e);t-=l}return r(i,i.length,-1)}return i.dom==n?s(t,e):r(i,t,e)}function uk(t,e,i,n){if(i instanceof ok)for(let r of i.children){let i=0,s=kx(r.dom,n);if(kx(r.dom,t))return i+(s?uk(t,e,r,n):r.localPosFromDOM(t,e));i+=s?n.nodeValue.length:r.length}else if(i.dom==n)return Math.min(e,n.nodeValue.length);return i.localPosFromDOM(t,e)}class fk extends Vx{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof fk&&t.side==this.side}split(){return new fk(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return Lx.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){let e=this.dom.getBoundingClientRect(),i=function(t,e){let i=t.parent,n=i?i.children.indexOf(t):-1;for(;i&&n>=0;)if(e<0?n>0:n<i.children.length){let t=i.children[n+e];if(t instanceof sk){let i=t.coordsAt(e<0?t.length:0,e);if(i)return i}n+=e}else{if(!(i instanceof ok&&i.parent)){let t=i.dom.lastChild;if(t&&"BR"==t.nodeName)return t.getClientRects()[0];break}n=i.parent.children.indexOf(i)+(e<0?0:1),i=i.parent}return}(this,this.side>0?-1:1);return i&&i.top<e.bottom&&i.bottom>e.top?{left:e.left,right:e.right,top:i.top,bottom:i.bottom}:e}get overrideDOMText(){return Bw.empty}}function dk(t,e,i){let n=0;for(let r=0;n<e.length;n++){let s=e[n],o=r+s.length;if(!(o==r&&s.getSide()<=0)){if(i>r&&i<o&&s.dom.parentNode==t)return s.domAtPos(i-r);if(i<=r)break;r=o}}for(;n>0;n--){let i=e[n-1].dom;if(i.parentNode==t)return Lx.after(i)}return new Lx(t,0)}function pk(t,e,i){let n,{children:r}=t;i>0&&e instanceof ok&&r.length&&(n=r[r.length-1])instanceof ok&&n.mark.eq(e.mark)?pk(n,e.children[0],i-1):(r.push(e),e.setParent(t)),t.length+=e.length}function gk(t,e,i){for(let n=0,r=0;r<t.children.length;r++){let s,o=t.children[r],l=n+o.length;if((i<=0||l==t.length||o.getSide()>0?l>=e:l>e)&&(e<l||r+1==t.children.length||(s=t.children[r+1]).length||s.getSide()>0)){let t=0;if(l==n){if(o.getSide()<=0)continue;t=i=-o.getSide()}let r=o.coordsAt(Math.max(0,e-n),i);return t&&r?Rx(r,i<0):r}n=l}let n=t.dom.lastChild;if(!n)return t.dom.getBoundingClientRect();let r=Cx(n);return r[r.length-1]||null}function mk(t,e){for(let i in t)"class"==i&&e.class?e.class+=" "+t.class:"style"==i&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}function bk(t,e){if(t==e)return!0;if(!t||!e)return!1;let i=Object.keys(t),n=Object.keys(e);if(i.length!=n.length)return!1;for(let r of i)if(-1==n.indexOf(r)||t[r]!==e[r])return!1;return!0}function Ok(t,e,i){let n=null;if(e)for(let r in e)i&&r in i||t.removeAttribute(n=r);if(i)for(let r in i)e&&e[r]==i[r]||t.setAttribute(n=r,i[r]);return!!n}sk.prototype.children=ak.prototype.children=fk.prototype.children=Wx;class vk{eq(t){return!1}updateDOM(t){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}ignoreEvent(t){return!0}get customView(){return null}destroy(t){}}var wk=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(wk||(wk={}));class yk extends ox{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new xk(t)}static widget(t){let e=t.side||0,i=!!t.block;return e+=i?e>0?3e8:-4e8:e>0?1e8:-1e8,new Sk(t,e,e,i,t.widget||null,!1)}static replace(t){let e,i,n=!!t.block;if(t.isBlockGap)e=-5e8,i=4e8;else{let{start:r,end:s}=Ck(t,n);e=(r?n?-3e8:-1:5e8)-1,i=1+(s?n?2e8:1:-6e8)}return new Sk(t,e,i,n,t.widget||null,!0)}static line(t){return new kk(t)}static set(t,e=!1){return cx.of(t,e)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}yk.none=cx.empty;class xk extends yk{constructor(t){let{start:e,end:i}=Ck(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){return this==t||t instanceof xk&&this.tagName==t.tagName&&this.class==t.class&&bk(this.attrs,t.attrs)}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}xk.prototype.point=!1;class kk extends yk{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof kk&&bk(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}kk.prototype.mapMode=ry.TrackBefore,kk.prototype.point=!0;class Sk extends yk{constructor(t,e,i,n,r,s){super(e,i,r,t),this.block=n,this.isReplace=s,this.mapMode=n?e<=0?ry.TrackBefore:ry.TrackAfter:ry.TrackDel}get type(){return this.startSide<this.endSide?wk.WidgetRange:this.startSide<=0?wk.WidgetBefore:wk.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(t){return t instanceof Sk&&(e=this.widget,i=t.widget,e==i||!!(e&&i&&e.compare(i)))&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide;var e,i}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}function Ck(t,e=!1){let{inclusiveStart:i,inclusiveEnd:n}=t;return null==i&&(i=t.inclusive),null==n&&(n=t.inclusive),{start:null!=i?i:e,end:null!=n?n:e}}function Ak(t,e,i,n=0){let r=i.length-1;r>=0&&i[r]+n>=t?i[r]=Math.max(i[r],e):i.push(t,e)}Sk.prototype.point=!0;class Tk extends Vx{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,r,s){if(i){if(!(i instanceof Tk))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),Xx(this,t,e,i?i.children:[],r,s),!0}split(t){let e=new Tk;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let t=i;t<this.children.length;t++)e.append(this.children[t],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){bk(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){pk(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=mk(e,this.attrs||{})),i&&(this.attrs=mk({class:i},this.attrs||{}))}domAtPos(t){return dk(this.dom,this.children,t)}reuseDOM(t){"DIV"==t.nodeName&&(this.setDOM(t),this.dirty|=6)}sync(t){var e;this.dom?4&this.dirty&&(zx(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(Ok(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t);let i=this.dom.lastChild;for(;i&&Vx.get(i)instanceof ok;)i=i.lastChild;if(!(i&&this.length&&("BR"==i.nodeName||0!=(null===(e=Vx.get(i))||void 0===e?void 0:e.isEditable)||rk.ios&&this.children.some((t=>t instanceof sk))))){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t=0;for(let e of this.children){if(!(e instanceof sk))return null;let i=Cx(e.dom);if(1!=i.length)return null;t+=i[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length}}coordsAt(t,e){return gk(this,t,e)}become(t){return!1}get type(){return wk.Text}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let r=t.children[i],s=n+r.length;if(s>=e){if(r instanceof Tk)return r;if(s>e)break}n=s+r.breakAfter}return null}}class Pk extends Vx{constructor(t,e,i){super(),this.widget=t,this.length=e,this.type=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,r,s){return!(i&&(!(i instanceof Pk&&this.widget.compare(i.widget))||t>0&&r<=0||e<this.length&&s<=0))&&(this.length=t+(i?i.length:0)+(this.length-e),!0)}domAtPos(t){return 0==t?Lx.before(this.dom):Lx.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new Pk(this.widget,e,this.type);return i.breakAfter=this.breakAfter,i}get children(){return Wx}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Bw.empty}domBoundsAround(){return null}become(t){return t instanceof Pk&&t.type==this.type&&t.widget.constructor==this.widget.constructor&&(t.widget.eq(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Mk{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof Pk&&t.type==wk.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new Tk),this.atCursorPos=!0),this.curLine}flushBuffer(t){this.pendingBuffer&&(this.curLine.append(Qk(new fk(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer([]),this.curLine=null,this.content.push(t)}finish(t){t?this.pendingBuffer=0:this.flushBuffer([]),this.posCovered()||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:i,done:n}=this.cursor.next(this.skip);if(this.skip=0,n)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer([]),this.curLine=null,t--;continue}this.text=e,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(0,i)),this.getLine().append(Qk(new sk(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,r,s){if(this.disallowBlockEffectsFor[s]&&i instanceof Sk){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=e-t;if(i instanceof Sk)if(i.block){let{type:t}=i;t!=wk.WidgetAfter||this.posCovered()||this.getLine(),this.addBlockWidget(new Pk(i.widget||new Rk("div"),o,t))}else{let s=ak.create(i.widget||new Rk("span"),o,i.startSide),l=this.atCursorPos&&!s.isEditable&&r<=n.length&&(t<e||i.startSide>0),a=!s.isEditable&&(t<e||i.startSide<=0),h=this.getLine();2!=this.pendingBuffer||l||(this.pendingBuffer=0),this.flushBuffer(n),l&&(h.append(Qk(new fk(1),n),r),r=n.length+Math.max(0,r-n.length)),h.append(Qk(s,n),r),this.atCursorPos=a,this.pendingBuffer=a?t<e?1:2:0}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=r)}static build(t,e,i,n,r){let s=new Mk(t,e,i,r);return s.openEnd=cx.spans(n,e,i,s),s.openStart<0&&(s.openStart=s.openEnd),s.finish(s.openEnd),s}}function Qk(t,e){for(let i of e)t=new ok(i,[t],t.length);return t}class Rk extends vk{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}}const $k=by.define(),_k=by.define(),Dk=by.define(),Ek=by.define(),Nk=by.define(),Bk=by.define(),Ik=by.define({combine:t=>t.some((t=>t))});class zk{constructor(t,e="nearest",i="nearest",n=5,r=5){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=r}map(t){return t.empty?this:new zk(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin)}}const Lk=Fy.define({map:(t,e)=>t.map(e)});function Wk(t,e,i){let n=t.facet(Ek);n.length?n[0](e):window.onerror?window.onerror(String(e),i,void 0,void 0,e):i?console.error(i+":",e):console.error(e)}const Vk=by.define({combine:t=>!t.length||t[0]});let jk=0;const qk=by.define();class Hk{constructor(t,e,i,n){this.id=t,this.create=e,this.domEventHandlers=i,this.extension=n(this)}static define(t,e){const{eventHandlers:i,provide:n,decorations:r}=e||{};return new Hk(jk++,t,i,(t=>{let e=[qk.of(t)];return r&&e.push(Gk.of((e=>{let i=e.plugin(t);return i?r(i):yk.none}))),n&&e.push(n(t)),e}))}static fromClass(t,e){return Hk.define((e=>new t(e)),e)}}class Xk{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(e){if(Wk(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){Wk(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null===(e=this.value)||void 0===e?void 0:e.destroy)try{this.value.destroy()}catch(e){Wk(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Fk=by.define(),Zk=by.define(),Gk=by.define(),Uk=by.define(),Yk=by.define(),Kk=by.define();class Jk{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new Jk(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(0==e.length)return t;let i=[];for(let n=0,r=0,s=0,o=0;;n++){let l=n==t.length?null:t[n],a=s-o,h=l?l.fromB:1e9;for(;r<e.length&&e[r]<h;){let t=e[r],n=e[r+1],s=Math.max(o,t),l=Math.min(h,n);if(s<=l&&new Jk(s+a,l+a,s,l).addToSet(i),n>h)break;r+=2}if(!l)return i;new Jk(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),s=l.toA,o=l.toB}}}class tS{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=oy.empty(this.startState.doc.length);for(let t of i)this.changes=this.changes.compose(t.changes);let n=[];this.changes.iterChangedRanges(((t,e,i,r)=>n.push(new Jk(t,e,i,r)))),this.changedRanges=n;let r=t.hasFocus;r!=t.inputState.notifiedFocused&&(t.inputState.notifiedFocused=r,this.flags|=1)}static create(t,e,i){return new tS(t,e,i)}get viewportChanged(){return(4&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(10&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((t=>t.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}var eS=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(eS||(eS={}));const iS=eS.LTR,nS=eS.RTL;function rS(t){let e=[];for(let i=0;i<t.length;i++)e.push(1<<+t[i]);return e}const sS=rS("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),oS=rS("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),lS=Object.create(null),aS=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),i=t.charCodeAt(1);lS[e]=i,lS[i]=-e}const hS=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;class cS{constructor(t,e,i){this.from=t,this.to=e,this.level=i}get dir(){return this.level%2?nS:iS}side(t,e){return this.dir==e==t?this.to:this.from}static find(t,e,i,n){let r=-1;for(let s=0;s<t.length;s++){let o=t[s];if(o.from<=e&&o.to>=e){if(o.level==i)return s;(r<0||(0!=n?n<0?o.from<e:o.to>e:t[r].level>o.level))&&(r=s)}}if(r<0)throw new RangeError("Index out of range");return r}}const uS=[];function fS(t){return[new cS(0,t,0)]}let dS="";function pS(t,e,i,n,r){var s;let o=n.head-t.from,l=-1;if(0==o){if(!r||!t.length)return null;e[0].level!=i&&(o=e[0].side(!1,i),l=0)}else if(o==t.length){if(r)return null;let t=e[e.length-1];t.level!=i&&(o=t.side(!0,i),l=e.length-1)}l<0&&(l=cS.find(e,o,null!==(s=n.bidiLevel)&&void 0!==s?s:-1,n.assoc));let a=e[l];o==a.side(r,i)&&(a=e[l+=r?1:-1],o=a.side(!r,i));let h=r==(a.dir==i),c=Gw(t.text,o,h);if(dS=t.text.slice(Math.min(o,c),Math.max(o,c)),c!=a.side(r,i))return py.cursor(c+t.from,h?-1:1,a.level);let u=l==(r?e.length-1:0)?null:e[l+(r?1:-1)];return u||a.level==i?u&&u.level<a.level?py.cursor(u.side(!r,i)+t.from,r?1:-1,u.level):py.cursor(c+t.from,r?-1:1,a.level):py.cursor(r?t.to:t.from,r?-1:1,i)}const gS="￿";class mS{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(sx.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=gS}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n),this.readNode(n);let t=n.nextSibling;if(t==e)break;let r=Vx.get(n),s=Vx.get(t);(r&&s?r.breakAfter:(r?r.breakAfter:bS(n))||bS(t)&&("BR"!=n.nodeName||n.cmIgnore))&&this.lineBreak(),n=t}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let r,s=-1,o=1;if(this.lineSeparator?(s=e.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(r=n.exec(e))&&(s=r.index,o=r[0].length),this.append(e.slice(i,s<0?e.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let e of this.points)e.node==t&&e.pos>this.text.length&&(e.pos-=o-1);i=s+o}}readNode(t){if(t.cmIgnore)return;let e=Vx.get(t),i=e&&e.overrideDOMText;if(null!=i){this.findPointInside(t,i.length);for(let t=i.iter();!t.next().done;)t.lineBreak?this.lineBreak():this.append(t.value)}else 3==t.nodeType?this.readTextNode(t):"BR"==t.nodeName?t.nextSibling&&this.lineBreak():1==t.nodeType&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(3==t.nodeType?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+Math.min(e,i.offset))}}function bS(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}class OS{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class vS extends Vx{constructor(t){super(),this.view=t,this.compositionDeco=yk.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new Tk],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Jk(0,0,0,t.state.doc.length)],0)}get root(){return this.view.root}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(t){let e=t.changedRanges;this.minWidth>0&&e.length&&(e.every((({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo))?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=yk.none:(t.transactions.length||this.dirty)&&(this.compositionDeco=function(t,e){let i=yS(t);if(!i)return yk.none;let{from:n,to:r,node:s,text:o}=i,l=e.mapPos(n,1),a=Math.max(l,e.mapPos(r,-1)),{state:h}=t,c=3==s.nodeType?s.nodeValue:new mS([],h).readRange(s.firstChild,null).text;if(a-l<c.length)if(h.doc.sliceString(l,Math.min(h.doc.length,l+c.length),gS)==c)a=l+c.length;else{if(h.doc.sliceString(Math.max(0,a-c.length),a,gS)!=c)return yk.none;l=a-c.length}else if(h.doc.sliceString(l,a,gS)!=c)return yk.none;let u=Vx.get(s);u instanceof hk?u=u.widget.topView:u&&(u.parent=null);return yk.set(yk.replace({widget:new xS(s,o,u),inclusive:!0}).range(l,a))}(this.view,t.changes)),(rk.ie||rk.chrome)&&!this.compositionDeco.size&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let i=function(t,e,i){let n=new SS;return cx.compare(t,e,i,n),n.changes}(this.decorations,this.updateDeco(),t.changes);return e=Jk.extendWithRanges(e,i),(0!=this.dirty||0!=e.length)&&(this.updateInner(e,t.startState.doc.length),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e);let{observer:i}=this.view;i.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let t=rk.chrome||rk.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(t),this.dirty=0,t&&(t.written||i.selectionRange.focusNode!=t.node)&&(this.forceSelection=!0),this.dom.style.height=""}));let n=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let t of this.children)t instanceof Pk&&t.widget instanceof wS&&n.push(t.dom);i.updateGaps(n)}updateChildren(t,e){let i=this.childCursor(e);for(let e=t.length-1;;e--){let n=e>=0?t[e]:null;if(!n)break;let{fromA:r,toA:s,fromB:o,toB:l}=n,{content:a,breakAtStart:h,openStart:c,openEnd:u}=Mk.build(this.view.state.doc,o,l,this.decorations,this.dynamicDecorationMap),{i:f,off:d}=i.findPos(s,1),{i:p,off:g}=i.findPos(r,-1);Hx(this,p,g,f,d,a,h,c,u)}}updateSelection(t=!1,e=!1){if(t&&this.view.observer.readSelectionRange(),!e&&!this.mayControlSelection()||rk.ios&&this.view.inputState.rapidCompositionStart)return;let i=this.forceSelection;this.forceSelection=!1;let n=this.view.state.selection.main,r=this.domAtPos(n.anchor),s=n.empty?r:this.domAtPos(n.head);if(rk.gecko&&n.empty&&(1==(o=r).node.nodeType&&o.node.firstChild&&(0==o.offset||"false"==o.node.childNodes[o.offset-1].contentEditable)&&(o.offset==o.node.childNodes.length||"false"==o.node.childNodes[o.offset].contentEditable))){let t=document.createTextNode("");this.view.observer.ignore((()=>r.node.insertBefore(t,r.node.childNodes[r.offset]||null))),r=s=new Lx(t,0),i=!0}var o;let l=this.view.observer.selectionRange;!i&&l.focusNode&&Ax(r.node,r.offset,l.anchorNode,l.anchorOffset)&&Ax(s.node,s.offset,l.focusNode,l.focusOffset)||(this.view.observer.ignore((()=>{rk.android&&rk.chrome&&this.dom.contains(l.focusNode)&&function(t,e){for(let i=t;i&&i!=e;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}(l.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let t=xx(this.root);if(n.empty){if(rk.gecko){let t=(e=r.node,i=r.offset,1!=e.nodeType?0:(i&&"false"==e.childNodes[i-1].contentEditable?1:0)|(i<e.childNodes.length&&"false"==e.childNodes[i].contentEditable?2:0));if(t&&3!=t){let e=kS(r.node,r.offset,1==t?1:-1);e&&(r=new Lx(e,1==t?0:e.nodeValue.length))}}t.collapse(r.node,r.offset),null!=n.bidiLevel&&null!=l.cursorBidiLevel&&(l.cursorBidiLevel=n.bidiLevel)}else if(t.extend)t.collapse(r.node,r.offset),t.extend(s.node,s.offset);else{let e=document.createRange();n.anchor>n.head&&([r,s]=[s,r]),e.setEnd(s.node,s.offset),e.setStart(r.node,r.offset),t.removeAllRanges(),t.addRange(e)}var e,i})),this.view.observer.setSelectionRange(r,s)),this.impreciseAnchor=r.precise?null:new Lx(l.anchorNode,l.anchorOffset),this.impreciseHead=s.precise?null:new Lx(l.focusNode,l.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let t=this.view.state.selection.main,e=xx(this.root);if(!t.empty||!t.assoc||!e.modify)return;let i=Tk.find(this,t.head);if(!i)return;let n=i.posAtStart;if(t.head==n||t.head==n+i.length)return;let r=this.coordsAt(t.head,-1),s=this.coordsAt(t.head,1);if(!r||!s||r.bottom>s.top)return;let o=this.domAtPos(t.head+t.assoc);e.collapse(o.node,o.offset),e.modify("move",t.assoc<0?"forward":"backward","lineboundary")}mayControlSelection(){return this.view.state.facet(Vk)?this.root.activeElement==this.dom:Sx(this.dom,this.view.observer.selectionRange)}nearest(t){for(let e=t;e;){let t=Vx.get(e);if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(i<t.length||t instanceof Tk)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){for(let i=this.length,n=this.children.length-1;;n--){let r=this.children[n],s=i-r.breakAfter-r.length;if(t>s||t==s&&r.type!=wk.WidgetBefore&&r.type!=wk.WidgetAfter&&(!n||2==e||this.children[n-1].breakAfter||this.children[n-1].type==wk.WidgetBefore&&e>-2))return r.coordsAt(t-s,e);i=s}}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,r=this.view.contentDOM.clientWidth,s=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,l=this.view.textDirection==eS.LTR;for(let t=0,a=0;a<this.children.length;a++){let h=this.children[a],c=t+h.length;if(c>n)break;if(t>=i){let i=h.dom.getBoundingClientRect();if(e.push(i.height),s){let e=h.dom.lastChild,n=e?Cx(e):[];if(n.length){let e=n[n.length-1],s=l?e.right-i.left:i.right-e.left;s>o&&(o=s,this.minWidth=r,this.minWidthFrom=t,this.minWidthTo=c)}}}t=c+h.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return"rtl"==getComputedStyle(this.children[e].dom).direction?eS.RTL:eS.LTR}measureTextSize(){for(let t of this.children)if(t instanceof Tk){let e=t.measureTextSize();if(e)return e}let t,e,i=document.createElement("div");return i.className="cm-line",i.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(i);let n=Cx(i.firstChild)[0];t=i.getBoundingClientRect().height,e=n?n.width/27:7,i.remove()})),{lineHeight:t,charWidth:e}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new qx(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let r=n==e.viewports.length?null:e.viewports[n],s=r?r.from-1:this.length;if(s>i){let n=e.lineBlockAt(s).bottom-e.lineBlockAt(i).top;t.push(yk.replace({widget:new wS(n),block:!0,inclusive:!0,isBlockGap:!0}).range(i,s))}if(!r)break;i=r.to+1}return yk.set(t)}updateDeco(){let t=this.view.state.facet(Gk).map(((t,e)=>(this.dynamicDecorationMap[e]="function"==typeof t)?t(this.view):t));for(let e=t.length;e<t.length+3;e++)this.dynamicDecorationMap[e]=!1;return this.decorations=[...t,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(t){let e,{range:i}=t,n=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1);if(!n)return;!i.empty&&(e=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(n={left:Math.min(n.left,e.left),top:Math.min(n.top,e.top),right:Math.max(n.right,e.right),bottom:Math.max(n.bottom,e.bottom)});let r=0,s=0,o=0,l=0;for(let t of this.view.state.facet(Yk).map((t=>t(this.view))))if(t){let{left:e,right:i,top:n,bottom:a}=t;null!=e&&(r=Math.max(r,e)),null!=i&&(s=Math.max(s,i)),null!=n&&(o=Math.max(o,n)),null!=a&&(l=Math.max(l,a))}let a={left:n.left-r,top:n.top-o,right:n.right+s,bottom:n.bottom+l};!function(t,e,i,n,r,s,o,l){let a=t.ownerDocument,h=a.defaultView;for(let c=t;c;)if(1==c.nodeType){let t,u=c==a.body;if(u)t=$x(h);else{if(c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.parentNode;continue}let e=c.getBoundingClientRect();t={left:e.left,right:e.left+c.clientWidth,top:e.top,bottom:e.top+c.clientHeight}}let f=0,d=0;if("nearest"==r)e.top<t.top?(d=-(t.top-e.top+o),i>0&&e.bottom>t.bottom+d&&(d=e.bottom-t.bottom+d+o)):e.bottom>t.bottom&&(d=e.bottom-t.bottom+o,i<0&&e.top-d<t.top&&(d=-(t.top+d-e.top+o)));else{let n=e.bottom-e.top,s=t.bottom-t.top;d=("center"==r&&n<=s?e.top+n/2-s/2:"start"==r||"center"==r&&i<0?e.top-o:e.bottom-s+o)-t.top}if("nearest"==n?e.left<t.left?(f=-(t.left-e.left+s),i>0&&e.right>t.right+f&&(f=e.right-t.right+f+s)):e.right>t.right&&(f=e.right-t.right+s,i<0&&e.left<t.left+f&&(f=-(t.left+f-e.left+s))):f=("center"==n?e.left+(e.right-e.left)/2-(t.right-t.left)/2:"start"==n==l?e.left-s:e.right-(t.right-t.left)+s)-t.left,f||d)if(u)h.scrollBy(f,d);else{if(d){let t=c.scrollTop;c.scrollTop+=d,d=c.scrollTop-t}if(f){let t=c.scrollLeft;c.scrollLeft+=f,f=c.scrollLeft-t}e={left:e.left-f,top:e.top-d,right:e.right-f,bottom:e.bottom-d}}if(u)break;c=c.assignedSlot||c.parentNode,n=r="nearest"}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,a,i.head<i.anchor?-1:1,t.x,t.y,t.xMargin,t.yMargin,this.view.textDirection==eS.LTR)}}class wS extends vk{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function yS(t){let e=t.observer.selectionRange,i=e.focusNode&&kS(e.focusNode,e.focusOffset,0);if(!i)return null;let n=t.docView.nearest(i);if(!n)return null;if(n instanceof Tk){let t=i;for(;t.parentNode!=n.dom;)t=t.parentNode;let e=t.previousSibling;for(;e&&!Vx.get(e);)e=e.previousSibling;let r=e?Vx.get(e).posAtEnd:n.posAtStart;return{from:r,to:r,node:t,text:i}}{for(;;){let{parent:t}=n;if(!t)return null;if(t instanceof Tk)break;n=t}let t=n.posAtStart;return{from:t,to:t+n.length,node:n.dom,text:i}}}class xS extends vk{constructor(t,e,i){super(),this.top=t,this.text=e,this.topView=i}eq(t){return this.top==t.top&&this.text==t.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return hk}}function kS(t,e,i){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0&&i<=0)e=Mx(t=t.childNodes[e-1]);else{if(!(1==t.nodeType&&e<t.childNodes.length&&i>=0))return null;t=t.childNodes[e],e=0}}}class SS{constructor(){this.changes=[]}compareRange(t,e){Ak(t,e,this.changes)}comparePoint(t,e){Ak(t,e,this.changes)}}function CS(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function AS(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function TS(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function PS(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function MS(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function QS(t,e,i){let n,r,s,o,l,a,h,c;for(let u=t.firstChild;u;u=u.nextSibling){let t=Cx(u);for(let f=0;f<t.length;f++){let d=t[f];r&&TS(r,d)&&(d=PS(MS(d,r.bottom),r.top));let p=CS(e,d),g=AS(i,d);if(0==p&&0==g)return 3==u.nodeType?RS(u,e,i):QS(u,e,i);(!n||o>g||o==g&&s>p)&&(n=u,r=d,s=p,o=g),0==p?i>d.bottom&&(!h||h.bottom<d.bottom)?(l=u,h=d):i<d.top&&(!c||c.top>d.top)&&(a=u,c=d):h&&TS(h,d)?h=MS(h,d.bottom):c&&TS(c,d)&&(c=PS(c,d.top))}}if(h&&h.bottom>=i?(n=l,r=h):c&&c.top<=i&&(n=a,r=c),!n)return{node:t,offset:0};let u=Math.max(r.left,Math.min(r.right,e));return 3==n.nodeType?RS(n,u,i):s||"true"!=n.contentEditable?{node:t,offset:Array.prototype.indexOf.call(t.childNodes,n)+(e>=(r.left+r.right)/2?1:0)}:QS(n,u,i)}function RS(t,e,i){let n=t.nodeValue.length,r=-1,s=1e9,o=0;for(let l=0;l<n;l++){let n=Bx(t,l,l+1).getClientRects();for(let a=0;a<n.length;a++){let h=n[a];if(h.top==h.bottom)continue;o||(o=e-h.left);let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&c<s){let i=e>=(h.left+h.right)/2,n=i;if(rk.chrome||rk.gecko){Bx(t,l).getBoundingClientRect().left==h.right&&(n=!i)}if(c<=0)return{node:t,offset:l+(n?1:0)};r=l+(n?1:0),s=c}}}return{node:t,offset:r>-1?r:o>0?t.nodeValue.length:0}}function $S(t,{x:e,y:i},n,r=-1){var s;let o,l=t.contentDOM.getBoundingClientRect(),a=l.top+t.viewState.paddingTop,{docHeight:h}=t.viewState,c=i-a;if(c<0)return 0;if(c>h)return t.state.doc.length;for(let e=t.defaultLineHeight/2,i=!1;o=t.elementAtHeight(c),o.type!=wk.Text;)for(;c=r>0?o.bottom+e:o.top-e,!(c>=0&&c<=h);){if(i)return n?null:0;i=!0,r=-r}i=a+c;let u=o.from;if(u<t.viewport.from)return 0==t.viewport.from?0:n?null:_S(t,l,o,e,i);if(u>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:n?null:_S(t,l,o,e,i);let f=t.dom.ownerDocument,d=t.root.elementFromPoint?t.root:f,p=d.elementFromPoint(e,i);p&&!t.contentDOM.contains(p)&&(p=null),p||(e=Math.max(l.left+1,Math.min(l.right-1,e)),p=d.elementFromPoint(e,i),p&&!t.contentDOM.contains(p)&&(p=null));let g,m=-1;if(p&&0!=(null===(s=t.docView.nearest(p))||void 0===s?void 0:s.isEditable))if(f.caretPositionFromPoint){let t=f.caretPositionFromPoint(e,i);t&&({offsetNode:g,offset:m}=t)}else if(f.caretRangeFromPoint){let t=f.caretRangeFromPoint(e,i);t&&(({startContainer:g,startOffset:m}=t),rk.safari&&function(t,e,i){let n;if(3!=t.nodeType||e!=(n=t.nodeValue.length))return!1;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return Bx(t,n-1,n).getBoundingClientRect().left>i}(g,m,e)&&(g=void 0))}if(!g||!t.docView.dom.contains(g)){let n=Tk.find(t.docView,u);if(!n)return c>o.top+o.height/2?o.to:o.from;({node:g,offset:m}=QS(n.dom,e,i))}return t.docView.posFromDOM(g,m)}function _S(t,e,i,n,r){let s=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&i.height>1.5*t.defaultLineHeight){s+=Math.floor((r-i.top)/t.defaultLineHeight)*t.viewState.heightOracle.lineLength}let o=t.state.sliceDoc(i.from,i.to);return i.from+function(t,e,i,n){for(let n=0,r=0;;){if(r>=e)return n;if(n==t.length)break;r+=9==t.charCodeAt(n)?i-r%i:1,n=Gw(t,n)}return!0===n?-1:t.length}(o,s,t.state.tabSize)}function DS(t,e,i,n){let r=t.state.doc.lineAt(e.head),s=t.bidiSpans(r),o=t.textDirectionAt(r.from);for(let l=e,a=null;;){let e=pS(r,s,o,l,i),h=dS;if(!e){if(r.number==(i?t.state.doc.lines:1))return l;h="\n",r=t.state.doc.line(r.number+(i?1:-1)),s=t.bidiSpans(r),e=py.cursor(i?r.from:r.to)}if(a){if(!a(h))return l}else{if(!n)return e;a=n(h)}l=e}}function ES(t,e,i){let n=t.state.facet(Uk).map((e=>e(t)));for(;;){let t=!1;for(let r of n)r.between(i.from-1,i.from+1,((n,r,s)=>{i.from>n&&i.from<r&&(i=e.from>i.from?py.cursor(n,1):py.cursor(r,-1),t=!0)}));if(!t)return i}}class NS{constructor(t){this.lastKeyCode=0,this.lastKeyTime=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.rapidCompositionStart=!1,this.mouseSelection=null;for(let e in WS){let i=WS[e];t.contentDOM.addEventListener(e,(n=>{LS(t,n)&&!this.ignoreDuringComposition(n)&&("keydown"==e&&this.keydown(t,n)||(this.mustFlushObserver(n)&&t.observer.forceFlush(),this.runCustomHandlers(e,t,n)?n.preventDefault():i(t,n)))})),this.registeredEvents.push(e)}rk.chrome&&rk.chrome_version>=102&&t.scrollDOM.addEventListener("wheel",(()=>{this.chromeScrollHack<0?t.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout((()=>{this.chromeScrollHack=-1,t.contentDOM.style.pointerEvents=""}),100)}),{passive:!0}),this.notifiedFocused=t.hasFocus,rk.safari&&t.contentDOM.addEventListener("input",(()=>null))}setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}ensureHandlers(t,e){var i;let n;this.customHandlers=[];for(let r of e)if(n=null===(i=r.update(t).spec)||void 0===i?void 0:i.domEventHandlers){this.customHandlers.push({plugin:r.value,handlers:n});for(let e in n)this.registeredEvents.indexOf(e)<0&&"scroll"!=e&&(this.registeredEvents.push(e),t.contentDOM.addEventListener(e,(i=>{LS(t,i)&&this.runCustomHandlers(e,t,i)&&i.preventDefault()})))}}runCustomHandlers(t,e,i){for(let n of this.customHandlers){let r=n.handlers[t];if(r)try{if(r.call(n.plugin,i,e)||i.defaultPrevented)return!0}catch(t){Wk(e.state,t)}}return!1}runScrollHandlers(t,e){for(let i of this.customHandlers){let n=i.handlers.scroll;if(n)try{n.call(i.plugin,e,t)}catch(e){Wk(t.state,e)}}}keydown(t,e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),9==e.keyCode&&Date.now()<this.lastEscPress+2e3)return!0;if(rk.android&&rk.chrome&&!e.synthetic&&(13==e.keyCode||8==e.keyCode))return t.observer.delayAndroidKey(e.key,e.keyCode),!0;let i;return!(!rk.ios||!(i=BS.find((t=>t.keyCode==e.keyCode)))||e.ctrlKey||e.altKey||e.metaKey||e.synthetic)&&(this.pendingIOSKey=i,setTimeout((()=>this.flushIOSKey(t)),250),!0)}flushIOSKey(t){let e=this.pendingIOSKey;return!!e&&(this.pendingIOSKey=void 0,Ix(t.contentDOM,e.key,e.keyCode))}ignoreDuringComposition(t){return!!/^key/.test(t.type)&&(this.composing>0||!!(rk.safari&&Date.now()-this.compositionEndedAt<100)&&(this.compositionEndedAt=0,!0))}mustFlushObserver(t){return"keydown"==t.type&&229!=t.keyCode||"compositionend"==t.type&&!rk.ios}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.mouseSelection&&this.mouseSelection.update(t),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const BS=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],IS=[16,17,18,20,91,92,224,225];class zS{constructor(t,e,i,n){this.view=t,this.style=i,this.mustSelect=n,this.lastEvent=e;let r=t.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(sx.allowMultipleSelections)&&function(t,e){let i=t.state.facet($k);return i.length?i[0](e):rk.mac?e.metaKey:e.ctrlKey}(t,e),this.dragMove=function(t,e){let i=t.state.facet(_k);return i.length?i[0](e):rk.mac?!e.altKey:!e.ctrlKey}(t,e),this.dragging=!(!function(t,e){let{main:i}=t.state.selection;if(i.empty)return!1;let n=xx(t.root);if(0==n.rangeCount)return!0;let r=n.getRangeAt(0).getClientRects();for(let t=0;t<r.length;t++){let i=r[t];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}(t,e)||1!=tC(e))&&null,!1===this.dragging&&(e.preventDefault(),this.select(e))}move(t){if(0==t.buttons)return this.destroy();!1===this.dragging&&this.select(this.lastEvent=t)}up(t){null==this.dragging&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}select(t){let e=this.style.get(t,this.extend,this.multiple);!this.mustSelect&&e.eq(this.view.state.selection)&&e.main.assoc==this.view.state.selection.main.assoc||this.view.dispatch({selection:e,userEvent:"select.pointer",scrollIntoView:!0}),this.mustSelect=!1}update(t){t.docChanged&&this.dragging&&(this.dragging=this.dragging.map(t.changes)),this.style.update(t)&&setTimeout((()=>this.select(this.lastEvent)),20)}}function LS(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i,n=e.target;n!=t.contentDOM;n=n.parentNode)if(!n||11==n.nodeType||(i=Vx.get(n))&&i.ignoreEvent(e))return!1;return!0}const WS=Object.create(null),VS=rk.ie&&rk.ie_version<15||rk.ios&&rk.webkit_version<604;function jS(t,e){let i,{state:n}=t,r=1,s=n.toText(e),o=s.lines==n.selection.ranges.length;if(null!=iC&&n.selection.ranges.every((t=>t.empty))&&iC==s.toString()){let t=-1;i=n.changeByRange((i=>{let l=n.doc.lineAt(i.from);if(l.from==t)return{range:i};t=l.from;let a=n.toText((o?s.line(r++).text:e)+n.lineBreak);return{changes:{from:l.from,insert:a},range:py.cursor(i.from+a.length)}}))}else i=o?n.changeByRange((t=>{let e=s.line(r++);return{changes:{from:t.from,to:t.to,insert:e.text},range:py.cursor(t.from+e.length)}})):n.replaceSelection(s);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}WS.keydown=(t,e)=>{t.inputState.setSelectionOrigin("select"),27==e.keyCode?t.inputState.lastEscPress=Date.now():IS.indexOf(e.keyCode)<0&&(t.inputState.lastEscPress=0)};let qS=0;function HS(t,e,i,n){if(1==n)return py.cursor(e,i);if(2==n)return function(t,e,i=1){let n=t.charCategorizer(e),r=t.doc.lineAt(e),s=e-r.from;if(0==r.length)return py.cursor(e);0==s?i=1:s==r.length&&(i=-1);let o=s,l=s;i<0?o=Gw(r.text,s,!1):l=Gw(r.text,s);let a=n(r.text.slice(o,l));for(;o>0;){let t=Gw(r.text,o,!1);if(n(r.text.slice(t,o))!=a)break;o=t}for(;l<r.length;){let t=Gw(r.text,l);if(n(r.text.slice(l,t))!=a)break;l=t}return py.range(o+r.from,l+r.from)}(t.state,e,i);{let i=Tk.find(t.docView,e),n=t.state.doc.lineAt(i?i.posAtEnd:e),r=i?i.posAtStart:n.from,s=i?i.posAtEnd:n.to;return s<t.state.doc.length&&s==n.to&&s++,py.range(r,s)}}WS.touchstart=(t,e)=>{qS=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},WS.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")},WS.mousedown=(t,e)=>{if(t.observer.flush(),qS>Date.now()-2e3&&1==tC(e))return;let i=null;for(let n of t.state.facet(Dk))if(i=n(t,e),i)break;if(i||0!=e.button||(i=function(t,e){let i=GS(t,e),n=tC(e),r=t.state.selection,s=i,o=e;return{update(t){t.docChanged&&(i&&(i.pos=t.changes.mapPos(i.pos)),r=r.map(t.changes),o=null)},get(e,l,a){let h;if(o&&e.clientX==o.clientX&&e.clientY==o.clientY?h=s:(h=s=GS(t,e),o=e),!h||!i)return r;let c=HS(t,h.pos,h.bias,n);if(i.pos!=h.pos&&!l){let e=HS(t,i.pos,i.bias,n),r=Math.min(e.from,c.from),s=Math.max(e.to,c.to);c=r<c.from?py.range(r,s):py.range(s,r)}return l?r.replaceRange(r.main.extend(c.from,c.to)):a?r.addRange(c):py.create([c])}}}(t,e)),i){let n=t.root.activeElement!=t.contentDOM;n&&t.observer.ignore((()=>Nx(t.contentDOM))),t.inputState.startMouseSelection(new zS(t,e,i,n))}};let XS=(t,e)=>t>=e.top&&t<=e.bottom,FS=(t,e,i)=>XS(e,i)&&t>=i.left&&t<=i.right;function ZS(t,e,i,n){let r=Tk.find(t.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(0==s)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&FS(i,n,o))return-1;let l=r.coordsAt(s,1);return l&&FS(i,n,l)?1:o&&XS(n,o)?-1:1}function GS(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:ZS(t,i,e.clientX,e.clientY)}}const US=rk.ie&&rk.ie_version<=11;let YS=null,KS=0,JS=0;function tC(t){if(!US)return t.detail;let e=YS,i=JS;return YS=t,JS=Date.now(),KS=!e||i>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(KS+1)%3:1}function eC(t,e,i,n){if(!i)return;let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:s}=t.inputState,o=n&&s&&s.dragging&&s.dragMove?{from:s.dragging.from,to:s.dragging.to}:null,l={from:r,insert:i},a=t.state.changes(o?[o,l]:l);t.focus(),t.dispatch({changes:a,selection:{anchor:a.mapPos(r,-1),head:a.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"})}WS.dragstart=(t,e)=>{let{selection:{main:i}}=t.state,{mouseSelection:n}=t.inputState;n&&(n.dragging=i),e.dataTransfer&&(e.dataTransfer.setData("Text",t.state.sliceDoc(i.from,i.to)),e.dataTransfer.effectAllowed="copyMove")},WS.drop=(t,e)=>{if(!e.dataTransfer)return;if(t.state.readOnly)return e.preventDefault();let i=e.dataTransfer.files;if(i&&i.length){e.preventDefault();let n=Array(i.length),r=0,s=()=>{++r==i.length&&eC(t,e,n.filter((t=>null!=t)).join(t.state.lineBreak),!1)};for(let t=0;t<i.length;t++){let e=new FileReader;e.onerror=s,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(n[t]=e.result),s()},e.readAsText(i[t])}}else eC(t,e,e.dataTransfer.getData("Text"),!0)},WS.paste=(t,e)=>{if(t.state.readOnly)return e.preventDefault();t.observer.flush();let i=VS?null:e.clipboardData;i?(jS(t,i.getData("text/plain")),e.preventDefault()):function(t){let e=t.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((()=>{t.focus(),i.remove(),jS(t,i.value)}),50)}(t)};let iC=null;function nC(t){setTimeout((()=>{t.hasFocus!=t.inputState.notifiedFocused&&t.update([])}),10)}function rC(t,e){if(t.docView.compositionDeco.size){t.inputState.rapidCompositionStart=e;try{t.update([])}finally{t.inputState.rapidCompositionStart=!1}}}WS.copy=WS.cut=(t,e)=>{let{text:i,ranges:n,linewise:r}=function(t){let e=[],i=[],n=!1;for(let n of t.selection.ranges)n.empty||(e.push(t.sliceDoc(n.from,n.to)),i.push(n));if(!e.length){let r=-1;for(let{from:n}of t.selection.ranges){let s=t.doc.lineAt(n);s.number>r&&(e.push(s.text),i.push({from:s.from,to:Math.min(t.doc.length,s.to+1)})),r=s.number}n=!0}return{text:e.join(t.lineBreak),ranges:i,linewise:n}}(t.state);if(!i&&!r)return;iC=r?i:null;let s=VS?null:e.clipboardData;s?(e.preventDefault(),s.clearData(),s.setData("text/plain",i)):function(t,e){let i=t.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout((()=>{n.remove(),t.focus()}),50)}(t,i),"cut"!=e.type||t.state.readOnly||t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"})},WS.focus=nC,WS.blur=t=>{t.observer.clearSelectionRange(),nC(t)},WS.compositionstart=WS.compositionupdate=t=>{null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0,t.docView.compositionDeco.size&&(t.observer.flush(),rC(t,!0)))},WS.compositionend=t=>{t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionFirstChange=null,setTimeout((()=>{t.inputState.composing<0&&rC(t,!1)}),50)},WS.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()},WS.beforeinput=(t,e)=>{var i;let n;if(rk.chrome&&rk.android&&(n=BS.find((t=>t.inputType==e.inputType)))&&(t.observer.delayAndroidKey(n.key,n.keyCode),"Backspace"==n.key||"Delete"==n.key)){let e=(null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0;setTimeout((()=>{var i;((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>e+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())}),100)}};const sC=["pre-wrap","normal","pre-line","break-spaces"];class oC{constructor(){this.doc=Bw.empty,this.lineWrapping=!1,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength)),this.lineHeight*i}heightForLine(t){if(!this.lineWrapping)return this.lineHeight;return(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return sC.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(10*n)]||(e=!0,this.heightSamples[Math.floor(10*n)]=!0)}return e}refresh(t,e,i,n,r){let s=sC.indexOf(t)>-1,o=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=s;if(this.lineWrapping=s,this.lineHeight=e,this.charWidth=i,this.lineLength=n,o){this.heightSamples={};for(let t=0;t<r.length;t++){let e=r[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return o}}class lC{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class aC{constructor(t,e,i,n,r){this.from=t,this.length=e,this.top=i,this.height=n,this.type=r}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(t){let e=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(t.type)?t.type:[t]);return new aC(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var hC=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(hC||(hC={}));const cC=.001;class uC{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t,e){this.height!=e&&(Math.abs(this.height-e)>cC&&(t.heightChanged=!0),this.height=e)}replace(t,e,i){return uC.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let r=this;for(let s=n.length-1;s>=0;s--){let{fromA:o,toA:l,fromB:a,toB:h}=n[s],c=r.lineAt(o,hC.ByPosNoHeight,e,0,0),u=c.to>=l?c:r.lineAt(l,hC.ByPosNoHeight,e,0,0);for(h+=u.to-l,l=u.to;s>0&&c.from<=n[s-1].toA;)o=n[s-1].fromA,a=n[s-1].fromB,s--,o<c.from&&(c=r.lineAt(o,hC.ByPosNoHeight,e,0,0));a+=c.from-o,o=c.from;let f=bC.build(i,t,a,h);r=r.replace(o,l,f)}return r.updateHeight(i,0)}static empty(){return new dC(0,0)}static of(t){if(1==t.length)return t[0];let e=0,i=t.length,n=0,r=0;for(;;)if(e==i)if(n>2*r){let r=t[e-1];r.break?t.splice(--e,1,r.left,null,r.right):t.splice(--e,1,r.left,r.right),i+=1+r.break,n-=r.size}else{if(!(r>2*n))break;{let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,r-=e.size}}else if(n<r){let i=t[e++];i&&(n+=i.size)}else{let e=t[--i];e&&(r+=e.size)}let s=0;return null==t[e-1]?(s=1,e--):null==t[e]&&(s=1,i++),new gC(uC.of(t.slice(0,e)),s,uC.of(t.slice(i)))}}uC.prototype.size=1;class fC extends uC{constructor(t,e,i){super(t,e),this.type=i}blockAt(t,e,i,n){return new aC(n,this.length,i,this.height,this.type)}lineAt(t,e,i,n,r){return this.blockAt(0,i,n,r)}forEachLine(t,e,i,n,r,s){t<=r+this.length&&e>=r&&s(this.blockAt(0,i,n,r))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(t,n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class dC extends fC{constructor(t,e){super(t,e,wk.Text),this.collapsed=0,this.widgetHeight=0}replace(t,e,i){let n=i[0];return 1==i.length&&(n instanceof dC||n instanceof pC&&4&n.flags)&&Math.abs(this.length-n.length)<10?(n instanceof pC?n=new dC(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):uC.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(t,n.heights[n.index++]):(i||this.outdated)&&this.setHeight(t,Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class pC extends uC{constructor(t){super(t,0)}lines(t,e){let i=t.lineAt(e).number,n=t.lineAt(e+this.length).number;return{firstLine:i,lastLine:n,lineHeight:this.height/(n-i+1)}}blockAt(t,e,i,n){let{firstLine:r,lastLine:s,lineHeight:o}=this.lines(e,n),l=Math.max(0,Math.min(s-r,Math.floor((t-i)/o))),{from:a,length:h}=e.line(r+l);return new aC(a,h,i+o*l,o,wk.Text)}lineAt(t,e,i,n,r){if(e==hC.ByHeight)return this.blockAt(t,i,n,r);if(e==hC.ByPosNoHeight){let{from:e,to:n}=i.lineAt(t);return new aC(e,n-e,0,0,wk.Text)}let{firstLine:s,lineHeight:o}=this.lines(i,r),{from:l,length:a,number:h}=i.lineAt(t);return new aC(l,a,n+o*(h-s),o,wk.Text)}forEachLine(t,e,i,n,r,s){let{firstLine:o,lineHeight:l}=this.lines(i,r);for(let a=Math.max(t,r),h=Math.min(r+this.length,e);a<=h;){let e=i.lineAt(a);a==t&&(n+=l*(e.number-o)),s(new aC(e.from,e.length,n,l,wk.Text)),n+=l,a=e.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let t=i[i.length-1];t instanceof pC?i[i.length-1]=new pC(t.length+n):i.push(null,new pC(n-1))}if(t>0){let e=i[0];e instanceof pC?i[0]=new pC(t+e.length):i.unshift(new pC(t-1),null)}return uC.of(i)}decomposeLeft(t,e){e.push(new pC(t-1),null)}decomposeRight(t,e){e.push(null,new pC(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let r=e+this.length;if(n&&n.from<=e+this.length&&n.more){let i=[],s=Math.max(e,n.from),o=-1,l=t.heightChanged;for(n.from>e&&i.push(new pC(n.from-e-1).updateHeight(t,e));s<=r&&n.more;){let e=t.doc.lineAt(s).length;i.length&&i.push(null);let r=n.heights[n.index++];-1==o?o=r:Math.abs(r-o)>=cC&&(o=-2);let l=new dC(e,r);l.outdated=!1,i.push(l),s+=e+1}s<=r&&i.push(null,new pC(r-s).updateHeight(t,s));let a=uC.of(i);return t.heightChanged=l||o<0||Math.abs(a.height-this.height)>=cC||Math.abs(o-this.lines(t.doc,e).lineHeight)>=cC,a}return(i||this.outdated)&&(this.setHeight(t,t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class gC extends uC{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return 1&this.flags}blockAt(t,e,i,n){let r=i+this.left.height;return t<r?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,r,n+this.left.length+this.break)}lineAt(t,e,i,n,r){let s=n+this.left.height,o=r+this.left.length+this.break,l=e==hC.ByHeight?t<s:t<o,a=l?this.left.lineAt(t,e,i,n,r):this.right.lineAt(t,e,i,s,o);if(this.break||(l?a.to<o:a.from>o))return a;let h=e==hC.ByPosNoHeight?hC.ByPosNoHeight:hC.ByPos;return l?a.join(this.right.lineAt(o,h,i,s,o)):this.left.lineAt(o,h,i,n,r).join(a)}forEachLine(t,e,i,n,r,s){let o=n+this.left.height,l=r+this.left.length+this.break;if(this.break)t<l&&this.left.forEachLine(t,e,i,n,r,s),e>=l&&this.right.forEachLine(t,e,i,o,l,s);else{let a=this.lineAt(l,hC.ByPos,i,n,r);t<a.from&&this.left.forEachLine(t,a.from-1,i,n,r,s),a.to>=t&&a.from<=e&&s(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,o,l,s)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let r=[];t>0&&this.decomposeLeft(t,r);let s=r.length;for(let t of i)r.push(t);if(t>0&&mC(r,s-1),e<this.length){let t=r.length;this.decomposeRight(e,r),mC(r,t)}return uC.of(r)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?uC.of(this.break?[t,null,e]:[t,e]):(this.left=t,this.right=e,this.height=t.height+e.height,this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:r,right:s}=this,o=e+r.length+this.break,l=null;return n&&n.from<=e+r.length&&n.more?l=r=r.updateHeight(t,e,i,n):r.updateHeight(t,e,i),n&&n.from<=o+s.length&&n.more?l=s=s.updateHeight(t,o,i,n):s.updateHeight(t,o,i),l?this.balanced(r,s):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function mC(t,e){let i,n;null==t[e]&&(i=t[e-1])instanceof pC&&(n=t[e+1])instanceof pC&&t.splice(e-1,3,new pC(i.length+1+n.length))}class bC{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof dC?i.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new dC(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0;n<0&&(n=this.oracle.lineHeight);let r=e-t;i.block?this.addBlock(new fC(r,n,i.type)):(r||n>=5)&&this.addLineDeco(n,r)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new dC(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new pC(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof dC)return t;let e=new dC(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine(),t.type!=wk.WidgetAfter||this.isCovered||this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,t.type!=wk.WidgetBefore&&(this.covering=t)}addLineDeco(t,e){let i=this.ensureLine();i.length+=e,i.collapsed+=e,i.widgetHeight=Math.max(i.widgetHeight,t),this.writtenTo=this.pos=this.pos+e}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof dC||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new dC(0,-1));let i=t;for(let t of this.nodes)t instanceof dC&&t.updateHeight(this.oracle,i),i+=t?t.length:1;return this.nodes}static build(t,e,i,n){let r=new bC(i,t);return cx.spans(e,i,n,r,0),r.finish(i)}}class OC{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&Ak(t,e,this.changes,5)}}function vC(t,e){let i=t.getBoundingClientRect(),n=Math.max(0,i.left),r=Math.min(innerWidth,i.right),s=Math.max(0,i.top),o=Math.min(innerHeight,i.bottom),l=t.ownerDocument.body;for(let e=t.parentNode;e&&e!=l;)if(1==e.nodeType){let t=e,i=window.getComputedStyle(t);if((t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)&&"visible"!=i.overflow){let e=t.getBoundingClientRect();n=Math.max(n,e.left),r=Math.min(r,e.right),s=Math.max(s,e.top),o=Math.min(o,e.bottom)}e="absolute"==i.position||"fixed"==i.position?t.offsetParent:t.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{left:n-i.left,right:Math.max(n,r)-i.left,top:s-(i.top+e),bottom:Math.max(s,o)-(i.top+e)}}function wC(t,e){let i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class yC{constructor(t,e,i){this.from=t,this.to=e,this.size=i}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],r=e[i];if(n.from!=r.from||n.to!=r.to||n.size!=r.size)return!1}return!0}draw(t){return yk.replace({widget:new xC(this.size,t)}).range(this.from,this.to)}}class xC extends vk{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class kC{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.heightOracle=new oC,this.scaler=QC,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=eS.RTL,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1,this.stateDeco=t.facet(Gk).filter((t=>"function"!=typeof t)),this.heightMap=uC.empty().applyChanges(this.stateDeco,Bw.empty,this.heightOracle.setDoc(t.doc),[new Jk(0,0,0,t.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=yk.set(this.lineGaps.map((t=>t.draw(!1)))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some((({from:t,to:e})=>n>=t&&n<=e))){let{from:e,to:i}=this.lineBlockAt(n);t.push(new SC(e,i))}}this.viewports=t.sort(((t,e)=>t.from-e.from)),this.scaler=this.heightMap.height<=7e6?QC:new RC(this.heightOracle.doc,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,(t=>{this.viewportLines.push(1==this.scaler.scale?t:$C(t,this.scaler))}))}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(Gk).filter((t=>"function"!=typeof t));let n=t.changedRanges,r=Jk.extendWithRanges(n,function(t,e,i){let n=new OC;return cx.compare(t,e,i,n,0),n.changes}(i,this.stateDeco,t?t.changes:oy.empty(this.state.doc.length))),s=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),r),this.heightMap.height!=s&&(t.flags|=2);let o=r.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<o.from||e.range.head>o.to)||!this.viewportIsAppropriate(o))&&(o=this.getViewport(0,e));let l=!t.changes.empty||2&t.flags||o.from!=this.viewport.from||o.to!=this.viewport.to;this.viewport=o,this.updateForViewport(),l&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,r=i.whiteSpace;this.defaultTextDirection="rtl"==i.direction?eS.RTL:eS.LTR;let s=this.heightOracle.mustRefreshForWrapping(r),o=s||this.mustMeasureContent||this.contentDOMHeight!=e.clientHeight;this.contentDOMHeight=e.clientHeight,this.mustMeasureContent=!1;let l=0,a=0,h=parseInt(i.paddingTop)||0,c=parseInt(i.paddingBottom)||0;this.paddingTop==h&&this.paddingBottom==c||(this.paddingTop=h,this.paddingBottom=c,l|=10),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(o=!0),this.editorWidth=t.scrollDOM.clientWidth,l|=8);let u=(this.printing?wC:vC)(e,this.paddingTop),f=u.top-this.pixelViewport.top,d=u.bottom-this.pixelViewport.bottom;this.pixelViewport=u;let p=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(p!=this.inView&&(this.inView=p,p&&(o=!0)),!this.inView)return 0;let g=e.clientWidth;if(this.contentDOMWidth==g&&this.editorHeight==t.scrollDOM.clientHeight||(this.contentDOMWidth=g,this.editorHeight=t.scrollDOM.clientHeight,l|=8),o){let e=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(e)&&(s=!0),s||n.lineWrapping&&Math.abs(g-this.contentDOMWidth)>n.charWidth){let{lineHeight:i,charWidth:o}=t.docView.measureTextSize();s=n.refresh(r,i,o,g/o,e),s&&(t.docView.minWidth=0,l|=8)}f>0&&d>0?a=Math.max(f,d):f<0&&d<0&&(a=Math.min(f,d)),n.heightChanged=!1;for(let i of this.viewports){let r=i.from==this.viewport.from?e:t.docView.measureVisibleLineHeights(i);this.heightMap=this.heightMap.updateHeight(n,0,s,new lC(i.from,r))}n.heightChanged&&(l|=2)}let m=!this.viewportIsAppropriate(this.viewport,a)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return m&&(this.viewport=this.getViewport(a,this.scrollTarget)),this.updateForViewport(),(2&l||m)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(s?[]:this.lineGaps)),l|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),l}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,r=this.state.doc,{visibleTop:s,visibleBottom:o}=this,l=new SC(n.lineAt(s-1e3*i,hC.ByHeight,r,0,0).from,n.lineAt(o+1e3*(1-i),hC.ByHeight,r,0,0).to);if(e){let{head:t}=e.range;if(t<l.from||t>l.to){let i,s=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),o=n.lineAt(t,hC.ByPos,r,0,0);i="center"==e.y?(o.top+o.bottom)/2-s/2:"start"==e.y||"nearest"==e.y&&t<l.from?o.top:o.bottom-s,l=new SC(n.lineAt(i-500,hC.ByHeight,r,0,0).from,n.lineAt(i+s+500,hC.ByHeight,r,0,0).to)}}return l}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new SC(this.heightMap.lineAt(i,hC.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(n,hC.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,hC.ByPos,this.state.doc,0,0),{bottom:r}=this.heightMap.lineAt(e,hC.ByPos,this.state.doc,0,0),{visibleTop:s,visibleBottom:o}=this;return(0==t||n<=s-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||r>=o+Math.max(10,Math.min(i,250)))&&n>s-2e3&&r<o+2e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new yC(e.mapPos(n.from),e.mapPos(n.to),n.size));return i}ensureLineGaps(t){let e=[];if(this.defaultTextDirection!=eS.LTR)return e;for(let i of this.viewportLines){if(i.length<4e3)continue;let n,r,s=CC(i.from,i.to,this.stateDeco);if(s.total<4e3)continue;if(this.heightOracle.lineWrapping){let t=2e3/this.heightOracle.lineLength*this.heightOracle.lineHeight;n=AC(s,(this.visibleTop-i.top-t)/i.height),r=AC(s,(this.visibleBottom-i.top+t)/i.height)}else{let t=s.total*this.heightOracle.charWidth,e=2e3*this.heightOracle.charWidth;n=AC(s,(this.pixelViewport.left-e)/t),r=AC(s,(this.pixelViewport.right+e)/t)}let o=[];n>i.from&&o.push({from:i.from,to:n}),r<i.to&&o.push({from:r,to:i.to});let l=this.state.selection.main;l.from>=i.from&&l.from<=i.to&&PC(o,l.from-10,l.from+10),!l.empty&&l.to>=i.from&&l.to<=i.to&&PC(o,l.to-10,l.to+10);for(let{from:n,to:r}of o)r-n>1e3&&e.push(MC(t,(t=>t.from>=i.from&&t.to<=i.to&&Math.abs(t.from-n)<1e3&&Math.abs(t.to-r)<1e3))||new yC(n,r,this.gapSize(i,n,r,s)))}return e}gapSize(t,e,i,n){let r=TC(n,i)-TC(n,e);return this.heightOracle.lineWrapping?t.height*r:n.total*this.heightOracle.charWidth*r}updateLineGaps(t){yC.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=yk.set(t.map((t=>t.draw(this.heightOracle.lineWrapping)))))}computeVisibleRanges(){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let e=[];cx.spans(t,this.viewport.from,this.viewport.to,{span(t,i){e.push({from:t,to:i})},point(){}},20);let i=e.length!=this.visibleRanges.length||this.visibleRanges.some(((t,i)=>t.from!=e[i].from||t.to!=e[i].to));return this.visibleRanges=e,i?4:0}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find((e=>e.from<=t&&e.to>=t))||$C(this.heightMap.lineAt(t,hC.ByPos,this.state.doc,0,0),this.scaler)}lineBlockAtHeight(t){return $C(this.heightMap.lineAt(this.scaler.fromDOM(t),hC.ByHeight,this.state.doc,0,0),this.scaler)}elementAtHeight(t){return $C(this.heightMap.blockAt(this.scaler.fromDOM(t),this.state.doc,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class SC{constructor(t,e){this.from=t,this.to=e}}function CC(t,e,i){let n=[],r=t,s=0;return cx.spans(i,t,e,{span(){},point(t,e){t>r&&(n.push({from:r,to:t}),s+=t-r),r=e}},20),r<e&&(n.push({from:r,to:e}),s+=e-r),{total:s,ranges:n}}function AC({total:t,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let n=Math.floor(t*i);for(let t=0;;t++){let{from:i,to:r}=e[t],s=r-i;if(n<=s)return i+n;n-=s}}function TC(t,e){let i=0;for(let{from:n,to:r}of t.ranges){if(e<=r){i+=e-n;break}i+=r-n}return i/t.total}function PC(t,e,i){for(let n=0;n<t.length;n++){let r=t[n];if(r.from<i&&r.to>e){let s=[];r.from<e&&s.push({from:r.from,to:e}),r.to>i&&s.push({from:i,to:r.to}),t.splice(n,1,...s),n+=s.length-1}}}function MC(t,e){for(let i of t)if(e(i))return i}const QC={toDOM:t=>t,fromDOM:t=>t,scale:1};class RC{constructor(t,e,i){let n=0,r=0,s=0;this.viewports=i.map((({from:i,to:r})=>{let s=e.lineAt(i,hC.ByPos,t,0,0).top,o=e.lineAt(r,hC.ByPos,t,0,0).bottom;return n+=o-s,{from:i,to:r,top:s,bottom:o,domTop:0,domBottom:0}})),this.scale=(7e6-n)/(e.height-n);for(let t of this.viewports)t.domTop=s+(t.top-r)*this.scale,s=t.domBottom=t.domTop+(t.bottom-t.top),r=t.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.top)return n+(t-i)*this.scale;if(t<=r.bottom)return r.domTop+(t-r.top);i=r.bottom,n=r.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.domTop)return i+(t-n)/this.scale;if(t<=r.domBottom)return r.top+(t-r.domTop);i=r.bottom,n=r.domBottom}}}function $C(t,e){if(1==e.scale)return t;let i=e.toDOM(t.top),n=e.toDOM(t.bottom);return new aC(t.from,t.length,i,n-i,Array.isArray(t.type)?t.type.map((t=>$C(t,e))):t.type)}const _C=by.define({combine:t=>t.join(" ")}),DC=by.define({combine:t=>t.indexOf(!0)>-1}),EC=Je.newName(),NC=Je.newName(),BC=Je.newName(),IC={"&light":"."+NC,"&dark":"."+BC};function zC(t,e,i){return new Je(e,{finish:e=>/&/.test(e)?e.replace(/&\w*/,(e=>{if("&"==e)return t;if(!i||!i[e])throw new RangeError(`Unsupported selector: ${e}`);return i[e]})):t+" "+e})}const LC=zC("."+EC,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere"},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},".cm-cursor, .cm-dropCursor":{position:"absolute",borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#f3f9ff"},"&dark .cm-activeLine":{backgroundColor:"#223039"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},IC),WC={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},VC=rk.ie&&rk.ie_version<=11;class jC{constructor(t,e,i){this.view=t,this.onChange=e,this.onScrollChanged=i,this.active=!1,this.selectionRange=new _x,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.scrollTargets=[],this.intersection=null,this.resize=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver((e=>{for(let t of e)this.queue.push(t);(rk.ie&&rk.ie_version<=11||rk.ios&&t.composing)&&e.some((t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length))?this.flushSoon():this.flush()})),VC&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),window.addEventListener("resize",this.onResize=this.onResize.bind(this)),"function"==typeof ResizeObserver&&(this.resize=new ResizeObserver((()=>{this.view.docView.lastUpdate<Date.now()-75&&this.onResize()})),this.resize.observe(t.scrollDOM)),window.addEventListener("beforeprint",this.onPrint=this.onPrint.bind(this)),this.start(),window.addEventListener("scroll",this.onScroll=this.onScroll.bind(this)),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange(),this.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}onScroll(t){this.intersecting&&this.flush(!1),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500)}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some(((e,i)=>e!=t[i])))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:e}=this,i=this.selectionRange;if(e.state.facet(Vk)?e.root.activeElement!=this.dom:!Sx(e.dom,i))return;let n=i.anchorNode&&e.docView.nearest(i.anchorNode);n&&n.ignoreEvent(t)||((rk.ie&&rk.ie_version<=11||rk.android&&rk.chrome)&&!e.state.selection.main.empty&&i.focusNode&&Ax(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1))}readSelectionRange(){let{root:t}=this.view,e=xx(t),i=rk.safari&&11==t.nodeType&&function(){let t=document.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}()==this.view.contentDOM&&function(t){let e=null;function i(t){t.preventDefault(),t.stopImmediatePropagation(),e=t.getTargetRanges()[0]}if(t.contentDOM.addEventListener("beforeinput",i,!0),document.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",i,!0),!e)return null;let n=e.startContainer,r=e.startOffset,s=e.endContainer,o=e.endOffset,l=t.docView.domAtPos(t.state.selection.main.anchor);Ax(l.node,l.offset,s,o)&&([n,r,s,o]=[s,o,n,r]);return{anchorNode:n,anchorOffset:r,focusNode:s,focusOffset:o}}(this.view)||e;return!this.selectionRange.eq(i)&&(this.selectionRange.setRange(i),this.selectionChanged=!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(1==i.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else{if(11!=i.nodeType)break;i=i.host}if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,WC),VC&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),VC&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){this.delayedAndroidKey||requestAnimationFrame((()=>{let t=this.delayedAndroidKey;this.delayedAndroidKey=null,this.delayedFlush=-1,this.flush()||Ix(this.view.contentDOM,t.key,t.keyCode)})),this.delayedAndroidKey&&"Enter"!=t||(this.delayedAndroidKey={key:t,keyCode:e})}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=window.setTimeout((()=>{this.delayedFlush=-1,this.flush()}),20))}forceFlush(){this.delayedFlush>=0&&(window.clearTimeout(this.delayedFlush),this.delayedFlush=-1,this.flush())}processRecords(){let t=this.queue;for(let e of this.observer.takeRecords())t.push(e);t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let r of t){let t=this.readMutation(r);t&&(t.typeOver&&(n=!0),-1==e?({from:e,to:i}=t):(e=Math.min(t.from,e),i=Math.max(t.to,i)))}return{from:e,to:i,typeOver:n}}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return;t&&this.readSelectionRange();let{from:e,to:i,typeOver:n}=this.processRecords(),r=this.selectionChanged&&Sx(this.dom,this.selectionRange);if(e<0&&!r)return;this.selectionChanged=!1;let s=this.view.state,o=this.onChange(e,i,n);return this.view.state==s&&this.view.update([]),o}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty("attributes"==t.type),"attributes"==t.type&&(e.dirty|=4),"childList"==t.type){let i=qC(e,t.previousSibling||t.target.previousSibling,-1),n=qC(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}return"characterData"==t.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}destroy(){var t,e,i;this.stop(),null===(t=this.intersection)||void 0===t||t.disconnect(),null===(e=this.gapIntersection)||void 0===e||e.disconnect(),null===(i=this.resize)||void 0===i||i.disconnect();for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onResize),window.removeEventListener("beforeprint",this.onPrint),this.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout)}}function qC(t,e,i){for(;e;){let n=Vx.get(e);if(n&&n.parent==t)return n;let r=e.parentNode;e=r!=t.dom?r:i>0?e.nextSibling:e.previousSibling}return null}function HC(t,e,i,n){let r,s,o=t.state.selection.main;if(e>-1){let n=t.docView.domBoundsAround(e,i,0);if(!n||t.state.readOnly)return!1;let{from:l,to:a}=n,h=t.docView.impreciseHead||t.docView.impreciseAnchor?[]:function(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:i,anchorOffset:n,focusNode:r,focusOffset:s}=t.observer.selectionRange;i&&(e.push(new OS(i,n)),r==i&&s==n||e.push(new OS(r,s)));return e}(t),c=new mS(h,t.state);c.readRange(n.startDOM,n.endDOM);let u=o.from,f=null;(8===t.inputState.lastKeyCode&&t.inputState.lastKeyTime>Date.now()-100||rk.android&&c.text.length<a-l)&&(u=o.to,f="end");let d=function(t,e,i,n){let r=Math.min(t.length,e.length),s=0;for(;s<r&&t.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==r&&t.length==e.length)return null;let o=t.length,l=e.length;for(;o>0&&l>0&&t.charCodeAt(o-1)==e.charCodeAt(l-1);)o--,l--;if("end"==n){i-=o+Math.max(0,s-Math.min(o,l))-s}if(o<s&&t.length<e.length){s-=i<=s&&i>=o?s-i:0,l=s+(l-o),o=s}else if(l<s){s-=i<=s&&i>=l?s-i:0,o=s+(o-l),l=s}return{from:s,toA:o,toB:l}}(t.state.doc.sliceString(l,a,gS),c.text,u-l,f);d&&(rk.chrome&&13==t.inputState.lastKeyCode&&d.toB==d.from+2&&"￿￿"==c.text.slice(d.from,d.toB)&&d.toB--,r={from:l+d.from,to:l+d.toA,insert:Bw.of(c.text.slice(d.from,d.toB).split(gS))}),s=function(t,e){if(0==t.length)return null;let i=t[0].pos,n=2==t.length?t[1].pos:i;return i>-1&&n>-1?py.single(i+e,n+e):null}(h,l)}else if(t.hasFocus||!t.state.facet(Vk)){let e=t.observer.selectionRange,{impreciseHead:i,impreciseAnchor:n}=t.docView,r=i&&i.node==e.focusNode&&i.offset==e.focusOffset||!kx(t.contentDOM,e.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),l=n&&n.node==e.anchorNode&&n.offset==e.anchorOffset||!kx(t.contentDOM,e.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(e.anchorNode,e.anchorOffset);r==o.head&&l==o.anchor||(s=py.single(l,r))}if(!r&&!s)return!1;if(!r&&n&&!o.empty&&s&&s.main.empty?r={from:o.from,to:o.to,insert:t.state.doc.slice(o.from,o.to)}:r&&r.from>=o.from&&r.to<=o.to&&(r.from!=o.from||r.to!=o.to)&&o.to-o.from-(r.to-r.from)<=4?r={from:o.from,to:o.to,insert:t.state.doc.slice(o.from,r.from).append(r.insert).append(t.state.doc.slice(r.to,o.to))}:(rk.mac||rk.android)&&r&&r.from==r.to&&r.from==o.head-1&&"."==r.insert.toString()&&(r={from:o.from,to:o.to,insert:Bw.of([" "])}),r){let e=t.state;if(rk.ios&&t.inputState.flushIOSKey(t))return!0;if(rk.android&&(r.from==o.from&&r.to==o.to&&1==r.insert.length&&2==r.insert.lines&&Ix(t.contentDOM,"Enter",13)||r.from==o.from-1&&r.to==o.to&&0==r.insert.length&&Ix(t.contentDOM,"Backspace",8)||r.from==o.from&&r.to==o.to+1&&0==r.insert.length&&Ix(t.contentDOM,"Delete",46)))return!0;let i,n=r.insert.toString();if(t.state.facet(Bk).some((e=>e(t,r.from,r.to,n))))return!0;if(t.inputState.composing>=0&&t.inputState.composing++,r.from>=o.from&&r.to<=o.to&&r.to-r.from>=(o.to-o.from)/3&&(!s||s.main.empty&&s.main.from==r.from+r.insert.length)&&t.inputState.composing<0){let n=o.from<r.from?e.sliceDoc(o.from,r.from):"",s=o.to>r.to?e.sliceDoc(r.to,o.to):"";i=e.replaceSelection(t.state.toText(n+r.insert.sliceString(0,void 0,t.state.lineBreak)+s))}else{let n=e.changes(r),l=s&&!e.selection.main.eq(s.main)&&s.main.to<=n.newLength?s.main:void 0;if(e.selection.ranges.length>1&&t.inputState.composing>=0&&r.to<=o.to&&r.to>=o.to-10){let s=t.state.sliceDoc(r.from,r.to),a=yS(t)||t.state.doc.lineAt(o.head),h=o.to-r.to,c=o.to-o.from;i=e.changeByRange((i=>{if(i.from==o.from&&i.to==o.to)return{changes:n,range:l||i.map(n)};let u=i.to-h,f=u-s.length;if(i.to-i.from!=c||t.state.sliceDoc(f,u)!=s||a&&i.to>=a.from&&i.from<=a.to)return{range:i};let d=e.changes({from:f,to:u,insert:r.insert}),p=i.to-o.to;return{changes:d,range:l?py.range(Math.max(0,l.anchor+p),Math.max(0,l.head+p)):i.map(d)}}))}else i={changes:n,selection:l&&e.selection.replaceRange(l)}}let l="input.type";return t.composing&&(l+=".compose",t.inputState.compositionFirstChange&&(l+=".start",t.inputState.compositionFirstChange=!1)),t.dispatch(i,{scrollIntoView:!0,userEvent:l}),!0}if(s&&!s.main.eq(o)){let e=!1,i="select";return t.inputState.lastSelectionTime>Date.now()-50&&("select"==t.inputState.lastSelectionOrigin&&(e=!0),i=t.inputState.lastSelectionOrigin),t.dispatch({selection:s,scrollIntoView:e,userEvent:i}),!0}return!1}class XC{constructor(t={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: absolute; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=t.dispatch||(t=>this.update([t])),this.dispatch=this.dispatch.bind(this),this.root=t.root||function(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}(t.parent)||document,this.viewState=new kC(t.state||sx.create()),this.plugins=this.state.facet(qk).map((t=>new Xk(t)));for(let t of this.plugins)t.update(this);this.observer=new jC(this,((t,e,i)=>HC(this,t,e,i)),(t=>{this.inputState.runScrollHandlers(this,t),this.observer.intersecting&&this.measure()})),this.inputState=new NS(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new vS(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),t.parent&&t.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}dispatch(...t){this._dispatch(1==t.length&&t[0]instanceof Zy?t[0]:this.state.update(...t))}update(t){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e,i=!1,n=!1,r=this.state;for(let e of t){if(e.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=e.state}if(this.destroyed)return void(this.viewState.state=r);if(this.observer.clear(),r.facet(sx.phrases)!=this.state.facet(sx.phrases))return this.setState(r);e=tS.create(this,r,t);let s=this.viewState.scrollTarget;try{this.updateState=2;for(let e of t){if(s&&(s=s.map(e.changes)),e.scrollIntoView){let{main:t}=e.state.selection;s=new zk(t.empty?t:py.cursor(t.head,t.head>t.anchor?-1:1))}for(let t of e.effects)t.is(Lk)&&(s=t.value)}this.viewState.update(e,s),this.bidiCache=GC.update(this.bidiCache,e.changes),e.empty||(this.updatePlugins(e),this.inputState.update(e)),i=this.docView.update(e),this.state.facet(Kk)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some((t=>t.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(e.startState.facet(_C)!=e.state.facet(_C)&&(this.viewState.mustMeasureContent=!0),(i||n||s||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!e.empty)for(let t of this.state.facet(Nk))t(e)}setState(t){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=t);this.updateState=2;let e=this.hasFocus;try{for(let t of this.plugins)t.destroy(this);this.viewState=new kC(t),this.plugins=t.facet(qk).map((t=>new Xk(t))),this.pluginMap.clear();for(let t of this.plugins)t.update(this);this.docView=new vS(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(qk),i=t.state.facet(qk);if(e!=i){let n=[];for(let r of i){let i=e.indexOf(r);if(i<0)n.push(new Xk(r));else{let e=this.plugins[i];e.mustUpdate=t,n.push(e)}}for(let e of this.plugins)e.mustUpdate!=t&&e.destroy(this);this.plugins=n,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let e of this.plugins)e.mustUpdate=t;for(let t=0;t<this.plugins.length;t++)this.plugins[t].update(this)}measure(t=!0){if(this.destroyed)return;this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,t&&this.observer.flush();let e=null;try{for(let t=0;;t++){this.updateState=1;let i=this.viewport,n=this.viewState.measure(this);if(!n&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(t>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let r=[];4&n||([this.measureRequests,r]=[r,this.measureRequests]);let s=r.map((t=>{try{return t.read(this)}catch(t){return Wk(this.state,t),ZC}})),o=tS.create(this,this.state,[]),l=!1,a=!1;o.flags|=n,e?e.flags|=n:e=o,this.updateState=2,o.empty||(this.updatePlugins(o),this.inputState.update(o),this.updateAttrs(),l=this.docView.update(o));for(let t=0;t<r.length;t++)if(s[t]!=ZC)try{let e=r[t];e.write&&e.write(s[t],this)}catch(t){Wk(this.state,t)}if(this.viewState.scrollTarget&&(this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=!0),l&&this.docView.updateSelection(!0),this.viewport.from==i.from&&this.viewport.to==i.to&&!a&&0==this.measureRequests.length)break}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let t of this.state.facet(Nk))t(e)}get themeClasses(){return EC+" "+(this.state.facet(DC)?BC:NC)+" "+this.state.facet(_C)}updateAttrs(){let t=UC(this,Fk,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Vk)?"true":"false",class:"cm-content",style:`${rk.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),UC(this,Zk,e);let i=this.observer.ignore((()=>{let i=Ok(this.contentDOM,this.contentAttrs,e),n=Ok(this.dom,this.editorAttrs,t);return i||n}));return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let t of i.effects)if(t.is(XC.announce)){e&&(this.announceDOM.textContent=""),e=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value}}mountStyles(){this.styleModules=this.state.facet(Kk),Je.mount(this.root,this.styleModules.concat(LC).reverse())}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=requestAnimationFrame((()=>this.measure()))),t){if(null!=t.key)for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key)return void(this.measureRequests[e]=t);this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find((e=>e.spec==t))||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return ES(this,t,DS(this,t,e,i))}moveByGroup(t,e){return ES(this,t,DS(this,t,e,(e=>function(t,e,i){let n=t.state.charCategorizer(e),r=n(i);return t=>{let e=n(t);return r==ex.Space&&(r=e),r==e}}(this,t.head,e))))}moveToLineBoundary(t,e,i=!0){return function(t,e,i,n){let r=t.state.doc.lineAt(e.head),s=n&&t.lineWrapping?t.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head):null;if(s){let e=t.dom.getBoundingClientRect(),n=t.textDirectionAt(r.from),o=t.posAtCoords({x:i==(n==eS.LTR)?e.right-1:e.left+1,y:(s.top+s.bottom)/2});if(null!=o)return py.cursor(o,i?-1:1)}let o=Tk.find(t.docView,e.head),l=o?i?o.posAtEnd:o.posAtStart:i?r.to:r.from;return py.cursor(l,i?-1:1)}(this,t,e,i)}moveVertically(t,e,i){return ES(this,t,function(t,e,i,n){let r=e.head,s=i?1:-1;if(r==(i?t.state.doc.length:0))return py.cursor(r,e.assoc);let o,l=e.goalColumn,a=t.contentDOM.getBoundingClientRect(),h=t.coordsAtPos(r),c=t.documentTop;if(h)null==l&&(l=h.left-a.left),o=s<0?h.top:h.bottom;else{let e=t.viewState.lineBlockAt(r);null==l&&(l=Math.min(a.right-a.left,t.defaultCharacterWidth*(r-e.from))),o=(s<0?e.top:e.bottom)+c}let u=a.left+l,f=null!=n?n:t.defaultLineHeight>>1;for(let i=0;;i+=10){let n=o+(f+i)*s,h=$S(t,{x:u,y:n},!1,s);if(n<a.top||n>a.bottom||(s<0?h<r:h>r))return py.cursor(h,e.assoc,void 0,l)}}(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),$S(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),r=this.bidiSpans(n);return Rx(i,r[cS.find(r,t-n.from,-1,e)].dir==eS.LTR==e>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(Ik)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>FC)return fS(t.length);let e=this.textDirectionAt(t.from);for(let i of this.bidiCache)if(i.from==t.from&&i.dir==e)return i.order;let i=function(t,e){let i=t.length,n=e==iS?1:2,r=e==iS?2:1;if(!t||1==n&&!hS.test(t))return fS(i);for(let e=0,r=n,o=n;e<i;e++){let i=(s=t.charCodeAt(e))<=247?sS[s]:1424<=s&&s<=1524?2:1536<=s&&s<=1785?oS[s-1536]:1774<=s&&s<=2220?4:8192<=s&&s<=8203||8204==s?256:1;512==i?i=r:8==i&&4==o&&(i=16),uS[e]=4==i?2:i,7&i&&(o=i),r=i}var s;for(let t=0,e=n,r=n;t<i;t++){let n=uS[t];if(128==n)t<i-1&&e==uS[t+1]&&24&e?n=uS[t]=e:uS[t]=256;else if(64==n){let n=t+1;for(;n<i&&64==uS[n];)n++;let s=t&&8==e||n<i&&8==uS[n]?1==r?1:8:256;for(let e=t;e<n;e++)uS[e]=s;t=n-1}else 8==n&&1==r&&(uS[t]=1);e=n,7&n&&(r=n)}for(let e,s,o,l=0,a=0,h=0;l<i;l++)if(s=lS[e=t.charCodeAt(l)])if(s<0){for(let t=a-3;t>=0;t-=3)if(aS[t+1]==-s){let e=aS[t+2],i=2&e?n:4&e?1&e?r:n:0;i&&(uS[l]=uS[aS[t]]=i),a=t;break}}else{if(189==aS.length)break;aS[a++]=l,aS[a++]=e,aS[a++]=h}else if(2==(o=uS[l])||1==o){let t=o==n;h=t?0:1;for(let e=a-3;e>=0;e-=3){let i=aS[e+2];if(2&i)break;if(t)aS[e+2]|=2;else{if(4&i)break;aS[e+2]|=4}}}for(let t=0;t<i;t++)if(256==uS[t]){let e=t+1;for(;e<i&&256==uS[e];)e++;let r=1==(t?uS[t-1]:n),s=r==(1==(e<i?uS[e]:n))?r?1:2:n;for(let i=t;i<e;i++)uS[i]=s;t=e-1}let o=[];if(1==n)for(let t=0;t<i;){let e=t,n=1!=uS[t++];for(;t<i&&n==(1!=uS[t]);)t++;if(n)for(let i=t;i>e;){let t=i,n=2!=uS[--i];for(;i>e&&n==(2!=uS[i-1]);)i--;o.push(new cS(i,t,n?2:1))}else o.push(new cS(e,t,0))}else for(let t=0;t<i;){let e=t,n=2==uS[t++];for(;t<i&&n==(2==uS[t]);)t++;o.push(new cS(e,t,n?1:2))}return o}(t.text,e);return this.bidiCache.push(new GC(t.from,t.to,e,i)),i}get hasFocus(){var t;return(document.hasFocus()||rk.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{Nx(this.contentDOM),this.docView.updateSelection()}))}destroy(){for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return Lk.of(new zk("number"==typeof t?py.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}static domEventHandlers(t){return Hk.define((()=>({})),{eventHandlers:t})}static theme(t,e){let i=Je.newName(),n=[_C.of(i),Kk.of(zC(`.${i}`,t))];return e&&e.dark&&n.push(DC.of(!0)),n}static baseTheme(t){return Qy.lowest(Kk.of(zC("."+EC,t,IC)))}}XC.styleModule=Kk,XC.inputHandler=Bk,XC.perLineTextDirection=Ik,XC.exceptionSink=Ek,XC.updateListener=Nk,XC.editable=Vk,XC.mouseSelectionStyle=Dk,XC.dragMovesSelection=_k,XC.clickAddsSelectionRange=$k,XC.decorations=Gk,XC.atomicRanges=Uk,XC.scrollMargins=Yk,XC.darkTheme=DC,XC.contentAttributes=Zk,XC.editorAttributes=Fk,XC.lineWrapping=XC.contentAttributes.of({class:"cm-lineWrapping"}),XC.announce=Fy.define();const FC=4096,ZC={};class GC{constructor(t,e,i,n){this.from=t,this.to=e,this.dir=i,this.order=n}static update(t,e){if(e.empty)return t;let i=[],n=t.length?t[t.length-1].dir:eS.LTR;for(let r=Math.max(0,t.length-10);r<t.length;r++){let s=t[r];s.dir!=n||e.touchesRange(s.from,s.to)||i.push(new GC(e.mapPos(s.from,1),e.mapPos(s.to,-1),s.dir,s.order))}return i}}function UC(t,e,i){for(let n=t.state.facet(e),r=n.length-1;r>=0;r--){let e=n[r],s="function"==typeof e?e(t):e;s&&mk(s,i)}return i}const YC=rk.mac?"mac":rk.windows?"win":rk.linux?"linux":"key";function KC(t,e,i){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),!1!==i&&e.shiftKey&&(t="Shift-"+t),t}const JC=XC.domEventHandlers({keydown:(t,e)=>function(t,e,i,n){let r=fi(e),s=1==r.length&&" "!=r,o="",l=!1;iA&&iA.view==i&&iA.scope==n&&(o=iA.prefix+" ",(l=IS.indexOf(e.keyCode)<0)&&(iA=null));let a,h=t=>{if(t){for(let e of t.commands)if(e(i))return!0;t.preventDefault&&(l=!0)}return!1},c=t[n];if(c){if(h(c[o+KC(r,e,!s)]))return!0;if(s&&(e.shiftKey||e.altKey||e.metaKey)&&(a=ii[e.keyCode])&&a!=r){if(h(c[o+KC(a,e,!0)]))return!0}else if(s&&e.shiftKey&&h(c[o+KC(r,e,!0)]))return!0}return l}(function(t){let e=t.facet(tA),i=eA.get(e);i||eA.set(e,i=function(t,e=YC){let i=Object.create(null),n=Object.create(null),r=(t,e)=>{let i=n[t];if(null==i)n[t]=e;else if(i!=e)throw new Error("Key binding "+t+" is used both as a regular binding and as a multi-stroke prefix")},s=(t,n,s,o)=>{let l=i[t]||(i[t]=Object.create(null)),a=n.split(/ (?!$)/).map((t=>function(t,e){const i=t.split(/-(?!$)/);let n,r,s,o,l=i[i.length-1];"Space"==l&&(l=" ");for(let t=0;t<i.length-1;++t){const l=i[t];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))s=!0;else{if(!/^mod$/i.test(l))throw new Error("Unrecognized modifier name: "+l);"mac"==e?o=!0:r=!0}}return n&&(l="Alt-"+l),r&&(l="Ctrl-"+l),o&&(l="Meta-"+l),s&&(l="Shift-"+l),l}(t,e)));for(let e=1;e<a.length;e++){let i=a.slice(0,e).join(" ");r(i,!0),l[i]||(l[i]={preventDefault:!0,commands:[e=>{let n=iA={view:e,prefix:i,scope:t};return setTimeout((()=>{iA==n&&(iA=null)}),4e3),!0}]})}let h=a.join(" ");r(h,!1);let c=l[h]||(l[h]={preventDefault:!1,commands:[]});c.commands.push(s),o&&(c.preventDefault=!0)};for(let i of t){let t=i[e]||i.key;if(t)for(let e of i.scope?i.scope.split(" "):["editor"])s(e,t,i.run,i.preventDefault),i.shift&&s(e,"Shift-"+t,i.shift,i.preventDefault)}return i}(e.reduce(((t,e)=>t.concat(e)),[])));return i}(e.state),t,e,"editor")}),tA=by.define({enables:JC}),eA=new WeakMap;let iA=null;const nA="-10000px";class rA{constructor(t,e,i){this.facet=e,this.createTooltipView=i,this.input=t.state.facet(e),this.tooltips=this.input.filter((t=>t)),this.tooltipViews=this.tooltips.map(i)}update(t){let e=t.state.facet(this.facet),i=e.filter((t=>t));if(e===this.input){for(let e of this.tooltipViews)e.update&&e.update(t);return!1}let n=[];for(let e=0;e<i.length;e++){let r=i[e],s=-1;if(r){for(let t=0;t<this.tooltips.length;t++){let e=this.tooltips[t];e&&e.create==r.create&&(s=t)}if(s<0)n[e]=this.createTooltipView(r);else{let i=n[e]=this.tooltipViews[s];i.update&&i.update(t)}}}for(let t of this.tooltipViews)n.indexOf(t)<0&&t.dom.remove();return this.input=e,this.tooltips=i,this.tooltipViews=n,!0}}function sA(){return{top:0,left:0,bottom:innerHeight,right:innerWidth}}const oA=by.define({combine:t=>{var e,i,n;return{position:rk.ios?"absolute":(null===(e=t.find((t=>t.position)))||void 0===e?void 0:e.position)||"fixed",parent:(null===(i=t.find((t=>t.parent)))||void 0===i?void 0:i.parent)||null,tooltipSpace:(null===(n=t.find((t=>t.tooltipSpace)))||void 0===n?void 0:n.tooltipSpace)||sA}}}),lA=Hk.fromClass(class{constructor(t){var e;this.view=t,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let i=t.state.facet(oA);this.position=i.position,this.parent=i.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new rA(t,hA,(t=>this.createTooltip(t))),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver((t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()}),{threshold:[1]}):null,this.observeIntersection(),null===(e=t.dom.ownerDocument.defaultView)||void 0===e||e.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout((()=>{this.measureTimeout=-1,this.maybeMeasure()}),50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t);e&&this.observeIntersection();let i=e||t.geometryChanged,n=t.state.facet(oA);if(n.position!=this.position){this.position=n.position;for(let t of this.manager.tooltipViews)t.dom.style.position=this.position;i=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let t of this.manager.tooltipViews)this.container.appendChild(t.dom);i=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);i&&this.maybeMeasure()}createTooltip(t){let e=t.create(this.view);if(e.dom.classList.add("cm-tooltip"),t.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=nA,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var t,e;null===(t=this.view.dom.ownerDocument.defaultView)||void 0===t||t.removeEventListener("resize",this.measureSoon);for(let{dom:t}of this.manager.tooltipViews)t.remove();null===(e=this.intersectionObserver)||void 0===e||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=this.view.dom.getBoundingClientRect();return{editor:t,parent:this.parent?this.container.getBoundingClientRect():t,pos:this.manager.tooltips.map(((t,e)=>{let i=this.manager.tooltipViews[e];return i.getCoords?i.getCoords(t.pos):this.view.coordsAtPos(t.pos)})),size:this.manager.tooltipViews.map((({dom:t})=>t.getBoundingClientRect())),space:this.view.state.facet(oA).tooltipSpace(this.view)}}writeMeasure(t){let{editor:e,space:i}=t,n=[];for(let r=0;r<this.manager.tooltips.length;r++){let s=this.manager.tooltips[r],o=this.manager.tooltipViews[r],{dom:l}=o,a=t.pos[r],h=t.size[r];if(!a||a.bottom<=Math.max(e.top,i.top)||a.top>=Math.min(e.bottom,i.bottom)||a.right<Math.max(e.left,i.left)-.1||a.left>Math.min(e.right,i.right)+.1){l.style.top=nA;continue}let c=s.arrow?o.dom.querySelector(".cm-tooltip-arrow"):null,u=c?7:0,f=h.right-h.left,d=h.bottom-h.top,p=o.offset||aA,g=this.view.textDirection==eS.LTR,m=h.width>i.right-i.left?g?i.left:i.right-h.width:g?Math.min(a.left-(c?14:0)+p.x,i.right-f):Math.max(i.left,a.left-f+(c?14:0)-p.x),b=!!s.above;!s.strictSide&&(b?a.top-(h.bottom-h.top)-p.y<i.top:a.bottom+(h.bottom-h.top)+p.y>i.bottom)&&b==i.bottom-a.bottom>a.top-i.top&&(b=!b);let O=b?a.top-d-u-p.y:a.bottom+u+p.y,v=m+f;if(!0!==o.overlap)for(let t of n)t.left<v&&t.right>m&&t.top<O+d&&t.bottom>O&&(O=b?t.top-d-2-u:t.bottom+u+2);"absolute"==this.position?(l.style.top=O-t.parent.top+"px",l.style.left=m-t.parent.left+"px"):(l.style.top=O+"px",l.style.left=m+"px"),c&&(c.style.left=a.left+(g?p.x:-p.x)-(m+14-7)+"px"),!0!==o.overlap&&n.push({left:m,top:O,right:v,bottom:O+d}),l.classList.toggle("cm-tooltip-above",b),l.classList.toggle("cm-tooltip-below",!b),o.positioned&&o.positioned()}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=nA}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),aA={x:0,y:0},hA=by.define({enables:[lA,XC.baseTheme({".cm-tooltip":{zIndex:100},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}})]});class cA extends ox{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}cA.prototype.elementClass="",cA.prototype.toDOM=void 0,cA.prototype.mapMode=ry.TrackBefore,cA.prototype.startSide=cA.prototype.endSide=-1,cA.prototype.point=!0;class uA{constructor(t,e,i){this.state=t,this.pos=e,this.explicit=i,this.abortListeners=[]}tokenBefore(t){let e=KO(this.state).resolveInner(this.pos,-1);for(;e&&t.indexOf(e.name)<0;)e=e.parent;return e?{from:e.from,to:this.pos,text:this.state.sliceDoc(e.from,this.pos),type:e.type}:null}matchBefore(t){let e=this.state.doc.lineAt(this.pos),i=Math.max(e.from,this.pos-250),n=e.text.slice(i-e.from,this.pos-e.from),r=n.search(mA(t,!1));return r<0?null:{from:i+r,to:this.pos,text:n.slice(r)}}get aborted(){return null==this.abortListeners}addEventListener(t,e){"abort"==t&&this.abortListeners&&this.abortListeners.push(e)}}function fA(t){let e=Object.keys(t).join(""),i=/\w/.test(e);return i&&(e=e.replace(/\w/g,"")),`[${i?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function dA(t){let e=t.map((t=>"string"==typeof t?{label:t}:t)),[i,n]=e.every((t=>/^\w+$/.test(t.label)))?[/\w*$/,/\w+$/]:function(t){let e=Object.create(null),i=Object.create(null);for(let{label:n}of t){e[n[0]]=!0;for(let t=1;t<n.length;t++)i[n[t]]=!0}let n=fA(e)+fA(i)+"*$";return[new RegExp("^"+n),new RegExp(n)]}(e);return t=>{let r=t.matchBefore(n);return r||t.explicit?{from:r?r.from:t.pos,options:e,validFor:i}:null}}class pA{constructor(t,e,i){this.completion=t,this.source=e,this.match=i}}function gA(t){return t.selection.main.head}function mA(t,e){var i;let{source:n}=t,r=e&&"^"!=n[0],s="$"!=n[n.length-1];return r||s?new RegExp(`${r?"^":""}(?:${n})${s?"$":""}`,null!==(i=t.flags)&&void 0!==i?i:t.ignoreCase?"i":""):t}function bA(t,e){const i=e.completion.apply||e.completion.label;let n=e.source;"string"==typeof i?t.dispatch(function(t,e,i,n){return Object.assign(Object.assign({},t.changeByRange((r=>{if(r==t.selection.main)return{changes:{from:i,to:n,insert:e},range:py.cursor(i+e.length)};let s=n-i;return!r.empty||s&&t.sliceDoc(r.from-s,r.from)!=t.sliceDoc(i,n)?{range:r}:{changes:{from:r.from-s,to:r.from,insert:e},range:py.cursor(r.from-s+e.length)}}))),{userEvent:"input.complete"})}(t.state,i,n.from,n.to)):i(t,e.completion,n.from,n.to)}const OA=new WeakMap;function vA(t){if(!Array.isArray(t))return t;let e=OA.get(t);return e||OA.set(t,e=dA(t)),e}class wA{constructor(t){this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(let e=0;e<t.length;){let i=ty(t,e),n=iy(i);this.chars.push(i);let r=t.slice(e,e+n),s=r.toUpperCase();this.folded.push(ty(s==r?r.toLowerCase():s,0)),e+=n}this.astral=t.length!=this.chars.length}match(t){if(0==this.pattern.length)return[0];if(t.length<this.pattern.length)return null;let{chars:e,folded:i,any:n,precise:r,byWord:s}=this;if(1==e.length){let n=ty(t,0);return n==e[0]?[0,0,iy(n)]:n==i[0]?[-200,0,iy(n)]:null}let o=t.indexOf(this.pattern);if(0==o)return[0,0,this.pattern.length];let l=e.length,a=0;if(o<0){for(let r=0,s=Math.min(t.length,200);r<s&&a<l;){let s=ty(t,r);s!=e[a]&&s!=i[a]||(n[a++]=r),r+=iy(s)}if(a<l)return null}let h=0,c=0,u=!1,f=0,d=-1,p=-1,g=/[a-z]/.test(t),m=!0;for(let n=0,a=Math.min(t.length,200),b=0;n<a&&c<l;){let a=ty(t,n);o<0&&(h<l&&a==e[h]&&(r[h++]=n),f<l&&(a==e[f]||a==i[f]?(0==f&&(d=n),p=n+1,f++):f=0));let O,v=a<255?a>=48&&a<=57||a>=97&&a<=122?2:a>=65&&a<=90?1:0:(O=ey(a))!=O.toLowerCase()?1:O!=O.toUpperCase()?2:0;(!n||1==v&&g||0==b&&0!=v)&&(e[c]==a||i[c]==a&&(u=!0)?s[c++]=n:s.length&&(m=!1)),b=v,n+=iy(a)}return c==l&&0==s[0]&&m?this.result((u?-200:0)-100,s,t):f==l&&0==d?[-200-t.length,0,p]:o>-1?[-700-t.length,o,o+this.pattern.length]:f==l?[-900-t.length,d,p]:c==l?this.result((u?-200:0)-100-700+(m?0:-1100),s,t):2==e.length?null:this.result((n[0]?-700:0)-200-1100,n,t)}result(t,e,i){let n=[t-i.length],r=1;for(let t of e){let e=t+(this.astral?iy(ty(i,t)):1);r>1&&n[r-1]==t?n[r-1]=e:(n[r++]=t,n[r++]=e)}return n}}const yA=by.define({combine:t=>function(t,e,i={}){let n={};for(let e of t)for(let t of Object.keys(e)){let r=e[t],s=n[t];if(void 0===s)n[t]=r;else if(s===r||void 0===r);else{if(!Object.hasOwnProperty.call(i,t))throw new Error("Config merge conflict for field "+t);n[t]=i[t](s,r)}}for(let t in e)void 0===n[t]&&(n[t]=e[t]);return n}(t,{activateOnTyping:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[]},{defaultKeymap:(t,e)=>t&&e,closeOnBlur:(t,e)=>t&&e,icons:(t,e)=>t&&e,optionClass:(t,e)=>i=>function(t,e){return t?e?t+" "+e:t:e}(t(i),e(i)),addToOptions:(t,e)=>t.concat(e)})});function xA(t,e,i){if(t<=i)return{from:0,to:t};if(e<=t>>1){let t=Math.floor(e/i);return{from:t*i,to:(t+1)*i}}let n=Math.floor((t-e)/i);return{from:t-(n+1)*i,to:t-n*i}}class kA{constructor(t,e){this.view=t,this.stateField=e,this.info=null,this.placeInfo={read:()=>this.measureInfo(),write:t=>this.positionInfo(t),key:this};let i=t.state.field(e),{options:n,selected:r}=i.open,s=t.state.facet(yA);this.optionContent=function(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(t){let e=document.createElement("div");return e.classList.add("cm-completionIcon"),t.type&&e.classList.add(...t.type.split(/\s+/g).map((t=>"cm-completionIcon-"+t))),e.setAttribute("aria-hidden","true"),e},position:20}),e.push({render(t,e,i){let n=document.createElement("span");n.className="cm-completionLabel";let{label:r}=t,s=0;for(let t=1;t<i.length;){let e=i[t++],o=i[t++];e>s&&n.appendChild(document.createTextNode(r.slice(s,e)));let l=n.appendChild(document.createElement("span"));l.appendChild(document.createTextNode(r.slice(e,o))),l.className="cm-completionMatchedText",s=o}return s<r.length&&n.appendChild(document.createTextNode(r.slice(s))),n},position:50},{render(t){if(!t.detail)return null;let e=document.createElement("span");return e.className="cm-completionDetail",e.textContent=t.detail,e},position:80}),e.sort(((t,e)=>t.position-e.position)).map((t=>t.render))}(s),this.optionClass=s.optionClass,this.range=xA(n.length,r,s.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.dom.addEventListener("mousedown",(e=>{for(let i,r=e.target;r&&r!=this.dom;r=r.parentNode)if("LI"==r.nodeName&&(i=/-(\d+)$/.exec(r.id))&&+i[1]<n.length)return bA(t,n[+i[1]]),void e.preventDefault()})),this.list=this.dom.appendChild(this.createListBox(n,i.id,this.range)),this.list.addEventListener("scroll",(()=>{this.info&&this.view.requestMeasure(this.placeInfo)}))}mount(){this.updateSel()}update(t){t.state.field(this.stateField)!=t.startState.field(this.stateField)&&this.updateSel()}positioned(){this.info&&this.view.requestMeasure(this.placeInfo)}updateSel(){let t=this.view.state.field(this.stateField),e=t.open;if((e.selected<this.range.from||e.selected>=this.range.to)&&(this.range=xA(e.options.length,e.selected,this.view.state.facet(yA).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e.options,t.id,this.range)),this.list.addEventListener("scroll",(()=>{this.info&&this.view.requestMeasure(this.placeInfo)}))),this.updateSelectedOption(e.selected)){this.info&&(this.info.remove(),this.info=null);let{completion:i}=e.options[e.selected],{info:n}=i;if(!n)return;let r="string"==typeof n?document.createTextNode(n):n(i);if(!r)return;"then"in r?r.then((e=>{e&&this.view.state.field(this.stateField,!1)==t&&this.addInfoPane(e)})).catch((t=>Wk(this.view.state,t,"completion info"))):this.addInfoPane(r)}}addInfoPane(t){let e=this.info=document.createElement("div");e.className="cm-tooltip cm-completionInfo",e.appendChild(t),this.dom.appendChild(e),this.view.requestMeasure(this.placeInfo)}updateSelectedOption(t){let e=null;for(let i=this.list.firstChild,n=this.range.from;i;i=i.nextSibling,n++)n==t?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),e=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return e&&function(t,e){let i=t.getBoundingClientRect(),n=e.getBoundingClientRect();n.top<i.top?t.scrollTop-=i.top-n.top:n.bottom>i.bottom&&(t.scrollTop+=n.bottom-i.bottom)}(this.list,e),e}measureInfo(){let t=this.dom.querySelector("[aria-selected]");if(!t||!this.info)return null;let e=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),n=t.getBoundingClientRect();if(n.top>Math.min(innerHeight,e.bottom)-10||n.bottom<Math.max(0,e.top)+10)return null;let r=Math.max(0,Math.min(n.top,innerHeight-i.height))-e.top,s=this.view.textDirection==eS.RTL,o=e.left,l=innerWidth-e.right;return s&&o<Math.min(i.width,l)?s=!1:!s&&l<Math.min(i.width,o)&&(s=!0),{top:r,left:s}}positionInfo(t){this.info&&(this.info.style.top=(t?t.top:-1e6)+"px",t&&(this.info.classList.toggle("cm-completionInfo-left",t.left),this.info.classList.toggle("cm-completionInfo-right",!t.left)))}createListBox(t,e,i){const n=document.createElement("ul");n.id=e,n.setAttribute("role","listbox"),n.setAttribute("aria-expanded","true"),n.setAttribute("aria-label",this.view.state.phrase("Completions"));for(let r=i.from;r<i.to;r++){let{completion:i,match:s}=t[r];const o=n.appendChild(document.createElement("li"));o.id=e+"-"+r,o.setAttribute("role","option");let l=this.optionClass(i);l&&(o.className=l);for(let t of this.optionContent){let e=t(i,this.view.state,s);e&&o.appendChild(e)}}return i.from&&n.classList.add("cm-completionListIncompleteTop"),i.to<t.length&&n.classList.add("cm-completionListIncompleteBottom"),n}}function SA(t){return 100*(t.boost||0)+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}class CA{constructor(t,e,i,n,r){this.options=t,this.attrs=e,this.tooltip=i,this.timestamp=n,this.selected=r}setSelected(t,e){return t==this.selected||t>=this.options.length?this:new CA(this.options,PA(e,t),this.tooltip,this.timestamp,t)}static build(t,e,i,n,r){let s=function(t,e){let i=[],n=0;for(let r of t)if(r.hasResult())if(!1===r.result.filter){let t=r.result.getMatch;for(let e of r.result.options){let s=[1e9-n++];if(t)for(let i of t(e))s.push(i);i.push(new pA(e,r,s))}}else{let t,n=new wA(e.sliceDoc(r.from,r.to));for(let e of r.result.options)(t=n.match(e.label))&&(null!=e.boost&&(t[0]+=e.boost),i.push(new pA(e,r,t)))}let r=[],s=null;for(let t of i.sort(QA))!s||s.label!=t.completion.label||s.detail!=t.completion.detail||null!=s.type&&null!=t.completion.type&&s.type!=t.completion.type||s.apply!=t.completion.apply?r.push(t):SA(t.completion)>SA(s)&&(r[r.length-1]=t),s=t.completion;return r}(t,e);if(!s.length)return null;let o=0;if(n&&n.selected){let t=n.options[n.selected].completion;for(let e=0;e<s.length;e++)if(s[e].completion==t){o=e;break}}return new CA(s,PA(i,o),{pos:t.reduce(((t,e)=>e.hasResult()?Math.min(t,e.from):t),1e8),create:(l=IA,t=>new kA(t,l)),above:r.aboveCursor},n?n.timestamp:Date.now(),o);var l}map(t){return new CA(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:t.mapPos(this.tooltip.pos)}),this.timestamp,this.selected)}}class AA{constructor(t,e,i){this.active=t,this.id=e,this.open=i}static start(){return new AA(MA,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(t){let{state:e}=t,i=e.facet(yA),n=(i.override||e.languageDataAt("autocomplete",gA(e)).map(vA)).map((e=>(this.active.find((t=>t.source==e))||new $A(e,this.active.some((t=>0!=t.state))?1:0)).update(t,i)));n.length==this.active.length&&n.every(((t,e)=>t==this.active[e]))&&(n=this.active);let r=t.selection||n.some((e=>e.hasResult()&&t.changes.touchesRange(e.from,e.to)))||!function(t,e){if(t==e)return!0;for(let i=0,n=0;;){for(;i<t.length&&!t[i].hasResult;)i++;for(;n<e.length&&!e[n].hasResult;)n++;let r=i==t.length,s=n==e.length;if(r||s)return r==s;if(t[i++].result!=e[n++].result)return!1}}(n,this.active)?CA.build(n,e,this.id,this.open,i):this.open&&t.docChanged?this.open.map(t.changes):this.open;!r&&n.every((t=>1!=t.state))&&n.some((t=>t.hasResult()))&&(n=n.map((t=>t.hasResult()?new $A(t.source,0):t)));for(let e of t.effects)e.is(BA)&&(r=r&&r.setSelected(e.value,this.id));return n==this.active&&r==this.open?this:new AA(n,this.id,r)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:TA}}const TA={"aria-autocomplete":"list"};function PA(t,e){return{"aria-autocomplete":"list","aria-haspopup":"listbox","aria-activedescendant":t+"-"+e,"aria-controls":t}}const MA=[];function QA(t,e){let i=e.match[0]-t.match[0];return i||t.completion.label.localeCompare(e.completion.label)}function RA(t){return t.isUserEvent("input.type")?"input":t.isUserEvent("delete.backward")?"delete":null}class $A{constructor(t,e,i=-1){this.source=t,this.state=e,this.explicitPos=i}hasResult(){return!1}update(t,e){let i=RA(t),n=this;i?n=n.handleUserEvent(t,i,e):t.docChanged?n=n.handleChange(t):t.selection&&0!=n.state&&(n=new $A(n.source,0));for(let e of t.effects)if(e.is(DA))n=new $A(n.source,1,e.value?gA(t.state):-1);else if(e.is(EA))n=new $A(n.source,0);else if(e.is(NA))for(let t of e.value)t.source==n.source&&(n=t);return n}handleUserEvent(t,e,i){return"delete"!=e&&i.activateOnTyping?new $A(this.source,1):this.map(t.changes)}handleChange(t){return t.changes.touchesRange(gA(t.startState))?new $A(this.source,0):this.map(t.changes)}map(t){return t.empty||this.explicitPos<0?this:new $A(this.source,this.state,t.mapPos(this.explicitPos))}}class _A extends $A{constructor(t,e,i,n,r){super(t,2,e),this.result=i,this.from=n,this.to=r}hasResult(){return!0}handleUserEvent(t,e,i){var n;let r=t.changes.mapPos(this.from),s=t.changes.mapPos(this.to,1),o=gA(t.state);if((this.explicitPos<0?o<=r:o<this.from)||o>s||"delete"==e&&gA(t.startState)==this.from)return new $A(this.source,"input"==e&&i.activateOnTyping?1:0);let l,a=this.explicitPos<0?-1:t.changes.mapPos(this.explicitPos);return function(t,e,i,n){if(!t)return!1;let r=e.sliceDoc(i,n);return"function"==typeof t?t(r,i,n,e):mA(t,!0).test(r)}(this.result.validFor,t.state,r,s)?new _A(this.source,a,this.result,r,s):this.result.update&&(l=this.result.update(this.result,r,s,new uA(t.state,o,a>=0)))?new _A(this.source,a,l,l.from,null!==(n=l.to)&&void 0!==n?n:gA(t.state)):new $A(this.source,1,a)}handleChange(t){return t.changes.touchesRange(this.from,this.to)?new $A(this.source,0):this.map(t.changes)}map(t){return t.empty?this:new _A(this.source,this.explicitPos<0?-1:t.mapPos(this.explicitPos),this.result,t.mapPos(this.from),t.mapPos(this.to,1))}}const DA=Fy.define(),EA=Fy.define(),NA=Fy.define({map:(t,e)=>t.map((t=>t.map(e)))}),BA=Fy.define(),IA=Sy.define({create:()=>AA.start(),update:(t,e)=>t.update(e),provide:t=>[hA.from(t,(t=>t.tooltip)),XC.contentAttributes.from(t,(t=>t.attrs))]});function zA(t,e="option"){return i=>{let n=i.state.field(IA,!1);if(!n||!n.open||Date.now()-n.open.timestamp<75)return!1;let r,s=1;"page"==e&&(r=function(t,e){let i=t.plugin(lA);if(!i)return null;let n=i.manager.tooltips.indexOf(e);return n<0?null:i.manager.tooltipViews[n]}(i,n.open.tooltip))&&(s=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1));let o=n.open.selected+s*(t?1:-1),{length:l}=n.open.options;return o<0?o="page"==e?0:l-1:o>=l&&(o="page"==e?l-1:0),i.dispatch({effects:BA.of(o)}),!0}}class LA{constructor(t,e){this.active=t,this.context=e,this.time=Date.now(),this.updates=[],this.done=void 0}}const WA=Hk.fromClass(class{constructor(t){this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let e of t.state.field(IA).active)1==e.state&&this.startQuery(e)}update(t){let e=t.state.field(IA);if(!t.selectionSet&&!t.docChanged&&t.startState.field(IA)==e)return;let i=t.transactions.some((t=>(t.selection||t.docChanged)&&!RA(t)));for(let e=0;e<this.running.length;e++){let n=this.running[e];if(i||n.updates.length+t.transactions.length>50&&Date.now()-n.time>1e3){for(let t of n.context.abortListeners)try{t()}catch(t){Wk(this.view.state,t)}n.context.abortListeners=null,this.running.splice(e--,1)}else n.updates.push(...t.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=e.active.some((t=>1==t.state&&!this.running.some((e=>e.active.source==t.source))))?setTimeout((()=>this.startUpdate()),50):-1,0!=this.composing)for(let e of t.transactions)"input"==RA(e)?this.composing=2:2==this.composing&&e.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:t}=this.view,e=t.field(IA);for(let t of e.active)1!=t.state||this.running.some((e=>e.active.source==t.source))||this.startQuery(t)}startQuery(t){let{state:e}=this.view,i=gA(e),n=new uA(e,i,t.explicitPos==i),r=new LA(t,n);this.running.push(r),Promise.resolve(t.source(n)).then((t=>{r.context.aborted||(r.done=t||null,this.scheduleAccept())}),(t=>{this.view.dispatch({effects:EA.of(null)}),Wk(this.view.state,t)}))}scheduleAccept(){this.running.every((t=>void 0!==t.done))?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout((()=>this.accept()),50))}accept(){var t;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],i=this.view.state.facet(yA);for(let n=0;n<this.running.length;n++){let r=this.running[n];if(void 0===r.done)continue;if(this.running.splice(n--,1),r.done){let n=new _A(r.active.source,r.active.explicitPos,r.done,r.done.from,null!==(t=r.done.to)&&void 0!==t?t:gA(r.updates.length?r.updates[0].startState:this.view.state));for(let t of r.updates)n=n.update(t,i);if(n.hasResult()){e.push(n);continue}}let s=this.view.state.field(IA).active.find((t=>t.source==r.active.source));if(s&&1==s.state)if(null==r.done){let t=new $A(r.active.source,0);for(let e of r.updates)t=t.update(e,i);1!=t.state&&e.push(t)}else this.startQuery(s)}e.length&&this.view.dispatch({effects:NA.of(e)})}},{eventHandlers:{blur(){let t=this.view.state.field(IA,!1);t&&t.tooltip&&this.view.state.facet(yA).closeOnBlur&&this.view.dispatch({effects:EA.of(null)})},compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout((()=>this.view.dispatch({effects:DA.of(!1)})),20),this.composing=0}}}),VA=XC.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"300px"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),jA={brackets:["(","[","{","'",'"'],before:")]}:;>"},qA=Fy.define({map(t,e){let i=e.mapPos(t,-1,ry.TrackAfter);return null==i?void 0:i}}),HA=Fy.define({map:(t,e)=>e.mapPos(t)}),XA=new class extends ox{};XA.startSide=1,XA.endSide=-1;const FA=Sy.define({create:()=>cx.empty,update(t,e){if(e.selection){let i=e.state.doc.lineAt(e.selection.main.head).from,n=e.startState.doc.lineAt(e.startState.selection.main.head).from;i!=e.changes.mapPos(n,-1)&&(t=cx.empty)}t=t.map(e.changes);for(let i of e.effects)i.is(qA)?t=t.update({add:[XA.range(i.value,i.value+1)]}):i.is(HA)&&(t=t.update({filter:t=>t!=i.value}));return t}});function ZA(){return[JA,FA]}const GA="()[]{}<>";function UA(t){for(let e=0;e<GA.length;e+=2)if(GA.charCodeAt(e)==t)return GA.charAt(e+1);return ey(t<128?t:t+1)}function YA(t,e){return t.languageDataAt("closeBrackets",e)[0]||jA}const KA="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),JA=XC.inputHandler.of(((t,e,i,n)=>{if((KA?t.composing:t.compositionStarted)||t.state.readOnly)return!1;let r=t.state.selection.main;if(n.length>2||2==n.length&&1==iy(ty(n,0))||e!=r.from||i!=r.to)return!1;let s=function(t,e){let i=YA(t,t.selection.main.head),n=i.brackets||jA.brackets;for(let r of n){let s=UA(ty(r,0));if(e==r)return s==r?sT(t,r,n.indexOf(r+r+r)>-1):nT(t,r,s,i.before||jA.before);if(e==s&&eT(t,t.selection.main.from))return rT(t,r,s)}return null}(t.state,n);return!!s&&(t.dispatch(s),!0)})),tT=[{key:"Backspace",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=YA(t,t.selection.main.head).brackets||jA.brackets,n=null,r=t.changeByRange((e=>{if(e.empty){let n=function(t,e){let i=t.sliceString(e-2,e);return iy(ty(i,0))==i.length?i:i.slice(1)}(t.doc,e.head);for(let r of i)if(r==n&&iT(t.doc,e.head)==UA(ty(r,0)))return{changes:{from:e.head-r.length,to:e.head+r.length},range:py.cursor(e.head-r.length),userEvent:"delete.backward"}}return{range:n=e}}));return n||e(t.update(r,{scrollIntoView:!0})),!n}}];function eT(t,e){let i=!1;return t.field(FA).between(0,t.doc.length,(t=>{t==e&&(i=!0)})),i}function iT(t,e){let i=t.sliceString(e,e+2);return i.slice(0,iy(ty(i,0)))}function nT(t,e,i,n){let r=null,s=t.changeByRange((s=>{if(!s.empty)return{changes:[{insert:e,from:s.from},{insert:i,from:s.to}],effects:qA.of(s.to+e.length),range:py.range(s.anchor+e.length,s.head+e.length)};let o=iT(t.doc,s.head);return!o||/\s/.test(o)||n.indexOf(o)>-1?{changes:{insert:e+i,from:s.head},effects:qA.of(s.head+e.length),range:py.cursor(s.head+e.length)}:{range:r=s}}));return r?null:t.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function rT(t,e,i){let n=null,r=t.selection.ranges.map((e=>e.empty&&iT(t.doc,e.head)==i?py.cursor(e.head+i.length):n=e));return n?null:t.update({selection:py.create(r,t.selection.mainIndex),scrollIntoView:!0,effects:t.selection.ranges.map((({from:t})=>HA.of(t)))})}function sT(t,e,i){let n=null,r=t.changeByRange((r=>{if(!r.empty)return{changes:[{insert:e,from:r.from},{insert:e,from:r.to}],effects:qA.of(r.to+e.length),range:py.range(r.anchor+e.length,r.head+e.length)};let s=r.head,o=iT(t.doc,s);if(o==e){if(oT(t,s))return{changes:{insert:e+e,from:s},effects:qA.of(s+e.length),range:py.cursor(s+e.length)};if(eT(t,s)){let n=i&&t.sliceDoc(s,s+3*e.length)==e+e+e;return{range:py.cursor(s+e.length*(n?3:1)),effects:HA.of(s)}}}else{if(i&&t.sliceDoc(s-2*e.length,s)==e+e&&oT(t,s-2*e.length))return{changes:{insert:e+e+e+e,from:s},effects:qA.of(s+e.length),range:py.cursor(s+e.length)};if(t.charCategorizer(s)(o)!=ex.Word){let i=t.sliceDoc(s-1,s);if(i!=e&&t.charCategorizer(s)(i)!=ex.Word&&!function(t,e,i){let n=KO(t).resolveInner(e,-1);for(let r=0;r<5;r++){if(t.sliceDoc(n.from,n.from+i.length)==i)return!0;let r=n.to==e&&n.parent;if(!r)break;n=r}return!1}(t,s,e))return{changes:{insert:e+e,from:s},effects:qA.of(s+e.length),range:py.cursor(s+e.length)}}}return{range:n=r}}));return n?null:t.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function oT(t,e){let i=KO(t).resolveInner(e+1);return i.parent&&i.from==e}function lT(t={}){return[IA,yA.of(t),WA,hT,VA]}const aT=[{key:"Ctrl-Space",run:t=>!!t.state.field(IA,!1)&&(t.dispatch({effects:DA.of(!0)}),!0)},{key:"Escape",run:t=>{let e=t.state.field(IA,!1);return!(!e||!e.active.some((t=>0!=t.state)))&&(t.dispatch({effects:EA.of(null)}),!0)}},{key:"ArrowDown",run:zA(!0)},{key:"ArrowUp",run:zA(!1)},{key:"PageDown",run:zA(!0,"page")},{key:"PageUp",run:zA(!1,"page")},{key:"Enter",run:t=>{let e=t.state.field(IA,!1);return!(t.state.readOnly||!e||!e.open||Date.now()-e.open.timestamp<75)&&(bA(t,e.open.options[e.open.selected]),!0)}}],hT=Qy.highest(tA.computeN([yA],(t=>t.facet(yA).defaultKeymap?[aT]:[])));class cT{constructor(){}lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,i){let n=[];return this.decompose(0,t,n,2),i.length&&i.decompose(0,i.length,n,3),this.decompose(e,this.length,n,1),fT.from(n,this.length-(e-t)+i.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){let i=[];return this.decompose(t,e,i,0),fT.from(i,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),i=this.length-this.scanIdentical(t,-1),n=new gT(this),r=new gT(t);for(let t=e,s=e;;){if(n.next(t),r.next(t),t=0,n.lineBreak!=r.lineBreak||n.done!=r.done||n.value!=r.value)return!1;if(s+=n.value.length,n.done||s>=i)return!0}}iter(t=1){return new gT(this,t)}iterRange(t,e=this.length){return new mT(this,t,e)}iterLines(t,e){let i;if(null==t)i=this.iter();else{null==e&&(e=this.lines+1);let n=this.line(t).from;i=this.iterRange(n,Math.max(n,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new bT(i)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}static of(t){if(0==t.length)throw new RangeError("A document must have at least one line");return 1!=t.length||t[0]?t.length<=32?new uT(t):fT.from(uT.split(t,[])):cT.empty}}class uT extends cT{constructor(t,e=function(t){let e=-1;for(let i of t)e+=i.length+1;return e}(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,i,n){for(let r=0;;r++){let s=this.text[r],o=n+s.length;if((e?i:o)>=t)return new OT(n,o,i,s);n=o+1,i++}}decompose(t,e,i,n){let r=t<=0&&e>=this.length?this:new uT(pT(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(1&n){let t=i.pop(),e=dT(r.text,t.text.slice(),0,r.length);if(e.length<=32)i.push(new uT(e,t.length+r.length));else{let t=e.length>>1;i.push(new uT(e.slice(0,t)),new uT(e.slice(t)))}}else i.push(r)}replace(t,e,i){if(!(i instanceof uT))return super.replace(t,e,i);let n=dT(this.text,dT(i.text,pT(this.text,0,t)),e),r=this.length+i.length-(e-t);return n.length<=32?new uT(n,r):fT.from(uT.split(n,[]),r)}sliceString(t,e=this.length,i="\n"){let n="";for(let r=0,s=0;r<=e&&s<this.text.length;s++){let o=this.text[s],l=r+o.length;r>t&&s&&(n+=i),t<l&&e>r&&(n+=o.slice(Math.max(0,t-r),e-r)),r=l+1}return n}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let i=[],n=-1;for(let r of t)i.push(r),n+=r.length+1,32==i.length&&(e.push(new uT(i,n)),i=[],n=-1);return n>-1&&e.push(new uT(i,n)),e}}class fT extends cT{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let e of t)this.lines+=e.lines}lineInner(t,e,i,n){for(let r=0;;r++){let s=this.children[r],o=n+s.length,l=i+s.lines-1;if((e?l:o)>=t)return s.lineInner(t,e,i,n);n=o+1,i=l+1}}decompose(t,e,i,n){for(let r=0,s=0;s<=e&&r<this.children.length;r++){let o=this.children[r],l=s+o.length;if(t<=l&&e>=s){let r=n&((s<=t?1:0)|(l>=e?2:0));s>=t&&l<=e&&!r?i.push(o):o.decompose(t-s,e-s,i,r)}s=l+1}}replace(t,e,i){if(i.lines<this.lines)for(let n=0,r=0;n<this.children.length;n++){let s=this.children[n],o=r+s.length;if(t>=r&&e<=o){let l=s.replace(t-r,e-r,i),a=this.lines-s.lines+l.lines;if(l.lines<a>>4&&l.lines>a>>6){let r=this.children.slice();return r[n]=l,new fT(r,this.length-(e-t)+i.length)}return super.replace(r,o,l)}r=o+1}return super.replace(t,e,i)}sliceString(t,e=this.length,i="\n"){let n="";for(let r=0,s=0;r<this.children.length&&s<=e;r++){let o=this.children[r],l=s+o.length;s>t&&r&&(n+=i),t<l&&e>s&&(n+=o.sliceString(t-s,e-s,i)),s=l+1}return n}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof fT))return 0;let i=0,[n,r,s,o]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;n+=e,r+=e){if(n==s||r==o)return i;let l=this.children[n],a=t.children[r];if(l!=a)return i+l.scanIdentical(a,e);i+=l.length+1}}static from(t,e=t.reduce(((t,e)=>t+e.length+1),-1)){let i=0;for(let e of t)i+=e.lines;if(i<32){let i=[];for(let e of t)e.flatten(i);return new uT(i,e)}let n=Math.max(32,i>>5),r=n<<1,s=n>>1,o=[],l=0,a=-1,h=[];function c(t){let e;if(t.lines>r&&t instanceof fT)for(let e of t.children)c(e);else t.lines>s&&(l>s||!l)?(u(),o.push(t)):t instanceof uT&&l&&(e=h[h.length-1])instanceof uT&&t.lines+e.lines<=32?(l+=t.lines,a+=t.length+1,h[h.length-1]=new uT(e.text.concat(t.text),e.length+1+t.length)):(l+t.lines>n&&u(),l+=t.lines,a+=t.length+1,h.push(t))}function u(){0!=l&&(o.push(1==h.length?h[0]:fT.from(h,a)),a=-1,l=h.length=0)}for(let e of t)c(e);return u(),1==o.length?o[0]:new fT(o,e)}}function dT(t,e,i=0,n=1e9){for(let r=0,s=0,o=!0;s<t.length&&r<=n;s++){let l=t[s],a=r+l.length;a>=i&&(a>n&&(l=l.slice(0,n-r)),r<i&&(l=l.slice(i-r)),o?(e[e.length-1]+=l,o=!1):e.push(l)),r=a+1}return e}function pT(t,e,i){return dT(t,[""],e,i)}cT.empty=new uT([""],0);class gT{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof uT?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,n=this.nodes[i],r=this.offsets[i],s=r>>1,o=n instanceof uT?n.text.length:n.children.length;if(s==(e>0?o:0)){if(0==i)return this.done=!0,this.value="",this;e>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&r)==(e>0?0:1)){if(this.offsets[i]+=e,0==t)return this.lineBreak=!0,this.value="\n",this;t--}else if(n instanceof uT){let r=n.text[s+(e<0?-1:0)];if(this.offsets[i]+=e,r.length>Math.max(0,t))return this.value=0==t?r:e>0?r.slice(t):r.slice(0,r.length-t),this;t-=r.length}else{let r=n.children[s+(e<0?-1:0)];t>r.length?(t-=r.length,this.offsets[i]+=e):(e<0&&this.offsets[i]--,this.nodes.push(r),this.offsets.push(e>0?1:(r instanceof uT?r.text.length:r.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class mT{constructor(t,e,i){this.value="",this.done=!1,this.cursor=new gT(t,e>i?-1:1),this.pos=e>i?t.length:0,this.from=Math.min(e,i),this.to=Math.max(e,i)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let i=e<0?this.pos-this.from:this.to-this.pos;t>i&&(t=i),i-=t;let{value:n}=this.cursor.next(t);return this.pos+=(n.length+t)*e,this.value=n.length<=i?n:e<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class bT{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:i,value:n}=this.inner.next(t);return e?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(cT.prototype[Symbol.iterator]=function(){return this.iter()},gT.prototype[Symbol.iterator]=mT.prototype[Symbol.iterator]=bT.prototype[Symbol.iterator]=function(){return this});class OT{constructor(t,e,i,n){this.from=t,this.to=e,this.number=i,this.text=n}get length(){return this.to-this.from}}let vT="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((t=>t?parseInt(t,36):1));for(let t=1;t<vT.length;t++)vT[t]+=vT[t-1];function wT(t){for(let e=1;e<vT.length;e+=2)if(vT[e]>t)return vT[e-1]<=t;return!1}function yT(t){return t>=127462&&t<=127487}function xT(t,e,i=!0,n=!0){return(i?kT:ST)(t,e,n)}function kT(t,e,i){if(e==t.length)return e;e&&CT(t.charCodeAt(e))&&AT(t.charCodeAt(e-1))&&e--;let n=TT(t,e);for(e+=PT(n);e<t.length;){let r=TT(t,e);if(8205==n||8205==r||i&&wT(r))e+=PT(r),n=r;else{if(!yT(r))break;{let i=0,n=e-2;for(;n>=0&&yT(TT(t,n));)i++,n-=2;if(i%2==0)break;e+=2}}}return e}function ST(t,e,i){for(;e>0;){let n=kT(t,e-2,i);if(n<e)return n;e--}return 0}function CT(t){return t>=56320&&t<57344}function AT(t){return t>=55296&&t<56320}function TT(t,e){let i=t.charCodeAt(e);if(!AT(i)||e+1==t.length)return i;let n=t.charCodeAt(e+1);return CT(n)?n-56320+(i-55296<<10)+65536:i}function PT(t){return t<65536?1:2}const MT=/\r\n?|\n/;var QT=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(QT||(QT={}));class RT{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e+1];t+=i<0?this.sections[e]:i}return t}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(t){for(let e=0,i=0,n=0;e<this.sections.length;){let r=this.sections[e++],s=this.sections[e++];s<0?(t(i,n,r),n+=r):n+=s,i+=r}}iterChangedRanges(t,e=!1){ET(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];n<0?t.push(i,n):t.push(n,i)}return new RT(t)}composeDesc(t){return this.empty?t:t.empty?this:BT(this,t)}mapDesc(t,e=!1){return t.empty?this:NT(this,t,e)}mapPos(t,e=-1,i=QT.Simple){let n=0,r=0;for(let s=0;s<this.sections.length;){let o=this.sections[s++],l=this.sections[s++],a=n+o;if(l<0){if(a>t)return r+(t-n);r+=o}else{if(i!=QT.Simple&&a>=t&&(i==QT.TrackDel&&n<t&&a>t||i==QT.TrackBefore&&n<t||i==QT.TrackAfter&&a>t))return null;if(a>t||a==t&&e<0&&!o)return t==n||e<0?r:r+l;r+=l}n=a}if(t>n)throw new RangeError(`Position ${t} is out of range for changeset of length ${n}`);return r}touchesRange(t,e=t){for(let i=0,n=0;i<this.sections.length&&n<=e;){let r=n+this.sections[i++];if(this.sections[i++]>=0&&n<=e&&r>=t)return!(n<t&&r>e)||"cover";n=r}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+i+(n>=0?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some((t=>"number"!=typeof t)))throw new RangeError("Invalid JSON representation of ChangeDesc");return new RT(t)}static create(t){return new RT(t)}}class $T extends RT{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return ET(this,((e,i,n,r,s)=>t=t.replace(n,n+(i-e),s)),!1),t}mapDesc(t,e=!1){return NT(this,t,e,!0)}invert(t){let e=this.sections.slice(),i=[];for(let n=0,r=0;n<e.length;n+=2){let s=e[n],o=e[n+1];if(o>=0){e[n]=o,e[n+1]=s;let l=n>>1;for(;i.length<l;)i.push(cT.empty);i.push(s?t.slice(r,r+s):cT.empty)}r+=s}return new $T(e,i)}compose(t){return this.empty?t:t.empty?this:BT(this,t,!0)}map(t,e=!1){return t.empty?this:NT(this,t,e,!0)}iterChanges(t,e=!1){ET(this,t,e)}get desc(){return RT.create(this.sections)}filter(t){let e=[],i=[],n=[],r=new IT(this);t:for(let s=0,o=0;;){let l=s==t.length?1e9:t[s++];for(;o<l||o==l&&0==r.len;){if(r.done)break t;let t=Math.min(r.len,l-o);_T(n,t,-1);let s=-1==r.ins?-1:0==r.off?r.ins:0;_T(e,t,s),s>0&&DT(i,e,r.text),r.forward(t),o+=t}let a=t[s++];for(;o<a;){if(r.done)break t;let t=Math.min(r.len,a-o);_T(e,t,-1),_T(n,t,-1==r.ins?-1:0==r.off?r.ins:0),r.forward(t),o+=t}}return{changes:new $T(e,i),filtered:RT.create(n)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e],n=this.sections[e+1];n<0?t.push(i):0==n?t.push([i]):t.push([i].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,i){let n=[],r=[],s=0,o=null;function l(t=!1){if(!t&&!n.length)return;s<e&&_T(n,e-s,-1);let i=new $T(n,r);o=o?o.compose(i.map(o)):i,n=[],r=[],s=0}return function t(a){if(Array.isArray(a))for(let e of a)t(e);else if(a instanceof $T){if(a.length!=e)throw new RangeError(`Mismatched change set length (got ${a.length}, expected ${e})`);l(),o=o?o.compose(a.map(o)):a}else{let{from:t,to:o=t,insert:h}=a;if(t>o||t<0||o>e)throw new RangeError(`Invalid change range ${t} to ${o} (in doc of length ${e})`);let c=h?"string"==typeof h?cT.of(h.split(i||MT)):h:cT.empty,u=c.length;if(t==o&&0==u)return;t<s&&l(),t>s&&_T(n,t-s,-1),_T(n,o-t,u),DT(r,n,c),s=o}}(t),l(!o),o}static empty(t){return new $T(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],i=[];for(let n=0;n<t.length;n++){let r=t[n];if("number"==typeof r)e.push(r,-1);else{if(!Array.isArray(r)||"number"!=typeof r[0]||r.some(((t,e)=>e&&"string"!=typeof t)))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==r.length)e.push(r[0],0);else{for(;i.length<n;)i.push(cT.empty);i[n]=cT.of(r.slice(1)),e.push(r[0],i[n].length)}}}return new $T(e,i)}static createSet(t,e){return new $T(t,e)}}function _T(t,e,i,n=!1){if(0==e&&i<=0)return;let r=t.length-2;r>=0&&i<=0&&i==t[r+1]?t[r]+=e:0==e&&0==t[r]?t[r+1]+=i:n?(t[r]+=e,t[r+1]+=i):t.push(e,i)}function DT(t,e,i){if(0==i.length)return;let n=e.length-2>>1;if(n<t.length)t[t.length-1]=t[t.length-1].append(i);else{for(;t.length<n;)t.push(cT.empty);t.push(i)}}function ET(t,e,i){let n=t.inserted;for(let r=0,s=0,o=0;o<t.sections.length;){let l=t.sections[o++],a=t.sections[o++];if(a<0)r+=l,s+=l;else{let h=r,c=s,u=cT.empty;for(;h+=l,c+=a,a&&n&&(u=u.append(n[o-2>>1])),!(i||o==t.sections.length||t.sections[o+1]<0);)l=t.sections[o++],a=t.sections[o++];e(r,h,s,c,u),r=h,s=c}}}function NT(t,e,i,n=!1){let r=[],s=n?[]:null,o=new IT(t),l=new IT(e);for(let t=0,e=0;;)if(-1==o.ins)t+=o.len,o.next();else if(-1==l.ins&&e<t){let i=Math.min(l.len,t-e);l.forward(i),_T(r,i,-1),e+=i}else if(l.ins>=0&&(o.done||e<t||e==t&&(l.len<o.len||l.len==o.len&&!i))){for(_T(r,l.ins,-1);t>e&&!o.done&&t+o.len<e+l.len;)t+=o.len,o.next();e+=l.len,l.next()}else{if(!(o.ins>=0)){if(o.done&&l.done)return s?$T.createSet(r,s):RT.create(r);throw new Error("Mismatched change set lengths")}{let i=0,n=t+o.len;for(;;)if(l.ins>=0&&e>t&&e+l.len<n)i+=l.ins,e+=l.len,l.next();else{if(!(-1==l.ins&&e<n))break;{let t=Math.min(l.len,n-e);i+=t,l.forward(t),e+=t}}_T(r,i,o.ins),s&&DT(s,r,o.text),t=n,o.next()}}}function BT(t,e,i=!1){let n=[],r=i?[]:null,s=new IT(t),o=new IT(e);for(let t=!1;;){if(s.done&&o.done)return r?$T.createSet(n,r):RT.create(n);if(0==s.ins)_T(n,s.len,0,t),s.next();else if(0!=o.len||o.done){if(s.done||o.done)throw new Error("Mismatched change set lengths");{let e=Math.min(s.len2,o.len),i=n.length;if(-1==s.ins){let i=-1==o.ins?-1:o.off?0:o.ins;_T(n,e,i,t),r&&i&&DT(r,n,o.text)}else-1==o.ins?(_T(n,s.off?0:s.len,e,t),r&&DT(r,n,s.textBit(e))):(_T(n,s.off?0:s.len,o.off?0:o.ins,t),r&&!o.off&&DT(r,n,o.text));t=(s.ins>e||o.ins>=0&&o.len>e)&&(t||n.length>i),s.forward2(e),o.forward(e)}}else _T(n,0,o.ins,t),r&&DT(r,n,o.text),o.next()}}class IT{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?cT.empty:t[e]}textBit(t){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length&&!t?cT.empty:e[i].slice(this.off,null==t?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){-1==this.ins?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class zT{constructor(t,e,i){this.from=t,this.to=e,this.flags=i}get anchor(){return 16&this.flags?this.to:this.from}get head(){return 16&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 4&this.flags?-1:8&this.flags?1:0}get bidiLevel(){let t=3&this.flags;return 3==t?null:t}get goalColumn(){let t=this.flags>>5;return 33554431==t?void 0:t}map(t,e=-1){let i,n;return this.empty?i=n=t.mapPos(this.from,e):(i=t.mapPos(this.from,1),n=t.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new zT(i,n,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return LT.range(t,e);let i=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return LT.range(this.anchor,i)}eq(t){return this.anchor==t.anchor&&this.head==t.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||"number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid JSON representation for SelectionRange");return LT.range(t.anchor,t.head)}static create(t,e,i){return new zT(t,e,i)}}class LT{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:LT.create(this.ranges.map((i=>i.map(t,e))),this.mainIndex)}eq(t){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let e=0;e<this.ranges.length;e++)if(!this.ranges[e].eq(t.ranges[e]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new LT([this.main],0)}addRange(t,e=!0){return LT.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let i=this.ranges.slice();return i[e]=t,LT.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map((t=>t.toJSON())),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||"number"!=typeof t.main||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new LT(t.ranges.map((t=>zT.fromJSON(t))),t.main)}static single(t,e=t){return new LT([LT.range(t,e)],0)}static create(t,e=0){if(0==t.length)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<t.length;n++){let r=t[n];if(r.empty?r.from<=i:r.from<i)return LT.normalized(t.slice(),e);i=r.to}return new LT(t,e)}static cursor(t,e=0,i,n){return zT.create(t,t,(0==e?0:e<0?4:8)|(null==i?3:Math.min(2,i))|(null!=n?n:33554431)<<5)}static range(t,e,i){let n=(null!=i?i:33554431)<<5;return e<t?zT.create(e,t,24|n):zT.create(t,e,n|(e>t?4:0))}static normalized(t,e=0){let i=t[e];t.sort(((t,e)=>t.from-e.from)),e=t.indexOf(i);for(let i=1;i<t.length;i++){let n=t[i],r=t[i-1];if(n.empty?n.from<=r.to:n.from<r.to){let s=r.from,o=Math.max(n.to,r.to);i<=e&&e--,t.splice(--i,2,n.anchor>n.head?LT.range(o,s):LT.range(s,o))}}return new LT(t,e)}}function WT(t,e){for(let i of t.ranges)if(i.to>e)throw new RangeError("Selection points outside of document")}let VT=0;class jT{constructor(t,e,i,n,r){this.combine=t,this.compareInput=e,this.compare=i,this.isStatic=n,this.extensions=r,this.id=VT++,this.default=t([])}static define(t={}){return new jT(t.combine||(t=>t),t.compareInput||((t,e)=>t===e),t.compare||(t.combine?(t,e)=>t===e:qT),!!t.static,t.enables)}of(t){return new HT([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new HT(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new HT(t,this,2,e)}from(t,e){return e||(e=t=>t),this.compute([t],(i=>e(i.field(t))))}}function qT(t,e){return t==e||t.length==e.length&&t.every(((t,i)=>t===e[i]))}class HT{constructor(t,e,i,n){this.dependencies=t,this.facet=e,this.type=i,this.value=n,this.id=VT++}dynamicSlot(t){var e;let i=this.value,n=this.facet.compareInput,r=this.id,s=t[r]>>1,o=2==this.type,l=!1,a=!1,h=[];for(let i of this.dependencies)"doc"==i?l=!0:"selection"==i?a=!0:0==(1&(null!==(e=t[i.id])&&void 0!==e?e:1))&&h.push(t[i.id]);return{create:t=>(t.values[s]=i(t),1),update(t,e){if(l&&e.docChanged||a&&(e.docChanged||e.selection)||FT(t,h)){let e=i(t);if(o?!XT(e,t.values[s],n):!n(e,t.values[s]))return t.values[s]=e,1}return 0},reconfigure:(t,e)=>{let l=i(t),a=e.config.address[r];if(null!=a){let i=aP(e,a);if(this.dependencies.every((i=>i instanceof jT?e.facet(i)===t.facet(i):!(i instanceof UT)||e.field(i,!1)==t.field(i,!1)))||(o?XT(l,i,n):n(l,i)))return t.values[s]=i,0}return t.values[s]=l,1}}}}function XT(t,e,i){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1;return!0}function FT(t,e){let i=!1;for(let n of e)1&lP(t,n)&&(i=!0);return i}function ZT(t,e,i){let n=i.map((e=>t[e.id])),r=i.map((t=>t.type)),s=n.filter((t=>!(1&t))),o=t[e.id]>>1;function l(t){let i=[];for(let e=0;e<n.length;e++){let s=aP(t,n[e]);if(2==r[e])for(let t of s)i.push(t);else i.push(s)}return e.combine(i)}return{create(t){for(let e of n)lP(t,e);return t.values[o]=l(t),1},update(t,i){if(!FT(t,s))return 0;let n=l(t);return e.compare(n,t.values[o])?0:(t.values[o]=n,1)},reconfigure(t,r){let s=FT(t,n),a=r.config.facets[e.id],h=r.facet(e);if(a&&!s&&qT(i,a))return t.values[o]=h,0;let c=l(t);return e.compare(c,h)?(t.values[o]=h,0):(t.values[o]=c,1)}}}const GT=jT.define({static:!0});class UT{constructor(t,e,i,n,r){this.id=t,this.createF=e,this.updateF=i,this.compareF=n,this.spec=r,this.provides=void 0}static define(t){let e=new UT(VT++,t.create,t.update,t.compare||((t,e)=>t===e),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(GT).find((t=>t.field==this));return((null==e?void 0:e.create)||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:t=>(t.values[e]=this.create(t),1),update:(t,i)=>{let n=t.values[e],r=this.updateF(n,i);return this.compareF(n,r)?0:(t.values[e]=r,1)},reconfigure:(t,i)=>null!=i.config.address[this.id]?(t.values[e]=i.field(this),0):(t.values[e]=this.create(t),1)}}init(t){return[this,GT.of({field:this,create:t})]}get extension(){return this}}const YT=4,KT=3,JT=2,tP=1;function eP(t){return e=>new nP(e,t)}const iP={highest:eP(0),high:eP(tP),default:eP(JT),low:eP(KT),lowest:eP(YT)};class nP{constructor(t,e){this.inner=t,this.prec=e}}class rP{of(t){return new sP(this,t)}reconfigure(t){return rP.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class sP{constructor(t,e){this.compartment=t,this.inner=e}}class oP{constructor(t,e,i,n,r,s){for(this.base=t,this.compartments=e,this.dynamicSlots=i,this.address=n,this.staticValues=r,this.facets=s,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return null==e?t.default:this.staticValues[e>>1]}static resolve(t,e,i){let n=[],r=Object.create(null),s=new Map;for(let i of function(t,e,i){let n=[[],[],[],[],[]],r=new Map;function s(t,o){let l=r.get(t);if(null!=l){if(l<=o)return;let e=n[l].indexOf(t);e>-1&&n[l].splice(e,1),t instanceof sP&&i.delete(t.compartment)}if(r.set(t,o),Array.isArray(t))for(let e of t)s(e,o);else if(t instanceof sP){if(i.has(t.compartment))throw new RangeError("Duplicate use of compartment in extensions");let n=e.get(t.compartment)||t.inner;i.set(t.compartment,n),s(n,o)}else if(t instanceof nP)s(t.inner,t.prec);else if(t instanceof UT)n[o].push(t),t.provides&&s(t.provides,o);else if(t instanceof HT)n[o].push(t),t.facet.extensions&&s(t.facet.extensions,o);else{let e=t.extension;if(!e)throw new Error(`Unrecognized extension value in extension set (${t}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(e,o)}}return s(t,JT),n.reduce(((t,e)=>t.concat(e)))}(t,e,s))i instanceof UT?n.push(i):(r[i.facet.id]||(r[i.facet.id]=[])).push(i);let o=Object.create(null),l=[],a=[];for(let t of n)o[t.id]=a.length<<1,a.push((e=>t.slot(e)));let h=null==i?void 0:i.config.facets;for(let t in r){let e=r[t],n=e[0].facet,s=h&&h[t]||[];if(e.every((t=>0==t.type)))if(o[n.id]=l.length<<1|1,qT(s,e))l.push(i.facet(n));else{let t=n.combine(e.map((t=>t.value)));l.push(i&&n.compare(t,i.facet(n))?i.facet(n):t)}else{for(let t of e)0==t.type?(o[t.id]=l.length<<1|1,l.push(t.value)):(o[t.id]=a.length<<1,a.push((e=>t.dynamicSlot(e))));o[n.id]=a.length<<1,a.push((t=>ZT(t,n,e)))}}let c=a.map((t=>t(o)));return new oP(t,s,c,o,l,r)}}function lP(t,e){if(1&e)return 2;let i=e>>1,n=t.status[i];if(4==n)throw new Error("Cyclic dependency between fields and/or facets");if(2&n)return n;t.status[i]=4;let r=t.computeSlot(t,t.config.dynamicSlots[i]);return t.status[i]=2|r}function aP(t,e){return 1&e?t.config.staticValues[e>>1]:t.values[e>>1]}const hP=jT.define(),cP=jT.define({combine:t=>t.some((t=>t)),static:!0}),uP=jT.define({combine:t=>t.length?t[0]:void 0,static:!0}),fP=jT.define(),dP=jT.define(),pP=jT.define(),gP=jT.define({combine:t=>!!t.length&&t[0]});class mP{constructor(t,e){this.type=t,this.value=e}static define(){return new bP}}class bP{of(t){return new mP(this,t)}}class OP{constructor(t){this.map=t}of(t){return new vP(this,t)}}class vP{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return void 0===e?void 0:e==this.value?this:new vP(this.type,e)}is(t){return this.type==t}static define(t={}){return new OP(t.map||(t=>t))}static mapEffects(t,e){if(!t.length)return t;let i=[];for(let n of t){let t=n.map(e);t&&i.push(t)}return i}}vP.reconfigure=vP.define(),vP.appendConfig=vP.define();class wP{constructor(t,e,i,n,r,s){this.startState=t,this.changes=e,this.selection=i,this.effects=n,this.annotations=r,this.scrollIntoView=s,this._doc=null,this._state=null,i&&WT(i,e.newLength),r.some((t=>t.type==wP.time))||(this.annotations=r.concat(wP.time.of(Date.now())))}static create(t,e,i,n,r,s){return new wP(t,e,i,n,r,s)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(wP.userEvent);return!(!e||!(e==t||e.length>t.length&&e.slice(0,t.length)==t&&"."==e[t.length]))}}function yP(t,e){let i=[];for(let n=0,r=0;;){let s,o;if(n<t.length&&(r==e.length||e[r]>=t[n]))s=t[n++],o=t[n++];else{if(!(r<e.length))return i;s=e[r++],o=e[r++]}!i.length||i[i.length-1]<s?i.push(s,o):i[i.length-1]<o&&(i[i.length-1]=o)}}function xP(t,e,i){var n;let r,s,o;return i?(r=e.changes,s=$T.empty(e.changes.length),o=t.changes.compose(e.changes)):(r=e.changes.map(t.changes),s=t.changes.mapDesc(e.changes,!0),o=t.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):null===(n=t.selection)||void 0===n?void 0:n.map(r),effects:vP.mapEffects(t.effects,r).concat(vP.mapEffects(e.effects,s)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function kP(t,e,i){let n=e.selection,r=AP(e.annotations);return e.userEvent&&(r=r.concat(wP.userEvent.of(e.userEvent))),{changes:e.changes instanceof $T?e.changes:$T.of(e.changes||[],i,t.facet(uP)),selection:n&&(n instanceof LT?n:LT.single(n.anchor,n.head)),effects:AP(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function SP(t,e,i){let n=kP(t,e.length?e[0]:{},t.doc.length);e.length&&!1===e[0].filter&&(i=!1);for(let r=1;r<e.length;r++){!1===e[r].filter&&(i=!1);let s=!!e[r].sequential;n=xP(n,kP(t,e[r],s?n.changes.newLength:t.doc.length),s)}let r=wP.create(t,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return function(t){let e=t.startState,i=e.facet(pP),n=t;for(let r=i.length-1;r>=0;r--){let s=i[r](t);s&&Object.keys(s).length&&(n=xP(t,kP(e,s,t.changes.newLength),!0))}return n==t?t:wP.create(e,t.changes,t.selection,n.effects,n.annotations,n.scrollIntoView)}(i?function(t){let e=t.startState,i=!0;for(let n of e.facet(fP)){let e=n(t);if(!1===e){i=!1;break}Array.isArray(e)&&(i=!0===i?e:yP(i,e))}if(!0!==i){let n,r;if(!1===i)r=t.changes.invertedDesc,n=$T.empty(e.doc.length);else{let e=t.changes.filter(i);n=e.changes,r=e.filtered.invertedDesc}t=wP.create(e,n,t.selection&&t.selection.map(r),vP.mapEffects(t.effects,r),t.annotations,t.scrollIntoView)}let n=e.facet(dP);for(let i=n.length-1;i>=0;i--){let r=n[i](t);t=r instanceof wP?r:Array.isArray(r)&&1==r.length&&r[0]instanceof wP?r[0]:SP(e,AP(r),!1)}return t}(r):r)}wP.time=mP.define(),wP.userEvent=mP.define(),wP.addToHistory=mP.define(),wP.remote=mP.define();const CP=[];function AP(t){return null==t?CP:Array.isArray(t)?t:[t]}var TP=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(TP||(TP={}));const PP=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let MP;try{MP=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(t){}function QP(t){return e=>{if(!/\S/.test(e))return TP.Space;if(function(t){if(MP)return MP.test(t);for(let e=0;e<t.length;e++){let i=t[e];if(/\w/.test(i)||i>""&&(i.toUpperCase()!=i.toLowerCase()||PP.test(i)))return!0}return!1}(e))return TP.Word;for(let i=0;i<t.length;i++)if(e.indexOf(t[i])>-1)return TP.Word;return TP.Other}}class RP{constructor(t,e,i,n,r,s){this.config=t,this.doc=e,this.selection=i,this.values=n,this.status=t.statusTemplate.slice(),this.computeSlot=r,s&&(s._state=this);for(let t=0;t<this.config.dynamicSlots.length;t++)lP(this,t<<1);this.computeSlot=null}field(t,e=!0){let i=this.config.address[t.id];if(null!=i)return lP(this,i),aP(this,i);if(e)throw new RangeError("Field is not present in this state")}update(...t){return SP(this,t,!0)}applyTransaction(t){let e,i=this.config,{base:n,compartments:r}=i;for(let e of t.effects)e.is(rP.reconfigure)?(i&&(r=new Map,i.compartments.forEach(((t,e)=>r.set(e,t))),i=null),r.set(e.value.compartment,e.value.extension)):e.is(vP.reconfigure)?(i=null,n=e.value):e.is(vP.appendConfig)&&(i=null,n=AP(n).concat(e.value));if(i)e=t.startState.values.slice();else{i=oP.resolve(n,r,this);let t=new RP(i,this.doc,this.selection,i.dynamicSlots.map((()=>null)),((t,e)=>e.reconfigure(t,this)),null);e=t.values}new RP(i,t.newDoc,t.newSelection,e,((e,i)=>i.update(e,t)),t)}replaceSelection(t){return"string"==typeof t&&(t=this.toText(t)),this.changeByRange((e=>({changes:{from:e.from,to:e.to,insert:t},range:LT.cursor(e.from+t.length)})))}changeByRange(t){let e=this.selection,i=t(e.ranges[0]),n=this.changes(i.changes),r=[i.range],s=AP(i.effects);for(let i=1;i<e.ranges.length;i++){let o=t(e.ranges[i]),l=this.changes(o.changes),a=l.map(n);for(let t=0;t<i;t++)r[t]=r[t].map(a);let h=n.mapDesc(l,!0);r.push(o.range.map(h)),n=n.compose(a),s=vP.mapEffects(s,a).concat(vP.mapEffects(AP(o.effects),h))}return{changes:n,selection:LT.create(r,e.mainIndex),effects:s}}changes(t=[]){return t instanceof $T?t:$T.of(t,this.doc.length,this.facet(RP.lineSeparator))}toText(t){return cT.of(t.split(this.facet(RP.lineSeparator)||MT))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return null==e?t.default:(lP(this,e),aP(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let i in t){let n=t[i];n instanceof UT&&(e[i]=n.spec.toJSON(this.field(t[i]),this))}return e}static fromJSON(t,e={},i){if(!t||"string"!=typeof t.doc)throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i)for(let e in i){let r=i[e],s=t[e];n.push(r.init((t=>r.spec.fromJSON(s,t))))}return RP.create({doc:t.doc,selection:LT.fromJSON(t.selection),extensions:e.extensions?n.concat([e.extensions]):n})}static create(t={}){let e=oP.resolve(t.extensions||[],new Map),i=t.doc instanceof cT?t.doc:cT.of((t.doc||"").split(e.staticFacet(RP.lineSeparator)||MT)),n=t.selection?t.selection instanceof LT?t.selection:LT.single(t.selection.anchor,t.selection.head):LT.single(0);return WT(n,i.length),e.staticFacet(cP)||(n=n.asSingle()),new RP(e,i,n,e.dynamicSlots.map((()=>null)),((t,e)=>e.create(t)),null)}get tabSize(){return this.facet(RP.tabSize)}get lineBreak(){return this.facet(RP.lineSeparator)||"\n"}get readOnly(){return this.facet(gP)}phrase(t,...e){for(let e of this.facet(RP.phrases))if(Object.prototype.hasOwnProperty.call(e,t)){t=e[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,((t,i)=>{if("$"==i)return"$";let n=+(i||1);return n>e.length?t:e[n-1]}))),t}languageDataAt(t,e,i=-1){let n=[];for(let r of this.facet(hP))for(let s of r(this,e,i))Object.prototype.hasOwnProperty.call(s,t)&&n.push(s[t]);return n}charCategorizer(t){return QP(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:i,length:n}=this.doc.lineAt(t),r=this.charCategorizer(t),s=t-i,o=t-i;for(;s>0;){let t=xT(e,s,!1);if(r(e.slice(t,s))!=TP.Word)break;s=t}for(;o<n;){let t=xT(e,o);if(r(e.slice(o,t))!=TP.Word)break;o=t}return s==o?null:LT.range(s+i,o+i)}}RP.allowMultipleSelections=cP,RP.tabSize=jT.define({combine:t=>t.length?t[0]:4}),RP.lineSeparator=uP,RP.readOnly=gP,RP.phrases=jT.define({compare(t,e){let i=Object.keys(t),n=Object.keys(e);return i.length==n.length&&i.every((i=>t[i]==e[i]))}}),RP.languageData=hP,RP.changeFilter=fP,RP.transactionFilter=dP,RP.transactionExtender=pP,rP.reconfigure=vP.define();class $P{eq(t){return this==t}range(t,e=t){return _P.create(t,e,this)}}$P.prototype.startSide=$P.prototype.endSide=0,$P.prototype.point=!1,$P.prototype.mapMode=QT.TrackDel;class _P{constructor(t,e,i){this.from=t,this.to=e,this.value=i}static create(t,e,i){return new _P(t,e,i)}}function DP(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class EP{constructor(t,e,i,n){this.from=t,this.to=e,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(t,e,i,n=0){let r=i?this.to:this.from;for(let s=n,o=r.length;;){if(s==o)return s;let n=s+o>>1,l=r[n]-t||(i?this.value[n].endSide:this.value[n].startSide)-e;if(n==s)return l>=0?s:o;l>=0?o=n:s=n+1}}between(t,e,i,n){for(let r=this.findIndex(e,-1e9,!0),s=this.findIndex(i,1e9,!1,r);r<s;r++)if(!1===n(this.from[r]+t,this.to[r]+t,this.value[r]))return!1}map(t,e){let i=[],n=[],r=[],s=-1,o=-1;for(let l=0;l<this.value.length;l++){let a,h,c=this.value[l],u=this.from[l]+t,f=this.to[l]+t;if(u==f){let t=e.mapPos(u,c.startSide,c.mapMode);if(null==t)continue;if(a=h=t,c.startSide!=c.endSide&&(h=e.mapPos(u,c.endSide),h<a))continue}else if(a=e.mapPos(u,c.startSide),h=e.mapPos(f,c.endSide),a>h||a==h&&c.startSide>0&&c.endSide<=0)continue;(h-a||c.endSide-c.startSide)<0||(s<0&&(s=a),c.point&&(o=Math.max(o,h-a)),i.push(c),n.push(a-s),r.push(h-s))}return{mapped:i.length?new EP(n,r,i,o):null,pos:s}}}class NP{constructor(t,e,i,n){this.chunkPos=t,this.chunk=e,this.nextLayer=i,this.maxPoint=n}static create(t,e,i,n){return new NP(t,e,i,n)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:i=!1,filterFrom:n=0,filterTo:r=this.length}=t,s=t.filter;if(0==e.length&&!s)return this;if(i&&(e=e.slice().sort(DP)),this.isEmpty)return e.length?NP.of(e):this;let o=new zP(this,null,-1).goto(0),l=0,a=[],h=new BP;for(;o.value||l<e.length;)if(l<e.length&&(o.from-e[l].from||o.startSide-e[l].value.startSide)>=0){let t=e[l++];h.addInner(t.from,t.to,t.value)||a.push(t)}else 1==o.rangeIndex&&o.chunkIndex<this.chunk.length&&(l==e.length||this.chunkEnd(o.chunkIndex)<e[l].from)&&(!s||n>this.chunkEnd(o.chunkIndex)||r<this.chunkPos[o.chunkIndex])&&h.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!s||n>o.to||r<o.from||s(o.from,o.to,o.value))&&(h.addInner(o.from,o.to,o.value)||a.push(_P.create(o.from,o.to,o.value))),o.next());return h.finishInner(this.nextLayer.isEmpty&&!a.length?NP.empty:this.nextLayer.update({add:a,filter:s,filterFrom:n,filterTo:r}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],i=[],n=-1;for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r],l=t.touchesRange(s,s+o.length);if(!1===l)n=Math.max(n,o.maxPoint),e.push(o),i.push(t.mapPos(s));else if(!0===l){let{mapped:r,pos:l}=o.map(s,t);r&&(n=Math.max(n,r.maxPoint),e.push(r),i.push(l))}}let r=this.nextLayer.map(t);return 0==e.length?r:new NP(i,e,r||NP.empty,n)}between(t,e,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let r=this.chunkPos[n],s=this.chunk[n];if(e>=r&&t<=r+s.length&&!1===s.between(r,t-r,e-r,i))return}this.nextLayer.between(t,e,i)}}iter(t=0){return LP.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return LP.from(t).goto(e)}static compare(t,e,i,n,r=-1){let s=t.filter((t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=r)),o=e.filter((t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=r)),l=IP(s,o,i),a=new VP(s,l,r),h=new VP(o,l,r);i.iterGaps(((t,e,i)=>jP(a,t,h,e,i,n))),i.empty&&0==i.length&&jP(a,0,h,0,0,n)}static eq(t,e,i=0,n){null==n&&(n=1e9);let r=t.filter((t=>!t.isEmpty&&e.indexOf(t)<0)),s=e.filter((e=>!e.isEmpty&&t.indexOf(e)<0));if(r.length!=s.length)return!1;if(!r.length)return!0;let o=IP(r,s),l=new VP(r,o,0).goto(i),a=new VP(s,o,0).goto(i);for(;;){if(l.to!=a.to||!qP(l.active,a.active)||l.point&&(!a.point||!l.point.eq(a.point)))return!1;if(l.to>n)return!0;l.next(),a.next()}}static spans(t,e,i,n,r=-1){let s=new VP(t,null,r).goto(e),o=e,l=s.openStart;for(;;){let t=Math.min(s.to,i);if(s.point?(n.point(o,t,s.point,s.activeForPoint(s.to),l,s.pointRank),l=s.openEnd(t)+(s.to>t?1:0)):t>o&&(n.span(o,t,s.active,l),l=s.openEnd(t)),s.to>i)break;o=s.to,s.next()}return l}static of(t,e=!1){let i=new BP;for(let n of t instanceof _P?[t]:e?function(t){if(t.length>1)for(let e=t[0],i=1;i<t.length;i++){let n=t[i];if(DP(e,n)>0)return t.slice().sort(DP);e=n}return t}(t):t)i.add(n.from,n.to,n.value);return i.finish()}}NP.empty=new NP([],[],null,-1),NP.empty.nextLayer=NP.empty;class BP{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(t){this.chunks.push(new EP(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}add(t,e,i){this.addInner(t,e,i)||(this.nextLayer||(this.nextLayer=new BP)).add(t,e,i)}addInner(t,e,i){let n=t-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(t-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(n<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=i,this.lastFrom=t,this.lastTo=e,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let i=e.value.length-1;return this.last=e.value[i],this.lastFrom=e.from[i]+t,this.lastTo=e.to[i]+t,!0}finish(){return this.finishInner(NP.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return t;let e=NP.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function IP(t,e,i){let n=new Map;for(let e of t)for(let t=0;t<e.chunk.length;t++)e.chunk[t].maxPoint<=0&&n.set(e.chunk[t],e.chunkPos[t]);let r=new Set;for(let t of e)for(let e=0;e<t.chunk.length;e++){let s=n.get(t.chunk[e]);null==s||(i?i.mapPos(s):s)!=t.chunkPos[e]||(null==i?void 0:i.touchesRange(s,s+t.chunk[e].length))||r.add(t.chunk[e])}return r}class zP{constructor(t,e,i,n=0){this.layer=t,this.skip=e,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,i){for(;this.chunkIndex<this.layer.chunk.length;){let e=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(e)||this.layer.chunkEnd(this.chunkIndex)<t||e.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],i=t+e.from[this.rangeIndex];if(this.from=i,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class LP{constructor(t){this.heap=t}static from(t,e=null,i=-1){let n=[];for(let r=0;r<t.length;r++)for(let s=t[r];!s.isEmpty;s=s.nextLayer)s.maxPoint>=i&&n.push(new zP(s,e,i,r));return 1==n.length?n[0]:new LP(n)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let i of this.heap)i.goto(t,e);for(let t=this.heap.length>>1;t>=0;t--)WP(this.heap,t);return this.next(),this}forward(t,e){for(let i of this.heap)i.forward(t,e);for(let t=this.heap.length>>1;t>=0;t--)WP(this.heap,t);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),WP(this.heap,0)}}}function WP(t,e){for(let i=t[e];;){let n=1+(e<<1);if(n>=t.length)break;let r=t[n];if(n+1<t.length&&r.compare(t[n+1])>=0&&(r=t[n+1],n++),i.compare(r)<0)break;t[n]=i,t[e]=r,e=n}}class VP{constructor(t,e,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=LP.from(t,e,i)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){HP(this.active,t),HP(this.activeTo,t),HP(this.activeRank,t),this.minActive=FP(this.active,this.activeTo)}addActive(t){let e=0,{value:i,to:n,rank:r}=this.cursor;for(;e<this.activeRank.length&&this.activeRank[e]<=r;)e++;XP(this.active,e,i),XP(this.activeTo,e,n),XP(this.activeRank,e,r),t&&XP(t,e,this.cursor.from),this.minActive=FP(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let i=this.openStart<0?[]:null,n=0;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>t){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),i&&HP(i,r)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let r=this.cursor.value;if(r.point){if(!(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.from<t&&(n=1),this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(i),this.cursor.next()}}}if(i){let e=0;for(;e<i.length&&i[e]<t;)e++;this.openStart=e+n}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>t||this.activeTo[i]==t&&this.active[i].endSide>=this.point.endSide)&&e.push(this.active[i]);return e.reverse()}openEnd(t){let e=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>t;i--)e++;return e}}function jP(t,e,i,n,r,s){t.goto(e),i.goto(n);let o=n+r,l=n,a=n-e;for(;;){let e=t.to+a-i.to||t.endSide-i.endSide,n=e<0?t.to+a:i.to,r=Math.min(n,o);if(t.point||i.point?t.point&&i.point&&(t.point==i.point||t.point.eq(i.point))&&qP(t.activeForPoint(t.to+a),i.activeForPoint(i.to))||s.comparePoint(l,r,t.point,i.point):r>l&&!qP(t.active,i.active)&&s.compareRange(l,r,t.active,i.active),n>o)break;l=n,e<=0&&t.next(),e>=0&&i.next()}}function qP(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!=e[i]&&!t[i].eq(e[i]))return!1;return!0}function HP(t,e){for(let i=e,n=t.length-1;i<n;i++)t[i]=t[i+1];t.pop()}function XP(t,e,i){for(let i=t.length-1;i>=e;i--)t[i+1]=t[i];t[e]=i}function FP(t,e){let i=-1,n=1e9;for(let r=0;r<e.length;r++)(e[r]-n||t[r].endSide-t[i].endSide)<0&&(i=r,n=e[r]);return i}function ZP(t){let e;return e=11==t.nodeType?t.getSelection?t:t.ownerDocument:t,e.getSelection()}function GP(t,e){return!!e&&(t==e||t.contains(1!=e.nodeType?e.parentNode:e))}function UP(t,e){if(!e.anchorNode)return!1;try{return GP(t,e.anchorNode)}catch(t){return!1}}function YP(t){return 3==t.nodeType?hM(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function KP(t,e,i,n){return!!i&&(tM(t,e,i,n,-1)||tM(t,e,i,n,1))}function JP(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function tM(t,e,i,n,r){for(;;){if(t==i&&e==n)return!0;if(e==(r<0?0:eM(t))){if("DIV"==t.nodeName)return!1;let i=t.parentNode;if(!i||1!=i.nodeType)return!1;e=JP(t)+(r<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[e+(r<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;e=r<0?eM(t):0}}}function eM(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}const iM={left:0,right:0,top:0,bottom:0};function nM(t,e){let i=e?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function rM(t){return{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}class sM{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){this.set(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let oM,lM=null;function aM(t){if(t.setActive)return t.setActive();if(lM)return t.focus(lM);let e=[];for(let i=t;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==lM?{get preventScroll(){return lM={preventScroll:!0},!0}}:void 0),!lM){lM=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],r=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=r&&(i.scrollLeft=r)}}}function hM(t,e,i=e){let n=oM||(oM=document.createRange());return n.setEnd(t,i),n.setStart(t,e),n}function cM(t,e,i){let n={key:e,code:e,keyCode:i,which:i,cancelable:!0},r=new KeyboardEvent("keydown",n);r.synthetic=!0,t.dispatchEvent(r);let s=new KeyboardEvent("keyup",n);return s.synthetic=!0,t.dispatchEvent(s),r.defaultPrevented||s.defaultPrevented}function uM(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}class fM{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new fM(t.parentNode,JP(t),e)}static after(t,e){return new fM(t.parentNode,JP(t)+1,e)}}const dM=[];class pM{constructor(){this.parent=null,this.dom=null,this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}coordsAt(t,e){return null}sync(t){if(2&this.dirty){let e,i=this.dom,n=null;for(let r of this.children){if(r.dirty){if(!r.dom&&(e=n?n.nextSibling:i.firstChild)){let t=pM.get(e);t&&(t.parent||t.constructor!=r.constructor)||r.reuseDOM(e)}r.sync(t),r.dirty=0}if(e=n?n.nextSibling:i.firstChild,t&&!t.written&&t.node==i&&e!=r.dom&&(t.written=!0),r.dom.parentNode==i)for(;e&&e!=r.dom;)e=gM(e);else i.insertBefore(r.dom,e);n=r.dom}for(e=n?n.nextSibling:i.firstChild,e&&t&&t.node==i&&(t.written=!0);e;)e=gM(e)}else if(1&this.dirty)for(let e of this.children)e.dirty&&(e.sync(t),e.dirty=0)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=0==eM(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==n&&e.firstChild!=e.lastChild&&(n=t==e.firstChild?-1:1),t=e}i=n<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!pM.get(i);)i=i.nextSibling;if(!i)return this.length;for(let t=0,e=0;;t++){let n=this.children[t];if(n.dom==i)return e;e+=n.length+n.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,r=-1,s=-1,o=-1;for(let l=0,a=i,h=i;l<this.children.length;l++){let i=this.children[l],c=a+i.length;if(a<t&&c>e)return i.domBoundsAround(t,e,a);if(c>=t&&-1==n&&(n=l,r=a),a>e&&i.dom.parentNode==this.dom){s=l,o=h;break}h=c,a=c+i.breakAfter}return{from:r,to:o<0?i+this.length:o,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:s<this.children.length&&s>=0?this.children[s].dom:null}}markDirty(t=!1){this.dirty|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.dirty|=2),1&e.dirty)return;e.dirty|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.dirty&&this.markParentsDirty(!0))}setDOM(t){this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=dM){this.markDirty();for(let i=t;i<e;i++){let t=this.children[i];t.parent==this&&t.destroy()}this.children.splice(t,e-t,...i);for(let t=0;t<i.length;t++)i[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new mM(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}merge(t,e,i,n,r,s){return!1}become(t){return!1}getSide(){return 0}destroy(){this.parent=null}}function gM(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}pM.prototype.breakAfter=0;class mM{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function bM(t,e,i,n,r,s,o,l,a){let{children:h}=t,c=h.length?h[e]:null,u=s.length?s[s.length-1]:null,f=u?u.breakAfter:o;if(!(e==n&&c&&!o&&!f&&s.length<2&&c.merge(i,r,s.length?u:null,0==i,l,a))){if(n<h.length){let t=h[n];t&&r<t.length?(e==n&&(t=t.split(r),r=0),!f&&u&&t.merge(0,r,u,!0,0,a)?s[s.length-1]=t:(r&&t.merge(0,r,null,!1,0,a),s.push(t))):(null==t?void 0:t.breakAfter)&&(u?u.breakAfter=1:o=1),n++}for(c&&(c.breakAfter=o,i>0&&(!o&&s.length&&c.merge(i,c.length,s[0],!1,l,0)?c.breakAfter=s.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,l,0),e++));e<n&&s.length;)if(h[n-1].become(s[s.length-1]))n--,s.pop(),a=s.length?0:l;else{if(!h[e].become(s[0]))break;e++,s.shift(),l=s.length?0:a}!s.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,l,a)&&e--,(e<n||s.length)&&t.replaceChildren(e,n,s)}}function OM(t,e,i,n,r,s){let o=t.childCursor(),{i:l,off:a}=o.findPos(i,1),{i:h,off:c}=o.findPos(e,-1),u=e-i;for(let t of n)u+=t.length;t.length+=u,bM(t,h,c,l,a,n,0,r,s)}let vM="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},wM="undefined"!=typeof document?document:{documentElement:{style:{}}};const yM=/Edge\/(\d+)/.exec(vM.userAgent),xM=/MSIE \d/.test(vM.userAgent),kM=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(vM.userAgent),SM=!!(xM||kM||yM),CM=!SM&&/gecko\/(\d+)/i.test(vM.userAgent),AM=!SM&&/Chrome\/(\d+)/.exec(vM.userAgent),TM="webkitFontSmoothing"in wM.documentElement.style,PM=!SM&&/Apple Computer/.test(vM.vendor),MM=PM&&(/Mobile\/\w+/.test(vM.userAgent)||vM.maxTouchPoints>2);var QM={mac:MM||/Mac/.test(vM.platform),windows:/Win/.test(vM.platform),linux:/Linux|X11/.test(vM.platform),ie:SM,ie_version:xM?wM.documentMode||6:kM?+kM[1]:yM?+yM[1]:0,gecko:CM,gecko_version:CM?+(/Firefox\/(\d+)/.exec(vM.userAgent)||[0,0])[1]:0,chrome:!!AM,chrome_version:AM?+AM[1]:0,ios:MM,android:/Android\b/.test(vM.userAgent),webkit:TM,safari:PM,webkit_version:TM?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=wM.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class RM extends pM{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){3==t.nodeType&&this.createDOM(t)}merge(t,e,i){return(!i||i instanceof RM&&!(this.length-(e-t)+i.length>256))&&(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new RM(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new fM(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return _M(this.dom,t,e)}}class $M extends pM{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let t of e)t.setParent(this)}setAttrs(t){if(uM(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.dirty|=6)}sync(t){this.dom?4&this.dirty&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t)}merge(t,e,i,n,r,s){return(!i||!(!(i instanceof $M&&i.mark.eq(this.mark))||t&&r<=0||e<this.length&&s<=0))&&(OM(this,t,e,i?i.children:[],r-1,s-1),this.markDirty(),!0)}split(t){let e=[],i=0,n=-1,r=0;for(let s of this.children){let o=i+s.length;o>t&&e.push(i<t?s.split(t-i):s),n<0&&i>=t&&(n=r),i=o,r++}let s=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new $M(this.mark,e,s)}domAtPos(t){return zM(this.dom,this.children,t)}coordsAt(t,e){return WM(this,t,e)}}function _M(t,e,i){let n=t.nodeValue.length;e>n&&(e=n);let r=e,s=e,o=0;0==e&&i<0||e==n&&i>=0?QM.chrome||QM.gecko||(e?(r--,o=1):s<n&&(s++,o=-1)):i<0?r--:s<n&&s++;let l=hM(t,r,s).getClientRects();if(!l.length)return iM;let a=l[(o?o<0:i>=0)?0:l.length-1];return QM.safari&&!o&&0==a.width&&(a=Array.prototype.find.call(l,(t=>t.width))||a),o?nM(a,o<0):a||null}class DM extends pM{constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}static create(t,e,i){return new(t.customView||DM)(t,e,i)}split(t){let e=DM.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(t,e,i,n,r,s){return!(i&&(!(i instanceof DM&&this.widget.compare(i.widget))||t>0&&r<=0||e<this.length&&s<=0))&&(this.length=t+(i?i.length:0)+(this.length-e),!0)}become(t){return t.length==this.length&&t instanceof DM&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.eq(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return cT.empty;let t=this;for(;t.parent;)t=t.parent;let e=t.editorView,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):cT.empty}domAtPos(t){return 0==t?fM.before(this.dom):fM.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.dom.getClientRects(),n=null;if(!i.length)return iM;for(let e=t>0?i.length-1:0;n=i[e],!(t>0?0==e:e==i.length-1||n.top<n.bottom);e+=t>0?-1:1);return 0==t&&e>0||t==this.length&&e<=0?n:nM(n,0==t)}get isEditable(){return!1}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class EM extends DM{domAtPos(t){let{topView:e,text:i}=this.widget;return e?NM(t,0,e,i,((t,e)=>t.domAtPos(e)),(t=>new fM(i,Math.min(t,i.nodeValue.length)))):new fM(i,Math.min(t,i.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(t,e){let{topView:i,text:n}=this.widget;return i?BM(t,e,i,n):Math.min(e,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(t,e){let{topView:i,text:n}=this.widget;return i?NM(t,e,i,n,((t,e,i)=>t.coordsAt(e,i)),((t,e)=>_M(n,t,e))):_M(n,t,e)}destroy(){var t;super.destroy(),null===(t=this.widget.topView)||void 0===t||t.destroy()}get isEditable(){return!0}}function NM(t,e,i,n,r,s){if(i instanceof $M){for(let o of i.children){let i=GP(o.dom,n),l=i?n.nodeValue.length:o.length;if(t<l||t==l&&o.getSide()<=0)return i?NM(t,e,o,n,r,s):r(o,t,e);t-=l}return r(i,i.length,-1)}return i.dom==n?s(t,e):r(i,t,e)}function BM(t,e,i,n){if(i instanceof $M)for(let r of i.children){let i=0,s=GP(r.dom,n);if(GP(r.dom,t))return i+(s?BM(t,e,r,n):r.localPosFromDOM(t,e));i+=s?n.nodeValue.length:r.length}else if(i.dom==n)return Math.min(e,n.nodeValue.length);return i.localPosFromDOM(t,e)}class IM extends pM{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof IM&&t.side==this.side}split(){return new IM(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return fM.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){let e=this.dom.getBoundingClientRect(),i=function(t,e){let i=t.parent,n=i?i.children.indexOf(t):-1;for(;i&&n>=0;)if(e<0?n>0:n<i.children.length){let t=i.children[n+e];if(t instanceof RM){let i=t.coordsAt(e<0?t.length:0,e);if(i)return i}n+=e}else{if(!(i instanceof $M&&i.parent)){let t=i.dom.lastChild;if(t&&"BR"==t.nodeName)return t.getClientRects()[0];break}n=i.parent.children.indexOf(i)+(e<0?0:1),i=i.parent}return}(this,this.side>0?-1:1);return i&&i.top<e.bottom&&i.bottom>e.top?{left:e.left,right:e.right,top:i.top,bottom:i.bottom}:e}get overrideDOMText(){return cT.empty}}function zM(t,e,i){let n=0;for(let r=0;n<e.length;n++){let s=e[n],o=r+s.length;if(!(o==r&&s.getSide()<=0)){if(i>r&&i<o&&s.dom.parentNode==t)return s.domAtPos(i-r);if(i<=r)break;r=o}}for(;n>0;n--){let i=e[n-1].dom;if(i.parentNode==t)return fM.after(i)}return new fM(t,0)}function LM(t,e,i){let n,{children:r}=t;i>0&&e instanceof $M&&r.length&&(n=r[r.length-1])instanceof $M&&n.mark.eq(e.mark)?LM(n,e.children[0],i-1):(r.push(e),e.setParent(t)),t.length+=e.length}function WM(t,e,i){for(let n=0,r=0;r<t.children.length;r++){let s,o=t.children[r],l=n+o.length;if((i<=0||l==t.length||o.getSide()>0?l>=e:l>e)&&(e<l||r+1==t.children.length||(s=t.children[r+1]).length||s.getSide()>0)){let t=0;if(l==n){if(o.getSide()<=0)continue;t=i=-o.getSide()}let r=o.coordsAt(Math.max(0,e-n),i);return t&&r?nM(r,i<0):r}n=l}let n=t.dom.lastChild;if(!n)return t.dom.getBoundingClientRect();let r=YP(n);return r[r.length-1]||null}function VM(t,e){for(let i in t)"class"==i&&e.class?e.class+=" "+t.class:"style"==i&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}function jM(t,e){if(t==e)return!0;if(!t||!e)return!1;let i=Object.keys(t),n=Object.keys(e);if(i.length!=n.length)return!1;for(let r of i)if(-1==n.indexOf(r)||t[r]!==e[r])return!1;return!0}function qM(t,e,i){let n=null;if(e)for(let r in e)i&&r in i||t.removeAttribute(n=r);if(i)for(let r in i)e&&e[r]==i[r]||t.setAttribute(n=r,i[r]);return!!n}RM.prototype.children=DM.prototype.children=IM.prototype.children=dM;class HM{eq(t){return!1}updateDOM(t){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}ignoreEvent(t){return!0}get customView(){return null}destroy(t){}}var XM=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(XM||(XM={}));class FM extends $P{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new ZM(t)}static widget(t){let e=t.side||0,i=!!t.block;return e+=i?e>0?3e8:-4e8:e>0?1e8:-1e8,new UM(t,e,e,i,t.widget||null,!1)}static replace(t){let e,i,n=!!t.block;if(t.isBlockGap)e=-5e8,i=4e8;else{let{start:r,end:s}=YM(t,n);e=(r?n?-3e8:-1:5e8)-1,i=1+(s?n?2e8:1:-6e8)}return new UM(t,e,i,n,t.widget||null,!0)}static line(t){return new GM(t)}static set(t,e=!1){return NP.of(t,e)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}FM.none=NP.empty;class ZM extends FM{constructor(t){let{start:e,end:i}=YM(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){return this==t||t instanceof ZM&&this.tagName==t.tagName&&this.class==t.class&&jM(this.attrs,t.attrs)}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}ZM.prototype.point=!1;class GM extends FM{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof GM&&jM(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}GM.prototype.mapMode=QT.TrackBefore,GM.prototype.point=!0;class UM extends FM{constructor(t,e,i,n,r,s){super(e,i,r,t),this.block=n,this.isReplace=s,this.mapMode=n?e<=0?QT.TrackBefore:QT.TrackAfter:QT.TrackDel}get type(){return this.startSide<this.endSide?XM.WidgetRange:this.startSide<=0?XM.WidgetBefore:XM.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(t){return t instanceof UM&&(e=this.widget,i=t.widget,e==i||!!(e&&i&&e.compare(i)))&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide;var e,i}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}function YM(t,e=!1){let{inclusiveStart:i,inclusiveEnd:n}=t;return null==i&&(i=t.inclusive),null==n&&(n=t.inclusive),{start:null!=i?i:e,end:null!=n?n:e}}function KM(t,e,i,n=0){let r=i.length-1;r>=0&&i[r]+n>=t?i[r]=Math.max(i[r],e):i.push(t,e)}UM.prototype.point=!0;class JM extends pM{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,r,s){if(i){if(!(i instanceof JM))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),OM(this,t,e,i?i.children:[],r,s),!0}split(t){let e=new JM;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let t=i;t<this.children.length;t++)e.append(this.children[t],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){jM(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){LM(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=VM(e,this.attrs||{})),i&&(this.attrs=VM({class:i},this.attrs||{}))}domAtPos(t){return zM(this.dom,this.children,t)}reuseDOM(t){"DIV"==t.nodeName&&(this.setDOM(t),this.dirty|=6)}sync(t){var e;this.dom?4&this.dirty&&(uM(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(qM(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t);let i=this.dom.lastChild;for(;i&&pM.get(i)instanceof $M;)i=i.lastChild;if(!(i&&this.length&&("BR"==i.nodeName||0!=(null===(e=pM.get(i))||void 0===e?void 0:e.isEditable)||QM.ios&&this.children.some((t=>t instanceof RM))))){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t=0;for(let e of this.children){if(!(e instanceof RM))return null;let i=YP(e.dom);if(1!=i.length)return null;t+=i[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length}}coordsAt(t,e){return WM(this,t,e)}become(t){return!1}get type(){return XM.Text}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let r=t.children[i],s=n+r.length;if(s>=e){if(r instanceof JM)return r;if(s>e)break}n=s+r.breakAfter}return null}}class tQ extends pM{constructor(t,e,i){super(),this.widget=t,this.length=e,this.type=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,r,s){return!(i&&(!(i instanceof tQ&&this.widget.compare(i.widget))||t>0&&r<=0||e<this.length&&s<=0))&&(this.length=t+(i?i.length:0)+(this.length-e),!0)}domAtPos(t){return 0==t?fM.before(this.dom):fM.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new tQ(this.widget,e,this.type);return i.breakAfter=this.breakAfter,i}get children(){return dM}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):cT.empty}domBoundsAround(){return null}become(t){return t instanceof tQ&&t.type==this.type&&t.widget.constructor==this.widget.constructor&&(t.widget.eq(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class eQ{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof tQ&&t.type==XM.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new JM),this.atCursorPos=!0),this.curLine}flushBuffer(t){this.pendingBuffer&&(this.curLine.append(iQ(new IM(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer([]),this.curLine=null,this.content.push(t)}finish(t){t?this.pendingBuffer=0:this.flushBuffer([]),this.posCovered()||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:i,done:n}=this.cursor.next(this.skip);if(this.skip=0,n)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer([]),this.curLine=null,t--;continue}this.text=e,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(0,i)),this.getLine().append(iQ(new RM(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,r,s){if(this.disallowBlockEffectsFor[s]&&i instanceof UM){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=e-t;if(i instanceof UM)if(i.block){let{type:t}=i;t!=XM.WidgetAfter||this.posCovered()||this.getLine(),this.addBlockWidget(new tQ(i.widget||new nQ("div"),o,t))}else{let s=DM.create(i.widget||new nQ("span"),o,i.startSide),l=this.atCursorPos&&!s.isEditable&&r<=n.length&&(t<e||i.startSide>0),a=!s.isEditable&&(t<e||i.startSide<=0),h=this.getLine();2!=this.pendingBuffer||l||(this.pendingBuffer=0),this.flushBuffer(n),l&&(h.append(iQ(new IM(1),n),r),r=n.length+Math.max(0,r-n.length)),h.append(iQ(s,n),r),this.atCursorPos=a,this.pendingBuffer=a?t<e?1:2:0}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=r)}static build(t,e,i,n,r){let s=new eQ(t,e,i,r);return s.openEnd=NP.spans(n,e,i,s),s.openStart<0&&(s.openStart=s.openEnd),s.finish(s.openEnd),s}}function iQ(t,e){for(let i of e)t=new $M(i,[t],t.length);return t}class nQ extends HM{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}}const rQ=jT.define(),sQ=jT.define(),oQ=jT.define(),lQ=jT.define(),aQ=jT.define(),hQ=jT.define(),cQ=jT.define({combine:t=>t.some((t=>t))});class uQ{constructor(t,e="nearest",i="nearest",n=5,r=5){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=r}map(t){return t.empty?this:new uQ(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin)}}const fQ=vP.define({map:(t,e)=>t.map(e)});function dQ(t,e,i){let n=t.facet(lQ);n.length?n[0](e):window.onerror?window.onerror(String(e),i,void 0,void 0,e):i?console.error(i+":",e):console.error(e)}const pQ=jT.define({combine:t=>!t.length||t[0]});let gQ=0;const mQ=jT.define();class bQ{constructor(t,e,i,n){this.id=t,this.create=e,this.domEventHandlers=i,this.extension=n(this)}static define(t,e){const{eventHandlers:i,provide:n,decorations:r}=e||{};return new bQ(gQ++,t,i,(t=>{let e=[mQ.of(t)];return r&&e.push(yQ.of((e=>{let i=e.plugin(t);return i?r(i):FM.none}))),n&&e.push(n(t)),e}))}static fromClass(t,e){return bQ.define((e=>new t(e)),e)}}class OQ{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(e){if(dQ(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){dQ(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null===(e=this.value)||void 0===e?void 0:e.destroy)try{this.value.destroy()}catch(e){dQ(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const vQ=jT.define(),wQ=jT.define(),yQ=jT.define(),xQ=jT.define(),kQ=jT.define(),SQ=jT.define();class CQ{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new CQ(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(0==e.length)return t;let i=[];for(let n=0,r=0,s=0,o=0;;n++){let l=n==t.length?null:t[n],a=s-o,h=l?l.fromB:1e9;for(;r<e.length&&e[r]<h;){let t=e[r],n=e[r+1],s=Math.max(o,t),l=Math.min(h,n);if(s<=l&&new CQ(s+a,l+a,s,l).addToSet(i),n>h)break;r+=2}if(!l)return i;new CQ(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),s=l.toA,o=l.toB}}}class AQ{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=$T.empty(this.startState.doc.length);for(let t of i)this.changes=this.changes.compose(t.changes);let n=[];this.changes.iterChangedRanges(((t,e,i,r)=>n.push(new CQ(t,e,i,r)))),this.changedRanges=n;let r=t.hasFocus;r!=t.inputState.notifiedFocused&&(t.inputState.notifiedFocused=r,this.flags|=1)}static create(t,e,i){return new AQ(t,e,i)}get viewportChanged(){return(4&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(10&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((t=>t.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}var TQ=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(TQ||(TQ={}));const PQ=TQ.LTR,MQ=TQ.RTL;function QQ(t){let e=[];for(let i=0;i<t.length;i++)e.push(1<<+t[i]);return e}const RQ=QQ("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),$Q=QQ("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),_Q=Object.create(null),DQ=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),i=t.charCodeAt(1);_Q[e]=i,_Q[i]=-e}const EQ=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;class NQ{constructor(t,e,i){this.from=t,this.to=e,this.level=i}get dir(){return this.level%2?MQ:PQ}side(t,e){return this.dir==e==t?this.to:this.from}static find(t,e,i,n){let r=-1;for(let s=0;s<t.length;s++){let o=t[s];if(o.from<=e&&o.to>=e){if(o.level==i)return s;(r<0||(0!=n?n<0?o.from<e:o.to>e:t[r].level>o.level))&&(r=s)}}if(r<0)throw new RangeError("Index out of range");return r}}const BQ=[];function IQ(t){return[new NQ(0,t,0)]}let zQ="";function LQ(t,e,i,n,r){var s;let o=n.head-t.from,l=-1;if(0==o){if(!r||!t.length)return null;e[0].level!=i&&(o=e[0].side(!1,i),l=0)}else if(o==t.length){if(r)return null;let t=e[e.length-1];t.level!=i&&(o=t.side(!0,i),l=e.length-1)}l<0&&(l=NQ.find(e,o,null!==(s=n.bidiLevel)&&void 0!==s?s:-1,n.assoc));let a=e[l];o==a.side(r,i)&&(a=e[l+=r?1:-1],o=a.side(!r,i));let h=r==(a.dir==i),c=xT(t.text,o,h);if(zQ=t.text.slice(Math.min(o,c),Math.max(o,c)),c!=a.side(r,i))return LT.cursor(c+t.from,h?-1:1,a.level);let u=l==(r?e.length-1:0)?null:e[l+(r?1:-1)];return u||a.level==i?u&&u.level<a.level?LT.cursor(u.side(!r,i)+t.from,r?1:-1,u.level):LT.cursor(c+t.from,r?-1:1,a.level):LT.cursor(r?t.to:t.from,r?-1:1,i)}const WQ="￿";class VQ{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(RP.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=WQ}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n),this.readNode(n);let t=n.nextSibling;if(t==e)break;let r=pM.get(n),s=pM.get(t);(r&&s?r.breakAfter:(r?r.breakAfter:jQ(n))||jQ(t)&&("BR"!=n.nodeName||n.cmIgnore))&&this.lineBreak(),n=t}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let r,s=-1,o=1;if(this.lineSeparator?(s=e.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(r=n.exec(e))&&(s=r.index,o=r[0].length),this.append(e.slice(i,s<0?e.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let e of this.points)e.node==t&&e.pos>this.text.length&&(e.pos-=o-1);i=s+o}}readNode(t){if(t.cmIgnore)return;let e=pM.get(t),i=e&&e.overrideDOMText;if(null!=i){this.findPointInside(t,i.length);for(let t=i.iter();!t.next().done;)t.lineBreak?this.lineBreak():this.append(t.value)}else 3==t.nodeType?this.readTextNode(t):"BR"==t.nodeName?t.nextSibling&&this.lineBreak():1==t.nodeType&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(3==t.nodeType?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+Math.min(e,i.offset))}}function jQ(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}class qQ{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class HQ extends pM{constructor(t){super(),this.view=t,this.compositionDeco=FM.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new JM],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new CQ(0,0,0,t.state.doc.length)],0)}get root(){return this.view.root}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(t){let e=t.changedRanges;this.minWidth>0&&e.length&&(e.every((({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo))?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=FM.none:(t.transactions.length||this.dirty)&&(this.compositionDeco=function(t,e){let i=FQ(t);if(!i)return FM.none;let{from:n,to:r,node:s,text:o}=i,l=e.mapPos(n,1),a=Math.max(l,e.mapPos(r,-1)),{state:h}=t,c=3==s.nodeType?s.nodeValue:new VQ([],h).readRange(s.firstChild,null).text;if(a-l<c.length)if(h.doc.sliceString(l,Math.min(h.doc.length,l+c.length),WQ)==c)a=l+c.length;else{if(h.doc.sliceString(Math.max(0,a-c.length),a,WQ)!=c)return FM.none;l=a-c.length}else if(h.doc.sliceString(l,a,WQ)!=c)return FM.none;let u=pM.get(s);u instanceof EM?u=u.widget.topView:u&&(u.parent=null);return FM.set(FM.replace({widget:new ZQ(s,o,u),inclusive:!0}).range(l,a))}(this.view,t.changes)),(QM.ie||QM.chrome)&&!this.compositionDeco.size&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let i=function(t,e,i){let n=new UQ;return NP.compare(t,e,i,n),n.changes}(this.decorations,this.updateDeco(),t.changes);return e=CQ.extendWithRanges(e,i),(0!=this.dirty||0!=e.length)&&(this.updateInner(e,t.startState.doc.length),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e);let{observer:i}=this.view;i.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let t=QM.chrome||QM.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(t),this.dirty=0,t&&(t.written||i.selectionRange.focusNode!=t.node)&&(this.forceSelection=!0),this.dom.style.height=""}));let n=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let t of this.children)t instanceof tQ&&t.widget instanceof XQ&&n.push(t.dom);i.updateGaps(n)}updateChildren(t,e){let i=this.childCursor(e);for(let e=t.length-1;;e--){let n=e>=0?t[e]:null;if(!n)break;let{fromA:r,toA:s,fromB:o,toB:l}=n,{content:a,breakAtStart:h,openStart:c,openEnd:u}=eQ.build(this.view.state.doc,o,l,this.decorations,this.dynamicDecorationMap),{i:f,off:d}=i.findPos(s,1),{i:p,off:g}=i.findPos(r,-1);bM(this,p,g,f,d,a,h,c,u)}}updateSelection(t=!1,e=!1){if(t&&this.view.observer.readSelectionRange(),!e&&!this.mayControlSelection()||QM.ios&&this.view.inputState.rapidCompositionStart)return;let i=this.forceSelection;this.forceSelection=!1;let n=this.view.state.selection.main,r=this.domAtPos(n.anchor),s=n.empty?r:this.domAtPos(n.head);if(QM.gecko&&n.empty&&(1==(o=r).node.nodeType&&o.node.firstChild&&(0==o.offset||"false"==o.node.childNodes[o.offset-1].contentEditable)&&(o.offset==o.node.childNodes.length||"false"==o.node.childNodes[o.offset].contentEditable))){let t=document.createTextNode("");this.view.observer.ignore((()=>r.node.insertBefore(t,r.node.childNodes[r.offset]||null))),r=s=new fM(t,0),i=!0}var o;let l=this.view.observer.selectionRange;!i&&l.focusNode&&KP(r.node,r.offset,l.anchorNode,l.anchorOffset)&&KP(s.node,s.offset,l.focusNode,l.focusOffset)||(this.view.observer.ignore((()=>{QM.android&&QM.chrome&&this.dom.contains(l.focusNode)&&function(t,e){for(let i=t;i&&i!=e;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}(l.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let t=ZP(this.root);if(n.empty){if(QM.gecko){let t=(e=r.node,i=r.offset,1!=e.nodeType?0:(i&&"false"==e.childNodes[i-1].contentEditable?1:0)|(i<e.childNodes.length&&"false"==e.childNodes[i].contentEditable?2:0));if(t&&3!=t){let e=GQ(r.node,r.offset,1==t?1:-1);e&&(r=new fM(e,1==t?0:e.nodeValue.length))}}t.collapse(r.node,r.offset),null!=n.bidiLevel&&null!=l.cursorBidiLevel&&(l.cursorBidiLevel=n.bidiLevel)}else if(t.extend)t.collapse(r.node,r.offset),t.extend(s.node,s.offset);else{let e=document.createRange();n.anchor>n.head&&([r,s]=[s,r]),e.setEnd(s.node,s.offset),e.setStart(r.node,r.offset),t.removeAllRanges(),t.addRange(e)}var e,i})),this.view.observer.setSelectionRange(r,s)),this.impreciseAnchor=r.precise?null:new fM(l.anchorNode,l.anchorOffset),this.impreciseHead=s.precise?null:new fM(l.focusNode,l.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let t=this.view.state.selection.main,e=ZP(this.root);if(!t.empty||!t.assoc||!e.modify)return;let i=JM.find(this,t.head);if(!i)return;let n=i.posAtStart;if(t.head==n||t.head==n+i.length)return;let r=this.coordsAt(t.head,-1),s=this.coordsAt(t.head,1);if(!r||!s||r.bottom>s.top)return;let o=this.domAtPos(t.head+t.assoc);e.collapse(o.node,o.offset),e.modify("move",t.assoc<0?"forward":"backward","lineboundary")}mayControlSelection(){return this.view.state.facet(pQ)?this.root.activeElement==this.dom:UP(this.dom,this.view.observer.selectionRange)}nearest(t){for(let e=t;e;){let t=pM.get(e);if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(i<t.length||t instanceof JM)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){for(let i=this.length,n=this.children.length-1;;n--){let r=this.children[n],s=i-r.breakAfter-r.length;if(t>s||t==s&&r.type!=XM.WidgetBefore&&r.type!=XM.WidgetAfter&&(!n||2==e||this.children[n-1].breakAfter||this.children[n-1].type==XM.WidgetBefore&&e>-2))return r.coordsAt(t-s,e);i=s}}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,r=this.view.contentDOM.clientWidth,s=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,l=this.view.textDirection==TQ.LTR;for(let t=0,a=0;a<this.children.length;a++){let h=this.children[a],c=t+h.length;if(c>n)break;if(t>=i){let i=h.dom.getBoundingClientRect();if(e.push(i.height),s){let e=h.dom.lastChild,n=e?YP(e):[];if(n.length){let e=n[n.length-1],s=l?e.right-i.left:i.right-e.left;s>o&&(o=s,this.minWidth=r,this.minWidthFrom=t,this.minWidthTo=c)}}}t=c+h.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return"rtl"==getComputedStyle(this.children[e].dom).direction?TQ.RTL:TQ.LTR}measureTextSize(){for(let t of this.children)if(t instanceof JM){let e=t.measureTextSize();if(e)return e}let t,e,i=document.createElement("div");return i.className="cm-line",i.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(i);let n=YP(i.firstChild)[0];t=i.getBoundingClientRect().height,e=n?n.width/27:7,i.remove()})),{lineHeight:t,charWidth:e}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new mM(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let r=n==e.viewports.length?null:e.viewports[n],s=r?r.from-1:this.length;if(s>i){let n=e.lineBlockAt(s).bottom-e.lineBlockAt(i).top;t.push(FM.replace({widget:new XQ(n),block:!0,inclusive:!0,isBlockGap:!0}).range(i,s))}if(!r)break;i=r.to+1}return FM.set(t)}updateDeco(){let t=this.view.state.facet(yQ).map(((t,e)=>(this.dynamicDecorationMap[e]="function"==typeof t)?t(this.view):t));for(let e=t.length;e<t.length+3;e++)this.dynamicDecorationMap[e]=!1;return this.decorations=[...t,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(t){let e,{range:i}=t,n=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1);if(!n)return;!i.empty&&(e=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(n={left:Math.min(n.left,e.left),top:Math.min(n.top,e.top),right:Math.max(n.right,e.right),bottom:Math.max(n.bottom,e.bottom)});let r=0,s=0,o=0,l=0;for(let t of this.view.state.facet(kQ).map((t=>t(this.view))))if(t){let{left:e,right:i,top:n,bottom:a}=t;null!=e&&(r=Math.max(r,e)),null!=i&&(s=Math.max(s,i)),null!=n&&(o=Math.max(o,n)),null!=a&&(l=Math.max(l,a))}let a={left:n.left-r,top:n.top-o,right:n.right+s,bottom:n.bottom+l};!function(t,e,i,n,r,s,o,l){let a=t.ownerDocument,h=a.defaultView;for(let c=t;c;)if(1==c.nodeType){let t,u=c==a.body;if(u)t=rM(h);else{if(c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.parentNode;continue}let e=c.getBoundingClientRect();t={left:e.left,right:e.left+c.clientWidth,top:e.top,bottom:e.top+c.clientHeight}}let f=0,d=0;if("nearest"==r)e.top<t.top?(d=-(t.top-e.top+o),i>0&&e.bottom>t.bottom+d&&(d=e.bottom-t.bottom+d+o)):e.bottom>t.bottom&&(d=e.bottom-t.bottom+o,i<0&&e.top-d<t.top&&(d=-(t.top+d-e.top+o)));else{let n=e.bottom-e.top,s=t.bottom-t.top;d=("center"==r&&n<=s?e.top+n/2-s/2:"start"==r||"center"==r&&i<0?e.top-o:e.bottom-s+o)-t.top}if("nearest"==n?e.left<t.left?(f=-(t.left-e.left+s),i>0&&e.right>t.right+f&&(f=e.right-t.right+f+s)):e.right>t.right&&(f=e.right-t.right+s,i<0&&e.left<t.left+f&&(f=-(t.left+f-e.left+s))):f=("center"==n?e.left+(e.right-e.left)/2-(t.right-t.left)/2:"start"==n==l?e.left-s:e.right-(t.right-t.left)+s)-t.left,f||d)if(u)h.scrollBy(f,d);else{if(d){let t=c.scrollTop;c.scrollTop+=d,d=c.scrollTop-t}if(f){let t=c.scrollLeft;c.scrollLeft+=f,f=c.scrollLeft-t}e={left:e.left-f,top:e.top-d,right:e.right-f,bottom:e.bottom-d}}if(u)break;c=c.assignedSlot||c.parentNode,n=r="nearest"}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,a,i.head<i.anchor?-1:1,t.x,t.y,t.xMargin,t.yMargin,this.view.textDirection==TQ.LTR)}}class XQ extends HM{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function FQ(t){let e=t.observer.selectionRange,i=e.focusNode&&GQ(e.focusNode,e.focusOffset,0);if(!i)return null;let n=t.docView.nearest(i);if(!n)return null;if(n instanceof JM){let t=i;for(;t.parentNode!=n.dom;)t=t.parentNode;let e=t.previousSibling;for(;e&&!pM.get(e);)e=e.previousSibling;let r=e?pM.get(e).posAtEnd:n.posAtStart;return{from:r,to:r,node:t,text:i}}{for(;;){let{parent:t}=n;if(!t)return null;if(t instanceof JM)break;n=t}let t=n.posAtStart;return{from:t,to:t+n.length,node:n.dom,text:i}}}class ZQ extends HM{constructor(t,e,i){super(),this.top=t,this.text=e,this.topView=i}eq(t){return this.top==t.top&&this.text==t.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return EM}}function GQ(t,e,i){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0&&i<=0)e=eM(t=t.childNodes[e-1]);else{if(!(1==t.nodeType&&e<t.childNodes.length&&i>=0))return null;t=t.childNodes[e],e=0}}}class UQ{constructor(){this.changes=[]}compareRange(t,e){KM(t,e,this.changes)}comparePoint(t,e){KM(t,e,this.changes)}}function YQ(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function KQ(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function JQ(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function tR(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function eR(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function iR(t,e,i){let n,r,s,o,l,a,h,c;for(let u=t.firstChild;u;u=u.nextSibling){let t=YP(u);for(let f=0;f<t.length;f++){let d=t[f];r&&JQ(r,d)&&(d=tR(eR(d,r.bottom),r.top));let p=YQ(e,d),g=KQ(i,d);if(0==p&&0==g)return 3==u.nodeType?nR(u,e,i):iR(u,e,i);(!n||o>g||o==g&&s>p)&&(n=u,r=d,s=p,o=g),0==p?i>d.bottom&&(!h||h.bottom<d.bottom)?(l=u,h=d):i<d.top&&(!c||c.top>d.top)&&(a=u,c=d):h&&JQ(h,d)?h=eR(h,d.bottom):c&&JQ(c,d)&&(c=tR(c,d.top))}}if(h&&h.bottom>=i?(n=l,r=h):c&&c.top<=i&&(n=a,r=c),!n)return{node:t,offset:0};let u=Math.max(r.left,Math.min(r.right,e));return 3==n.nodeType?nR(n,u,i):s||"true"!=n.contentEditable?{node:t,offset:Array.prototype.indexOf.call(t.childNodes,n)+(e>=(r.left+r.right)/2?1:0)}:iR(n,u,i)}function nR(t,e,i){let n=t.nodeValue.length,r=-1,s=1e9,o=0;for(let l=0;l<n;l++){let n=hM(t,l,l+1).getClientRects();for(let a=0;a<n.length;a++){let h=n[a];if(h.top==h.bottom)continue;o||(o=e-h.left);let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&c<s){let i=e>=(h.left+h.right)/2,n=i;if(QM.chrome||QM.gecko){hM(t,l).getBoundingClientRect().left==h.right&&(n=!i)}if(c<=0)return{node:t,offset:l+(n?1:0)};r=l+(n?1:0),s=c}}}return{node:t,offset:r>-1?r:o>0?t.nodeValue.length:0}}function rR(t,{x:e,y:i},n,r=-1){var s;let o,l=t.contentDOM.getBoundingClientRect(),a=l.top+t.viewState.paddingTop,{docHeight:h}=t.viewState,c=i-a;if(c<0)return 0;if(c>h)return t.state.doc.length;for(let e=t.defaultLineHeight/2,i=!1;o=t.elementAtHeight(c),o.type!=XM.Text;)for(;c=r>0?o.bottom+e:o.top-e,!(c>=0&&c<=h);){if(i)return n?null:0;i=!0,r=-r}i=a+c;let u=o.from;if(u<t.viewport.from)return 0==t.viewport.from?0:n?null:sR(t,l,o,e,i);if(u>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:n?null:sR(t,l,o,e,i);let f=t.dom.ownerDocument,d=t.root.elementFromPoint?t.root:f,p=d.elementFromPoint(e,i);p&&!t.contentDOM.contains(p)&&(p=null),p||(e=Math.max(l.left+1,Math.min(l.right-1,e)),p=d.elementFromPoint(e,i),p&&!t.contentDOM.contains(p)&&(p=null));let g,m=-1;if(p&&0!=(null===(s=t.docView.nearest(p))||void 0===s?void 0:s.isEditable))if(f.caretPositionFromPoint){let t=f.caretPositionFromPoint(e,i);t&&({offsetNode:g,offset:m}=t)}else if(f.caretRangeFromPoint){let t=f.caretRangeFromPoint(e,i);t&&(({startContainer:g,startOffset:m}=t),QM.safari&&function(t,e,i){let n;if(3!=t.nodeType||e!=(n=t.nodeValue.length))return!1;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return hM(t,n-1,n).getBoundingClientRect().left>i}(g,m,e)&&(g=void 0))}if(!g||!t.docView.dom.contains(g)){let n=JM.find(t.docView,u);if(!n)return c>o.top+o.height/2?o.to:o.from;({node:g,offset:m}=iR(n.dom,e,i))}return t.docView.posFromDOM(g,m)}function sR(t,e,i,n,r){let s=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&i.height>1.5*t.defaultLineHeight){s+=Math.floor((r-i.top)/t.defaultLineHeight)*t.viewState.heightOracle.lineLength}let o=t.state.sliceDoc(i.from,i.to);return i.from+function(t,e,i,n){for(let n=0,r=0;;){if(r>=e)return n;if(n==t.length)break;r+=9==t.charCodeAt(n)?i-r%i:1,n=xT(t,n)}return!0===n?-1:t.length}(o,s,t.state.tabSize)}function oR(t,e,i,n){let r=t.state.doc.lineAt(e.head),s=t.bidiSpans(r),o=t.textDirectionAt(r.from);for(let l=e,a=null;;){let e=LQ(r,s,o,l,i),h=zQ;if(!e){if(r.number==(i?t.state.doc.lines:1))return l;h="\n",r=t.state.doc.line(r.number+(i?1:-1)),s=t.bidiSpans(r),e=LT.cursor(i?r.from:r.to)}if(a){if(!a(h))return l}else{if(!n)return e;a=n(h)}l=e}}function lR(t,e,i){let n=t.state.facet(xQ).map((e=>e(t)));for(;;){let t=!1;for(let r of n)r.between(i.from-1,i.from+1,((n,r,s)=>{i.from>n&&i.from<r&&(i=e.from>i.from?LT.cursor(n,1):LT.cursor(r,-1),t=!0)}));if(!t)return i}}class aR{constructor(t){this.lastKeyCode=0,this.lastKeyTime=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.rapidCompositionStart=!1,this.mouseSelection=null;for(let e in dR){let i=dR[e];t.contentDOM.addEventListener(e,(n=>{fR(t,n)&&!this.ignoreDuringComposition(n)&&("keydown"==e&&this.keydown(t,n)||(this.mustFlushObserver(n)&&t.observer.forceFlush(),this.runCustomHandlers(e,t,n)?n.preventDefault():i(t,n)))})),this.registeredEvents.push(e)}QM.chrome&&QM.chrome_version>=102&&t.scrollDOM.addEventListener("wheel",(()=>{this.chromeScrollHack<0?t.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout((()=>{this.chromeScrollHack=-1,t.contentDOM.style.pointerEvents=""}),100)}),{passive:!0}),this.notifiedFocused=t.hasFocus,QM.safari&&t.contentDOM.addEventListener("input",(()=>null))}setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}ensureHandlers(t,e){var i;let n;this.customHandlers=[];for(let r of e)if(n=null===(i=r.update(t).spec)||void 0===i?void 0:i.domEventHandlers){this.customHandlers.push({plugin:r.value,handlers:n});for(let e in n)this.registeredEvents.indexOf(e)<0&&"scroll"!=e&&(this.registeredEvents.push(e),t.contentDOM.addEventListener(e,(i=>{fR(t,i)&&this.runCustomHandlers(e,t,i)&&i.preventDefault()})))}}runCustomHandlers(t,e,i){for(let n of this.customHandlers){let r=n.handlers[t];if(r)try{if(r.call(n.plugin,i,e)||i.defaultPrevented)return!0}catch(t){dQ(e.state,t)}}return!1}runScrollHandlers(t,e){for(let i of this.customHandlers){let n=i.handlers.scroll;if(n)try{n.call(i.plugin,e,t)}catch(e){dQ(t.state,e)}}}keydown(t,e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),9==e.keyCode&&Date.now()<this.lastEscPress+2e3)return!0;if(QM.android&&QM.chrome&&!e.synthetic&&(13==e.keyCode||8==e.keyCode))return t.observer.delayAndroidKey(e.key,e.keyCode),!0;let i;return!(!QM.ios||!(i=hR.find((t=>t.keyCode==e.keyCode)))||e.ctrlKey||e.altKey||e.metaKey||e.synthetic)&&(this.pendingIOSKey=i,setTimeout((()=>this.flushIOSKey(t)),250),!0)}flushIOSKey(t){let e=this.pendingIOSKey;return!!e&&(this.pendingIOSKey=void 0,cM(t.contentDOM,e.key,e.keyCode))}ignoreDuringComposition(t){return!!/^key/.test(t.type)&&(this.composing>0||!!(QM.safari&&Date.now()-this.compositionEndedAt<100)&&(this.compositionEndedAt=0,!0))}mustFlushObserver(t){return"keydown"==t.type&&229!=t.keyCode||"compositionend"==t.type&&!QM.ios}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.mouseSelection&&this.mouseSelection.update(t),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const hR=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],cR=[16,17,18,20,91,92,224,225];class uR{constructor(t,e,i,n){this.view=t,this.style=i,this.mustSelect=n,this.lastEvent=e;let r=t.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(RP.allowMultipleSelections)&&function(t,e){let i=t.state.facet(rQ);return i.length?i[0](e):QM.mac?e.metaKey:e.ctrlKey}(t,e),this.dragMove=function(t,e){let i=t.state.facet(sQ);return i.length?i[0](e):QM.mac?!e.altKey:!e.ctrlKey}(t,e),this.dragging=!(!function(t,e){let{main:i}=t.state.selection;if(i.empty)return!1;let n=ZP(t.root);if(0==n.rangeCount)return!0;let r=n.getRangeAt(0).getClientRects();for(let t=0;t<r.length;t++){let i=r[t];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}(t,e)||1!=AR(e))&&null,!1===this.dragging&&(e.preventDefault(),this.select(e))}move(t){if(0==t.buttons)return this.destroy();!1===this.dragging&&this.select(this.lastEvent=t)}up(t){null==this.dragging&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}select(t){let e=this.style.get(t,this.extend,this.multiple);!this.mustSelect&&e.eq(this.view.state.selection)&&e.main.assoc==this.view.state.selection.main.assoc||this.view.dispatch({selection:e,userEvent:"select.pointer",scrollIntoView:!0}),this.mustSelect=!1}update(t){t.docChanged&&this.dragging&&(this.dragging=this.dragging.map(t.changes)),this.style.update(t)&&setTimeout((()=>this.select(this.lastEvent)),20)}}function fR(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i,n=e.target;n!=t.contentDOM;n=n.parentNode)if(!n||11==n.nodeType||(i=pM.get(n))&&i.ignoreEvent(e))return!1;return!0}const dR=Object.create(null),pR=QM.ie&&QM.ie_version<15||QM.ios&&QM.webkit_version<604;function gR(t,e){let i,{state:n}=t,r=1,s=n.toText(e),o=s.lines==n.selection.ranges.length;if(null!=PR&&n.selection.ranges.every((t=>t.empty))&&PR==s.toString()){let t=-1;i=n.changeByRange((i=>{let l=n.doc.lineAt(i.from);if(l.from==t)return{range:i};t=l.from;let a=n.toText((o?s.line(r++).text:e)+n.lineBreak);return{changes:{from:l.from,insert:a},range:LT.cursor(i.from+a.length)}}))}else i=o?n.changeByRange((t=>{let e=s.line(r++);return{changes:{from:t.from,to:t.to,insert:e.text},range:LT.cursor(t.from+e.length)}})):n.replaceSelection(s);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}dR.keydown=(t,e)=>{t.inputState.setSelectionOrigin("select"),27==e.keyCode?t.inputState.lastEscPress=Date.now():cR.indexOf(e.keyCode)<0&&(t.inputState.lastEscPress=0)};let mR=0;function bR(t,e,i,n){if(1==n)return LT.cursor(e,i);if(2==n)return function(t,e,i=1){let n=t.charCategorizer(e),r=t.doc.lineAt(e),s=e-r.from;if(0==r.length)return LT.cursor(e);0==s?i=1:s==r.length&&(i=-1);let o=s,l=s;i<0?o=xT(r.text,s,!1):l=xT(r.text,s);let a=n(r.text.slice(o,l));for(;o>0;){let t=xT(r.text,o,!1);if(n(r.text.slice(t,o))!=a)break;o=t}for(;l<r.length;){let t=xT(r.text,l);if(n(r.text.slice(l,t))!=a)break;l=t}return LT.range(o+r.from,l+r.from)}(t.state,e,i);{let i=JM.find(t.docView,e),n=t.state.doc.lineAt(i?i.posAtEnd:e),r=i?i.posAtStart:n.from,s=i?i.posAtEnd:n.to;return s<t.state.doc.length&&s==n.to&&s++,LT.range(r,s)}}dR.touchstart=(t,e)=>{mR=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},dR.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")},dR.mousedown=(t,e)=>{if(t.observer.flush(),mR>Date.now()-2e3&&1==AR(e))return;let i=null;for(let n of t.state.facet(oQ))if(i=n(t,e),i)break;if(i||0!=e.button||(i=function(t,e){let i=yR(t,e),n=AR(e),r=t.state.selection,s=i,o=e;return{update(t){t.docChanged&&(i&&(i.pos=t.changes.mapPos(i.pos)),r=r.map(t.changes),o=null)},get(e,l,a){let h;if(o&&e.clientX==o.clientX&&e.clientY==o.clientY?h=s:(h=s=yR(t,e),o=e),!h||!i)return r;let c=bR(t,h.pos,h.bias,n);if(i.pos!=h.pos&&!l){let e=bR(t,i.pos,i.bias,n),r=Math.min(e.from,c.from),s=Math.max(e.to,c.to);c=r<c.from?LT.range(r,s):LT.range(s,r)}return l?r.replaceRange(r.main.extend(c.from,c.to)):a?r.addRange(c):LT.create([c])}}}(t,e)),i){let n=t.root.activeElement!=t.contentDOM;n&&t.observer.ignore((()=>aM(t.contentDOM))),t.inputState.startMouseSelection(new uR(t,e,i,n))}};let OR=(t,e)=>t>=e.top&&t<=e.bottom,vR=(t,e,i)=>OR(e,i)&&t>=i.left&&t<=i.right;function wR(t,e,i,n){let r=JM.find(t.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(0==s)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&vR(i,n,o))return-1;let l=r.coordsAt(s,1);return l&&vR(i,n,l)?1:o&&OR(n,o)?-1:1}function yR(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:wR(t,i,e.clientX,e.clientY)}}const xR=QM.ie&&QM.ie_version<=11;let kR=null,SR=0,CR=0;function AR(t){if(!xR)return t.detail;let e=kR,i=CR;return kR=t,CR=Date.now(),SR=!e||i>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(SR+1)%3:1}function TR(t,e,i,n){if(!i)return;let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:s}=t.inputState,o=n&&s&&s.dragging&&s.dragMove?{from:s.dragging.from,to:s.dragging.to}:null,l={from:r,insert:i},a=t.state.changes(o?[o,l]:l);t.focus(),t.dispatch({changes:a,selection:{anchor:a.mapPos(r,-1),head:a.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"})}dR.dragstart=(t,e)=>{let{selection:{main:i}}=t.state,{mouseSelection:n}=t.inputState;n&&(n.dragging=i),e.dataTransfer&&(e.dataTransfer.setData("Text",t.state.sliceDoc(i.from,i.to)),e.dataTransfer.effectAllowed="copyMove")},dR.drop=(t,e)=>{if(!e.dataTransfer)return;if(t.state.readOnly)return e.preventDefault();let i=e.dataTransfer.files;if(i&&i.length){e.preventDefault();let n=Array(i.length),r=0,s=()=>{++r==i.length&&TR(t,e,n.filter((t=>null!=t)).join(t.state.lineBreak),!1)};for(let t=0;t<i.length;t++){let e=new FileReader;e.onerror=s,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(n[t]=e.result),s()},e.readAsText(i[t])}}else TR(t,e,e.dataTransfer.getData("Text"),!0)},dR.paste=(t,e)=>{if(t.state.readOnly)return e.preventDefault();t.observer.flush();let i=pR?null:e.clipboardData;i?(gR(t,i.getData("text/plain")),e.preventDefault()):function(t){let e=t.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((()=>{t.focus(),i.remove(),gR(t,i.value)}),50)}(t)};let PR=null;function MR(t){setTimeout((()=>{t.hasFocus!=t.inputState.notifiedFocused&&t.update([])}),10)}function QR(t,e){if(t.docView.compositionDeco.size){t.inputState.rapidCompositionStart=e;try{t.update([])}finally{t.inputState.rapidCompositionStart=!1}}}dR.copy=dR.cut=(t,e)=>{let{text:i,ranges:n,linewise:r}=function(t){let e=[],i=[],n=!1;for(let n of t.selection.ranges)n.empty||(e.push(t.sliceDoc(n.from,n.to)),i.push(n));if(!e.length){let r=-1;for(let{from:n}of t.selection.ranges){let s=t.doc.lineAt(n);s.number>r&&(e.push(s.text),i.push({from:s.from,to:Math.min(t.doc.length,s.to+1)})),r=s.number}n=!0}return{text:e.join(t.lineBreak),ranges:i,linewise:n}}(t.state);if(!i&&!r)return;PR=r?i:null;let s=pR?null:e.clipboardData;s?(e.preventDefault(),s.clearData(),s.setData("text/plain",i)):function(t,e){let i=t.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout((()=>{n.remove(),t.focus()}),50)}(t,i),"cut"!=e.type||t.state.readOnly||t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"})},dR.focus=MR,dR.blur=t=>{t.observer.clearSelectionRange(),MR(t)},dR.compositionstart=dR.compositionupdate=t=>{null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0,t.docView.compositionDeco.size&&(t.observer.flush(),QR(t,!0)))},dR.compositionend=t=>{t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionFirstChange=null,setTimeout((()=>{t.inputState.composing<0&&QR(t,!1)}),50)},dR.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()},dR.beforeinput=(t,e)=>{var i;let n;if(QM.chrome&&QM.android&&(n=hR.find((t=>t.inputType==e.inputType)))&&(t.observer.delayAndroidKey(n.key,n.keyCode),"Backspace"==n.key||"Delete"==n.key)){let e=(null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0;setTimeout((()=>{var i;((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>e+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())}),100)}};const RR=["pre-wrap","normal","pre-line","break-spaces"];class $R{constructor(){this.doc=cT.empty,this.lineWrapping=!1,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength)),this.lineHeight*i}heightForLine(t){if(!this.lineWrapping)return this.lineHeight;return(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return RR.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(10*n)]||(e=!0,this.heightSamples[Math.floor(10*n)]=!0)}return e}refresh(t,e,i,n,r){let s=RR.indexOf(t)>-1,o=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=s;if(this.lineWrapping=s,this.lineHeight=e,this.charWidth=i,this.lineLength=n,o){this.heightSamples={};for(let t=0;t<r.length;t++){let e=r[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return o}}class _R{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class DR{constructor(t,e,i,n,r){this.from=t,this.length=e,this.top=i,this.height=n,this.type=r}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(t){let e=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(t.type)?t.type:[t]);return new DR(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var ER=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(ER||(ER={}));const NR=.001;class BR{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t,e){this.height!=e&&(Math.abs(this.height-e)>NR&&(t.heightChanged=!0),this.height=e)}replace(t,e,i){return BR.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let r=this;for(let s=n.length-1;s>=0;s--){let{fromA:o,toA:l,fromB:a,toB:h}=n[s],c=r.lineAt(o,ER.ByPosNoHeight,e,0,0),u=c.to>=l?c:r.lineAt(l,ER.ByPosNoHeight,e,0,0);for(h+=u.to-l,l=u.to;s>0&&c.from<=n[s-1].toA;)o=n[s-1].fromA,a=n[s-1].fromB,s--,o<c.from&&(c=r.lineAt(o,ER.ByPosNoHeight,e,0,0));a+=c.from-o,o=c.from;let f=jR.build(i,t,a,h);r=r.replace(o,l,f)}return r.updateHeight(i,0)}static empty(){return new zR(0,0)}static of(t){if(1==t.length)return t[0];let e=0,i=t.length,n=0,r=0;for(;;)if(e==i)if(n>2*r){let r=t[e-1];r.break?t.splice(--e,1,r.left,null,r.right):t.splice(--e,1,r.left,r.right),i+=1+r.break,n-=r.size}else{if(!(r>2*n))break;{let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,r-=e.size}}else if(n<r){let i=t[e++];i&&(n+=i.size)}else{let e=t[--i];e&&(r+=e.size)}let s=0;return null==t[e-1]?(s=1,e--):null==t[e]&&(s=1,i++),new WR(BR.of(t.slice(0,e)),s,BR.of(t.slice(i)))}}BR.prototype.size=1;class IR extends BR{constructor(t,e,i){super(t,e),this.type=i}blockAt(t,e,i,n){return new DR(n,this.length,i,this.height,this.type)}lineAt(t,e,i,n,r){return this.blockAt(0,i,n,r)}forEachLine(t,e,i,n,r,s){t<=r+this.length&&e>=r&&s(this.blockAt(0,i,n,r))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(t,n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class zR extends IR{constructor(t,e){super(t,e,XM.Text),this.collapsed=0,this.widgetHeight=0}replace(t,e,i){let n=i[0];return 1==i.length&&(n instanceof zR||n instanceof LR&&4&n.flags)&&Math.abs(this.length-n.length)<10?(n instanceof LR?n=new zR(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):BR.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(t,n.heights[n.index++]):(i||this.outdated)&&this.setHeight(t,Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class LR extends BR{constructor(t){super(t,0)}lines(t,e){let i=t.lineAt(e).number,n=t.lineAt(e+this.length).number;return{firstLine:i,lastLine:n,lineHeight:this.height/(n-i+1)}}blockAt(t,e,i,n){let{firstLine:r,lastLine:s,lineHeight:o}=this.lines(e,n),l=Math.max(0,Math.min(s-r,Math.floor((t-i)/o))),{from:a,length:h}=e.line(r+l);return new DR(a,h,i+o*l,o,XM.Text)}lineAt(t,e,i,n,r){if(e==ER.ByHeight)return this.blockAt(t,i,n,r);if(e==ER.ByPosNoHeight){let{from:e,to:n}=i.lineAt(t);return new DR(e,n-e,0,0,XM.Text)}let{firstLine:s,lineHeight:o}=this.lines(i,r),{from:l,length:a,number:h}=i.lineAt(t);return new DR(l,a,n+o*(h-s),o,XM.Text)}forEachLine(t,e,i,n,r,s){let{firstLine:o,lineHeight:l}=this.lines(i,r);for(let a=Math.max(t,r),h=Math.min(r+this.length,e);a<=h;){let e=i.lineAt(a);a==t&&(n+=l*(e.number-o)),s(new DR(e.from,e.length,n,l,XM.Text)),n+=l,a=e.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let t=i[i.length-1];t instanceof LR?i[i.length-1]=new LR(t.length+n):i.push(null,new LR(n-1))}if(t>0){let e=i[0];e instanceof LR?i[0]=new LR(t+e.length):i.unshift(new LR(t-1),null)}return BR.of(i)}decomposeLeft(t,e){e.push(new LR(t-1),null)}decomposeRight(t,e){e.push(null,new LR(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let r=e+this.length;if(n&&n.from<=e+this.length&&n.more){let i=[],s=Math.max(e,n.from),o=-1,l=t.heightChanged;for(n.from>e&&i.push(new LR(n.from-e-1).updateHeight(t,e));s<=r&&n.more;){let e=t.doc.lineAt(s).length;i.length&&i.push(null);let r=n.heights[n.index++];-1==o?o=r:Math.abs(r-o)>=NR&&(o=-2);let l=new zR(e,r);l.outdated=!1,i.push(l),s+=e+1}s<=r&&i.push(null,new LR(r-s).updateHeight(t,s));let a=BR.of(i);return t.heightChanged=l||o<0||Math.abs(a.height-this.height)>=NR||Math.abs(o-this.lines(t.doc,e).lineHeight)>=NR,a}return(i||this.outdated)&&(this.setHeight(t,t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class WR extends BR{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return 1&this.flags}blockAt(t,e,i,n){let r=i+this.left.height;return t<r?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,r,n+this.left.length+this.break)}lineAt(t,e,i,n,r){let s=n+this.left.height,o=r+this.left.length+this.break,l=e==ER.ByHeight?t<s:t<o,a=l?this.left.lineAt(t,e,i,n,r):this.right.lineAt(t,e,i,s,o);if(this.break||(l?a.to<o:a.from>o))return a;let h=e==ER.ByPosNoHeight?ER.ByPosNoHeight:ER.ByPos;return l?a.join(this.right.lineAt(o,h,i,s,o)):this.left.lineAt(o,h,i,n,r).join(a)}forEachLine(t,e,i,n,r,s){let o=n+this.left.height,l=r+this.left.length+this.break;if(this.break)t<l&&this.left.forEachLine(t,e,i,n,r,s),e>=l&&this.right.forEachLine(t,e,i,o,l,s);else{let a=this.lineAt(l,ER.ByPos,i,n,r);t<a.from&&this.left.forEachLine(t,a.from-1,i,n,r,s),a.to>=t&&a.from<=e&&s(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,o,l,s)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let r=[];t>0&&this.decomposeLeft(t,r);let s=r.length;for(let t of i)r.push(t);if(t>0&&VR(r,s-1),e<this.length){let t=r.length;this.decomposeRight(e,r),VR(r,t)}return BR.of(r)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?BR.of(this.break?[t,null,e]:[t,e]):(this.left=t,this.right=e,this.height=t.height+e.height,this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:r,right:s}=this,o=e+r.length+this.break,l=null;return n&&n.from<=e+r.length&&n.more?l=r=r.updateHeight(t,e,i,n):r.updateHeight(t,e,i),n&&n.from<=o+s.length&&n.more?l=s=s.updateHeight(t,o,i,n):s.updateHeight(t,o,i),l?this.balanced(r,s):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function VR(t,e){let i,n;null==t[e]&&(i=t[e-1])instanceof LR&&(n=t[e+1])instanceof LR&&t.splice(e-1,3,new LR(i.length+1+n.length))}class jR{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof zR?i.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new zR(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0;n<0&&(n=this.oracle.lineHeight);let r=e-t;i.block?this.addBlock(new IR(r,n,i.type)):(r||n>=5)&&this.addLineDeco(n,r)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new zR(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new LR(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof zR)return t;let e=new zR(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine(),t.type!=XM.WidgetAfter||this.isCovered||this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,t.type!=XM.WidgetBefore&&(this.covering=t)}addLineDeco(t,e){let i=this.ensureLine();i.length+=e,i.collapsed+=e,i.widgetHeight=Math.max(i.widgetHeight,t),this.writtenTo=this.pos=this.pos+e}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof zR||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new zR(0,-1));let i=t;for(let t of this.nodes)t instanceof zR&&t.updateHeight(this.oracle,i),i+=t?t.length:1;return this.nodes}static build(t,e,i,n){let r=new jR(i,t);return NP.spans(e,i,n,r,0),r.finish(i)}}class qR{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&KM(t,e,this.changes,5)}}function HR(t,e){let i=t.getBoundingClientRect(),n=Math.max(0,i.left),r=Math.min(innerWidth,i.right),s=Math.max(0,i.top),o=Math.min(innerHeight,i.bottom),l=t.ownerDocument.body;for(let e=t.parentNode;e&&e!=l;)if(1==e.nodeType){let t=e,i=window.getComputedStyle(t);if((t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)&&"visible"!=i.overflow){let e=t.getBoundingClientRect();n=Math.max(n,e.left),r=Math.min(r,e.right),s=Math.max(s,e.top),o=Math.min(o,e.bottom)}e="absolute"==i.position||"fixed"==i.position?t.offsetParent:t.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{left:n-i.left,right:Math.max(n,r)-i.left,top:s-(i.top+e),bottom:Math.max(s,o)-(i.top+e)}}function XR(t,e){let i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class FR{constructor(t,e,i){this.from=t,this.to=e,this.size=i}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],r=e[i];if(n.from!=r.from||n.to!=r.to||n.size!=r.size)return!1}return!0}draw(t){return FM.replace({widget:new ZR(this.size,t)}).range(this.from,this.to)}}class ZR extends HM{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class GR{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.heightOracle=new $R,this.scaler=i$,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=TQ.RTL,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1,this.stateDeco=t.facet(yQ).filter((t=>"function"!=typeof t)),this.heightMap=BR.empty().applyChanges(this.stateDeco,cT.empty,this.heightOracle.setDoc(t.doc),[new CQ(0,0,0,t.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=FM.set(this.lineGaps.map((t=>t.draw(!1)))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some((({from:t,to:e})=>n>=t&&n<=e))){let{from:e,to:i}=this.lineBlockAt(n);t.push(new UR(e,i))}}this.viewports=t.sort(((t,e)=>t.from-e.from)),this.scaler=this.heightMap.height<=7e6?i$:new n$(this.heightOracle.doc,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,(t=>{this.viewportLines.push(1==this.scaler.scale?t:r$(t,this.scaler))}))}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(yQ).filter((t=>"function"!=typeof t));let n=t.changedRanges,r=CQ.extendWithRanges(n,function(t,e,i){let n=new qR;return NP.compare(t,e,i,n,0),n.changes}(i,this.stateDeco,t?t.changes:$T.empty(this.state.doc.length))),s=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),r),this.heightMap.height!=s&&(t.flags|=2);let o=r.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<o.from||e.range.head>o.to)||!this.viewportIsAppropriate(o))&&(o=this.getViewport(0,e));let l=!t.changes.empty||2&t.flags||o.from!=this.viewport.from||o.to!=this.viewport.to;this.viewport=o,this.updateForViewport(),l&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,r=i.whiteSpace;this.defaultTextDirection="rtl"==i.direction?TQ.RTL:TQ.LTR;let s=this.heightOracle.mustRefreshForWrapping(r),o=s||this.mustMeasureContent||this.contentDOMHeight!=e.clientHeight;this.contentDOMHeight=e.clientHeight,this.mustMeasureContent=!1;let l=0,a=0,h=parseInt(i.paddingTop)||0,c=parseInt(i.paddingBottom)||0;this.paddingTop==h&&this.paddingBottom==c||(this.paddingTop=h,this.paddingBottom=c,l|=10),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(o=!0),this.editorWidth=t.scrollDOM.clientWidth,l|=8);let u=(this.printing?XR:HR)(e,this.paddingTop),f=u.top-this.pixelViewport.top,d=u.bottom-this.pixelViewport.bottom;this.pixelViewport=u;let p=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(p!=this.inView&&(this.inView=p,p&&(o=!0)),!this.inView)return 0;let g=e.clientWidth;if(this.contentDOMWidth==g&&this.editorHeight==t.scrollDOM.clientHeight||(this.contentDOMWidth=g,this.editorHeight=t.scrollDOM.clientHeight,l|=8),o){let e=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(e)&&(s=!0),s||n.lineWrapping&&Math.abs(g-this.contentDOMWidth)>n.charWidth){let{lineHeight:i,charWidth:o}=t.docView.measureTextSize();s=n.refresh(r,i,o,g/o,e),s&&(t.docView.minWidth=0,l|=8)}f>0&&d>0?a=Math.max(f,d):f<0&&d<0&&(a=Math.min(f,d)),n.heightChanged=!1;for(let i of this.viewports){let r=i.from==this.viewport.from?e:t.docView.measureVisibleLineHeights(i);this.heightMap=this.heightMap.updateHeight(n,0,s,new _R(i.from,r))}n.heightChanged&&(l|=2)}let m=!this.viewportIsAppropriate(this.viewport,a)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return m&&(this.viewport=this.getViewport(a,this.scrollTarget)),this.updateForViewport(),(2&l||m)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(s?[]:this.lineGaps)),l|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),l}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,r=this.state.doc,{visibleTop:s,visibleBottom:o}=this,l=new UR(n.lineAt(s-1e3*i,ER.ByHeight,r,0,0).from,n.lineAt(o+1e3*(1-i),ER.ByHeight,r,0,0).to);if(e){let{head:t}=e.range;if(t<l.from||t>l.to){let i,s=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),o=n.lineAt(t,ER.ByPos,r,0,0);i="center"==e.y?(o.top+o.bottom)/2-s/2:"start"==e.y||"nearest"==e.y&&t<l.from?o.top:o.bottom-s,l=new UR(n.lineAt(i-500,ER.ByHeight,r,0,0).from,n.lineAt(i+s+500,ER.ByHeight,r,0,0).to)}}return l}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new UR(this.heightMap.lineAt(i,ER.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(n,ER.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,ER.ByPos,this.state.doc,0,0),{bottom:r}=this.heightMap.lineAt(e,ER.ByPos,this.state.doc,0,0),{visibleTop:s,visibleBottom:o}=this;return(0==t||n<=s-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||r>=o+Math.max(10,Math.min(i,250)))&&n>s-2e3&&r<o+2e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new FR(e.mapPos(n.from),e.mapPos(n.to),n.size));return i}ensureLineGaps(t){let e=[];if(this.defaultTextDirection!=TQ.LTR)return e;for(let i of this.viewportLines){if(i.length<4e3)continue;let n,r,s=YR(i.from,i.to,this.stateDeco);if(s.total<4e3)continue;if(this.heightOracle.lineWrapping){let t=2e3/this.heightOracle.lineLength*this.heightOracle.lineHeight;n=KR(s,(this.visibleTop-i.top-t)/i.height),r=KR(s,(this.visibleBottom-i.top+t)/i.height)}else{let t=s.total*this.heightOracle.charWidth,e=2e3*this.heightOracle.charWidth;n=KR(s,(this.pixelViewport.left-e)/t),r=KR(s,(this.pixelViewport.right+e)/t)}let o=[];n>i.from&&o.push({from:i.from,to:n}),r<i.to&&o.push({from:r,to:i.to});let l=this.state.selection.main;l.from>=i.from&&l.from<=i.to&&t$(o,l.from-10,l.from+10),!l.empty&&l.to>=i.from&&l.to<=i.to&&t$(o,l.to-10,l.to+10);for(let{from:n,to:r}of o)r-n>1e3&&e.push(e$(t,(t=>t.from>=i.from&&t.to<=i.to&&Math.abs(t.from-n)<1e3&&Math.abs(t.to-r)<1e3))||new FR(n,r,this.gapSize(i,n,r,s)))}return e}gapSize(t,e,i,n){let r=JR(n,i)-JR(n,e);return this.heightOracle.lineWrapping?t.height*r:n.total*this.heightOracle.charWidth*r}updateLineGaps(t){FR.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=FM.set(t.map((t=>t.draw(this.heightOracle.lineWrapping)))))}computeVisibleRanges(){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let e=[];NP.spans(t,this.viewport.from,this.viewport.to,{span(t,i){e.push({from:t,to:i})},point(){}},20);let i=e.length!=this.visibleRanges.length||this.visibleRanges.some(((t,i)=>t.from!=e[i].from||t.to!=e[i].to));return this.visibleRanges=e,i?4:0}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find((e=>e.from<=t&&e.to>=t))||r$(this.heightMap.lineAt(t,ER.ByPos,this.state.doc,0,0),this.scaler)}lineBlockAtHeight(t){return r$(this.heightMap.lineAt(this.scaler.fromDOM(t),ER.ByHeight,this.state.doc,0,0),this.scaler)}elementAtHeight(t){return r$(this.heightMap.blockAt(this.scaler.fromDOM(t),this.state.doc,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class UR{constructor(t,e){this.from=t,this.to=e}}function YR(t,e,i){let n=[],r=t,s=0;return NP.spans(i,t,e,{span(){},point(t,e){t>r&&(n.push({from:r,to:t}),s+=t-r),r=e}},20),r<e&&(n.push({from:r,to:e}),s+=e-r),{total:s,ranges:n}}function KR({total:t,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let n=Math.floor(t*i);for(let t=0;;t++){let{from:i,to:r}=e[t],s=r-i;if(n<=s)return i+n;n-=s}}function JR(t,e){let i=0;for(let{from:n,to:r}of t.ranges){if(e<=r){i+=e-n;break}i+=r-n}return i/t.total}function t$(t,e,i){for(let n=0;n<t.length;n++){let r=t[n];if(r.from<i&&r.to>e){let s=[];r.from<e&&s.push({from:r.from,to:e}),r.to>i&&s.push({from:i,to:r.to}),t.splice(n,1,...s),n+=s.length-1}}}function e$(t,e){for(let i of t)if(e(i))return i}const i$={toDOM:t=>t,fromDOM:t=>t,scale:1};class n${constructor(t,e,i){let n=0,r=0,s=0;this.viewports=i.map((({from:i,to:r})=>{let s=e.lineAt(i,ER.ByPos,t,0,0).top,o=e.lineAt(r,ER.ByPos,t,0,0).bottom;return n+=o-s,{from:i,to:r,top:s,bottom:o,domTop:0,domBottom:0}})),this.scale=(7e6-n)/(e.height-n);for(let t of this.viewports)t.domTop=s+(t.top-r)*this.scale,s=t.domBottom=t.domTop+(t.bottom-t.top),r=t.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.top)return n+(t-i)*this.scale;if(t<=r.bottom)return r.domTop+(t-r.top);i=r.bottom,n=r.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.domTop)return i+(t-n)/this.scale;if(t<=r.domBottom)return r.top+(t-r.domTop);i=r.bottom,n=r.domBottom}}}function r$(t,e){if(1==e.scale)return t;let i=e.toDOM(t.top),n=e.toDOM(t.bottom);return new DR(t.from,t.length,i,n-i,Array.isArray(t.type)?t.type.map((t=>r$(t,e))):t.type)}const s$=jT.define({combine:t=>t.join(" ")}),o$=jT.define({combine:t=>t.indexOf(!0)>-1}),l$=Je.newName(),a$=Je.newName(),h$=Je.newName(),c$={"&light":"."+a$,"&dark":"."+h$};function u$(t,e,i){return new Je(e,{finish:e=>/&/.test(e)?e.replace(/&\w*/,(e=>{if("&"==e)return t;if(!i||!i[e])throw new RangeError(`Unsupported selector: ${e}`);return i[e]})):t+" "+e})}const f$=u$("."+l$,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere"},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},".cm-cursor, .cm-dropCursor":{position:"absolute",borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#f3f9ff"},"&dark .cm-activeLine":{backgroundColor:"#223039"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},c$),d$={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},p$=QM.ie&&QM.ie_version<=11;class g${constructor(t,e,i){this.view=t,this.onChange=e,this.onScrollChanged=i,this.active=!1,this.selectionRange=new sM,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.scrollTargets=[],this.intersection=null,this.resize=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver((e=>{for(let t of e)this.queue.push(t);(QM.ie&&QM.ie_version<=11||QM.ios&&t.composing)&&e.some((t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length))?this.flushSoon():this.flush()})),p$&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),window.addEventListener("resize",this.onResize=this.onResize.bind(this)),"function"==typeof ResizeObserver&&(this.resize=new ResizeObserver((()=>{this.view.docView.lastUpdate<Date.now()-75&&this.onResize()})),this.resize.observe(t.scrollDOM)),window.addEventListener("beforeprint",this.onPrint=this.onPrint.bind(this)),this.start(),window.addEventListener("scroll",this.onScroll=this.onScroll.bind(this)),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange(),this.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}onScroll(t){this.intersecting&&this.flush(!1),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500)}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some(((e,i)=>e!=t[i])))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:e}=this,i=this.selectionRange;if(e.state.facet(pQ)?e.root.activeElement!=this.dom:!UP(e.dom,i))return;let n=i.anchorNode&&e.docView.nearest(i.anchorNode);n&&n.ignoreEvent(t)||((QM.ie&&QM.ie_version<=11||QM.android&&QM.chrome)&&!e.state.selection.main.empty&&i.focusNode&&KP(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1))}readSelectionRange(){let{root:t}=this.view,e=ZP(t),i=QM.safari&&11==t.nodeType&&function(){let t=document.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}()==this.view.contentDOM&&function(t){let e=null;function i(t){t.preventDefault(),t.stopImmediatePropagation(),e=t.getTargetRanges()[0]}if(t.contentDOM.addEventListener("beforeinput",i,!0),document.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",i,!0),!e)return null;let n=e.startContainer,r=e.startOffset,s=e.endContainer,o=e.endOffset,l=t.docView.domAtPos(t.state.selection.main.anchor);KP(l.node,l.offset,s,o)&&([n,r,s,o]=[s,o,n,r]);return{anchorNode:n,anchorOffset:r,focusNode:s,focusOffset:o}}(this.view)||e;return!this.selectionRange.eq(i)&&(this.selectionRange.setRange(i),this.selectionChanged=!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(1==i.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else{if(11!=i.nodeType)break;i=i.host}if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,d$),p$&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),p$&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){this.delayedAndroidKey||requestAnimationFrame((()=>{let t=this.delayedAndroidKey;this.delayedAndroidKey=null,this.delayedFlush=-1,this.flush()||cM(this.view.contentDOM,t.key,t.keyCode)})),this.delayedAndroidKey&&"Enter"!=t||(this.delayedAndroidKey={key:t,keyCode:e})}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=window.setTimeout((()=>{this.delayedFlush=-1,this.flush()}),20))}forceFlush(){this.delayedFlush>=0&&(window.clearTimeout(this.delayedFlush),this.delayedFlush=-1,this.flush())}processRecords(){let t=this.queue;for(let e of this.observer.takeRecords())t.push(e);t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let r of t){let t=this.readMutation(r);t&&(t.typeOver&&(n=!0),-1==e?({from:e,to:i}=t):(e=Math.min(t.from,e),i=Math.max(t.to,i)))}return{from:e,to:i,typeOver:n}}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return;t&&this.readSelectionRange();let{from:e,to:i,typeOver:n}=this.processRecords(),r=this.selectionChanged&&UP(this.dom,this.selectionRange);if(e<0&&!r)return;this.selectionChanged=!1;let s=this.view.state,o=this.onChange(e,i,n);return this.view.state==s&&this.view.update([]),o}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty("attributes"==t.type),"attributes"==t.type&&(e.dirty|=4),"childList"==t.type){let i=m$(e,t.previousSibling||t.target.previousSibling,-1),n=m$(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}return"characterData"==t.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}destroy(){var t,e,i;this.stop(),null===(t=this.intersection)||void 0===t||t.disconnect(),null===(e=this.gapIntersection)||void 0===e||e.disconnect(),null===(i=this.resize)||void 0===i||i.disconnect();for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onResize),window.removeEventListener("beforeprint",this.onPrint),this.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout)}}function m$(t,e,i){for(;e;){let n=pM.get(e);if(n&&n.parent==t)return n;let r=e.parentNode;e=r!=t.dom?r:i>0?e.nextSibling:e.previousSibling}return null}function b$(t,e,i,n){let r,s,o=t.state.selection.main;if(e>-1){let n=t.docView.domBoundsAround(e,i,0);if(!n||t.state.readOnly)return!1;let{from:l,to:a}=n,h=t.docView.impreciseHead||t.docView.impreciseAnchor?[]:function(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:i,anchorOffset:n,focusNode:r,focusOffset:s}=t.observer.selectionRange;i&&(e.push(new qQ(i,n)),r==i&&s==n||e.push(new qQ(r,s)));return e}(t),c=new VQ(h,t.state);c.readRange(n.startDOM,n.endDOM);let u=o.from,f=null;(8===t.inputState.lastKeyCode&&t.inputState.lastKeyTime>Date.now()-100||QM.android&&c.text.length<a-l)&&(u=o.to,f="end");let d=function(t,e,i,n){let r=Math.min(t.length,e.length),s=0;for(;s<r&&t.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==r&&t.length==e.length)return null;let o=t.length,l=e.length;for(;o>0&&l>0&&t.charCodeAt(o-1)==e.charCodeAt(l-1);)o--,l--;if("end"==n){i-=o+Math.max(0,s-Math.min(o,l))-s}if(o<s&&t.length<e.length){s-=i<=s&&i>=o?s-i:0,l=s+(l-o),o=s}else if(l<s){s-=i<=s&&i>=l?s-i:0,o=s+(o-l),l=s}return{from:s,toA:o,toB:l}}(t.state.doc.sliceString(l,a,WQ),c.text,u-l,f);d&&(QM.chrome&&13==t.inputState.lastKeyCode&&d.toB==d.from+2&&"￿￿"==c.text.slice(d.from,d.toB)&&d.toB--,r={from:l+d.from,to:l+d.toA,insert:cT.of(c.text.slice(d.from,d.toB).split(WQ))}),s=function(t,e){if(0==t.length)return null;let i=t[0].pos,n=2==t.length?t[1].pos:i;return i>-1&&n>-1?LT.single(i+e,n+e):null}(h,l)}else if(t.hasFocus||!t.state.facet(pQ)){let e=t.observer.selectionRange,{impreciseHead:i,impreciseAnchor:n}=t.docView,r=i&&i.node==e.focusNode&&i.offset==e.focusOffset||!GP(t.contentDOM,e.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),l=n&&n.node==e.anchorNode&&n.offset==e.anchorOffset||!GP(t.contentDOM,e.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(e.anchorNode,e.anchorOffset);r==o.head&&l==o.anchor||(s=LT.single(l,r))}if(!r&&!s)return!1;if(!r&&n&&!o.empty&&s&&s.main.empty?r={from:o.from,to:o.to,insert:t.state.doc.slice(o.from,o.to)}:r&&r.from>=o.from&&r.to<=o.to&&(r.from!=o.from||r.to!=o.to)&&o.to-o.from-(r.to-r.from)<=4?r={from:o.from,to:o.to,insert:t.state.doc.slice(o.from,r.from).append(r.insert).append(t.state.doc.slice(r.to,o.to))}:(QM.mac||QM.android)&&r&&r.from==r.to&&r.from==o.head-1&&"."==r.insert.toString()&&(r={from:o.from,to:o.to,insert:cT.of([" "])}),r){let e=t.state;if(QM.ios&&t.inputState.flushIOSKey(t))return!0;if(QM.android&&(r.from==o.from&&r.to==o.to&&1==r.insert.length&&2==r.insert.lines&&cM(t.contentDOM,"Enter",13)||r.from==o.from-1&&r.to==o.to&&0==r.insert.length&&cM(t.contentDOM,"Backspace",8)||r.from==o.from&&r.to==o.to+1&&0==r.insert.length&&cM(t.contentDOM,"Delete",46)))return!0;let i,n=r.insert.toString();if(t.state.facet(hQ).some((e=>e(t,r.from,r.to,n))))return!0;if(t.inputState.composing>=0&&t.inputState.composing++,r.from>=o.from&&r.to<=o.to&&r.to-r.from>=(o.to-o.from)/3&&(!s||s.main.empty&&s.main.from==r.from+r.insert.length)&&t.inputState.composing<0){let n=o.from<r.from?e.sliceDoc(o.from,r.from):"",s=o.to>r.to?e.sliceDoc(r.to,o.to):"";i=e.replaceSelection(t.state.toText(n+r.insert.sliceString(0,void 0,t.state.lineBreak)+s))}else{let n=e.changes(r),l=s&&!e.selection.main.eq(s.main)&&s.main.to<=n.newLength?s.main:void 0;if(e.selection.ranges.length>1&&t.inputState.composing>=0&&r.to<=o.to&&r.to>=o.to-10){let s=t.state.sliceDoc(r.from,r.to),a=FQ(t)||t.state.doc.lineAt(o.head),h=o.to-r.to,c=o.to-o.from;i=e.changeByRange((i=>{if(i.from==o.from&&i.to==o.to)return{changes:n,range:l||i.map(n)};let u=i.to-h,f=u-s.length;if(i.to-i.from!=c||t.state.sliceDoc(f,u)!=s||a&&i.to>=a.from&&i.from<=a.to)return{range:i};let d=e.changes({from:f,to:u,insert:r.insert}),p=i.to-o.to;return{changes:d,range:l?LT.range(Math.max(0,l.anchor+p),Math.max(0,l.head+p)):i.map(d)}}))}else i={changes:n,selection:l&&e.selection.replaceRange(l)}}let l="input.type";return t.composing&&(l+=".compose",t.inputState.compositionFirstChange&&(l+=".start",t.inputState.compositionFirstChange=!1)),t.dispatch(i,{scrollIntoView:!0,userEvent:l}),!0}if(s&&!s.main.eq(o)){let e=!1,i="select";return t.inputState.lastSelectionTime>Date.now()-50&&("select"==t.inputState.lastSelectionOrigin&&(e=!0),i=t.inputState.lastSelectionOrigin),t.dispatch({selection:s,scrollIntoView:e,userEvent:i}),!0}return!1}class O${constructor(t={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: absolute; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=t.dispatch||(t=>this.update([t])),this.dispatch=this.dispatch.bind(this),this.root=t.root||function(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}(t.parent)||document,this.viewState=new GR(t.state||RP.create()),this.plugins=this.state.facet(mQ).map((t=>new OQ(t)));for(let t of this.plugins)t.update(this);this.observer=new g$(this,((t,e,i)=>b$(this,t,e,i)),(t=>{this.inputState.runScrollHandlers(this,t),this.observer.intersecting&&this.measure()})),this.inputState=new aR(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new HQ(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),t.parent&&t.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}dispatch(...t){this._dispatch(1==t.length&&t[0]instanceof wP?t[0]:this.state.update(...t))}update(t){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e,i=!1,n=!1,r=this.state;for(let e of t){if(e.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=e.state}if(this.destroyed)return void(this.viewState.state=r);if(this.observer.clear(),r.facet(RP.phrases)!=this.state.facet(RP.phrases))return this.setState(r);e=AQ.create(this,r,t);let s=this.viewState.scrollTarget;try{this.updateState=2;for(let e of t){if(s&&(s=s.map(e.changes)),e.scrollIntoView){let{main:t}=e.state.selection;s=new uQ(t.empty?t:LT.cursor(t.head,t.head>t.anchor?-1:1))}for(let t of e.effects)t.is(fQ)&&(s=t.value)}this.viewState.update(e,s),this.bidiCache=y$.update(this.bidiCache,e.changes),e.empty||(this.updatePlugins(e),this.inputState.update(e)),i=this.docView.update(e),this.state.facet(SQ)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some((t=>t.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(e.startState.facet(s$)!=e.state.facet(s$)&&(this.viewState.mustMeasureContent=!0),(i||n||s||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!e.empty)for(let t of this.state.facet(aQ))t(e)}setState(t){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=t);this.updateState=2;let e=this.hasFocus;try{for(let t of this.plugins)t.destroy(this);this.viewState=new GR(t),this.plugins=t.facet(mQ).map((t=>new OQ(t))),this.pluginMap.clear();for(let t of this.plugins)t.update(this);this.docView=new HQ(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(mQ),i=t.state.facet(mQ);if(e!=i){let n=[];for(let r of i){let i=e.indexOf(r);if(i<0)n.push(new OQ(r));else{let e=this.plugins[i];e.mustUpdate=t,n.push(e)}}for(let e of this.plugins)e.mustUpdate!=t&&e.destroy(this);this.plugins=n,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let e of this.plugins)e.mustUpdate=t;for(let t=0;t<this.plugins.length;t++)this.plugins[t].update(this)}measure(t=!0){if(this.destroyed)return;this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,t&&this.observer.flush();let e=null;try{for(let t=0;;t++){this.updateState=1;let i=this.viewport,n=this.viewState.measure(this);if(!n&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(t>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let r=[];4&n||([this.measureRequests,r]=[r,this.measureRequests]);let s=r.map((t=>{try{return t.read(this)}catch(t){return dQ(this.state,t),w$}})),o=AQ.create(this,this.state,[]),l=!1,a=!1;o.flags|=n,e?e.flags|=n:e=o,this.updateState=2,o.empty||(this.updatePlugins(o),this.inputState.update(o),this.updateAttrs(),l=this.docView.update(o));for(let t=0;t<r.length;t++)if(s[t]!=w$)try{let e=r[t];e.write&&e.write(s[t],this)}catch(t){dQ(this.state,t)}if(this.viewState.scrollTarget&&(this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=!0),l&&this.docView.updateSelection(!0),this.viewport.from==i.from&&this.viewport.to==i.to&&!a&&0==this.measureRequests.length)break}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let t of this.state.facet(aQ))t(e)}get themeClasses(){return l$+" "+(this.state.facet(o$)?h$:a$)+" "+this.state.facet(s$)}updateAttrs(){let t=x$(this,vQ,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(pQ)?"true":"false",class:"cm-content",style:`${QM.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),x$(this,wQ,e);let i=this.observer.ignore((()=>{let i=qM(this.contentDOM,this.contentAttrs,e),n=qM(this.dom,this.editorAttrs,t);return i||n}));return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let t of i.effects)if(t.is(O$.announce)){e&&(this.announceDOM.textContent=""),e=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value}}mountStyles(){this.styleModules=this.state.facet(SQ),Je.mount(this.root,this.styleModules.concat(f$).reverse())}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=requestAnimationFrame((()=>this.measure()))),t){if(null!=t.key)for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key)return void(this.measureRequests[e]=t);this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find((e=>e.spec==t))||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return lR(this,t,oR(this,t,e,i))}moveByGroup(t,e){return lR(this,t,oR(this,t,e,(e=>function(t,e,i){let n=t.state.charCategorizer(e),r=n(i);return t=>{let e=n(t);return r==TP.Space&&(r=e),r==e}}(this,t.head,e))))}moveToLineBoundary(t,e,i=!0){return function(t,e,i,n){let r=t.state.doc.lineAt(e.head),s=n&&t.lineWrapping?t.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head):null;if(s){let e=t.dom.getBoundingClientRect(),n=t.textDirectionAt(r.from),o=t.posAtCoords({x:i==(n==TQ.LTR)?e.right-1:e.left+1,y:(s.top+s.bottom)/2});if(null!=o)return LT.cursor(o,i?-1:1)}let o=JM.find(t.docView,e.head),l=o?i?o.posAtEnd:o.posAtStart:i?r.to:r.from;return LT.cursor(l,i?-1:1)}(this,t,e,i)}moveVertically(t,e,i){return lR(this,t,function(t,e,i,n){let r=e.head,s=i?1:-1;if(r==(i?t.state.doc.length:0))return LT.cursor(r,e.assoc);let o,l=e.goalColumn,a=t.contentDOM.getBoundingClientRect(),h=t.coordsAtPos(r),c=t.documentTop;if(h)null==l&&(l=h.left-a.left),o=s<0?h.top:h.bottom;else{let e=t.viewState.lineBlockAt(r);null==l&&(l=Math.min(a.right-a.left,t.defaultCharacterWidth*(r-e.from))),o=(s<0?e.top:e.bottom)+c}let u=a.left+l,f=null!=n?n:t.defaultLineHeight>>1;for(let i=0;;i+=10){let n=o+(f+i)*s,h=rR(t,{x:u,y:n},!1,s);if(n<a.top||n>a.bottom||(s<0?h<r:h>r))return LT.cursor(h,e.assoc,void 0,l)}}(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),rR(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),r=this.bidiSpans(n);return nM(i,r[NQ.find(r,t-n.from,-1,e)].dir==TQ.LTR==e>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(cQ)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>v$)return IQ(t.length);let e=this.textDirectionAt(t.from);for(let i of this.bidiCache)if(i.from==t.from&&i.dir==e)return i.order;let i=function(t,e){let i=t.length,n=e==PQ?1:2,r=e==PQ?2:1;if(!t||1==n&&!EQ.test(t))return IQ(i);for(let e=0,r=n,o=n;e<i;e++){let i=(s=t.charCodeAt(e))<=247?RQ[s]:1424<=s&&s<=1524?2:1536<=s&&s<=1785?$Q[s-1536]:1774<=s&&s<=2220?4:8192<=s&&s<=8203||8204==s?256:1;512==i?i=r:8==i&&4==o&&(i=16),BQ[e]=4==i?2:i,7&i&&(o=i),r=i}var s;for(let t=0,e=n,r=n;t<i;t++){let n=BQ[t];if(128==n)t<i-1&&e==BQ[t+1]&&24&e?n=BQ[t]=e:BQ[t]=256;else if(64==n){let n=t+1;for(;n<i&&64==BQ[n];)n++;let s=t&&8==e||n<i&&8==BQ[n]?1==r?1:8:256;for(let e=t;e<n;e++)BQ[e]=s;t=n-1}else 8==n&&1==r&&(BQ[t]=1);e=n,7&n&&(r=n)}for(let e,s,o,l=0,a=0,h=0;l<i;l++)if(s=_Q[e=t.charCodeAt(l)])if(s<0){for(let t=a-3;t>=0;t-=3)if(DQ[t+1]==-s){let e=DQ[t+2],i=2&e?n:4&e?1&e?r:n:0;i&&(BQ[l]=BQ[DQ[t]]=i),a=t;break}}else{if(189==DQ.length)break;DQ[a++]=l,DQ[a++]=e,DQ[a++]=h}else if(2==(o=BQ[l])||1==o){let t=o==n;h=t?0:1;for(let e=a-3;e>=0;e-=3){let i=DQ[e+2];if(2&i)break;if(t)DQ[e+2]|=2;else{if(4&i)break;DQ[e+2]|=4}}}for(let t=0;t<i;t++)if(256==BQ[t]){let e=t+1;for(;e<i&&256==BQ[e];)e++;let r=1==(t?BQ[t-1]:n),s=r==(1==(e<i?BQ[e]:n))?r?1:2:n;for(let i=t;i<e;i++)BQ[i]=s;t=e-1}let o=[];if(1==n)for(let t=0;t<i;){let e=t,n=1!=BQ[t++];for(;t<i&&n==(1!=BQ[t]);)t++;if(n)for(let i=t;i>e;){let t=i,n=2!=BQ[--i];for(;i>e&&n==(2!=BQ[i-1]);)i--;o.push(new NQ(i,t,n?2:1))}else o.push(new NQ(e,t,0))}else for(let t=0;t<i;){let e=t,n=2==BQ[t++];for(;t<i&&n==(2==BQ[t]);)t++;o.push(new NQ(e,t,n?1:2))}return o}(t.text,e);return this.bidiCache.push(new y$(t.from,t.to,e,i)),i}get hasFocus(){var t;return(document.hasFocus()||QM.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{aM(this.contentDOM),this.docView.updateSelection()}))}destroy(){for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return fQ.of(new uQ("number"==typeof t?LT.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}static domEventHandlers(t){return bQ.define((()=>({})),{eventHandlers:t})}static theme(t,e){let i=Je.newName(),n=[s$.of(i),SQ.of(u$(`.${i}`,t))];return e&&e.dark&&n.push(o$.of(!0)),n}static baseTheme(t){return iP.lowest(SQ.of(u$("."+l$,t,c$)))}}O$.styleModule=SQ,O$.inputHandler=hQ,O$.perLineTextDirection=cQ,O$.exceptionSink=lQ,O$.updateListener=aQ,O$.editable=pQ,O$.mouseSelectionStyle=oQ,O$.dragMovesSelection=sQ,O$.clickAddsSelectionRange=rQ,O$.decorations=yQ,O$.atomicRanges=xQ,O$.scrollMargins=kQ,O$.darkTheme=o$,O$.contentAttributes=wQ,O$.editorAttributes=vQ,O$.lineWrapping=O$.contentAttributes.of({class:"cm-lineWrapping"}),O$.announce=vP.define();const v$=4096,w$={};class y${constructor(t,e,i,n){this.from=t,this.to=e,this.dir=i,this.order=n}static update(t,e){if(e.empty)return t;let i=[],n=t.length?t[t.length-1].dir:TQ.LTR;for(let r=Math.max(0,t.length-10);r<t.length;r++){let s=t[r];s.dir!=n||e.touchesRange(s.from,s.to)||i.push(new y$(e.mapPos(s.from,1),e.mapPos(s.to,-1),s.dir,s.order))}return i}}function x$(t,e,i){for(let n=t.state.facet(e),r=n.length-1;r>=0;r--){let e=n[r],s="function"==typeof e?e(t):e;s&&VM(s,i)}return i}const k$="-10000px";class S${constructor(t,e,i){this.facet=e,this.createTooltipView=i,this.input=t.state.facet(e),this.tooltips=this.input.filter((t=>t)),this.tooltipViews=this.tooltips.map(i)}update(t){let e=t.state.facet(this.facet),i=e.filter((t=>t));if(e===this.input){for(let e of this.tooltipViews)e.update&&e.update(t);return!1}let n=[];for(let e=0;e<i.length;e++){let r=i[e],s=-1;if(r){for(let t=0;t<this.tooltips.length;t++){let e=this.tooltips[t];e&&e.create==r.create&&(s=t)}if(s<0)n[e]=this.createTooltipView(r);else{let i=n[e]=this.tooltipViews[s];i.update&&i.update(t)}}}for(let t of this.tooltipViews)n.indexOf(t)<0&&t.dom.remove();return this.input=e,this.tooltips=i,this.tooltipViews=n,!0}}function C$(){return{top:0,left:0,bottom:innerHeight,right:innerWidth}}const A$=jT.define({combine:t=>{var e,i,n;return{position:QM.ios?"absolute":(null===(e=t.find((t=>t.position)))||void 0===e?void 0:e.position)||"fixed",parent:(null===(i=t.find((t=>t.parent)))||void 0===i?void 0:i.parent)||null,tooltipSpace:(null===(n=t.find((t=>t.tooltipSpace)))||void 0===n?void 0:n.tooltipSpace)||C$}}}),T$=bQ.fromClass(class{constructor(t){var e;this.view=t,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let i=t.state.facet(A$);this.position=i.position,this.parent=i.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new S$(t,M$,(t=>this.createTooltip(t))),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver((t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()}),{threshold:[1]}):null,this.observeIntersection(),null===(e=t.dom.ownerDocument.defaultView)||void 0===e||e.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout((()=>{this.measureTimeout=-1,this.maybeMeasure()}),50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t);e&&this.observeIntersection();let i=e||t.geometryChanged,n=t.state.facet(A$);if(n.position!=this.position){this.position=n.position;for(let t of this.manager.tooltipViews)t.dom.style.position=this.position;i=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let t of this.manager.tooltipViews)this.container.appendChild(t.dom);i=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);i&&this.maybeMeasure()}createTooltip(t){let e=t.create(this.view);if(e.dom.classList.add("cm-tooltip"),t.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=k$,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var t,e;null===(t=this.view.dom.ownerDocument.defaultView)||void 0===t||t.removeEventListener("resize",this.measureSoon);for(let{dom:t}of this.manager.tooltipViews)t.remove();null===(e=this.intersectionObserver)||void 0===e||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=this.view.dom.getBoundingClientRect();return{editor:t,parent:this.parent?this.container.getBoundingClientRect():t,pos:this.manager.tooltips.map(((t,e)=>{let i=this.manager.tooltipViews[e];return i.getCoords?i.getCoords(t.pos):this.view.coordsAtPos(t.pos)})),size:this.manager.tooltipViews.map((({dom:t})=>t.getBoundingClientRect())),space:this.view.state.facet(A$).tooltipSpace(this.view)}}writeMeasure(t){let{editor:e,space:i}=t,n=[];for(let r=0;r<this.manager.tooltips.length;r++){let s=this.manager.tooltips[r],o=this.manager.tooltipViews[r],{dom:l}=o,a=t.pos[r],h=t.size[r];if(!a||a.bottom<=Math.max(e.top,i.top)||a.top>=Math.min(e.bottom,i.bottom)||a.right<Math.max(e.left,i.left)-.1||a.left>Math.min(e.right,i.right)+.1){l.style.top=k$;continue}let c=s.arrow?o.dom.querySelector(".cm-tooltip-arrow"):null,u=c?7:0,f=h.right-h.left,d=h.bottom-h.top,p=o.offset||P$,g=this.view.textDirection==TQ.LTR,m=h.width>i.right-i.left?g?i.left:i.right-h.width:g?Math.min(a.left-(c?14:0)+p.x,i.right-f):Math.max(i.left,a.left-f+(c?14:0)-p.x),b=!!s.above;!s.strictSide&&(b?a.top-(h.bottom-h.top)-p.y<i.top:a.bottom+(h.bottom-h.top)+p.y>i.bottom)&&b==i.bottom-a.bottom>a.top-i.top&&(b=!b);let O=b?a.top-d-u-p.y:a.bottom+u+p.y,v=m+f;if(!0!==o.overlap)for(let t of n)t.left<v&&t.right>m&&t.top<O+d&&t.bottom>O&&(O=b?t.top-d-2-u:t.bottom+u+2);"absolute"==this.position?(l.style.top=O-t.parent.top+"px",l.style.left=m-t.parent.left+"px"):(l.style.top=O+"px",l.style.left=m+"px"),c&&(c.style.left=a.left+(g?p.x:-p.x)-(m+14-7)+"px"),!0!==o.overlap&&n.push({left:m,top:O,right:v,bottom:O+d}),l.classList.toggle("cm-tooltip-above",b),l.classList.toggle("cm-tooltip-below",!b),o.positioned&&o.positioned()}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=k$}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),P$={x:0,y:0},M$=jT.define({enables:[T$,O$.baseTheme({".cm-tooltip":{zIndex:100},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}})]}),Q$=jT.define();class R${constructor(t){this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new S$(t,Q$,(t=>this.createHostedView(t)))}static create(t){return new R$(t)}createHostedView(t){let e=t.create(this.view);return e.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(e.dom),this.mounted&&e.mount&&e.mount(this.view),e}mount(t){for(let e of this.manager.tooltipViews)e.mount&&e.mount(t);this.mounted=!0}positioned(){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned()}update(t){this.manager.update(t)}}const $$=M$.compute([Q$],(t=>{let e=t.facet(Q$).filter((t=>t));return 0===e.length?null:{pos:Math.min(...e.map((t=>t.pos))),end:Math.max(...e.filter((t=>null!=t.end)).map((t=>t.end))),create:R$.create,above:e[0].above,arrow:e.some((t=>t.arrow))}}));class _${constructor(t,e,i,n,r){this.view=t,this.source=e,this.field=i,this.setHover=n,this.hoverTime=r,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout((()=>this.startHover()),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let t=Date.now()-this.lastMove.time;t<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-t):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:t}=this,e=this.view.contentDOM.contains(t.target)?this.view.posAtCoords(t):null;if(null==e)return;let i=this.view.coordsAtPos(e);if(null==i||t.y<i.top||t.y>i.bottom||t.x<i.left-this.view.defaultCharacterWidth||t.x>i.right+this.view.defaultCharacterWidth)return;let n=this.view.bidiSpans(this.view.state.doc.lineAt(e)).find((t=>t.from<=e&&t.to>=e)),r=n&&n.dir==TQ.RTL?-1:1,s=this.source(this.view,e,t.x<i.left?-r:r);if(null==s?void 0:s.then){let t=this.pending={pos:e};s.then((e=>{this.pending==t&&(this.pending=null,e&&this.view.dispatch({effects:this.setHover.of(e)}))}),(t=>dQ(this.view.state,t,"hover tooltip")))}else s&&this.view.dispatch({effects:this.setHover.of(s)})}mousemove(t){var e;this.lastMove={x:t.clientX,y:t.clientY,target:t.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let i=this.active;if(i&&!function(t){for(let e=t;e;e=e.parentNode)if(1==e.nodeType&&e.classList.contains("cm-tooltip"))return!0;return!1}(this.lastMove.target)||this.pending){let{pos:n}=i||this.pending,r=null!==(e=null==i?void 0:i.end)&&void 0!==e?e:n;(n==r?this.view.posAtCoords(this.lastMove)==n:function(t,e,i,n,r,s){let o=document.createRange(),l=t.domAtPos(e),a=t.domAtPos(i);o.setEnd(a.node,a.offset),o.setStart(l.node,l.offset);let h=o.getClientRects();o.detach();for(let t=0;t<h.length;t++){let e=h[t];if(Math.max(e.top-r,r-e.bottom,e.left-n,n-e.right)<=s)return!0}return!1}(this.view,n,r,t.clientX,t.clientY,6))||(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function D$(t,e={}){let i=vP.define(),n=UT.define({create:()=>null,update(t,n){if(t&&(e.hideOnChange&&(n.docChanged||n.selection)||e.hideOn&&e.hideOn(n,t)))return null;if(t&&n.docChanged){let e=n.changes.mapPos(t.pos,-1,QT.TrackDel);if(null==e)return null;let i=Object.assign(Object.create(null),t);i.pos=e,null!=t.end&&(i.end=n.changes.mapPos(t.end)),t=i}for(let e of n.effects)e.is(i)&&(t=e.value),e.is(E$)&&(t=null);return t},provide:t=>Q$.from(t)});return[n,bQ.define((r=>new _$(r,t,n,i,e.hoverTime||300))),$$]}const E$=vP.define(),N$=jT.define({combine(t){let e,i;for(let n of t)e=e||n.topContainer,i=i||n.bottomContainer;return{topContainer:e,bottomContainer:i}}});const B$=bQ.fromClass(class{constructor(t){this.input=t.state.facet(L$),this.specs=this.input.filter((t=>t)),this.panels=this.specs.map((e=>e(t)));let e=t.state.facet(N$);this.top=new I$(t,!0,e.topContainer),this.bottom=new I$(t,!1,e.bottomContainer),this.top.sync(this.panels.filter((t=>t.top))),this.bottom.sync(this.panels.filter((t=>!t.top)));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(t){let e=t.state.facet(N$);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new I$(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new I$(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let i=t.state.facet(L$);if(i!=this.input){let e=i.filter((t=>t)),n=[],r=[],s=[],o=[];for(let i of e){let e,l=this.specs.indexOf(i);l<0?(e=i(t.view),o.push(e)):(e=this.panels[l],e.update&&e.update(t)),n.push(e),(e.top?r:s).push(e)}this.specs=e,this.panels=n,this.top.sync(r),this.bottom.sync(s);for(let t of o)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}else for(let e of this.panels)e.update&&e.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>O$.scrollMargins.of((e=>{let i=e.plugin(t);return i&&{top:i.top.scrollMargin(),bottom:i.bottom.scrollMargin()}}))});class I${constructor(t,e,i){this.view=t,this.top=e,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let e of this.panels)e.destroy&&t.indexOf(e)<0&&e.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(0==this.panels.length)return void(this.dom&&(this.dom.remove(),this.dom=void 0));if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=z$(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=z$(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function z$(t){let e=t.nextSibling;return t.remove(),e}const L$=jT.define({enables:B$});class W$ extends $P{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}W$.prototype.elementClass="",W$.prototype.toDOM=void 0,W$.prototype.mapMode=QT.TrackBefore,W$.prototype.startSide=W$.prototype.endSide=-1,W$.prototype.point=!0;class V${constructor(t,e,i){this.from=t,this.to=e,this.diagnostic=i}}class j${constructor(t,e,i){this.diagnostics=t,this.panel=e,this.selected=i}static init(t,e,i){let n=t,r=i.facet(n_).markerFilter;r&&(n=r(n));let s=FM.set(n.map((t=>t.from==t.to||t.from==t.to-1&&i.doc.lineAt(t.from).to==t.from?FM.widget({widget:new o_(t),diagnostic:t}).range(t.from):FM.mark({attributes:{class:"cm-lintRange cm-lintRange-"+t.severity},diagnostic:t}).range(t.from,t.to))),!0);return new j$(s,e,q$(s))}}function q$(t,e=null,i=0){let n=null;return t.between(i,1e9,((t,i,{spec:r})=>{if(!e||r.diagnostic==e)return n=new V$(t,i,r.diagnostic),!1})),n}function H$(t,e){return!(!t.effects.some((t=>t.is(F$)))&&!t.changes.touchesRange(e.pos))}function X$(t,e){return t.field(U$,!1)?e:e.concat(vP.appendConfig.of([U$,O$.decorations.compute([U$],(t=>{let{selected:e,panel:i}=t.field(U$);return e&&i&&e.from!=e.to?FM.set([Y$.range(e.from,e.to)]):FM.none})),D$(K$,{hideOn:H$}),c_]))}const F$=vP.define(),Z$=vP.define(),G$=vP.define(),U$=UT.define({create:()=>new j$(FM.none,null,null),update(t,e){if(e.docChanged){let i=t.diagnostics.map(e.changes),n=null;if(t.selected){let r=e.changes.mapPos(t.selected.from,1);n=q$(i,t.selected.diagnostic,r)||q$(i,null,r)}t=new j$(i,t.panel,n)}for(let i of e.effects)i.is(F$)?t=j$.init(i.value,t.panel,e.state):i.is(Z$)?t=new j$(t.diagnostics,i.value?a_.open:null,t.selected):i.is(G$)&&(t=new j$(t.diagnostics,t.panel,i.value));return t},provide:t=>[L$.from(t,(t=>t.panel)),O$.decorations.from(t,(t=>t.diagnostics))]}),Y$=FM.mark({class:"cm-lintRange cm-lintRange-active"});function K$(t,e,i){let{diagnostics:n}=t.state.field(U$),r=[],s=2e8,o=0;n.between(e-(i<0?1:0),e+(i>0?1:0),((t,n,{spec:l})=>{e>=t&&e<=n&&(t==n||(e>t||i>0)&&(e<n||i<0))&&(r.push(l.diagnostic),s=Math.min(t,s),o=Math.max(n,o))}));let l=t.state.facet(n_).tooltipFilter;return l&&(r=l(r)),r.length?{pos:s,end:o,above:t.state.doc.lineAt(s).to<o,create:()=>({dom:J$(t,r)})}:null}function J$(t,e){return Tw("ul",{class:"cm-tooltip-lint"},e.map((e=>s_(t,e,!1))))}const t_=t=>{let e=t.state.field(U$,!1);return!(!e||!e.panel)&&(t.dispatch({effects:Z$.of(!1)}),!0)},e_=[{key:"Mod-Shift-m",run:t=>{let e=t.state.field(U$,!1);e&&e.panel||t.dispatch({effects:X$(t.state,[Z$.of(!0)])});let i=function(t,e){let i=t.plugin(B$),n=i?i.specs.indexOf(e):-1;return n>-1?i.panels[n]:null}(t,a_.open);return i&&i.dom.querySelector(".cm-panel-lint ul").focus(),!0}},{key:"F8",run:t=>{let e=t.state.field(U$,!1);if(!e)return!1;let i=t.state.selection.main,n=e.diagnostics.iter(i.to+1);return!(!n.value&&(n=e.diagnostics.iter(0),!n.value||n.from==i.from&&n.to==i.to))&&(t.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)}}],i_=bQ.fromClass(class{constructor(t){this.view=t,this.timeout=-1,this.set=!0;let{delay:e}=t.state.facet(n_);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){let t=Date.now();if(t<this.lintTime-10)setTimeout(this.run,this.lintTime-t);else{this.set=!1;let{state:t}=this.view,{sources:e}=t.facet(n_);Promise.all(e.map((t=>Promise.resolve(t(this.view))))).then((e=>{let i=e.reduce(((t,e)=>t.concat(e)));this.view.state.doc==t.doc&&this.view.dispatch(function(t,e){return{effects:X$(t,[F$.of(e)])}}(this.view.state,i))}),(t=>{dQ(this.view.state,t)}))}}update(t){let e=t.state.facet(n_);(t.docChanged||e!=t.startState.facet(n_))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),n_=jT.define({combine:t=>Object.assign({sources:t.map((t=>t.source))},function(t,e,i={}){let n={};for(let e of t)for(let t of Object.keys(e)){let r=e[t],s=n[t];if(void 0===s)n[t]=r;else if(s===r||void 0===r);else{if(!Object.hasOwnProperty.call(i,t))throw new Error("Config merge conflict for field "+t);n[t]=i[t](s,r)}}for(let t in e)void 0===n[t]&&(n[t]=e[t]);return n}(t.map((t=>t.config)),{delay:750,markerFilter:null,tooltipFilter:null})),enables:i_});function r_(t){let e=[];if(t)t:for(let{name:i}of t){for(let t=0;t<i.length;t++){let n=i[t];if(/[a-zA-Z]/.test(n)&&!e.some((t=>t.toLowerCase()==n.toLowerCase()))){e.push(n);continue t}}e.push("")}return e}function s_(t,e,i){var n;let r=i?r_(e.actions):[];return Tw("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Tw("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage():e.message),null===(n=e.actions)||void 0===n?void 0:n.map(((i,n)=>{let s=n=>{n.preventDefault();let r=q$(t.state.field(U$).diagnostics,e);r&&i.apply(t,r.from,r.to)},{name:o}=i,l=r[n]?o.indexOf(r[n]):-1,a=l<0?o:[o.slice(0,l),Tw("u",o.slice(l,l+1)),o.slice(l+1)];return Tw("button",{type:"button",class:"cm-diagnosticAction",onclick:s,onmousedown:s,"aria-label":` Action: ${o}${l<0?"":` (access key "${r[n]})"`}.`},a)})),e.source&&Tw("div",{class:"cm-diagnosticSource"},e.source))}class o_ extends HM{constructor(t){super(),this.diagnostic=t}eq(t){return t.diagnostic==this.diagnostic}toDOM(){return Tw("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class l_{constructor(t,e){this.diagnostic=e,this.id="item_"+Math.floor(4294967295*Math.random()).toString(16),this.dom=s_(t,e,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class a_{constructor(t){this.view=t,this.items=[];this.list=Tw("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:e=>{if(27==e.keyCode)t_(this.view),this.view.focus();else if(38==e.keyCode||33==e.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==e.keyCode||34==e.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==e.keyCode)this.moveSelection(0);else if(35==e.keyCode)this.moveSelection(this.items.length-1);else if(13==e.keyCode)this.view.focus();else{if(!(e.keyCode>=65&&e.keyCode<=90&&this.selectedIndex>=0))return;{let{diagnostic:i}=this.items[this.selectedIndex],n=r_(i.actions);for(let r=0;r<n.length;r++)if(n[r].toUpperCase().charCodeAt(0)==e.keyCode){let e=q$(this.view.state.field(U$).diagnostics,i);e&&i.actions[r].apply(t,e.from,e.to)}}}e.preventDefault()},onclick:t=>{for(let e=0;e<this.items.length;e++)this.items[e].dom.contains(t.target)&&this.moveSelection(e)}}),this.dom=Tw("div",{class:"cm-panel-lint"},this.list,Tw("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>t_(this.view)},"×")),this.update()}get selectedIndex(){let t=this.view.state.field(U$).selected;if(!t)return-1;for(let e=0;e<this.items.length;e++)if(this.items[e].diagnostic==t.diagnostic)return e;return-1}update(){let{diagnostics:t,selected:e}=this.view.state.field(U$),i=0,n=!1,r=null;for(t.between(0,this.view.state.doc.length,((t,s,{spec:o})=>{let l,a=-1;for(let t=i;t<this.items.length;t++)if(this.items[t].diagnostic==o.diagnostic){a=t;break}a<0?(l=new l_(this.view,o.diagnostic),this.items.splice(i,0,l),n=!0):(l=this.items[a],a>i&&(this.items.splice(i,a-i),n=!0)),e&&l.diagnostic==e.diagnostic?l.dom.hasAttribute("aria-selected")||(l.dom.setAttribute("aria-selected","true"),r=l):l.dom.hasAttribute("aria-selected")&&l.dom.removeAttribute("aria-selected"),i++}));i<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)n=!0,this.items.pop();0==this.items.length&&(this.items.push(new l_(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),n=!0),r?(this.list.setAttribute("aria-activedescendant",r.id),this.view.requestMeasure({key:this,read:()=>({sel:r.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:t,panel:e})=>{t.top<e.top?this.list.scrollTop-=e.top-t.top:t.bottom>e.bottom&&(this.list.scrollTop+=t.bottom-e.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),n&&this.sync()}sync(){let t=this.list.firstChild;function e(){let e=t;t=e.nextSibling,e.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;t!=i.dom;)e();t=i.dom.nextSibling}else this.list.insertBefore(i.dom,t);for(;t;)e()}moveSelection(t){if(this.selectedIndex<0)return;let e=q$(this.view.state.field(U$).diagnostics,this.items[t].diagnostic);e&&this.view.dispatch({selection:{anchor:e.from,head:e.to},scrollIntoView:!0,effects:G$.of(e)})}static open(t){return new a_(t)}}function h_(t){return function(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const c_=O$.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:h_("#d11")},".cm-lintRange-warning":{backgroundImage:h_("orange")},".cm-lintRange-info":{backgroundImage:h_("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),u_=1024;let f_=0;class d_{constructor(t,e){this.from=t,this.to=e}}class p_{constructor(t={}){this.id=f_++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=m_.match(t)),e=>{let i=t(e);return void 0===i?null:[this,i]}}}p_.closedBy=new p_({deserialize:t=>t.split(" ")}),p_.openedBy=new p_({deserialize:t=>t.split(" ")}),p_.group=new p_({deserialize:t=>t.split(" ")}),p_.contextHash=new p_({perNode:!0}),p_.lookAhead=new p_({perNode:!0}),p_.mounted=new p_({perNode:!0});const g_=Object.create(null);class m_{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):g_,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),n=new m_(t.name||"",e,t.id,i);if(t.props)for(let i of t.props)if(Array.isArray(i)||(i=i(n)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[i[0].id]=i[1]}return n}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop(p_.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return t=>{for(let i=t.prop(p_.group),n=-1;n<(i?i.length:0);n++){let r=e[n<0?t.name:i[n]];if(r)return r}}}}m_.none=new m_("",Object.create(null),0,8);const b_=new WeakMap,O_=new WeakMap;var v_;!function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"}(v_||(v_={}));class w_{constructor(t,e,i,n,r){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,r&&r.length){this.props=Object.create(null);for(let[t,e]of r)this.props["number"==typeof t?t:t.id]=e}}toString(){let t=this.prop(p_.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let i=t.toString();i&&(e&&(e+=","),e+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new R_(this.topNode,t)}cursorAt(t,e=0,i=0){let n=b_.get(this)||this.topNode,r=new R_(n);return r.moveTo(t,e),b_.set(this,r._tree),r}get topNode(){return new A_(this,0,0,null)}resolve(t,e=0){let i=C_(b_.get(this)||this.topNode,t,e,!1);return b_.set(this,i),i}resolveInner(t,e=0){let i=C_(O_.get(this)||this.topNode,t,e,!0);return O_.set(this,i),i}iterate(t){let{enter:e,leave:i,from:n=0,to:r=this.length}=t;for(let s=this.cursor((t.mode||0)|v_.IncludeAnonymous);;){let t=!1;if(s.from<=r&&s.to>=n&&(s.type.isAnonymous||!1!==e(s))){if(s.firstChild())continue;t=!0}for(;t&&i&&!s.type.isAnonymous&&i(s),!s.nextSibling();){if(!s.parent())return;t=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:E_(m_.none,this.children,this.positions,0,this.children.length,0,this.length,((t,e,i)=>new w_(this.type,t,e,i,this.propValues)),t.makeTree||((t,e,i)=>new w_(m_.none,t,e,i)))}static build(t){return function(t){var e;let{buffer:i,nodeSet:n,maxBufferLength:r=u_,reused:s=[],minRepeatType:o=n.types.length}=t,l=Array.isArray(i)?new y_(i,i.length):i,a=n.types,h=0,c=0;function u(t,e,i,b,O){let{id:v,start:w,end:y,size:x}=l,k=c;for(;x<0;){if(l.next(),-1==x){let e=s[v];return i.push(e),void b.push(w-t)}if(-3==x)return void(h=v);if(-4==x)return void(c=v);throw new RangeError(`Unrecognized record size: ${x}`)}let S,C,A=a[v],T=w-t;if(y-w<=r&&(C=g(l.pos-e,O))){let e=new Uint16Array(C.size-C.skip),i=l.pos-C.size,r=e.length;for(;l.pos>i;)r=m(C.start,e,r);S=new x_(e,y-C.start,n),T=C.start-t}else{let t=l.pos-x;l.next();let e=[],i=[],n=v>=o?v:-1,s=0,a=y;for(;l.pos>t;)n>=0&&l.id==n&&l.size>=0?(l.end<=a-r&&(d(e,i,w,s,l.end,a,n,k),s=e.length,a=l.end),l.next()):u(w,t,e,i,n);if(n>=0&&s>0&&s<e.length&&d(e,i,w,s,w,a,n,k),e.reverse(),i.reverse(),n>-1&&s>0){let t=f(A);S=E_(A,e,i,0,e.length,0,y-w,t,t)}else S=p(A,e,i,y-w,k-y)}i.push(S),b.push(T)}function f(t){return(e,i,n)=>{let r,s,o=0,l=e.length-1;if(l>=0&&(r=e[l])instanceof w_){if(!l&&r.type==t&&r.length==n)return r;(s=r.prop(p_.lookAhead))&&(o=i[l]+r.length+s)}return p(t,e,i,n,o)}}function d(t,e,i,r,s,o,l,a){let h=[],c=[];for(;t.length>r;)h.push(t.pop()),c.push(e.pop()+i-s);t.push(p(n.types[l],h,c,o-s,a-o)),e.push(s-i)}function p(t,e,i,n,r=0,s){if(h){let t=[p_.contextHash,h];s=s?[t].concat(s):[t]}if(r>25){let t=[p_.lookAhead,r];s=s?[t].concat(s):[t]}return new w_(t,e,i,n,s)}function g(t,e){let i=l.fork(),n=0,s=0,a=0,h=i.end-r,c={size:0,start:0,skip:0};t:for(let r=i.pos-t;i.pos>r;){let t=i.size;if(i.id==e&&t>=0){c.size=n,c.start=s,c.skip=a,a+=4,n+=4,i.next();continue}let l=i.pos-t;if(t<0||l<r||i.start<h)break;let u=i.id>=o?4:0,f=i.start;for(i.next();i.pos>l;){if(i.size<0){if(-3!=i.size)break t;u+=4}else i.id>=o&&(u+=4);i.next()}s=f,n+=t,a+=u}return(e<0||n==t)&&(c.size=n,c.start=s,c.skip=a),c.size>4?c:void 0}function m(t,e,i){let{id:n,start:r,end:s,size:a}=l;if(l.next(),a>=0&&n<o){let o=i;if(a>4){let n=l.pos-(a-4);for(;l.pos>n;)i=m(t,e,i)}e[--i]=o,e[--i]=s-t,e[--i]=r-t,e[--i]=n}else-3==a?h=n:-4==a&&(c=n);return i}let b=[],O=[];for(;l.pos>0;)u(t.start||0,t.bufferStart||0,b,O,-1);let v=null!==(e=t.length)&&void 0!==e?e:b.length?O[0]+b[0].length:0;return new w_(a[t.topID],b.reverse(),O.reverse(),v)}(t)}}w_.empty=new w_(m_.none,[],[],0);class y_{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new y_(this.buffer,this.index)}}class x_{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return m_.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],r=n.name;if(/\W/.test(r)&&!n.isError&&(r=JSON.stringify(r)),i==(t+=4))return r;let s=[];for(;t<i;)s.push(this.childString(t)),t=this.buffer[t+3];return r+"("+s.join(",")+")"}findChild(t,e,i,n,r){let{buffer:s}=this,o=-1;for(let l=t;l!=e&&!(k_(r,n,s[l+1],s[l+2])&&(o=l,i>0));l=s[l+3]);return o}slice(t,e,i,n){let r=this.buffer,s=new Uint16Array(e-t);for(let n=t,o=0;n<e;)s[o++]=r[n++],s[o++]=r[n++]-i,s[o++]=r[n++]-i,s[o++]=r[n++]-t;return new x_(s,n-i,this.set)}}function k_(t,e,i,n){switch(t){case-2:return i<e;case-1:return n>=e&&i<e;case 0:return i<e&&n>e;case 1:return i<=e&&n>e;case 2:return n>e;case 4:return!0}}function S_(t,e){let i=t.childBefore(e);for(;i;){let e=i.lastChild;if(!e||e.to!=i.to)break;e.type.isError&&e.from==e.to?(t=i,i=e.prevSibling):i=e}return t}function C_(t,e,i,n){for(var r;t.from==t.to||(i<1?t.from>=e:t.from>e)||(i>-1?t.to<=e:t.to<e);){let e=!n&&t instanceof A_&&t.index<0?null:t.parent;if(!e)return t;t=e}let s=n?0:v_.IgnoreOverlays;if(n)for(let n=t,o=n.parent;o;n=o,o=n.parent)n instanceof A_&&n.index<0&&(null===(r=o.enter(e,i,s))||void 0===r?void 0:r.from)!=n.from&&(t=o);for(;;){let n=t.enter(e,i,s);if(!n)return t;t=n}}class A_{constructor(t,e,i,n){this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,r=0){for(let s=this;;){for(let{children:o,positions:l}=s._tree,a=e>0?o.length:-1;t!=a;t+=e){let a=o[t],h=l[t]+s.from;if(k_(n,i,h,h+a.length))if(a instanceof x_){if(r&v_.ExcludeBuffers)continue;let o=a.findChild(0,a.buffer.length,e,i-h,n);if(o>-1)return new Q_(new M_(s,a,t,h),null,o)}else if(r&v_.IncludeAnonymous||!a.type.isAnonymous||$_(a)){let o;if(!(r&v_.IgnoreMounts)&&a.props&&(o=a.prop(p_.mounted))&&!o.overlay)return new A_(o.tree,h,t,s);let l=new A_(a,h,t,s);return r&v_.IncludeAnonymous||!l.type.isAnonymous?l:l.nextChild(e<0?a.children.length-1:0,e,i,n)}}if(r&v_.IncludeAnonymous||!s.type.isAnonymous)return null;if(t=s.index>=0?s.index+e:e<0?-1:s._parent._tree.children.length,s=s._parent,!s)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&v_.IgnoreOverlays)&&(n=this._tree.prop(p_.mounted))&&n.overlay){let i=t-this.from;for(let{from:t,to:r}of n.overlay)if((e>0?t<=i:t<i)&&(e<0?r>=i:r>i))return new A_(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new R_(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return C_(this,t,e,!1)}resolveInner(t,e=0){return C_(this,t,e,!0)}enterUnfinishedNodesBefore(t){return S_(this,t)}getChild(t,e=null,i=null){let n=T_(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return T_(this,t,e,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return P_(this,t)}}function T_(t,e,i,n){let r=t.cursor(),s=[];if(!r.firstChild())return s;if(null!=i)for(;!r.type.is(i);)if(!r.nextSibling())return s;for(;;){if(null!=n&&r.type.is(n))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return null==n?s:[]}}function P_(t,e,i=e.length-1){for(let n=t.parent;i>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[i]&&e[i]!=n.name)return!1;i--}}return!0}class M_{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class Q_{constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(t,e,i){let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return r<0?null:new Q_(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&v_.ExcludeBuffers)return null;let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new Q_(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new Q_(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new Q_(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new R_(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,r=i.buffer[this.index+3];if(r>n){let s=i.buffer[this.index+1],o=i.buffer[this.index+2];t.push(i.slice(n,r,s,o)),e.push(0)}return new w_(this.type,t,e,this.to-this.from)}resolve(t,e=0){return C_(this,t,e,!1)}resolveInner(t,e=0){return C_(this,t,e,!0)}enterUnfinishedNodesBefore(t){return S_(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let n=T_(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return T_(this,t,e,i)}get node(){return this}matchContext(t){return P_(this,t)}}class R_{constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof A_)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}get name(){return this.type.name}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return!!t&&(t instanceof A_?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?!(i&v_.ExcludeBuffers)&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&v_.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&v_.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let t=i<0?0:this.stack[i]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(t)}return i<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(n.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;({index:e,_parent:i}=i))if(e>-1)for(let n=e+t,r=t<0?-1:i._tree.children.length;n!=r;n+=t){let t=i._tree.children[n];if(this.mode&v_.IncludeAnonymous||t instanceof x_||!t.type.isAnonymous||$_(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,r=this.stack.length;r>=0;){for(let s=t;s;s=s._parent)if(s.index==n){if(n==this.index)return s;e=s,i=r+1;break t}n=this.stack[--r]}for(let t=i;t<this.stack.length;t++)e=new Q_(this.buffer,e,this.stack[t]);return this.bufferNode=new Q_(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||!1!==t(this)){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;n&&e&&e(this),n=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return P_(this.node,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,r=this.stack.length-1;n>=0;r--){if(r<0)return P_(this.node,t,n);let s=i[e.buffer[this.stack[r]]];if(!s.isAnonymous){if(t[n]&&t[n]!=s.name)return!1;n--}}return!0}}function $_(t){return t.children.some((t=>t instanceof x_||!t.type.isAnonymous||$_(t)))}const __=new WeakMap;function D_(t,e){if(!t.isAnonymous||e instanceof x_||e.type!=t)return 1;let i=__.get(e);if(null==i){i=1;for(let n of e.children){if(n.type!=t||!(n instanceof w_)){i=1;break}i+=D_(t,n)}__.set(e,i)}return i}function E_(t,e,i,n,r,s,o,l,a){let h=0;for(let i=n;i<r;i++)h+=D_(t,e[i]);let c=Math.ceil(1.5*h/8),u=[],f=[];return function e(i,n,r,o,l){for(let h=r;h<o;){let r=h,d=n[h],p=D_(t,i[h]);for(h++;h<o;h++){let e=D_(t,i[h]);if(p+e>=c)break;p+=e}if(h==r+1){if(p>c){let t=i[r];e(t.children,t.positions,0,t.children.length,n[r]+l);continue}u.push(i[r])}else{let e=n[h-1]+i[h-1].length-d;u.push(E_(t,i,n,r,h,d,e,null,a))}f.push(d+l-s)}}(e,i,n,r,0),(l||a)(u,f,o)}class N_{constructor(t,e,i,n,r=!1,s=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(r?1:0)|(s?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(t,e=[],i=!1){let n=[new N_(0,t.length,t,0,!1,i)];for(let i of e)i.to>t.length&&n.push(i);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],r=1,s=t.length?t[0]:null;for(let o=0,l=0,a=0;;o++){let h=o<e.length?e[o]:null,c=h?h.fromA:1e9;if(c-l>=i)for(;s&&s.from<c;){let e=s;if(l>=e.from||c<=e.to||a){let t=Math.max(e.from,l)-a,i=Math.min(e.to,c)-a;e=t>=i?null:new N_(t,i,e.tree,e.offset+a,o>0,!!h)}if(e&&n.push(e),s.to>c)break;s=r<t.length?t[r++]:null}if(!h)break;l=h.toA,a=h.toA-h.toB}return n}}class B_{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new p_({perNode:!0});let I_=0;class z_{constructor(t,e,i){this.set=t,this.base=e,this.modified=i,this.id=I_++}static define(t){if(null==t?void 0:t.base)throw new Error("Can not derive from a modified tag");let e=new z_([],null,[]);if(e.set.push(e),t)for(let i of t.set)e.set.push(i);return e}static defineModifier(){let t=new W_;return e=>e.modified.indexOf(t)>-1?e:W_.get(e.base||e,e.modified.concat(t).sort(((t,e)=>t.id-e.id)))}}let L_=0;class W_{constructor(){this.instances=[],this.id=L_++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find((i=>{return i.base==t&&(n=e,r=i.modified,n.length==r.length&&n.every(((t,e)=>t==r[e])));var n,r}));if(i)return i;let n=[],r=new z_(n,t,e);for(let t of e)t.instances.push(r);let s=V_(e);for(let e of t.set)for(let t of s)n.push(W_.get(e,t));return r}}function V_(t){let e=[t];for(let i=0;i<t.length;i++)for(let n of V_(t.slice(0,i).concat(t.slice(i+1))))e.push(n);return e}function j_(t){let e=Object.create(null);for(let i in t){let n=t[i];Array.isArray(n)||(n=[n]);for(let t of i.split(" "))if(t){let i=[],r=2,s=t;for(let e=0;;){if("..."==s&&e>0&&e+3==t.length){r=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!n)throw new RangeError("Invalid path: "+t);if(i.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),e+=n[0].length,e==t.length)break;let o=t[e++];if(e==t.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+t);s=t.slice(e)}let o=i.length-1,l=i[o];if(!l)throw new RangeError("Invalid path: "+t);let a=new H_(n,r,o>0?i.slice(0,o):null);e[l]=a.sort(e[l])}}return q_.add(e)}const q_=new p_;class H_{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}const X_=z_.define,F_=X_(),Z_=X_(),G_=X_(Z_),U_=X_(Z_),Y_=X_(),K_=X_(Y_),J_=X_(Y_),tD=X_(),eD=X_(tD),iD=X_(),nD=X_(),rD=X_(),sD=X_(rD),oD=X_(),lD={comment:F_,lineComment:X_(F_),blockComment:X_(F_),docComment:X_(F_),name:Z_,variableName:X_(Z_),typeName:G_,tagName:X_(G_),propertyName:U_,attributeName:X_(U_),className:X_(Z_),labelName:X_(Z_),namespace:X_(Z_),macroName:X_(Z_),literal:Y_,string:K_,docString:X_(K_),character:X_(K_),attributeValue:X_(K_),number:J_,integer:X_(J_),float:X_(J_),bool:X_(Y_),regexp:X_(Y_),escape:X_(Y_),color:X_(Y_),url:X_(Y_),keyword:iD,self:X_(iD),null:X_(iD),atom:X_(iD),unit:X_(iD),modifier:X_(iD),operatorKeyword:X_(iD),controlKeyword:X_(iD),definitionKeyword:X_(iD),moduleKeyword:X_(iD),operator:nD,derefOperator:X_(nD),arithmeticOperator:X_(nD),logicOperator:X_(nD),bitwiseOperator:X_(nD),compareOperator:X_(nD),updateOperator:X_(nD),definitionOperator:X_(nD),typeOperator:X_(nD),controlOperator:X_(nD),punctuation:rD,separator:X_(rD),bracket:sD,angleBracket:X_(sD),squareBracket:X_(sD),paren:X_(sD),brace:X_(sD),content:tD,heading:eD,heading1:X_(eD),heading2:X_(eD),heading3:X_(eD),heading4:X_(eD),heading5:X_(eD),heading6:X_(eD),contentSeparator:X_(tD),list:X_(tD),quote:X_(tD),emphasis:X_(tD),strong:X_(tD),link:X_(tD),monospace:X_(tD),strikethrough:X_(tD),inserted:X_(),deleted:X_(),changed:X_(),invalid:X_(),meta:oD,documentMeta:X_(oD),annotation:X_(oD),processingInstruction:X_(oD),definition:z_.defineModifier(),constant:z_.defineModifier(),function:z_.defineModifier(),standard:z_.defineModifier(),local:z_.defineModifier(),special:z_.defineModifier()};var aD;!function(t,e){let i=Object.create(null);for(let e of t)if(Array.isArray(e.tag))for(let t of e.tag)i[t.id]=e.class;else i[e.tag.id]=e.class;let{scope:n,all:r=null}=e||{}}([{tag:lD.link,class:"tok-link"},{tag:lD.heading,class:"tok-heading"},{tag:lD.emphasis,class:"tok-emphasis"},{tag:lD.strong,class:"tok-strong"},{tag:lD.keyword,class:"tok-keyword"},{tag:lD.atom,class:"tok-atom"},{tag:lD.bool,class:"tok-bool"},{tag:lD.url,class:"tok-url"},{tag:lD.labelName,class:"tok-labelName"},{tag:lD.inserted,class:"tok-inserted"},{tag:lD.deleted,class:"tok-deleted"},{tag:lD.literal,class:"tok-literal"},{tag:lD.string,class:"tok-string"},{tag:lD.number,class:"tok-number"},{tag:[lD.regexp,lD.escape,lD.special(lD.string)],class:"tok-string2"},{tag:lD.variableName,class:"tok-variableName"},{tag:lD.local(lD.variableName),class:"tok-variableName tok-local"},{tag:lD.definition(lD.variableName),class:"tok-variableName tok-definition"},{tag:lD.special(lD.variableName),class:"tok-variableName2"},{tag:lD.definition(lD.propertyName),class:"tok-propertyName tok-definition"},{tag:lD.typeName,class:"tok-typeName"},{tag:lD.namespace,class:"tok-namespace"},{tag:lD.className,class:"tok-className"},{tag:lD.macroName,class:"tok-macroName"},{tag:lD.propertyName,class:"tok-propertyName"},{tag:lD.operator,class:"tok-operator"},{tag:lD.comment,class:"tok-comment"},{tag:lD.meta,class:"tok-meta"},{tag:lD.invalid,class:"tok-invalid"},{tag:lD.punctuation,class:"tok-punctuation"}]);const hD=new p_;class cD{constructor(t,e,i=[]){this.data=t,Qe.prototype.hasOwnProperty("tree")||Object.defineProperty(Qe.prototype,"tree",{get(){return fD(this)}}),this.parser=e,this.extension=[yD.of(this),Qe.languageData.of(((t,e,i)=>t.facet(uD(t,e,i))))].concat(i)}isActiveAt(t,e,i=-1){return uD(t,e,i)==this.data}findRegions(t){let e=t.facet(yD);if((null==e?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let i=[],n=(t,e)=>{if(t.prop(hD)==this.data)return void i.push({from:e,to:e+t.length});let r=t.prop(p_.mounted);if(r){if(r.tree.prop(hD)==this.data){if(r.overlay)for(let t of r.overlay)i.push({from:t.from+e,to:t.to+e});else i.push({from:e,to:e+t.length});return}if(r.overlay){let t=i.length;if(n(r.tree,r.overlay[0].from+e),i.length>t)return}}for(let i=0;i<t.children.length;i++){let r=t.children[i];r instanceof w_&&n(r,t.positions[i]+e)}};return n(fD(t),0),i}get allowsNesting(){return!0}}function uD(t,e,i){let n=t.facet(yD);if(!n)return null;let r=n.data;if(n.allowsNesting)for(let n=fD(t).topNode;n;n=n.enter(e,i,v_.ExcludeBuffers))r=n.type.prop(hD)||r;return r}function fD(t){let e=t.field(cD.state,!1);return e?e.tree:w_.empty}cD.setState=Oe.define();class dD{constructor(t,e=t.length){this.doc=t,this.length=e,this.cursorPos=0,this.string="",this.cursor=t.iter()}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-i,e-i)}}let pD=null;class gD{constructor(t,e,i=[],n,r,s,o,l){this.parser=t,this.state=e,this.fragments=i,this.tree=n,this.treeLen=r,this.viewport=s,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(t,e,i){return new gD(t,e,[],w_.empty,0,i,[],null)}startParse(){return this.parser.startParse(new dD(this.state.doc),this.fragments)}work(t,e){return null!=e&&e>=this.state.doc.length&&(e=void 0),this.tree!=w_.empty&&this.isDone(null!=e?e:this.state.doc.length)?(this.takeTree(),!0):this.withContext((()=>{var i;if("number"==typeof t){let e=Date.now()+t;t=()=>Date.now()>e}for(this.parse||(this.parse=this.startParse()),null!=e&&(null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n){if(this.fragments=this.withoutTempSkipped(N_.addTree(n,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(i=this.parse.stoppedAt)&&void 0!==i?i:this.state.doc.length,this.tree=n,this.parse=null,!(this.treeLen<(null!=e?e:this.state.doc.length)))return!0;this.parse=this.startParse()}if(t())return!1}}))}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext((()=>{for(;!(e=this.parse.advance()););})),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(N_.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=pD;pD=this;try{return t()}finally{pD=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=mD(t,e.from,e.to);return t}changes(t,e){let{fragments:i,tree:n,treeLen:r,viewport:s,skipped:o}=this;if(this.takeTree(),!t.empty){let e=[];if(t.iterChangedRanges(((t,i,n,r)=>e.push({fromA:t,toA:i,fromB:n,toB:r}))),i=N_.applyChanges(i,e),n=w_.empty,r=0,s={from:t.mapPos(s.from,-1),to:t.mapPos(s.to,1)},this.skipped.length){o=[];for(let e of this.skipped){let i=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);i<n&&o.push({from:i,to:n})}}}return new gD(this.parser,e,i,n,r,s,o,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let e=0;e<this.skipped.length;e++){let{from:i,to:n}=this.skipped[e];i<t.to&&n>t.from&&(this.fragments=mD(this.fragments,i,n),this.skipped.splice(e--,1))}return!(this.skipped.length>=e)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends class{startParse(t,e,i){return"string"==typeof t&&(t=new B_(t)),i=i?i.length?i.map((t=>new d_(t.from,t.to))):[new d_(0,0)]:[new d_(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let t=n.advance();if(t)return t}}}{createParse(e,i,n){let r=n[0].from,s=n[n.length-1].to;return{parsedPos:r,advance(){let e=pD;if(e){for(let t of n)e.tempSkipped.push(t);t&&(e.scheduleOn=e.scheduleOn?Promise.all([e.scheduleOn,t]):t)}return this.parsedPos=s,new w_(m_.none,[],[],s-r)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&0==e[0].from&&e[0].to>=t}static get(){return pD}}function mD(t,e,i){return N_.applyChanges(t,[{fromA:e,toA:i,fromB:e,toB:i}])}class bD{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,i)||e.takeTree(),new bD(e)}static init(t){let e=Math.min(3e3,t.doc.length),i=gD.create(t.facet(yD).parser,t,{from:0,to:e});return i.work(20,e)||i.takeTree(),new bD(i)}}cD.state=Gt.define({create:bD.init,update(t,e){for(let t of e.effects)if(t.is(cD.setState))return t.value;return e.startState.facet(yD)!=e.state.facet(yD)?bD.init(e.state):t.apply(e)}});let OD=t=>{let e=setTimeout((()=>t()),500);return()=>clearTimeout(e)};"undefined"!=typeof requestIdleCallback&&(OD=t=>{let e=-1,i=setTimeout((()=>{e=requestIdleCallback(t,{timeout:400})}),100);return()=>e<0?clearTimeout(i):cancelIdleCallback(e)});const vD="undefined"!=typeof navigator&&(null===(aD=navigator.scheduling)||void 0===aD?void 0:aD.isInputPending)?()=>navigator.scheduling.isInputPending():null,wD=Bn.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(cD.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),t.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(cD.state);e.tree==e.context.tree&&e.context.isDone(t.doc.length)||(this.working=OD(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,r=i.field(cD.state);if(r.tree==r.context.tree&&r.context.isDone(n+1e5))return;let s=Date.now()+Math.min(this.chunkBudget,100,t&&!vD?Math.max(25,t.timeRemaining()-5):1e9),o=r.context.treeLen<n&&i.doc.length>n+1e3,l=r.context.work((()=>vD&&vD()||Date.now()>s),n+(o?0:1e5));this.chunkBudget-=Date.now()-e,(l||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:cD.setState.of(new bD(r.context))})),this.chunkBudget>0&&(!l||o)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then((()=>this.scheduleWork())).catch((t=>_n(this.view.state,t))).then((()=>this.workScheduled--)),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),yD=Vt.define({combine:t=>t.length?t[0]:null,enables:[cD.state,wD]}),xD=Vt.define(),kD=Vt.define({combine:t=>{if(!t.length)return"  ";if(!/^(?: +|\t+)$/.test(t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return t[0]}});function SD(t){let e=t.facet(kD);return 9==e.charCodeAt(0)?t.tabSize*e.length:e.length}function CD(t,e){let i="",n=t.tabSize;if(9==t.facet(kD).charCodeAt(0))for(;e>=n;)i+="\t",e-=n;for(let t=0;t<e;t++)i+=" ";return i}function AD(t,e){t instanceof Qe&&(t=new TD(t));for(let i of t.state.facet(xD)){let n=i(t,e);if(null!=n)return n}let i=fD(t.state);return i?function(t,e,i){return QD(e.resolveInner(i).enterUnfinishedNodesBefore(i),i,t)}(t,i,e):null}class TD{constructor(t,e={}){this.state=t,this.options=e,this.unit=SD(t)}lineAt(t,e=1){let i=this.state.doc.lineAt(t),{simulateBreak:n,simulateDoubleBreak:r}=this.options;return null!=n&&n>=i.from&&n<=i.to?r&&n==t?{text:"",from:t}:(e<0?n<t:n<=t)?{text:i.text.slice(n-i.from),from:n}:{text:i.text.slice(0,n-i.from),from:i.from}:i}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:i,from:n}=this.lineAt(t,e);return i.slice(t-n,Math.min(i.length,t+100-n))}column(t,e=1){let{text:i,from:n}=this.lineAt(t,e),r=this.countColumn(i,t-n),s=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return s>-1&&(r+=s-this.countColumn(i,i.search(/\S|$/))),r}countColumn(t,e=t.length){return Ze(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:i,from:n}=this.lineAt(t,e),r=this.options.overrideIndentation;if(r){let t=r(n);if(t>-1)return t}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const PD=new p_;function MD(t){let e=t.type.prop(PD);if(e)return e;let i,n=t.firstChild;if(n&&(i=n.type.prop(p_.closedBy))){let e=t.lastChild,n=e&&i.indexOf(e.name)>-1;return t=>function(t,e,i,n,r){let s=t.textAfter,o=s.match(/^\s*/)[0].length,l=n&&s.slice(o,o+n.length)==n||r==t.pos+o,a=e?function(t){let e=t.node,i=e.childAfter(e.from),n=e.lastChild;if(!i)return null;let r=t.options.simulateBreak,s=t.state.doc.lineAt(i.from),o=null==r||r<=s.from?s.to:Math.min(s.to,r);for(let t=i.to;;){let r=e.childAfter(t);if(!r||r==n)return null;if(!r.type.isSkipped)return r.from<o?i:null;t=r.to}}(t):null;return a?l?t.column(a.from):t.column(a.to):t.baseIndent+(l?0:t.unit*i)}(t,!0,1,void 0,n&&!function(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}(t)?e.from:void 0)}return null==t.parent?RD:null}function QD(t,e,i){for(;t;t=t.parent){let n=MD(t);if(n)return n($D.create(i,e,t))}return null}function RD(){return 0}class $D extends TD{constructor(t,e,i){super(t.state,t.options),this.base=t,this.pos=e,this.node=i}static create(t,e,i){return new $D(t,e,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let t=this.state.doc.lineAt(this.node.from);for(;;){let e=this.node.resolve(t.from);for(;e.parent&&e.parent.from==e.from;)e=e.parent;if(_D(e,this.node))break;t=this.state.doc.lineAt(e.from)}return this.lineIndent(t.from)}continue(){let t=this.node.parent;return t?QD(t,this.pos,this.base):0}}function _D(t,e){for(let i=e;i;i=i.parent)if(t==i)return!0;return!1}function DD(t,e,i){let n=t.prop(e<0?p_.openedBy:p_.closedBy);if(n)return n;if(1==t.name.length){let n=i.indexOf(t.name);if(n>-1&&n%2==(e<0?1:0))return[i[n+e]]}return null}function ED(t,e,i,n={}){let r=n.maxScanDistance||1e4,s=n.brackets||"()[]{}",o=fD(t),l=o.resolveInner(e,i);for(let n=l;n;n=n.parent){let r=DD(n.type,i,s);if(r&&n.from<n.to)return ND(t,e,i,n,r,s)}return function(t,e,i,n,r,s,o){let l=i<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),a=o.indexOf(l);if(a<0||a%2==0!=i>0)return null;let h={from:i<0?e-1:e,to:i>0?e+1:e},c=t.doc.iterRange(e,i>0?t.doc.length:0),u=0;for(let t=0;!c.next().done&&t<=s;){let s=c.value;i<0&&(t+=s.length);let l=e+t*i;for(let t=i>0?0:s.length-1,e=i>0?s.length:-1;t!=e;t+=i){let e=o.indexOf(s[t]);if(!(e<0||n.resolveInner(l+t,1).type!=r))if(e%2==0==i>0)u++;else{if(1==u)return{start:h,end:{from:l+t,to:l+t+1},matched:e>>1==a>>1};u--}}i>0&&(t+=s.length)}return c.done?{start:h,matched:!1}:null}(t,e,i,o,l.type,r,s)}function ND(t,e,i,n,r,s){let o=n.parent,l={from:n.from,to:n.to},a=0,h=null==o?void 0:o.cursor();if(h&&(i<0?h.childBefore(n.from):h.childAfter(n.to)))do{if(i<0?h.to<=n.from:h.from>=n.to){if(0==a&&r.indexOf(h.type.name)>-1&&h.from<h.to)return{start:l,end:{from:h.from,to:h.to},matched:!0};if(DD(h.type,i,s))a++;else if(DD(h.type,-i,s)&&(a--,0==a))return{start:l,end:h.from==h.to?void 0:{from:h.from,to:h.to},matched:!1}}}while(i<0?h.prevSibling():h.nextSibling());return{start:l,matched:!1}}const BD=Object.create(null),ID=[m_.none],zD=[],LD=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])LD[t]=VD(BD,e);function WD(t,e){zD.indexOf(t)>-1||(zD.push(t),console.warn(e))}function VD(t,e){let i=null;for(let n of e.split(".")){let e=t[n]||lD[n];e?"function"==typeof e?i?i=e(i):WD(n,`Modifier ${n} used at start of tag`):i?WD(n,`Tag ${n} used as modifier`):i=e:WD(n,`Unknown highlighting tag ${n}`)}if(!i)return 0;let n=e.replace(/ /g,"_"),r=m_.define({id:ID.length,name:n,props:[j_({[n]:i})]});return ID.push(r),r.id}function jD(t,e){return({state:i,dispatch:n})=>{if(i.readOnly)return!1;let r=t(e,i);return!!r&&(n(i.update(r)),!0)}}const qD=jD(GD,0),HD=jD(ZD,0),XD=jD(((t,e)=>ZD(t,e,function(t){let e=[];for(let i of t.selection.ranges){let n=t.doc.lineAt(i.from),r=i.to<=n.to?n:t.doc.lineAt(i.to),s=e.length-1;s>=0&&e[s].to>n.from?e[s].to=r.to:e.push({from:n.from,to:r.to})}return e}(e))),0);function FD(t,e=t.selection.main.head){let i=t.languageDataAt("commentTokens",e);return i.length?i[0]:{}}function ZD(t,e,i=e.selection.ranges){let n=i.map((t=>FD(e,t.from).block));if(!n.every((t=>t)))return null;let r=i.map(((t,i)=>function(t,{open:e,close:i},n,r){let s,o,l=t.sliceDoc(n-50,n),a=t.sliceDoc(r,r+50),h=/\s*$/.exec(l)[0].length,c=/^\s*/.exec(a)[0].length,u=l.length-h;if(l.slice(u-e.length,u)==e&&a.slice(c,c+i.length)==i)return{open:{pos:n-h,margin:h&&1},close:{pos:r+c,margin:c&&1}};r-n<=100?s=o=t.sliceDoc(n,r):(s=t.sliceDoc(n,n+50),o=t.sliceDoc(r-50,r));let f=/^\s*/.exec(s)[0].length,d=/\s*$/.exec(o)[0].length,p=o.length-d-i.length;return s.slice(f,f+e.length)==e&&o.slice(p,p+i.length)==i?{open:{pos:n+f+e.length,margin:/\s/.test(s.charAt(f+e.length))?1:0},close:{pos:r-d-i.length,margin:/\s/.test(o.charAt(p-1))?1:0}}:null}(e,n[i],t.from,t.to)));if(2!=t&&!r.every((t=>t)))return{changes:e.changes(i.map(((t,e)=>r[e]?[]:[{from:t.from,insert:n[e].open+" "},{from:t.to,insert:" "+n[e].close}])))};if(1!=t&&r.some((t=>t))){let t=[];for(let e,i=0;i<r.length;i++)if(e=r[i]){let r=n[i],{open:s,close:o}=e;t.push({from:s.pos-r.open.length,to:s.pos+s.margin},{from:o.pos-o.margin,to:o.pos+r.close.length})}return{changes:t}}return null}function GD(t,e,i=e.selection.ranges){let n=[],r=-1;for(let{from:t,to:s}of i){let i=n.length,o=1e9;for(let i=t;i<=s;){let l=e.doc.lineAt(i);if(l.from>r&&(t==s||s>l.from)){r=l.from;let t=FD(e,i).line;if(!t)continue;let s=/^\s*/.exec(l.text)[0].length,a=s==l.length,h=l.text.slice(s,s+t.length)==t?s:-1;s<l.text.length&&s<o&&(o=s),n.push({line:l,comment:h,token:t,indent:s,empty:a,single:!1})}i=l.to+1}if(o<1e9)for(let t=i;t<n.length;t++)n[t].indent<n[t].line.text.length&&(n[t].indent=o);n.length==i+1&&(n[i].single=!0)}if(2!=t&&n.some((t=>t.comment<0&&(!t.empty||t.single)))){let t=[];for(let{line:e,token:i,indent:r,empty:s,single:o}of n)!o&&s||t.push({from:e.from+r,insert:i+" "});let i=e.changes(t);return{changes:i,selection:e.selection.map(i,1)}}if(1!=t&&n.some((t=>t.comment>=0))){let t=[];for(let{line:e,comment:i,token:r}of n)if(i>=0){let n=e.from+i,s=n+r.length;" "==e.text[s-e.from]&&s++,t.push({from:n,to:s})}return{changes:t}}return null}const UD=ge.define(),YD=ge.define(),KD=Vt.define(),JD=Vt.define({combine:t=>Re(t,{minDepth:100,newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min})});const tE=Gt.define({create:()=>mE.empty,update(t,e){let i=e.state.facet(JD),n=e.annotation(UD);if(n){let r=e.docChanged?zt.single(function(t){let e=0;return t.iterChangedRanges(((t,i)=>e=i)),e}(e.changes)):void 0,s=lE.fromTransaction(e,r),o=n.side,l=0==o?t.undone:t.done;return l=s?aE(l,l.length,i.minDepth,s):uE(l,e.startState.selection),new mE(0==o?n.rest:l,0==o?l:n.rest)}let r=e.annotation(YD);if("full"!=r&&"before"!=r||(t=t.isolate()),!1===e.annotation(ve.addToHistory))return e.changes.empty?t:t.addMapping(e.changes.desc);let s=lE.fromTransaction(e),o=e.annotation(ve.time),l=e.annotation(ve.userEvent);return s?t=t.addChanges(s,o,l,i.newGroupDelay,i.minDepth):e.selection&&(t=t.addSelection(e.startState.selection,o,l,i.newGroupDelay)),"full"!=r&&"after"!=r||(t=t.isolate()),t},toJSON:t=>({done:t.done.map((t=>t.toJSON())),undone:t.undone.map((t=>t.toJSON()))}),fromJSON:t=>new mE(t.done.map(lE.fromJSON),t.undone.map(lE.fromJSON))});function eE(t={}){return[tE,JD.of(t),Is.domEventHandlers({beforeinput(t,e){let i="historyUndo"==t.inputType?nE:"historyRedo"==t.inputType?rE:null;return!!i&&(t.preventDefault(),i(e))}})]}function iE(t,e){return function({state:i,dispatch:n}){if(!e&&i.readOnly)return!1;let r=i.field(tE,!1);if(!r)return!1;let s=r.pop(t,i,e);return!!s&&(n(s),!0)}}const nE=iE(0,!1),rE=iE(1,!1),sE=iE(0,!0),oE=iE(1,!0);class lE{constructor(t,e,i,n,r){this.changes=t,this.effects=e,this.mapped=i,this.startSelection=n,this.selectionsAfter=r}setSelAfter(t){return new lE(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var t,e,i;return{changes:null===(t=this.changes)||void 0===t?void 0:t.toJSON(),mapped:null===(e=this.mapped)||void 0===e?void 0:e.toJSON(),startSelection:null===(i=this.startSelection)||void 0===i?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map((t=>t.toJSON()))}}static fromJSON(t){return new lE(t.changes&&Rt.fromJSON(t.changes),[],t.mapped&&Qt.fromJSON(t.mapped),t.startSelection&&zt.fromJSON(t.startSelection),t.selectionsAfter.map(zt.fromJSON))}static fromTransaction(t,e){let i=cE;for(let e of t.startState.facet(KD)){let n=e(t);n.length&&(i=i.concat(n))}return!i.length&&t.changes.empty?null:new lE(t.changes.invert(t.startState.doc),i,void 0,e||t.startState.selection,cE)}static selection(t){return new lE(void 0,cE,void 0,void 0,t)}}function aE(t,e,i,n){let r=e+1>i+20?e-i-1:0,s=t.slice(r,e);return s.push(n),s}function hE(t,e){return t.length?e.length?t.concat(e):t:e}const cE=[];function uE(t,e){if(t.length){let i=t[t.length-1],n=i.selectionsAfter.slice(Math.max(0,i.selectionsAfter.length-200));return n.length&&n[n.length-1].eq(e)?t:(n.push(e),aE(t,t.length-1,1e9,i.setSelAfter(n)))}return[lE.selection([e])]}function fE(t){let e=t[t.length-1],i=t.slice();return i[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),i}function dE(t,e){if(!t.length)return t;let i=t.length,n=cE;for(;i;){let r=pE(t[i-1],e,n);if(r.changes&&!r.changes.empty||r.effects.length){let e=t.slice(0,i);return e[i-1]=r,e}e=r.mapped,i--,n=r.selectionsAfter}return n.length?[lE.selection(n)]:cE}function pE(t,e,i){let n=hE(t.selectionsAfter.length?t.selectionsAfter.map((t=>t.map(e))):cE,i);if(!t.changes)return lE.selection(n);let r=t.changes.map(e),s=e.mapDesc(t.changes,!0),o=t.mapped?t.mapped.composeDesc(s):s;return new lE(r,Oe.mapEffects(t.effects,e),o,t.startSelection.map(s),n)}const gE=/^(input\.type|delete)($|\.)/;class mE{constructor(t,e,i=0,n){this.done=t,this.undone=e,this.prevTime=i,this.prevUserEvent=n}isolate(){return this.prevTime?new mE(this.done,this.undone):this}addChanges(t,e,i,n,r){let s=this.done,o=s[s.length-1];return s=o&&o.changes&&!o.changes.empty&&t.changes&&(!i||gE.test(i))&&(!o.selectionsAfter.length&&e-this.prevTime<n&&function(t,e){let i=[],n=!1;return t.iterChangedRanges(((t,e)=>i.push(t,e))),e.iterChangedRanges(((t,e,r,s)=>{for(let t=0;t<i.length;){let e=i[t++],o=i[t++];s>=e&&r<=o&&(n=!0)}})),n}(o.changes,t.changes)||"input.type.compose"==i)?aE(s,s.length-1,r,new lE(t.changes.compose(o.changes),hE(t.effects,o.effects),o.mapped,o.startSelection,cE)):aE(s,s.length,r,t),new mE(s,cE,e,i)}addSelection(t,e,i,n){let r=this.done.length?this.done[this.done.length-1].selectionsAfter:cE;return r.length>0&&e-this.prevTime<n&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&(s=r[r.length-1],o=t,s.ranges.length==o.ranges.length&&0===s.ranges.filter(((t,e)=>t.empty!=o.ranges[e].empty)).length)?this:new mE(uE(this.done,t),this.undone,e,i);var s,o}addMapping(t){return new mE(dE(this.done,t),dE(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,e,i){let n=0==t?this.done:this.undone;if(0==n.length)return null;let r=n[n.length-1];if(i&&r.selectionsAfter.length)return e.update({selection:r.selectionsAfter[r.selectionsAfter.length-1],annotations:UD.of({side:t,rest:fE(n)}),userEvent:0==t?"select.undo":"select.redo",scrollIntoView:!0});if(r.changes){let i=1==n.length?cE:n.slice(0,n.length-1);return r.mapped&&(i=dE(i,r.mapped)),e.update({changes:r.changes,selection:r.startSelection,effects:r.effects,annotations:UD.of({side:t,rest:i}),filter:!1,userEvent:0==t?"undo":"redo",scrollIntoView:!0})}return null}}mE.empty=new mE(cE,cE);const bE=[{key:"Mod-z",run:nE,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:rE,preventDefault:!0},{linux:"Ctrl-Shift-z",run:rE,preventDefault:!0},{key:"Mod-u",run:sE,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:oE,preventDefault:!0}];function OE(t,e){return zt.create(t.ranges.map(e),t.mainIndex)}function vE(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function wE({state:t,dispatch:e},i){let n=OE(t.selection,i);return!n.eq(t.selection)&&(e(vE(t,n)),!0)}function yE(t,e){return zt.cursor(e?t.to:t.from)}function xE(t,e){return wE(t,(i=>i.empty?t.moveByChar(i,e):yE(i,e)))}function kE(t){return t.textDirectionAt(t.state.selection.main.head)==Fn.LTR}const SE=t=>xE(t,!kE(t)),CE=t=>xE(t,kE(t));function AE(t,e){return wE(t,(i=>i.empty?t.moveByGroup(i,e):yE(i,e)))}function TE(t,e,i){if(e.type.prop(i))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function PE(t,e,i){let n,r,s=fD(t).resolveInner(e.head),o=i?p_.closedBy:p_.openedBy;for(let n=e.head;;){let e=i?s.childAfter(n):s.childBefore(n);if(!e)break;TE(t,e,o)?s=e:n=i?e.to:e.from}return r=s.type.prop(o)&&(n=i?ED(t,s.from,1):ED(t,s.to,-1))&&n.matched?i?n.end.to:n.end.from:i?s.to:s.from,zt.cursor(r,i?-1:1)}function ME(t,e){return wE(t,(i=>{if(!i.empty)return yE(i,e);let n=t.moveVertically(i,e);return n.head!=i.head?n:t.moveToLineBoundary(i,e)}))}const QE=t=>ME(t,!1),RE=t=>ME(t,!0);function $E(t){return Math.max(t.defaultLineHeight,Math.min(t.dom.clientHeight,innerHeight)-5)}function _E(t,e){let{state:i}=t,n=OE(i.selection,(i=>i.empty?t.moveVertically(i,e,$E(t)):yE(i,e)));if(n.eq(i.selection))return!1;let r,s=t.coordsAtPos(i.selection.main.head),o=t.scrollDOM.getBoundingClientRect();return s&&s.top>o.top&&s.bottom<o.bottom&&s.top-o.top<=t.scrollDOM.scrollHeight-t.scrollDOM.scrollTop-t.scrollDOM.clientHeight&&(r=Is.scrollIntoView(n.main.head,{y:"start",yMargin:s.top-o.top})),t.dispatch(vE(i,n),{effects:r}),!0}const DE=t=>_E(t,!1),EE=t=>_E(t,!0);function NE(t,e,i){let n=t.lineBlockAt(e.head),r=t.moveToLineBoundary(e,i);if(r.head==e.head&&r.head!=(i?n.to:n.from)&&(r=t.moveToLineBoundary(e,i,!1)),!i&&r.head==n.from&&n.length){let i=/^\s*/.exec(t.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;i&&e.head!=n.from+i&&(r=zt.cursor(n.from+i))}return r}const BE=t=>wE(t,(e=>NE(t,e,!0))),IE=t=>wE(t,(e=>NE(t,e,!1)));function zE(t,e){let i=OE(t.state.selection,(t=>{let i=e(t);return zt.range(t.anchor,i.head,i.goalColumn)}));return!i.eq(t.state.selection)&&(t.dispatch(vE(t.state,i)),!0)}function LE(t,e){return zE(t,(i=>t.moveByChar(i,e)))}const WE=t=>LE(t,!kE(t)),VE=t=>LE(t,kE(t));function jE(t,e){return zE(t,(i=>t.moveByGroup(i,e)))}function qE(t,e){return zE(t,(i=>t.moveVertically(i,e)))}const HE=t=>qE(t,!1),XE=t=>qE(t,!0);function FE(t,e){return zE(t,(i=>t.moveVertically(i,e,$E(t))))}const ZE=t=>FE(t,!1),GE=t=>FE(t,!0),UE=t=>zE(t,(e=>NE(t,e,!0))),YE=t=>zE(t,(e=>NE(t,e,!1))),KE=({state:t,dispatch:e})=>(e(vE(t,{anchor:0})),!0),JE=({state:t,dispatch:e})=>(e(vE(t,{anchor:t.doc.length})),!0),tN=({state:t,dispatch:e})=>(e(vE(t,{anchor:t.selection.main.anchor,head:0})),!0),eN=({state:t,dispatch:e})=>(e(vE(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0);function iN({state:t,dispatch:e},i){if(t.readOnly)return!1;let n="delete.selection",r=t.changeByRange((t=>{let{from:e,to:r}=t;if(e==r){let t=i(e);t<e?n="delete.backward":t>e&&(n="delete.forward"),e=Math.min(e,t),r=Math.max(r,t)}return e==r?{range:t}:{changes:{from:e,to:r},range:zt.cursor(e)}}));return!r.changes.empty&&(e(t.update(r,{scrollIntoView:!0,userEvent:n,effects:"delete.selection"==n?Is.announce.of(t.phrase("Selection deleted")):void 0})),!0)}function nN(t,e,i){if(t instanceof Is)for(let n of t.state.facet(Is.atomicRanges).map((e=>e(t))))n.between(e,e,((t,n)=>{t<e&&n>e&&(e=i?n:t)}));return e}const rN=(t,e)=>iN(t,(i=>{let n,r,{state:s}=t,o=s.doc.lineAt(i);if(!e&&i>o.from&&i<o.from+200&&!/[^ \t]/.test(n=o.text.slice(0,i-o.from))){if("\t"==n[n.length-1])return i-1;let t=Ze(n,s.tabSize)%SD(s)||SD(s);for(let e=0;e<t&&" "==n[n.length-1-e];e++)i--;r=i}else r=wt(o.text,i-o.from,e,e)+o.from,r==i&&o.number!=(e?s.doc.lines:1)&&(r+=e?1:-1);return nN(t,r,e)})),sN=t=>rN(t,!1),oN=t=>rN(t,!0),lN=(t,e)=>iN(t,(i=>{let n=i,{state:r}=t,s=r.doc.lineAt(n),o=r.charCategorizer(n);for(let t=null;;){if(n==(e?s.to:s.from)){n==i&&s.number!=(e?r.doc.lines:1)&&(n+=e?1:-1);break}let l=wt(s.text,n-s.from,e)+s.from,a=s.text.slice(Math.min(n,l)-s.from,Math.max(n,l)-s.from),h=o(a);if(null!=t&&h!=t)break;" "==a&&n==i||(t=h),n=l}return nN(t,n,e)})),aN=t=>lN(t,!1),hN=t=>iN(t,(e=>{let i=t.lineBlockAt(e).to;return nN(t,e<i?i:Math.min(t.state.doc.length,e+1),!0)}));function cN(t){let e=[],i=-1;for(let n of t.selection.ranges){let r=t.doc.lineAt(n.from),s=t.doc.lineAt(n.to);if(n.empty||n.to!=s.from||(s=t.doc.lineAt(n.to-1)),i>=r.number){let t=e[e.length-1];t.to=s.to,t.ranges.push(n)}else e.push({from:r.from,to:s.to,ranges:[n]});i=s.number+1}return e}function uN(t,e,i){if(t.readOnly)return!1;let n=[],r=[];for(let e of cN(t)){if(i?e.to==t.doc.length:0==e.from)continue;let s=t.doc.lineAt(i?e.to+1:e.from-1),o=s.length+1;if(i){n.push({from:e.to,to:s.to},{from:e.from,insert:s.text+t.lineBreak});for(let i of e.ranges)r.push(zt.range(Math.min(t.doc.length,i.anchor+o),Math.min(t.doc.length,i.head+o)))}else{n.push({from:s.from,to:e.from},{from:e.to,insert:t.lineBreak+s.text});for(let t of e.ranges)r.push(zt.range(t.anchor-o,t.head-o))}}return!!n.length&&(e(t.update({changes:n,scrollIntoView:!0,selection:zt.create(r,t.selection.mainIndex),userEvent:"move.line"})),!0)}function fN(t,e,i){if(t.readOnly)return!1;let n=[];for(let e of cN(t))i?n.push({from:e.from,insert:t.doc.slice(e.from,e.to)+t.lineBreak}):n.push({from:e.to,insert:t.lineBreak+t.doc.slice(e.from,e.to)});return e(t.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const dN=gN(!1),pN=gN(!0);function gN(t){return({state:e,dispatch:i})=>{if(e.readOnly)return!1;let n=e.changeByRange((i=>{let{from:n,to:r}=i,s=e.doc.lineAt(n),o=!t&&n==r&&function(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let i,n=fD(t).resolveInner(e),r=n.childBefore(e),s=n.childAfter(e);return r&&s&&r.to<=e&&s.from>=e&&(i=r.type.prop(p_.closedBy))&&i.indexOf(s.name)>-1&&t.doc.lineAt(r.to).from==t.doc.lineAt(s.from).from?{from:r.to,to:s.from}:null}(e,n);t&&(n=r=(r<=s.to?s:e.doc.lineAt(r)).to);let l=new TD(e,{simulateBreak:n,simulateDoubleBreak:!!o}),a=AD(l,n);for(null==a&&(a=/^\s*/.exec(e.doc.lineAt(n).text)[0].length);r<s.to&&/\s/.test(s.text[r-s.from]);)r++;o?({from:n,to:r}=o):n>s.from&&n<s.from+100&&!/\S/.test(s.text.slice(0,n))&&(n=s.from);let h=["",CD(e,a)];return o&&h.push(CD(e,l.lineIndent(s.from,-1))),{changes:{from:n,to:r,insert:at.of(h)},range:zt.cursor(n+1+h[1].length)}}));return i(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function mN(t,e){let i=-1;return t.changeByRange((n=>{let r=[];for(let s=n.from;s<=n.to;){let o=t.doc.lineAt(s);o.number>i&&(n.empty||n.to>o.from)&&(e(o,r,n),i=o.number),s=o.to+1}let s=t.changes(r);return{changes:r,range:zt.range(s.mapPos(n.anchor,1),s.mapPos(n.head,1))}}))}const bN=[{key:"Ctrl-b",run:SE,shift:WE,preventDefault:!0},{key:"Ctrl-f",run:CE,shift:VE},{key:"Ctrl-p",run:QE,shift:HE},{key:"Ctrl-n",run:RE,shift:XE},{key:"Ctrl-a",run:t=>wE(t,(e=>zt.cursor(t.lineBlockAt(e.head).from,1))),shift:t=>zE(t,(e=>zt.cursor(t.lineBlockAt(e.head).from)))},{key:"Ctrl-e",run:t=>wE(t,(e=>zt.cursor(t.lineBlockAt(e.head).to,-1))),shift:t=>zE(t,(e=>zt.cursor(t.lineBlockAt(e.head).to)))},{key:"Ctrl-d",run:oN},{key:"Ctrl-h",run:sN},{key:"Ctrl-k",run:hN},{key:"Ctrl-Alt-h",run:aN},{key:"Ctrl-o",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange((t=>({changes:{from:t.from,to:t.to,insert:at.of(["",""])},range:zt.cursor(t.from)})));return e(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange((e=>{if(!e.empty||0==e.from||e.from==t.doc.length)return{range:e};let i=e.from,n=t.doc.lineAt(i),r=i==n.from?i-1:wt(n.text,i-n.from,!1)+n.from,s=i==n.to?i+1:wt(n.text,i-n.from,!0)+n.from;return{changes:{from:r,to:s,insert:t.doc.slice(i,s).append(t.doc.slice(r,i))},range:zt.cursor(s)}}));return!i.changes.empty&&(e(t.update(i,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:EE}],ON=[{key:"ArrowLeft",run:SE,shift:WE,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:t=>AE(t,!kE(t)),shift:t=>jE(t,!kE(t))},{mac:"Cmd-ArrowLeft",run:IE,shift:YE},{key:"ArrowRight",run:CE,shift:VE,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:t=>AE(t,kE(t)),shift:t=>jE(t,kE(t))},{mac:"Cmd-ArrowRight",run:BE,shift:UE},{key:"ArrowUp",run:QE,shift:HE,preventDefault:!0},{mac:"Cmd-ArrowUp",run:KE,shift:tN},{mac:"Ctrl-ArrowUp",run:DE,shift:ZE},{key:"ArrowDown",run:RE,shift:XE,preventDefault:!0},{mac:"Cmd-ArrowDown",run:JE,shift:eN},{mac:"Ctrl-ArrowDown",run:EE,shift:GE},{key:"PageUp",run:DE,shift:ZE},{key:"PageDown",run:EE,shift:GE},{key:"Home",run:IE,shift:YE,preventDefault:!0},{key:"Mod-Home",run:KE,shift:tN},{key:"End",run:BE,shift:UE,preventDefault:!0},{key:"Mod-End",run:JE,shift:eN},{key:"Enter",run:dN},{key:"Mod-a",run:({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:sN,shift:sN},{key:"Delete",run:oN},{key:"Mod-Backspace",mac:"Alt-Backspace",run:aN},{key:"Mod-Delete",mac:"Alt-Delete",run:t=>lN(t,!0)},{mac:"Mod-Backspace",run:t=>iN(t,(e=>{let i=t.lineBlockAt(e).from;return nN(t,e>i?i:Math.max(0,e-1),!1)}))},{mac:"Mod-Delete",run:hN}].concat(bN.map((t=>({mac:t.key,run:t.run,shift:t.shift})))),vN=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:t=>wE(t,(e=>PE(t.state,e,!kE(t)))),shift:t=>zE(t,(e=>PE(t.state,e,!kE(t))))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:t=>wE(t,(e=>PE(t.state,e,kE(t)))),shift:t=>zE(t,(e=>PE(t.state,e,kE(t))))},{key:"Alt-ArrowUp",run:({state:t,dispatch:e})=>uN(t,e,!1)},{key:"Shift-Alt-ArrowUp",run:({state:t,dispatch:e})=>fN(t,e,!1)},{key:"Alt-ArrowDown",run:({state:t,dispatch:e})=>uN(t,e,!0)},{key:"Shift-Alt-ArrowDown",run:({state:t,dispatch:e})=>fN(t,e,!0)},{key:"Escape",run:({state:t,dispatch:e})=>{let i=t.selection,n=null;return i.ranges.length>1?n=zt.create([i.main]):i.main.empty||(n=zt.create([zt.cursor(i.main.head)])),!!n&&(e(vE(t,n)),!0)}},{key:"Mod-Enter",run:pN},{key:"Alt-l",mac:"Ctrl-l",run:({state:t,dispatch:e})=>{let i=cN(t).map((({from:e,to:i})=>zt.range(e,Math.min(i+1,t.doc.length))));return e(t.update({selection:zt.create(i),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:t,dispatch:e})=>{let i=OE(t.selection,(e=>{var i;let n=fD(t).resolveInner(e.head,1);for(;!(n.from<e.from&&n.to>=e.to||n.to>e.to&&n.from<=e.from)&&(null===(i=n.parent)||void 0===i?void 0:i.parent);)n=n.parent;return zt.range(n.to,n.from)}));return e(vE(t,i)),!0},preventDefault:!0},{key:"Mod-[",run:({state:t,dispatch:e})=>!t.readOnly&&(e(t.update(mN(t,((e,i)=>{let n=/^\s*/.exec(e.text)[0];if(!n)return;let r=Ze(n,t.tabSize),s=0,o=CD(t,Math.max(0,r-SD(t)));for(;s<n.length&&s<o.length&&n.charCodeAt(s)==o.charCodeAt(s);)s++;i.push({from:e.from+s,to:e.from+n.length,insert:o.slice(s)})})),{userEvent:"delete.dedent"})),!0)},{key:"Mod-]",run:({state:t,dispatch:e})=>!t.readOnly&&(e(t.update(mN(t,((e,i)=>{i.push({from:e.from,insert:t.facet(kD)})})),{userEvent:"input.indent"})),!0)},{key:"Mod-Alt-\\",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=Object.create(null),n=new TD(t,{overrideIndentation:t=>{let e=i[t];return null==e?-1:e}}),r=mN(t,((e,r,s)=>{let o=AD(n,e.from);if(null==o)return;/\S/.test(e.text)||(o=0);let l=/^\s*/.exec(e.text)[0],a=CD(t,o);(l!=a||s.from<e.from+l.length)&&(i[e.from]=o,r.push({from:e.from,to:e.from+l.length,insert:a}))}));return r.changes.empty||e(t.update(r,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:t=>{if(t.state.readOnly)return!1;let{state:e}=t,i=e.changes(cN(e).map((({from:t,to:i})=>(t>0?t--:i<e.doc.length&&i++,{from:t,to:i})))),n=OE(e.selection,(e=>t.moveVertically(e,!0))).map(i);return t.dispatch({changes:i,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:({state:t,dispatch:e})=>function(t,e,i){let n=!1,r=OE(t.selection,(e=>{let r=ED(t,e.head,-1)||ED(t,e.head,1)||e.head>0&&ED(t,e.head-1,1)||e.head<t.doc.length&&ED(t,e.head+1,-1);if(!r||!r.end)return e;n=!0;let s=r.start.from==e.head?r.end.to:r.end.from;return i?zt.range(e.anchor,s):zt.cursor(s)}));return!!n&&(e(vE(t,r)),!0)}(t,e,!1)},{key:"Mod-/",run:t=>{let e=FD(t.state);return e.line?qD(t):!!e.block&&XD(t)}},{key:"Alt-A",run:HD}].concat(ON),wN="function"==typeof String.prototype.normalize?t=>t.normalize("NFKD"):t=>t;class yN{constructor(t,e,i=0,n=t.length,r){this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=t.iterRange(i,n),this.bufferStart=i,this.normalize=r?t=>r(wN(t)):wN,this.query=this.normalize(e)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Ct(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let t=this.peek();if(t<0)return this.done=!0,this;let e=At(t),i=this.bufferStart+this.bufferPos;this.bufferPos+=Tt(t);let n=this.normalize(e);for(let t=0,r=i;;t++){let s=n.charCodeAt(t),o=this.match(s,r);if(o)return this.value=o,this;if(t==n.length-1)break;r==i&&t<e.length&&e.charCodeAt(t)==s&&r++}}}match(t,e){let i=null;for(let n=0;n<this.matches.length;n+=2){let r=this.matches[n],s=!1;this.query.charCodeAt(r)==t&&(r==this.query.length-1?i={from:this.matches[n+1],to:e+1}:(this.matches[n]++,s=!0)),s||(this.matches.splice(n,2),n-=2)}return this.query.charCodeAt(0)==t&&(1==this.query.length?i={from:e,to:e+1}:this.matches.push(1,e)),i}}"undefined"!=typeof Symbol&&(yN.prototype[Symbol.iterator]=function(){return this});const xN={from:-1,to:-1,match:/.*/.exec("")},kN="gm"+(null==/x/.unicode?"":"u");class SN{constructor(t,e,i,n=0,r=t.length){if(this.to=r,this.curLine="",this.done=!1,this.value=xN,/\\[sWDnr]|\n|\r|\[\^/.test(e))return new TN(t,e,i,n,r);this.re=new RegExp(e,kN+((null==i?void 0:i.ignoreCase)?"i":"")),this.iter=t.iter();let s=t.lineAt(n);this.curLineStart=s.from,this.matchPos=n,this.getLine(this.curLineStart)}getLine(t){this.iter.next(t),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let t=this.matchPos-this.curLineStart;;){this.re.lastIndex=t;let e=this.matchPos<=this.to&&this.re.exec(this.curLine);if(e){let i=this.curLineStart+e.index,n=i+e[0].length;if(this.matchPos=n+(i==n?1:0),i==this.curLine.length&&this.nextLine(),i<n||i>this.value.to)return this.value={from:i,to:n,match:e},this;t=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),t=0}}}}const CN=new WeakMap;class AN{constructor(t,e){this.from=t,this.text=e}get to(){return this.from+this.text.length}static get(t,e,i){let n=CN.get(t);if(!n||n.from>=i||n.to<=e){let n=new AN(e,t.sliceString(e,i));return CN.set(t,n),n}if(n.from==e&&n.to==i)return n;let{text:r,from:s}=n;return s>e&&(r=t.sliceString(e,s)+r,s=e),n.to<i&&(r+=t.sliceString(n.to,i)),CN.set(t,new AN(s,r)),new AN(e,r.slice(e-s,i-s))}}class TN{constructor(t,e,i,n,r){this.text=t,this.to=r,this.done=!1,this.value=xN,this.matchPos=n,this.re=new RegExp(e,kN+((null==i?void 0:i.ignoreCase)?"i":"")),this.flat=AN.get(t,n,this.chunkEnd(n+5e3))}chunkEnd(t){return t>=this.to?this.to:this.text.lineAt(t).to}next(){for(;;){let t=this.re.lastIndex=this.matchPos-this.flat.from,e=this.re.exec(this.flat.text);if(e&&!e[0]&&e.index==t&&(this.re.lastIndex=t+1,e=this.re.exec(this.flat.text)),e&&this.flat.to<this.to&&e.index+e[0].length>this.flat.text.length-10&&(e=null),e){let t=this.flat.from+e.index,i=t+e[0].length;return this.value={from:t,to:i,match:e},this.matchPos=i+(t==i?1:0),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=AN.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}function PN(t){let e=Tw("input",{class:"cm-textfield",name:"line"});function i(){let i=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!i)return;let{state:n}=t,r=n.doc.lineAt(n.selection.main.head),[,s,o,l,a]=i,h=l?+l.slice(1):0,c=o?+o:r.number;if(o&&a){let t=c/100;s&&(t=t*("-"==s?-1:1)+r.number/n.doc.lines),c=Math.round(n.doc.lines*t)}else o&&s&&(c=c*("-"==s?-1:1)+r.number);let u=n.doc.line(Math.max(1,Math.min(n.doc.lines,c)));t.dispatch({effects:MN.of(!1),selection:zt.cursor(u.from+Math.max(0,Math.min(h,u.length))),scrollIntoView:!0}),t.focus()}return{dom:Tw("form",{class:"cm-gotoLine",onkeydown:e=>{27==e.keyCode?(e.preventDefault(),t.dispatch({effects:MN.of(!1)}),t.focus()):13==e.keyCode&&(e.preventDefault(),i())},onsubmit:t=>{t.preventDefault(),i()}},Tw("label",t.state.phrase("Go to line"),": ",e)," ",Tw("button",{class:"cm-button",type:"submit"},t.state.phrase("go")))}}"undefined"!=typeof Symbol&&(SN.prototype[Symbol.iterator]=TN.prototype[Symbol.iterator]=function(){return this});const MN=Oe.define(),QN=Gt.define({create:()=>!0,update(t,e){for(let i of e.effects)i.is(MN)&&(t=i.value);return t},provide:t=>Bo.from(t,(t=>t?PN:null))}),RN=Is.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),$N={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},_N=Vt.define({combine:t=>Re(t,$N,{highlightWordAroundCursor:(t,e)=>t||e,minSelectionLength:Math.min,maxMatches:Math.min})});function DN(t){let e=[zN,IN];return t&&e.push(_N.of(t)),e}const EN=dn.mark({class:"cm-selectionMatch"}),NN=dn.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function BN(t,e,i,n){return!(0!=i&&t(e.sliceDoc(i-1,i))==Ae.Word||n!=e.doc.length&&t(e.sliceDoc(n,n+1))==Ae.Word)}const IN=Bn.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.selectionSet||t.docChanged||t.viewportChanged)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=t.state.facet(_N),{state:i}=t,n=i.selection;if(n.ranges.length>1)return dn.none;let r,s=n.main,o=null;if(s.empty){if(!e.highlightWordAroundCursor)return dn.none;let t=i.wordAt(s.head);if(!t)return dn.none;o=i.charCategorizer(s.head),r=i.sliceDoc(t.from,t.to)}else{let t=s.to-s.from;if(t<e.minSelectionLength||t>200)return dn.none;if(e.wholeWords){if(r=i.sliceDoc(s.from,s.to),o=i.charCategorizer(s.head),!BN(o,i,s.from,s.to)||!function(t,e,i,n){return t(e.sliceDoc(i,i+1))==Ae.Word&&t(e.sliceDoc(n-1,n))==Ae.Word}(o,i,s.from,s.to))return dn.none}else if(r=i.sliceDoc(s.from,s.to).trim(),!r)return dn.none}let l=[];for(let n of t.visibleRanges){let t=new yN(i.doc,r,n.from,n.to);for(;!t.next().done;){let{from:n,to:r}=t.value;if((!o||BN(o,i,n,r))&&(s.empty&&n<=s.from&&r>=s.to?l.push(NN.range(n,r)):(n>=s.to||r<=s.from)&&l.push(EN.range(n,r)),l.length>e.maxMatches))return dn.none}}return dn.set(l)}},{decorations:t=>t.decorations}),zN=Is.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}});const LN=Vt.define({combine(t){var e;return{top:t.reduce(((t,e)=>null!=t?t:e.top),void 0)||!1,caseSensitive:t.reduce(((t,e)=>null!=t?t:e.caseSensitive),void 0)||!1,createPanel:(null===(e=t.find((t=>t.createPanel)))||void 0===e?void 0:e.createPanel)||(t=>new uB(t))}}});class WN{constructor(t){this.search=t.search,this.caseSensitive=!!t.caseSensitive,this.regexp=!!t.regexp,this.replace=t.replace||"",this.valid=!!this.search&&(!this.regexp||function(t){try{return new RegExp(t,kN),!0}catch(t){return!1}}(this.search)),this.unquoted=t.literal?this.search:this.search.replace(/\\([nrt\\])/g,((t,e)=>"n"==e?"\n":"r"==e?"\r":"t"==e?"\t":"\\"))}eq(t){return this.search==t.search&&this.replace==t.replace&&this.caseSensitive==t.caseSensitive&&this.regexp==t.regexp}create(){return this.regexp?new XN(this):new qN(this)}getCursor(t,e=0,i=t.length){return this.regexp?HN(this,t,e,i):jN(this,t,e,i)}}class VN{constructor(t){this.spec=t}}function jN(t,e,i,n){return new yN(e,t.unquoted,i,n,t.caseSensitive?void 0:t=>t.toLowerCase())}class qN extends VN{constructor(t){super(t)}nextMatch(t,e,i){let n=jN(this.spec,t,i,t.length).nextOverlapping();return n.done&&(n=jN(this.spec,t,0,e).nextOverlapping()),n.done?null:n.value}prevMatchInRange(t,e,i){for(let n=i;;){let i=Math.max(e,n-1e4-this.spec.unquoted.length),r=jN(this.spec,t,i,n),s=null;for(;!r.nextOverlapping().done;)s=r.value;if(s)return s;if(i==e)return null;n-=1e4}}prevMatch(t,e,i){return this.prevMatchInRange(t,0,e)||this.prevMatchInRange(t,i,t.length)}getReplacement(t){return this.spec.replace}matchAll(t,e){let i=jN(this.spec,t,0,t.length),n=[];for(;!i.next().done;){if(n.length>=e)return null;n.push(i.value)}return n}highlight(t,e,i,n){let r=jN(this.spec,t,Math.max(0,e-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,t.length));for(;!r.next().done;)n(r.value.from,r.value.to)}}function HN(t,e,i,n){return new SN(e,t.search,t.caseSensitive?void 0:{ignoreCase:!0},i,n)}class XN extends VN{nextMatch(t,e,i){let n=HN(this.spec,t,i,t.length).next();return n.done&&(n=HN(this.spec,t,0,e).next()),n.done?null:n.value}prevMatchInRange(t,e,i){for(let n=1;;n++){let r=Math.max(e,i-1e4*n),s=HN(this.spec,t,r,i),o=null;for(;!s.next().done;)o=s.value;if(o&&(r==e||o.from>r+10))return o;if(r==e)return null}}prevMatch(t,e,i){return this.prevMatchInRange(t,0,e)||this.prevMatchInRange(t,i,t.length)}getReplacement(t){return this.spec.replace.replace(/\$([$&\d+])/g,((e,i)=>"$"==i?"$":"&"==i?t.match[0]:"0"!=i&&+i<t.match.length?t.match[i]:e))}matchAll(t,e){let i=HN(this.spec,t,0,t.length),n=[];for(;!i.next().done;){if(n.length>=e)return null;n.push(i.value)}return n}highlight(t,e,i,n){let r=HN(this.spec,t,Math.max(0,e-250),Math.min(i+250,t.length));for(;!r.next().done;)n(r.value.from,r.value.to)}}const FN=Oe.define(),ZN=Oe.define(),GN=Gt.define({create:t=>new UN(lB(t).create(),null),update(t,e){for(let i of e.effects)i.is(FN)?t=new UN(i.value.create(),t.panel):i.is(ZN)&&(t=new UN(t.query,i.value?oB:null));return t},provide:t=>Bo.from(t,(t=>t.panel))});class UN{constructor(t,e){this.query=t,this.panel=e}}const YN=dn.mark({class:"cm-searchMatch"}),KN=dn.mark({class:"cm-searchMatch cm-searchMatch-selected"}),JN=Bn.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(GN))}update(t){let e=t.state.field(GN);(e!=t.startState.field(GN)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return dn.none;let{view:i}=this,n=new Be;for(let e=0,r=i.visibleRanges,s=r.length;e<s;e++){let{from:o,to:l}=r[e];for(;e<s-1&&l>r[e+1].from-500;)l=r[++e].to;t.highlight(i.state.doc,o,l,((t,e)=>{let r=i.state.selection.ranges.some((i=>i.from==t&&i.to==e));n.add(t,e,r?KN:YN)}))}return n.finish()}},{decorations:t=>t.decorations});function tB(t){return e=>{let i=e.state.field(GN,!1);return i&&i.query.spec.valid?t(e,i):aB(e)}}const eB=tB(((t,{query:e})=>{let{from:i,to:n}=t.state.selection.main,r=e.nextMatch(t.state.doc,i,n);return!(!r||r.from==i&&r.to==n)&&(t.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0,effects:pB(t,r),userEvent:"select.search"}),!0)})),iB=tB(((t,{query:e})=>{let{state:i}=t,{from:n,to:r}=i.selection.main,s=e.prevMatch(i.doc,n,r);return!!s&&(t.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0,effects:pB(t,s),userEvent:"select.search"}),!0)})),nB=tB(((t,{query:e})=>{let i=e.matchAll(t.state.doc,1e3);return!(!i||!i.length)&&(t.dispatch({selection:zt.create(i.map((t=>zt.range(t.from,t.to)))),userEvent:"select.search.matches"}),!0)})),rB=tB(((t,{query:e})=>{let{state:i}=t,{from:n,to:r}=i.selection.main;if(i.readOnly)return!1;let s=e.nextMatch(i.doc,n,n);if(!s)return!1;let o,l,a=[],h=[];if(s.from==n&&s.to==r&&(l=i.toText(e.getReplacement(s)),a.push({from:s.from,to:s.to,insert:l}),s=e.nextMatch(i.doc,s.from,s.to),h.push(Is.announce.of(i.phrase("replaced match on line $",i.doc.lineAt(n).number)+"."))),s){let e=0==a.length||a[0].from>=s.to?0:s.to-s.from-l.length;o={anchor:s.from-e,head:s.to-e},h.push(pB(t,s))}return t.dispatch({changes:a,selection:o,scrollIntoView:!!o,effects:h,userEvent:"input.replace"}),!0})),sB=tB(((t,{query:e})=>{if(t.state.readOnly)return!1;let i=e.matchAll(t.state.doc,1e9).map((t=>{let{from:i,to:n}=t;return{from:i,to:n,insert:e.getReplacement(t)}}));if(!i.length)return!1;let n=t.state.phrase("replaced $ matches",i.length)+".";return t.dispatch({changes:i,effects:Is.announce.of(n),userEvent:"input.replace.all"}),!0}));function oB(t){return t.state.facet(LN).createPanel(t)}function lB(t,e){var i;let n=t.selection.main,r=n.empty||n.to>n.from+100?"":t.sliceDoc(n.from,n.to),s=null!==(i=null==e?void 0:e.caseSensitive)&&void 0!==i?i:t.facet(LN).caseSensitive;return e&&!r?e:new WN({search:r.replace(/\n/g,"\\n"),caseSensitive:s})}const aB=t=>{let e=t.state.field(GN,!1);if(e&&e.panel){let i=_o(t,oB);if(!i)return!1;let n=i.dom.querySelector("[main-field]");if(n&&n!=t.root.activeElement){let i=lB(t.state,e.query.spec);i.valid&&t.dispatch({effects:FN.of(i)}),n.focus(),n.select()}}else t.dispatch({effects:[ZN.of(!0),e?FN.of(lB(t.state,e.query.spec)):Oe.appendConfig.of(mB)]});return!0},hB=t=>{let e=t.state.field(GN,!1);if(!e||!e.panel)return!1;let i=_o(t,oB);return i&&i.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:ZN.of(!1)}),!0},cB=[{key:"Mod-f",run:aB,scope:"editor search-panel"},{key:"F3",run:eB,shift:iB,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:eB,shift:iB,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:hB,scope:"editor search-panel"},{key:"Mod-Shift-l",run:({state:t,dispatch:e})=>{let i=t.selection;if(i.ranges.length>1||i.main.empty)return!1;let{from:n,to:r}=i.main,s=[],o=0;for(let e=new yN(t.doc,t.sliceDoc(n,r));!e.next().done;){if(s.length>1e3)return!1;e.value.from==n&&(o=s.length),s.push(zt.range(e.value.from,e.value.to))}return e(t.update({selection:zt.create(s,o),userEvent:"select.search.matches"})),!0}},{key:"Alt-g",run:t=>{let e=_o(t,PN);if(!e){let i=[MN.of(!0)];null==t.state.field(QN,!1)&&i.push(Oe.appendConfig.of([QN,RN])),t.dispatch({effects:i}),e=_o(t,PN)}return e&&e.dom.querySelector("input").focus(),!0}},{key:"Mod-d",run:({state:t,dispatch:e})=>{let{ranges:i}=t.selection;if(i.some((t=>t.from===t.to)))return(({state:t,dispatch:e})=>{let{selection:i}=t,n=zt.create(i.ranges.map((e=>t.wordAt(e.head)||zt.cursor(e.head))),i.mainIndex);return!n.eq(i)&&(e(t.update({selection:n})),!0)})({state:t,dispatch:e});let n=t.sliceDoc(i[0].from,i[0].to);if(t.selection.ranges.some((e=>t.sliceDoc(e.from,e.to)!=n)))return!1;let r=function(t,e){let{main:i,ranges:n}=t.selection,r=t.wordAt(i.head),s=r&&r.from==i.from&&r.to==i.to;for(let i=!1,r=new yN(t.doc,e,n[n.length-1].to);;){if(r.next(),!r.done){if(i&&n.some((t=>t.from==r.value.from)))continue;if(s){let e=t.wordAt(r.value.from);if(!e||e.from!=r.value.from||e.to!=r.value.to)continue}return r.value}if(i)return null;r=new yN(t.doc,e,0,Math.max(0,n[n.length-1].from-1)),i=!0}}(t,n);return!!r&&(e(t.update({selection:t.selection.addRange(zt.range(r.from,r.to),!1),effects:Is.scrollIntoView(r.to)})),!0)},preventDefault:!0}];class uB{constructor(t){this.view=t;let e=this.query=t.state.field(GN).query.spec;function i(t,e,i){return Tw("button",{class:"cm-button",name:t,onclick:e,type:"button"},i)}this.commit=this.commit.bind(this),this.searchField=Tw("input",{value:e.search,placeholder:fB(t,"Find"),"aria-label":fB(t,"Find"),class:"cm-textfield",name:"search","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Tw("input",{value:e.replace,placeholder:fB(t,"Replace"),"aria-label":fB(t,"Replace"),class:"cm-textfield",name:"replace",onchange:this.commit,onkeyup:this.commit}),this.caseField=Tw("input",{type:"checkbox",name:"case",checked:e.caseSensitive,onchange:this.commit}),this.reField=Tw("input",{type:"checkbox",name:"re",checked:e.regexp,onchange:this.commit}),this.dom=Tw("div",{onkeydown:t=>this.keydown(t),class:"cm-search"},[this.searchField,i("next",(()=>eB(t)),[fB(t,"next")]),i("prev",(()=>iB(t)),[fB(t,"previous")]),i("select",(()=>nB(t)),[fB(t,"all")]),Tw("label",null,[this.caseField,fB(t,"match case")]),Tw("label",null,[this.reField,fB(t,"regexp")]),...t.state.readOnly?[]:[Tw("br"),this.replaceField,i("replace",(()=>rB(t)),[fB(t,"replace")]),i("replaceAll",(()=>sB(t)),[fB(t,"replace all")]),Tw("button",{name:"close",onclick:()=>hB(t),"aria-label":fB(t,"close"),type:"button"},["×"])]])}commit(){let t=new WN({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,replace:this.replaceField.value});t.eq(this.query)||(this.query=t,this.view.dispatch({effects:FN.of(t)}))}keydown(t){!function(t,e,i){return Us(Zs(t.state),e,t,i)}(this.view,t,"search-panel")?13==t.keyCode&&t.target==this.searchField?(t.preventDefault(),(t.shiftKey?iB:eB)(this.view)):13==t.keyCode&&t.target==this.replaceField&&(t.preventDefault(),rB(this.view)):t.preventDefault()}update(t){for(let e of t.transactions)for(let t of e.effects)t.is(FN)&&!t.value.eq(this.query)&&this.setQuery(t.value)}setQuery(t){this.query=t,this.searchField.value=t.search,this.replaceField.value=t.replace,this.caseField.checked=t.caseSensitive,this.reField.checked=t.regexp}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(LN).top}}function fB(t,e){return t.state.phrase(e)}const dB=/[\s\.,:;?!]/;function pB(t,{from:e,to:i}){let n=t.state.doc.lineAt(e),r=t.state.doc.lineAt(i).to,s=Math.max(n.from,e-30),o=Math.min(r,i+30),l=t.state.sliceDoc(s,o);if(s!=n.from)for(let t=0;t<30;t++)if(!dB.test(l[t+1])&&dB.test(l[t])){l=l.slice(t);break}if(o!=r)for(let t=l.length-1;t>l.length-30;t--)if(!dB.test(l[t-1])&&dB.test(l[t])){l=l.slice(0,t);break}return Is.announce.of(`${t.state.phrase("current match")}. ${l} ${t.state.phrase("on line")} ${n.number}.`)}const gB=Is.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),mB=[GN,ee.lowest(JN),gB],bB=1024;let OB=0;class vB{constructor(t,e){this.from=t,this.to=e}}class wB{constructor(t={}){this.id=OB++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=xB.match(t)),e=>{let i=t(e);return void 0===i?null:[this,i]}}}wB.closedBy=new wB({deserialize:t=>t.split(" ")}),wB.openedBy=new wB({deserialize:t=>t.split(" ")}),wB.group=new wB({deserialize:t=>t.split(" ")}),wB.contextHash=new wB({perNode:!0}),wB.lookAhead=new wB({perNode:!0}),wB.mounted=new wB({perNode:!0});const yB=Object.create(null);class xB{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):yB,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),n=new xB(t.name||"",e,t.id,i);if(t.props)for(let i of t.props)if(Array.isArray(i)||(i=i(n)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[i[0].id]=i[1]}return n}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop(wB.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return t=>{for(let i=t.prop(wB.group),n=-1;n<(i?i.length:0);n++){let r=e[n<0?t.name:i[n]];if(r)return r}}}}xB.none=new xB("",Object.create(null),0,8);const kB=new WeakMap,SB=new WeakMap;var CB;!function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"}(CB||(CB={}));class AB{constructor(t,e,i,n,r){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,r&&r.length){this.props=Object.create(null);for(let[t,e]of r)this.props["number"==typeof t?t:t.id]=e}}toString(){let t=this.prop(wB.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let i=t.toString();i&&(e&&(e+=","),e+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new BB(this.topNode,t)}cursorAt(t,e=0,i=0){let n=kB.get(this)||this.topNode,r=new BB(n);return r.moveTo(t,e),kB.set(this,r._tree),r}get topNode(){return new $B(this,0,0,null)}resolve(t,e=0){let i=RB(kB.get(this)||this.topNode,t,e,!1);return kB.set(this,i),i}resolveInner(t,e=0){let i=RB(SB.get(this)||this.topNode,t,e,!0);return SB.set(this,i),i}iterate(t){let{enter:e,leave:i,from:n=0,to:r=this.length}=t;for(let s=this.cursor((t.mode||0)|CB.IncludeAnonymous);;){let t=!1;if(s.from<=r&&s.to>=n&&(s.type.isAnonymous||!1!==e(s))){if(s.firstChild())continue;t=!0}for(;t&&i&&!s.type.isAnonymous&&i(s),!s.nextSibling();){if(!s.parent())return;t=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:WB(xB.none,this.children,this.positions,0,this.children.length,0,this.length,((t,e,i)=>new AB(this.type,t,e,i,this.propValues)),t.makeTree||((t,e,i)=>new AB(xB.none,t,e,i)))}static build(t){return function(t){var e;let{buffer:i,nodeSet:n,maxBufferLength:r=bB,reused:s=[],minRepeatType:o=n.types.length}=t,l=Array.isArray(i)?new TB(i,i.length):i,a=n.types,h=0,c=0;function u(t,e,i,b,O){let{id:v,start:w,end:y,size:x}=l,k=c;for(;x<0;){if(l.next(),-1==x){let e=s[v];return i.push(e),void b.push(w-t)}if(-3==x)return void(h=v);if(-4==x)return void(c=v);throw new RangeError(`Unrecognized record size: ${x}`)}let S,C,A=a[v],T=w-t;if(y-w<=r&&(C=g(l.pos-e,O))){let e=new Uint16Array(C.size-C.skip),i=l.pos-C.size,r=e.length;for(;l.pos>i;)r=m(C.start,e,r);S=new PB(e,y-C.start,n),T=C.start-t}else{let t=l.pos-x;l.next();let e=[],i=[],n=v>=o?v:-1,s=0,a=y;for(;l.pos>t;)n>=0&&l.id==n&&l.size>=0?(l.end<=a-r&&(d(e,i,w,s,l.end,a,n,k),s=e.length,a=l.end),l.next()):u(w,t,e,i,n);if(n>=0&&s>0&&s<e.length&&d(e,i,w,s,w,a,n,k),e.reverse(),i.reverse(),n>-1&&s>0){let t=f(A);S=WB(A,e,i,0,e.length,0,y-w,t,t)}else S=p(A,e,i,y-w,k-y)}i.push(S),b.push(T)}function f(t){return(e,i,n)=>{let r,s,o=0,l=e.length-1;if(l>=0&&(r=e[l])instanceof AB){if(!l&&r.type==t&&r.length==n)return r;(s=r.prop(wB.lookAhead))&&(o=i[l]+r.length+s)}return p(t,e,i,n,o)}}function d(t,e,i,r,s,o,l,a){let h=[],c=[];for(;t.length>r;)h.push(t.pop()),c.push(e.pop()+i-s);t.push(p(n.types[l],h,c,o-s,a-o)),e.push(s-i)}function p(t,e,i,n,r=0,s){if(h){let t=[wB.contextHash,h];s=s?[t].concat(s):[t]}if(r>25){let t=[wB.lookAhead,r];s=s?[t].concat(s):[t]}return new AB(t,e,i,n,s)}function g(t,e){let i=l.fork(),n=0,s=0,a=0,h=i.end-r,c={size:0,start:0,skip:0};t:for(let r=i.pos-t;i.pos>r;){let t=i.size;if(i.id==e&&t>=0){c.size=n,c.start=s,c.skip=a,a+=4,n+=4,i.next();continue}let l=i.pos-t;if(t<0||l<r||i.start<h)break;let u=i.id>=o?4:0,f=i.start;for(i.next();i.pos>l;){if(i.size<0){if(-3!=i.size)break t;u+=4}else i.id>=o&&(u+=4);i.next()}s=f,n+=t,a+=u}return(e<0||n==t)&&(c.size=n,c.start=s,c.skip=a),c.size>4?c:void 0}function m(t,e,i){let{id:n,start:r,end:s,size:a}=l;if(l.next(),a>=0&&n<o){let o=i;if(a>4){let n=l.pos-(a-4);for(;l.pos>n;)i=m(t,e,i)}e[--i]=o,e[--i]=s-t,e[--i]=r-t,e[--i]=n}else-3==a?h=n:-4==a&&(c=n);return i}let b=[],O=[];for(;l.pos>0;)u(t.start||0,t.bufferStart||0,b,O,-1);let v=null!==(e=t.length)&&void 0!==e?e:b.length?O[0]+b[0].length:0;return new AB(a[t.topID],b.reverse(),O.reverse(),v)}(t)}}AB.empty=new AB(xB.none,[],[],0);class TB{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new TB(this.buffer,this.index)}}class PB{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return xB.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],r=n.name;if(/\W/.test(r)&&!n.isError&&(r=JSON.stringify(r)),i==(t+=4))return r;let s=[];for(;t<i;)s.push(this.childString(t)),t=this.buffer[t+3];return r+"("+s.join(",")+")"}findChild(t,e,i,n,r){let{buffer:s}=this,o=-1;for(let l=t;l!=e&&!(MB(r,n,s[l+1],s[l+2])&&(o=l,i>0));l=s[l+3]);return o}slice(t,e,i,n){let r=this.buffer,s=new Uint16Array(e-t);for(let n=t,o=0;n<e;)s[o++]=r[n++],s[o++]=r[n++]-i,s[o++]=r[n++]-i,s[o++]=r[n++]-t;return new PB(s,n-i,this.set)}}function MB(t,e,i,n){switch(t){case-2:return i<e;case-1:return n>=e&&i<e;case 0:return i<e&&n>e;case 1:return i<=e&&n>e;case 2:return n>e;case 4:return!0}}function QB(t,e){let i=t.childBefore(e);for(;i;){let e=i.lastChild;if(!e||e.to!=i.to)break;e.type.isError&&e.from==e.to?(t=i,i=e.prevSibling):i=e}return t}function RB(t,e,i,n){for(var r;t.from==t.to||(i<1?t.from>=e:t.from>e)||(i>-1?t.to<=e:t.to<e);){let e=!n&&t instanceof $B&&t.index<0?null:t.parent;if(!e)return t;t=e}let s=n?0:CB.IgnoreOverlays;if(n)for(let n=t,o=n.parent;o;n=o,o=n.parent)n instanceof $B&&n.index<0&&(null===(r=o.enter(e,i,s))||void 0===r?void 0:r.from)!=n.from&&(t=o);for(;;){let n=t.enter(e,i,s);if(!n)return t;t=n}}class $B{constructor(t,e,i,n){this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,r=0){for(let s=this;;){for(let{children:o,positions:l}=s._tree,a=e>0?o.length:-1;t!=a;t+=e){let a=o[t],h=l[t]+s.from;if(MB(n,i,h,h+a.length))if(a instanceof PB){if(r&CB.ExcludeBuffers)continue;let o=a.findChild(0,a.buffer.length,e,i-h,n);if(o>-1)return new NB(new EB(s,a,t,h),null,o)}else if(r&CB.IncludeAnonymous||!a.type.isAnonymous||IB(a)){let o;if(!(r&CB.IgnoreMounts)&&a.props&&(o=a.prop(wB.mounted))&&!o.overlay)return new $B(o.tree,h,t,s);let l=new $B(a,h,t,s);return r&CB.IncludeAnonymous||!l.type.isAnonymous?l:l.nextChild(e<0?a.children.length-1:0,e,i,n)}}if(r&CB.IncludeAnonymous||!s.type.isAnonymous)return null;if(t=s.index>=0?s.index+e:e<0?-1:s._parent._tree.children.length,s=s._parent,!s)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&CB.IgnoreOverlays)&&(n=this._tree.prop(wB.mounted))&&n.overlay){let i=t-this.from;for(let{from:t,to:r}of n.overlay)if((e>0?t<=i:t<i)&&(e<0?r>=i:r>i))return new $B(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new BB(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return RB(this,t,e,!1)}resolveInner(t,e=0){return RB(this,t,e,!0)}enterUnfinishedNodesBefore(t){return QB(this,t)}getChild(t,e=null,i=null){let n=_B(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return _B(this,t,e,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return DB(this,t)}}function _B(t,e,i,n){let r=t.cursor(),s=[];if(!r.firstChild())return s;if(null!=i)for(;!r.type.is(i);)if(!r.nextSibling())return s;for(;;){if(null!=n&&r.type.is(n))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return null==n?s:[]}}function DB(t,e,i=e.length-1){for(let n=t.parent;i>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[i]&&e[i]!=n.name)return!1;i--}}return!0}class EB{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class NB{constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(t,e,i){let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return r<0?null:new NB(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&CB.ExcludeBuffers)return null;let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new NB(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new NB(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new NB(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new BB(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,r=i.buffer[this.index+3];if(r>n){let s=i.buffer[this.index+1],o=i.buffer[this.index+2];t.push(i.slice(n,r,s,o)),e.push(0)}return new AB(this.type,t,e,this.to-this.from)}resolve(t,e=0){return RB(this,t,e,!1)}resolveInner(t,e=0){return RB(this,t,e,!0)}enterUnfinishedNodesBefore(t){return QB(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let n=_B(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return _B(this,t,e,i)}get node(){return this}matchContext(t){return DB(this,t)}}class BB{constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof $B)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}get name(){return this.type.name}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return!!t&&(t instanceof $B?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?!(i&CB.ExcludeBuffers)&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&CB.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&CB.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let t=i<0?0:this.stack[i]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(t)}return i<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(n.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;({index:e,_parent:i}=i))if(e>-1)for(let n=e+t,r=t<0?-1:i._tree.children.length;n!=r;n+=t){let t=i._tree.children[n];if(this.mode&CB.IncludeAnonymous||t instanceof PB||!t.type.isAnonymous||IB(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,r=this.stack.length;r>=0;){for(let s=t;s;s=s._parent)if(s.index==n){if(n==this.index)return s;e=s,i=r+1;break t}n=this.stack[--r]}for(let t=i;t<this.stack.length;t++)e=new NB(this.buffer,e,this.stack[t]);return this.bufferNode=new NB(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||!1!==t(this)){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;n&&e&&e(this),n=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return DB(this.node,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,r=this.stack.length-1;n>=0;r--){if(r<0)return DB(this.node,t,n);let s=i[e.buffer[this.stack[r]]];if(!s.isAnonymous){if(t[n]&&t[n]!=s.name)return!1;n--}}return!0}}function IB(t){return t.children.some((t=>t instanceof PB||!t.type.isAnonymous||IB(t)))}const zB=new WeakMap;function LB(t,e){if(!t.isAnonymous||e instanceof PB||e.type!=t)return 1;let i=zB.get(e);if(null==i){i=1;for(let n of e.children){if(n.type!=t||!(n instanceof AB)){i=1;break}i+=LB(t,n)}zB.set(e,i)}return i}function WB(t,e,i,n,r,s,o,l,a){let h=0;for(let i=n;i<r;i++)h+=LB(t,e[i]);let c=Math.ceil(1.5*h/8),u=[],f=[];return function e(i,n,r,o,l){for(let h=r;h<o;){let r=h,d=n[h],p=LB(t,i[h]);for(h++;h<o;h++){let e=LB(t,i[h]);if(p+e>=c)break;p+=e}if(h==r+1){if(p>c){let t=i[r];e(t.children,t.positions,0,t.children.length,n[r]+l);continue}u.push(i[r])}else{let e=n[h-1]+i[h-1].length-d;u.push(WB(t,i,n,r,h,d,e,null,a))}f.push(d+l-s)}}(e,i,n,r,0),(l||a)(u,f,o)}class VB{constructor(t,e,i,n,r=!1,s=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(r?1:0)|(s?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(t,e=[],i=!1){let n=[new VB(0,t.length,t,0,!1,i)];for(let i of e)i.to>t.length&&n.push(i);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],r=1,s=t.length?t[0]:null;for(let o=0,l=0,a=0;;o++){let h=o<e.length?e[o]:null,c=h?h.fromA:1e9;if(c-l>=i)for(;s&&s.from<c;){let e=s;if(l>=e.from||c<=e.to||a){let t=Math.max(e.from,l)-a,i=Math.min(e.to,c)-a;e=t>=i?null:new VB(t,i,e.tree,e.offset+a,o>0,!!h)}if(e&&n.push(e),s.to>c)break;s=r<t.length?t[r++]:null}if(!h)break;l=h.toA,a=h.toA-h.toB}return n}}class jB{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new wB({perNode:!0});let qB=0;class HB{constructor(t,e,i){this.set=t,this.base=e,this.modified=i,this.id=qB++}static define(t){if(null==t?void 0:t.base)throw new Error("Can not derive from a modified tag");let e=new HB([],null,[]);if(e.set.push(e),t)for(let i of t.set)e.set.push(i);return e}static defineModifier(){let t=new FB;return e=>e.modified.indexOf(t)>-1?e:FB.get(e.base||e,e.modified.concat(t).sort(((t,e)=>t.id-e.id)))}}let XB=0;class FB{constructor(){this.instances=[],this.id=XB++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find((i=>{return i.base==t&&(n=e,r=i.modified,n.length==r.length&&n.every(((t,e)=>t==r[e])));var n,r}));if(i)return i;let n=[],r=new HB(n,t,e);for(let t of e)t.instances.push(r);let s=ZB(e);for(let e of t.set)for(let t of s)n.push(FB.get(e,t));return r}}function ZB(t){let e=[t];for(let i=0;i<t.length;i++)for(let n of ZB(t.slice(0,i).concat(t.slice(i+1))))e.push(n);return e}function GB(t){let e=Object.create(null);for(let i in t){let n=t[i];Array.isArray(n)||(n=[n]);for(let t of i.split(" "))if(t){let i=[],r=2,s=t;for(let e=0;;){if("..."==s&&e>0&&e+3==t.length){r=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!n)throw new RangeError("Invalid path: "+t);if(i.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),e+=n[0].length,e==t.length)break;let o=t[e++];if(e==t.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+t);s=t.slice(e)}let o=i.length-1,l=i[o];if(!l)throw new RangeError("Invalid path: "+t);let a=new YB(n,r,o>0?i.slice(0,o):null);e[l]=a.sort(e[l])}}return UB.add(e)}const UB=new wB;class YB{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}const KB=HB.define,JB=KB(),tI=KB(),eI=KB(tI),iI=KB(tI),nI=KB(),rI=KB(nI),sI=KB(nI),oI=KB(),lI=KB(oI),aI=KB(),hI=KB(),cI=KB(),uI=KB(cI),fI=KB(),dI={comment:JB,lineComment:KB(JB),blockComment:KB(JB),docComment:KB(JB),name:tI,variableName:KB(tI),typeName:eI,tagName:KB(eI),propertyName:iI,attributeName:KB(iI),className:KB(tI),labelName:KB(tI),namespace:KB(tI),macroName:KB(tI),literal:nI,string:rI,docString:KB(rI),character:KB(rI),attributeValue:KB(rI),number:sI,integer:KB(sI),float:KB(sI),bool:KB(nI),regexp:KB(nI),escape:KB(nI),color:KB(nI),url:KB(nI),keyword:aI,self:KB(aI),null:KB(aI),atom:KB(aI),unit:KB(aI),modifier:KB(aI),operatorKeyword:KB(aI),controlKeyword:KB(aI),definitionKeyword:KB(aI),moduleKeyword:KB(aI),operator:hI,derefOperator:KB(hI),arithmeticOperator:KB(hI),logicOperator:KB(hI),bitwiseOperator:KB(hI),compareOperator:KB(hI),updateOperator:KB(hI),definitionOperator:KB(hI),typeOperator:KB(hI),controlOperator:KB(hI),punctuation:cI,separator:KB(cI),bracket:uI,angleBracket:KB(uI),squareBracket:KB(uI),paren:KB(uI),brace:KB(uI),content:oI,heading:lI,heading1:KB(lI),heading2:KB(lI),heading3:KB(lI),heading4:KB(lI),heading5:KB(lI),heading6:KB(lI),contentSeparator:KB(oI),list:KB(oI),quote:KB(oI),emphasis:KB(oI),strong:KB(oI),link:KB(oI),monospace:KB(oI),strikethrough:KB(oI),inserted:KB(),deleted:KB(),changed:KB(),invalid:KB(),meta:fI,documentMeta:KB(fI),annotation:KB(fI),processingInstruction:KB(fI),definition:HB.defineModifier(),constant:HB.defineModifier(),function:HB.defineModifier(),standard:HB.defineModifier(),local:HB.defineModifier(),special:HB.defineModifier()};var pI;!function(t,e){let i=Object.create(null);for(let e of t)if(Array.isArray(e.tag))for(let t of e.tag)i[t.id]=e.class;else i[e.tag.id]=e.class;let{scope:n,all:r=null}=e||{}}([{tag:dI.link,class:"tok-link"},{tag:dI.heading,class:"tok-heading"},{tag:dI.emphasis,class:"tok-emphasis"},{tag:dI.strong,class:"tok-strong"},{tag:dI.keyword,class:"tok-keyword"},{tag:dI.atom,class:"tok-atom"},{tag:dI.bool,class:"tok-bool"},{tag:dI.url,class:"tok-url"},{tag:dI.labelName,class:"tok-labelName"},{tag:dI.inserted,class:"tok-inserted"},{tag:dI.deleted,class:"tok-deleted"},{tag:dI.literal,class:"tok-literal"},{tag:dI.string,class:"tok-string"},{tag:dI.number,class:"tok-number"},{tag:[dI.regexp,dI.escape,dI.special(dI.string)],class:"tok-string2"},{tag:dI.variableName,class:"tok-variableName"},{tag:dI.local(dI.variableName),class:"tok-variableName tok-local"},{tag:dI.definition(dI.variableName),class:"tok-variableName tok-definition"},{tag:dI.special(dI.variableName),class:"tok-variableName2"},{tag:dI.definition(dI.propertyName),class:"tok-propertyName tok-definition"},{tag:dI.typeName,class:"tok-typeName"},{tag:dI.namespace,class:"tok-namespace"},{tag:dI.className,class:"tok-className"},{tag:dI.macroName,class:"tok-macroName"},{tag:dI.propertyName,class:"tok-propertyName"},{tag:dI.operator,class:"tok-operator"},{tag:dI.comment,class:"tok-comment"},{tag:dI.meta,class:"tok-meta"},{tag:dI.invalid,class:"tok-invalid"},{tag:dI.punctuation,class:"tok-punctuation"}]);const gI=new wB;function mI(t){return Vt.define({combine:t?e=>e.concat(t):void 0})}class bI{constructor(t,e,i=[]){this.data=t,Qe.prototype.hasOwnProperty("tree")||Object.defineProperty(Qe.prototype,"tree",{get(){return vI(this)}}),this.parser=e,this.extension=[PI.of(this),Qe.languageData.of(((t,e,i)=>t.facet(OI(t,e,i))))].concat(i)}isActiveAt(t,e,i=-1){return OI(t,e,i)==this.data}findRegions(t){let e=t.facet(PI);if((null==e?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let i=[],n=(t,e)=>{if(t.prop(gI)==this.data)return void i.push({from:e,to:e+t.length});let r=t.prop(wB.mounted);if(r){if(r.tree.prop(gI)==this.data){if(r.overlay)for(let t of r.overlay)i.push({from:t.from+e,to:t.to+e});else i.push({from:e,to:e+t.length});return}if(r.overlay){let t=i.length;if(n(r.tree,r.overlay[0].from+e),i.length>t)return}}for(let i=0;i<t.children.length;i++){let r=t.children[i];r instanceof AB&&n(r,t.positions[i]+e)}};return n(vI(t),0),i}get allowsNesting(){return!0}}function OI(t,e,i){let n=t.facet(PI);if(!n)return null;let r=n.data;if(n.allowsNesting)for(let n=vI(t).topNode;n;n=n.enter(e,i,CB.ExcludeBuffers))r=n.type.prop(gI)||r;return r}function vI(t){let e=t.field(bI.state,!1);return e?e.tree:AB.empty}bI.setState=Oe.define();class wI{constructor(t,e=t.length){this.doc=t,this.length=e,this.cursorPos=0,this.string="",this.cursor=t.iter()}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-i,e-i)}}let yI=null;class xI{constructor(t,e,i=[],n,r,s,o,l){this.parser=t,this.state=e,this.fragments=i,this.tree=n,this.treeLen=r,this.viewport=s,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(t,e,i){return new xI(t,e,[],AB.empty,0,i,[],null)}startParse(){return this.parser.startParse(new wI(this.state.doc),this.fragments)}work(t,e){return null!=e&&e>=this.state.doc.length&&(e=void 0),this.tree!=AB.empty&&this.isDone(null!=e?e:this.state.doc.length)?(this.takeTree(),!0):this.withContext((()=>{var i;if("number"==typeof t){let e=Date.now()+t;t=()=>Date.now()>e}for(this.parse||(this.parse=this.startParse()),null!=e&&(null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n){if(this.fragments=this.withoutTempSkipped(VB.addTree(n,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(i=this.parse.stoppedAt)&&void 0!==i?i:this.state.doc.length,this.tree=n,this.parse=null,!(this.treeLen<(null!=e?e:this.state.doc.length)))return!0;this.parse=this.startParse()}if(t())return!1}}))}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext((()=>{for(;!(e=this.parse.advance()););})),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(VB.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=yI;yI=this;try{return t()}finally{yI=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=kI(t,e.from,e.to);return t}changes(t,e){let{fragments:i,tree:n,treeLen:r,viewport:s,skipped:o}=this;if(this.takeTree(),!t.empty){let e=[];if(t.iterChangedRanges(((t,i,n,r)=>e.push({fromA:t,toA:i,fromB:n,toB:r}))),i=VB.applyChanges(i,e),n=AB.empty,r=0,s={from:t.mapPos(s.from,-1),to:t.mapPos(s.to,1)},this.skipped.length){o=[];for(let e of this.skipped){let i=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);i<n&&o.push({from:i,to:n})}}}return new xI(this.parser,e,i,n,r,s,o,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let e=0;e<this.skipped.length;e++){let{from:i,to:n}=this.skipped[e];i<t.to&&n>t.from&&(this.fragments=kI(this.fragments,i,n),this.skipped.splice(e--,1))}return!(this.skipped.length>=e)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends class{startParse(t,e,i){return"string"==typeof t&&(t=new jB(t)),i=i?i.length?i.map((t=>new vB(t.from,t.to))):[new vB(0,0)]:[new vB(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let t=n.advance();if(t)return t}}}{createParse(e,i,n){let r=n[0].from,s=n[n.length-1].to;return{parsedPos:r,advance(){let e=yI;if(e){for(let t of n)e.tempSkipped.push(t);t&&(e.scheduleOn=e.scheduleOn?Promise.all([e.scheduleOn,t]):t)}return this.parsedPos=s,new AB(xB.none,[],[],s-r)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&0==e[0].from&&e[0].to>=t}static get(){return yI}}function kI(t,e,i){return VB.applyChanges(t,[{fromA:e,toA:i,fromB:e,toB:i}])}class SI{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,i)||e.takeTree(),new SI(e)}static init(t){let e=Math.min(3e3,t.doc.length),i=xI.create(t.facet(PI).parser,t,{from:0,to:e});return i.work(20,e)||i.takeTree(),new SI(i)}}bI.state=Gt.define({create:SI.init,update(t,e){for(let t of e.effects)if(t.is(bI.setState))return t.value;return e.startState.facet(PI)!=e.state.facet(PI)?SI.init(e.state):t.apply(e)}});let CI=t=>{let e=setTimeout((()=>t()),500);return()=>clearTimeout(e)};"undefined"!=typeof requestIdleCallback&&(CI=t=>{let e=-1,i=setTimeout((()=>{e=requestIdleCallback(t,{timeout:400})}),100);return()=>e<0?clearTimeout(i):cancelIdleCallback(e)});const AI="undefined"!=typeof navigator&&(null===(pI=navigator.scheduling)||void 0===pI?void 0:pI.isInputPending)?()=>navigator.scheduling.isInputPending():null,TI=Bn.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(bI.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),t.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(bI.state);e.tree==e.context.tree&&e.context.isDone(t.doc.length)||(this.working=CI(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,r=i.field(bI.state);if(r.tree==r.context.tree&&r.context.isDone(n+1e5))return;let s=Date.now()+Math.min(this.chunkBudget,100,t&&!AI?Math.max(25,t.timeRemaining()-5):1e9),o=r.context.treeLen<n&&i.doc.length>n+1e3,l=r.context.work((()=>AI&&AI()||Date.now()>s),n+(o?0:1e5));this.chunkBudget-=Date.now()-e,(l||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:bI.setState.of(new SI(r.context))})),this.chunkBudget>0&&(!l||o)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then((()=>this.scheduleWork())).catch((t=>_n(this.view.state,t))).then((()=>this.workScheduled--)),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),PI=Vt.define({combine:t=>t.length?t[0]:null,enables:[bI.state,TI]});class MI{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}}class QI{constructor(t,e,i,n,r,s){this.name=t,this.alias=e,this.extensions=i,this.filename=n,this.loadFunc=r,this.support=s,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then((t=>this.support=t),(t=>{throw this.loading=null,t})))}static of(t){let{load:e,support:i}=t;if(!e){if(!i)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");e=()=>Promise.resolve(i)}return new QI(t.name,(t.alias||[]).concat(t.name).map((t=>t.toLowerCase())),t.extensions||[],t.filename,e,i)}static matchFilename(t,e){for(let i of t)if(i.filename&&i.filename.test(e))return i;let i=/\.([^.]+)$/.exec(e);if(i)for(let e of t)if(e.extensions.indexOf(i[1])>-1)return e;return null}static matchLanguageName(t,e,i=!0){e=e.toLowerCase();for(let i of t)if(i.alias.some((t=>t==e)))return i;if(i)for(let i of t)for(let t of i.alias){let n=e.indexOf(t);if(n>-1&&(t.length>2||!/\w/.test(e[n-1])&&!/\w/.test(e[n+t.length])))return i}return null}}const RI=new wB,$I=new wB,_I=Object.create(null),DI=[xB.none],EI=[],NI=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])NI[t]=II(_I,e);function BI(t,e){EI.indexOf(t)>-1||(EI.push(t),console.warn(e))}function II(t,e){let i=null;for(let n of e.split(".")){let e=t[n]||dI[n];e?"function"==typeof e?i?i=e(i):BI(n,`Modifier ${n} used at start of tag`):i?BI(n,`Tag ${n} used as modifier`):i=e:BI(n,`Unknown highlighting tag ${n}`)}if(!i)return 0;let n=e.replace(/ /g,"_"),r=xB.define({id:DI.length,name:n,props:[GB({[n]:i})]});return DI.push(r),r.id}const zI=1024;let LI=0;class WI{constructor(t,e){this.from=t,this.to=e}}class VI{constructor(t={}){this.id=LI++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=HI.match(t)),e=>{let i=t(e);return void 0===i?null:[this,i]}}}VI.closedBy=new VI({deserialize:t=>t.split(" ")}),VI.openedBy=new VI({deserialize:t=>t.split(" ")}),VI.group=new VI({deserialize:t=>t.split(" ")}),VI.contextHash=new VI({perNode:!0}),VI.lookAhead=new VI({perNode:!0}),VI.mounted=new VI({perNode:!0});class jI{constructor(t,e,i){this.tree=t,this.overlay=e,this.parser=i}}const qI=Object.create(null);class HI{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):qI,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),n=new HI(t.name||"",e,t.id,i);if(t.props)for(let i of t.props)if(Array.isArray(i)||(i=i(n)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[i[0].id]=i[1]}return n}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop(VI.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return t=>{for(let i=t.prop(VI.group),n=-1;n<(i?i.length:0);n++){let r=e[n<0?t.name:i[n]];if(r)return r}}}}HI.none=new HI("",Object.create(null),0,8);class XI{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let i of this.types){let n=null;for(let e of t){let t=e(i);t&&(n||(n=Object.assign({},i.props)),n[t[0].id]=t[1])}e.push(n?new HI(i.name,n,i.id,i.flags):i)}return new XI(e)}}const FI=new WeakMap,ZI=new WeakMap;var GI;!function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"}(GI||(GI={}));class UI{constructor(t,e,i,n,r){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,r&&r.length){this.props=Object.create(null);for(let[t,e]of r)this.props["number"==typeof t?t:t.id]=e}}toString(){let t=this.prop(VI.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let i=t.toString();i&&(e&&(e+=","),e+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new lz(this.topNode,t)}cursorAt(t,e=0,i=0){let n=FI.get(this)||this.topNode,r=new lz(n);return r.moveTo(t,e),FI.set(this,r._tree),r}get topNode(){return new iz(this,0,0,null)}resolve(t,e=0){let i=ez(FI.get(this)||this.topNode,t,e,!1);return FI.set(this,i),i}resolveInner(t,e=0){let i=ez(ZI.get(this)||this.topNode,t,e,!0);return ZI.set(this,i),i}iterate(t){let{enter:e,leave:i,from:n=0,to:r=this.length}=t;for(let s=this.cursor((t.mode||0)|GI.IncludeAnonymous);;){let t=!1;if(s.from<=r&&s.to>=n&&(s.type.isAnonymous||!1!==e(s))){if(s.firstChild())continue;t=!0}for(;t&&i&&!s.type.isAnonymous&&i(s),!s.nextSibling();){if(!s.parent())return;t=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:uz(HI.none,this.children,this.positions,0,this.children.length,0,this.length,((t,e,i)=>new UI(this.type,t,e,i,this.propValues)),t.makeTree||((t,e,i)=>new UI(HI.none,t,e,i)))}static build(t){return function(t){var e;let{buffer:i,nodeSet:n,maxBufferLength:r=zI,reused:s=[],minRepeatType:o=n.types.length}=t,l=Array.isArray(i)?new YI(i,i.length):i,a=n.types,h=0,c=0;function u(t,e,i,b,O){let{id:v,start:w,end:y,size:x}=l,k=c;for(;x<0;){if(l.next(),-1==x){let e=s[v];return i.push(e),void b.push(w-t)}if(-3==x)return void(h=v);if(-4==x)return void(c=v);throw new RangeError(`Unrecognized record size: ${x}`)}let S,C,A=a[v],T=w-t;if(y-w<=r&&(C=g(l.pos-e,O))){let e=new Uint16Array(C.size-C.skip),i=l.pos-C.size,r=e.length;for(;l.pos>i;)r=m(C.start,e,r);S=new KI(e,y-C.start,n),T=C.start-t}else{let t=l.pos-x;l.next();let e=[],i=[],n=v>=o?v:-1,s=0,a=y;for(;l.pos>t;)n>=0&&l.id==n&&l.size>=0?(l.end<=a-r&&(d(e,i,w,s,l.end,a,n,k),s=e.length,a=l.end),l.next()):u(w,t,e,i,n);if(n>=0&&s>0&&s<e.length&&d(e,i,w,s,w,a,n,k),e.reverse(),i.reverse(),n>-1&&s>0){let t=f(A);S=uz(A,e,i,0,e.length,0,y-w,t,t)}else S=p(A,e,i,y-w,k-y)}i.push(S),b.push(T)}function f(t){return(e,i,n)=>{let r,s,o=0,l=e.length-1;if(l>=0&&(r=e[l])instanceof UI){if(!l&&r.type==t&&r.length==n)return r;(s=r.prop(VI.lookAhead))&&(o=i[l]+r.length+s)}return p(t,e,i,n,o)}}function d(t,e,i,r,s,o,l,a){let h=[],c=[];for(;t.length>r;)h.push(t.pop()),c.push(e.pop()+i-s);t.push(p(n.types[l],h,c,o-s,a-o)),e.push(s-i)}function p(t,e,i,n,r=0,s){if(h){let t=[VI.contextHash,h];s=s?[t].concat(s):[t]}if(r>25){let t=[VI.lookAhead,r];s=s?[t].concat(s):[t]}return new UI(t,e,i,n,s)}function g(t,e){let i=l.fork(),n=0,s=0,a=0,h=i.end-r,c={size:0,start:0,skip:0};t:for(let r=i.pos-t;i.pos>r;){let t=i.size;if(i.id==e&&t>=0){c.size=n,c.start=s,c.skip=a,a+=4,n+=4,i.next();continue}let l=i.pos-t;if(t<0||l<r||i.start<h)break;let u=i.id>=o?4:0,f=i.start;for(i.next();i.pos>l;){if(i.size<0){if(-3!=i.size)break t;u+=4}else i.id>=o&&(u+=4);i.next()}s=f,n+=t,a+=u}return(e<0||n==t)&&(c.size=n,c.start=s,c.skip=a),c.size>4?c:void 0}function m(t,e,i){let{id:n,start:r,end:s,size:a}=l;if(l.next(),a>=0&&n<o){let o=i;if(a>4){let n=l.pos-(a-4);for(;l.pos>n;)i=m(t,e,i)}e[--i]=o,e[--i]=s-t,e[--i]=r-t,e[--i]=n}else-3==a?h=n:-4==a&&(c=n);return i}let b=[],O=[];for(;l.pos>0;)u(t.start||0,t.bufferStart||0,b,O,-1);let v=null!==(e=t.length)&&void 0!==e?e:b.length?O[0]+b[0].length:0;return new UI(a[t.topID],b.reverse(),O.reverse(),v)}(t)}}UI.empty=new UI(HI.none,[],[],0);class YI{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new YI(this.buffer,this.index)}}class KI{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return HI.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],r=n.name;if(/\W/.test(r)&&!n.isError&&(r=JSON.stringify(r)),i==(t+=4))return r;let s=[];for(;t<i;)s.push(this.childString(t)),t=this.buffer[t+3];return r+"("+s.join(",")+")"}findChild(t,e,i,n,r){let{buffer:s}=this,o=-1;for(let l=t;l!=e&&!(JI(r,n,s[l+1],s[l+2])&&(o=l,i>0));l=s[l+3]);return o}slice(t,e,i,n){let r=this.buffer,s=new Uint16Array(e-t);for(let n=t,o=0;n<e;)s[o++]=r[n++],s[o++]=r[n++]-i,s[o++]=r[n++]-i,s[o++]=r[n++]-t;return new KI(s,n-i,this.set)}}function JI(t,e,i,n){switch(t){case-2:return i<e;case-1:return n>=e&&i<e;case 0:return i<e&&n>e;case 1:return i<=e&&n>e;case 2:return n>e;case 4:return!0}}function tz(t,e){let i=t.childBefore(e);for(;i;){let e=i.lastChild;if(!e||e.to!=i.to)break;e.type.isError&&e.from==e.to?(t=i,i=e.prevSibling):i=e}return t}function ez(t,e,i,n){for(var r;t.from==t.to||(i<1?t.from>=e:t.from>e)||(i>-1?t.to<=e:t.to<e);){let e=!n&&t instanceof iz&&t.index<0?null:t.parent;if(!e)return t;t=e}let s=n?0:GI.IgnoreOverlays;if(n)for(let n=t,o=n.parent;o;n=o,o=n.parent)n instanceof iz&&n.index<0&&(null===(r=o.enter(e,i,s))||void 0===r?void 0:r.from)!=n.from&&(t=o);for(;;){let n=t.enter(e,i,s);if(!n)return t;t=n}}class iz{constructor(t,e,i,n){this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,r=0){for(let s=this;;){for(let{children:o,positions:l}=s._tree,a=e>0?o.length:-1;t!=a;t+=e){let a=o[t],h=l[t]+s.from;if(JI(n,i,h,h+a.length))if(a instanceof KI){if(r&GI.ExcludeBuffers)continue;let o=a.findChild(0,a.buffer.length,e,i-h,n);if(o>-1)return new oz(new sz(s,a,t,h),null,o)}else if(r&GI.IncludeAnonymous||!a.type.isAnonymous||az(a)){let o;if(!(r&GI.IgnoreMounts)&&a.props&&(o=a.prop(VI.mounted))&&!o.overlay)return new iz(o.tree,h,t,s);let l=new iz(a,h,t,s);return r&GI.IncludeAnonymous||!l.type.isAnonymous?l:l.nextChild(e<0?a.children.length-1:0,e,i,n)}}if(r&GI.IncludeAnonymous||!s.type.isAnonymous)return null;if(t=s.index>=0?s.index+e:e<0?-1:s._parent._tree.children.length,s=s._parent,!s)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&GI.IgnoreOverlays)&&(n=this._tree.prop(VI.mounted))&&n.overlay){let i=t-this.from;for(let{from:t,to:r}of n.overlay)if((e>0?t<=i:t<i)&&(e<0?r>=i:r>i))return new iz(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new lz(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return ez(this,t,e,!1)}resolveInner(t,e=0){return ez(this,t,e,!0)}enterUnfinishedNodesBefore(t){return tz(this,t)}getChild(t,e=null,i=null){let n=nz(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return nz(this,t,e,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return rz(this,t)}}function nz(t,e,i,n){let r=t.cursor(),s=[];if(!r.firstChild())return s;if(null!=i)for(;!r.type.is(i);)if(!r.nextSibling())return s;for(;;){if(null!=n&&r.type.is(n))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return null==n?s:[]}}function rz(t,e,i=e.length-1){for(let n=t.parent;i>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[i]&&e[i]!=n.name)return!1;i--}}return!0}class sz{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class oz{constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(t,e,i){let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return r<0?null:new oz(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&GI.ExcludeBuffers)return null;let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new oz(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new oz(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new oz(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new lz(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,r=i.buffer[this.index+3];if(r>n){let s=i.buffer[this.index+1],o=i.buffer[this.index+2];t.push(i.slice(n,r,s,o)),e.push(0)}return new UI(this.type,t,e,this.to-this.from)}resolve(t,e=0){return ez(this,t,e,!1)}resolveInner(t,e=0){return ez(this,t,e,!0)}enterUnfinishedNodesBefore(t){return tz(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let n=nz(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return nz(this,t,e,i)}get node(){return this}matchContext(t){return rz(this,t)}}class lz{constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof iz)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}get name(){return this.type.name}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return!!t&&(t instanceof iz?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?!(i&GI.ExcludeBuffers)&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&GI.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&GI.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let t=i<0?0:this.stack[i]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(t)}return i<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(n.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;({index:e,_parent:i}=i))if(e>-1)for(let n=e+t,r=t<0?-1:i._tree.children.length;n!=r;n+=t){let t=i._tree.children[n];if(this.mode&GI.IncludeAnonymous||t instanceof KI||!t.type.isAnonymous||az(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,r=this.stack.length;r>=0;){for(let s=t;s;s=s._parent)if(s.index==n){if(n==this.index)return s;e=s,i=r+1;break t}n=this.stack[--r]}for(let t=i;t<this.stack.length;t++)e=new oz(this.buffer,e,this.stack[t]);return this.bufferNode=new oz(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||!1!==t(this)){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;n&&e&&e(this),n=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return rz(this.node,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,r=this.stack.length-1;n>=0;r--){if(r<0)return rz(this.node,t,n);let s=i[e.buffer[this.stack[r]]];if(!s.isAnonymous){if(t[n]&&t[n]!=s.name)return!1;n--}}return!0}}function az(t){return t.children.some((t=>t instanceof KI||!t.type.isAnonymous||az(t)))}const hz=new WeakMap;function cz(t,e){if(!t.isAnonymous||e instanceof KI||e.type!=t)return 1;let i=hz.get(e);if(null==i){i=1;for(let n of e.children){if(n.type!=t||!(n instanceof UI)){i=1;break}i+=cz(t,n)}hz.set(e,i)}return i}function uz(t,e,i,n,r,s,o,l,a){let h=0;for(let i=n;i<r;i++)h+=cz(t,e[i]);let c=Math.ceil(1.5*h/8),u=[],f=[];return function e(i,n,r,o,l){for(let h=r;h<o;){let r=h,d=n[h],p=cz(t,i[h]);for(h++;h<o;h++){let e=cz(t,i[h]);if(p+e>=c)break;p+=e}if(h==r+1){if(p>c){let t=i[r];e(t.children,t.positions,0,t.children.length,n[r]+l);continue}u.push(i[r])}else{let e=n[h-1]+i[h-1].length-d;u.push(uz(t,i,n,r,h,d,e,null,a))}f.push(d+l-s)}}(e,i,n,r,0),(l||a)(u,f,o)}class fz{constructor(t,e,i,n,r=!1,s=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(r?1:0)|(s?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(t,e=[],i=!1){let n=[new fz(0,t.length,t,0,!1,i)];for(let i of e)i.to>t.length&&n.push(i);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],r=1,s=t.length?t[0]:null;for(let o=0,l=0,a=0;;o++){let h=o<e.length?e[o]:null,c=h?h.fromA:1e9;if(c-l>=i)for(;s&&s.from<c;){let e=s;if(l>=e.from||c<=e.to||a){let t=Math.max(e.from,l)-a,i=Math.min(e.to,c)-a;e=t>=i?null:new fz(t,i,e.tree,e.offset+a,o>0,!!h)}if(e&&n.push(e),s.to>c)break;s=r<t.length?t[r++]:null}if(!h)break;l=h.toA,a=h.toA-h.toB}return n}}class dz{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}class pz{constructor(t,e,i,n,r){this.parser=t,this.parse=e,this.overlay=i,this.target=n,this.ranges=r}}class gz{constructor(t,e,i,n,r,s,o){this.parser=t,this.predicate=e,this.mounts=i,this.index=n,this.start=r,this.target=s,this.prev=o,this.depth=0,this.ranges=[]}}const mz=new VI({perNode:!0});class bz{constructor(t,e,i,n,r){this.nest=e,this.input=i,this.fragments=n,this.ranges=r,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=t}advance(){if(this.baseParse){let t=this.baseParse.advance();if(!t)return null;if(this.baseParse=null,this.baseTree=t,this.startInner(),null!=this.stoppedAt)for(let t of this.inner)t.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let t=this.baseTree;return null!=this.stoppedAt&&(t=new UI(t.type,t.children,t.positions,t.length,t.propValues.concat([[mz,this.stoppedAt]]))),t}let t=this.inner[this.innerDone],e=t.parse.advance();if(e){this.innerDone++;let i=Object.assign(Object.create(null),t.target.props);i[VI.mounted.id]=new jI(e,t.overlay,t.parser),t.target.props=i}return null}get parsedPos(){if(this.baseParse)return 0;let t=this.input.length;for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].ranges[0].from<t&&(t=Math.min(t,this.inner[e].parse.parsedPos));return t}stopAt(t){if(this.stoppedAt=t,this.baseParse)this.baseParse.stopAt(t);else for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].parse.stopAt(t)}startInner(){let t=new xz(this.fragments),e=null,i=null,n=new lz(new iz(this.baseTree,this.ranges[0].from,0,null),GI.IncludeAnonymous|GI.IgnoreMounts);t:for(let r,s;null==this.stoppedAt||n.from<this.stoppedAt;){let o,l=!0;if(t.hasNode(n)){if(e){let t=e.mounts.find((t=>t.frag.from<=n.from&&t.frag.to>=n.to&&t.mount.overlay));if(t)for(let i of t.mount.overlay){let r=i.from+t.pos,s=i.to+t.pos;r>=n.from&&s<=n.to&&!e.ranges.some((t=>t.from<s&&t.to>r))&&e.ranges.push({from:r,to:s})}}l=!1}else if(i&&(s=Oz(i.ranges,n.from,n.to)))l=2!=s;else if(!n.type.isAnonymous&&n.from<n.to&&(r=this.nest(n,this.input))){n.tree||wz(n);let s=t.findMounts(n.from,r.parser);if("function"==typeof r.overlay)e=new gz(r.parser,r.overlay,s,this.inner.length,n.from,n.tree,e);else{let t=kz(this.ranges,r.overlay||[new WI(n.from,n.to)]);t.length&&this.inner.push(new pz(r.parser,r.parser.startParse(this.input,Cz(s,t),t),r.overlay?r.overlay.map((t=>new WI(t.from-n.from,t.to-n.from))):null,n.tree,t)),r.overlay?t.length&&(i={ranges:t,depth:0,prev:i}):l=!1}}else e&&(o=e.predicate(n))&&(!0===o&&(o=new WI(n.from,n.to)),o.from<o.to&&e.ranges.push(o));if(l&&n.firstChild())e&&e.depth++,i&&i.depth++;else for(;!n.nextSibling();){if(!n.parent())break t;if(e&&!--e.depth){let t=kz(this.ranges,e.ranges);t.length&&this.inner.splice(e.index,0,new pz(e.parser,e.parser.startParse(this.input,Cz(e.mounts,t),t),e.ranges.map((t=>new WI(t.from-e.start,t.to-e.start))),e.target,t)),e=e.prev}i&&!--i.depth&&(i=i.prev)}}}}function Oz(t,e,i){for(let n of t){if(n.from>=i)break;if(n.to>e)return n.from<=e&&n.to>=i?2:1}return 0}function vz(t,e,i,n,r,s){if(e<i){let o=t.buffer[e+1],l=t.buffer[i-2];n.push(t.slice(e,i,o,l)),r.push(o-s)}}function wz(t){let{node:e}=t,i=0;do{t.parent(),i++}while(!t.tree);let n=0,r=t.tree,s=0;for(;s=r.positions[n]+t.from,!(s<=e.from&&s+r.children[n].length>=e.to);n++);let o=r.children[n],l=o.buffer;r.children[n]=function t(i,n,r,a,h){let c=i;for(;l[c+2]+s<=e.from;)c=l[c+3];let u=[],f=[];vz(o,i,c,u,f,a);let d=l[c+1],p=l[c+2],g=d+s==e.from&&p+s==e.to&&l[c]==e.type.id;return u.push(g?e.toTree():t(c+4,l[c+3],o.set.types[l[c]],d,p-d)),f.push(d-a),vz(o,l[c+3],n,u,f,a),new UI(r,u,f,h)}(0,l.length,HI.none,0,o.length);for(let n=0;n<=i;n++)t.childAfter(e.from)}class yz{constructor(t,e){this.offset=e,this.done=!1,this.cursor=t.cursor(GI.IncludeAnonymous|GI.IgnoreMounts)}moveTo(t){let{cursor:e}=this,i=t-this.offset;for(;!this.done&&e.from<i;)e.to>=t&&e.enter(i,1,GI.IgnoreOverlays|GI.ExcludeBuffers)||e.next(!1)||(this.done=!0)}hasNode(t){if(this.moveTo(t.from),!this.done&&this.cursor.from+this.offset==t.from&&this.cursor.tree)for(let e=this.cursor.tree;;){if(e==t.tree)return!0;if(!(e.children.length&&0==e.positions[0]&&e.children[0]instanceof UI))break;e=e.children[0]}return!1}}class xz{constructor(t){var e;if(this.fragments=t,this.curTo=0,this.fragI=0,t.length){let i=this.curFrag=t[0];this.curTo=null!==(e=i.tree.prop(mz))&&void 0!==e?e:i.to,this.inner=new yz(i.tree,-i.offset)}else this.curFrag=this.inner=null}hasNode(t){for(;this.curFrag&&t.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=t.from&&this.curTo>=t.to&&this.inner.hasNode(t)}nextFrag(){var t;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let e=this.curFrag=this.fragments[this.fragI];this.curTo=null!==(t=e.tree.prop(mz))&&void 0!==t?t:e.to,this.inner=new yz(e.tree,-e.offset)}}findMounts(t,e){var i;let n=[];if(this.inner){this.inner.cursor.moveTo(t,1);for(let t=this.inner.cursor.node;t;t=t.parent){let r=null===(i=t.tree)||void 0===i?void 0:i.prop(VI.mounted);if(r&&r.parser==e)for(let e=this.fragI;e<this.fragments.length;e++){let i=this.fragments[e];if(i.from>=t.to)break;i.tree==this.curFrag.tree&&n.push({frag:i,pos:t.from-i.offset,mount:r})}}}return n}}function kz(t,e){let i=null,n=e;for(let r=1,s=0;r<t.length;r++){let o=t[r-1].to,l=t[r].from;for(;s<n.length;s++){let t=n[s];if(t.from>=l)break;t.to<=o||(i||(n=i=e.slice()),t.from<o?(i[s]=new WI(t.from,o),t.to>l&&i.splice(s+1,0,new WI(l,t.to))):t.to>l?i[s--]=new WI(l,t.to):i.splice(s--,1))}}return n}function Sz(t,e,i,n){let r=0,s=0,o=!1,l=!1,a=-1e9,h=[];for(;;){let c=r==t.length?1e9:o?t[r].to:t[r].from,u=s==e.length?1e9:l?e[s].to:e[s].from;if(o!=l){let t=Math.max(a,i),e=Math.min(c,u,n);t<e&&h.push(new WI(t,e))}if(a=Math.min(c,u),1e9==a)break;c==a&&(o?(o=!1,r++):o=!0),u==a&&(l?(l=!1,s++):l=!0)}return h}function Cz(t,e){let i=[];for(let{pos:n,mount:r,frag:s}of t){let t=n+(r.overlay?r.overlay[0].from:0),o=t+r.tree.length,l=Math.max(s.from,t),a=Math.min(s.to,o);if(r.overlay){let o=Sz(e,r.overlay.map((t=>new WI(t.from+n,t.to+n))),l,a);for(let e=0,n=l;;e++){let l=e==o.length,h=l?a:o[e].from;if(h>n&&i.push(new fz(n,h,r.tree,-t,s.from>=n,s.to<=h)),l)break;n=o[e].to}}else i.push(new fz(l,a,r.tree,-t,s.from>=t,s.to<=o))}return i}let Az=0;class Tz{constructor(t,e,i){this.set=t,this.base=e,this.modified=i,this.id=Az++}static define(t){if(null==t?void 0:t.base)throw new Error("Can not derive from a modified tag");let e=new Tz([],null,[]);if(e.set.push(e),t)for(let i of t.set)e.set.push(i);return e}static defineModifier(){let t=new Mz;return e=>e.modified.indexOf(t)>-1?e:Mz.get(e.base||e,e.modified.concat(t).sort(((t,e)=>t.id-e.id)))}}let Pz=0;class Mz{constructor(){this.instances=[],this.id=Pz++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find((i=>{return i.base==t&&(n=e,r=i.modified,n.length==r.length&&n.every(((t,e)=>t==r[e])));var n,r}));if(i)return i;let n=[],r=new Tz(n,t,e);for(let t of e)t.instances.push(r);let s=Qz(e);for(let e of t.set)for(let t of s)n.push(Mz.get(e,t));return r}}function Qz(t){let e=[t];for(let i=0;i<t.length;i++)for(let n of Qz(t.slice(0,i).concat(t.slice(i+1))))e.push(n);return e}function Rz(t){let e=Object.create(null);for(let i in t){let n=t[i];Array.isArray(n)||(n=[n]);for(let t of i.split(" "))if(t){let i=[],r=2,s=t;for(let e=0;;){if("..."==s&&e>0&&e+3==t.length){r=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!n)throw new RangeError("Invalid path: "+t);if(i.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),e+=n[0].length,e==t.length)break;let o=t[e++];if(e==t.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+t);s=t.slice(e)}let o=i.length-1,l=i[o];if(!l)throw new RangeError("Invalid path: "+t);let a=new _z(n,r,o>0?i.slice(0,o):null);e[l]=a.sort(e[l])}}return $z.add(e)}const $z=new VI;class _z{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}const Dz=Tz.define,Ez=Dz(),Nz=Dz(),Bz=Dz(Nz),Iz=Dz(Nz),zz=Dz(),Lz=Dz(zz),Wz=Dz(zz),Vz=Dz(),jz=Dz(Vz),qz=Dz(),Hz=Dz(),Xz=Dz(),Fz=Dz(Xz),Zz=Dz(),Gz={comment:Ez,lineComment:Dz(Ez),blockComment:Dz(Ez),docComment:Dz(Ez),name:Nz,variableName:Dz(Nz),typeName:Bz,tagName:Dz(Bz),propertyName:Iz,attributeName:Dz(Iz),className:Dz(Nz),labelName:Dz(Nz),namespace:Dz(Nz),macroName:Dz(Nz),literal:zz,string:Lz,docString:Dz(Lz),character:Dz(Lz),attributeValue:Dz(Lz),number:Wz,integer:Dz(Wz),float:Dz(Wz),bool:Dz(zz),regexp:Dz(zz),escape:Dz(zz),color:Dz(zz),url:Dz(zz),keyword:qz,self:Dz(qz),null:Dz(qz),atom:Dz(qz),unit:Dz(qz),modifier:Dz(qz),operatorKeyword:Dz(qz),controlKeyword:Dz(qz),definitionKeyword:Dz(qz),moduleKeyword:Dz(qz),operator:Hz,derefOperator:Dz(Hz),arithmeticOperator:Dz(Hz),logicOperator:Dz(Hz),bitwiseOperator:Dz(Hz),compareOperator:Dz(Hz),updateOperator:Dz(Hz),definitionOperator:Dz(Hz),typeOperator:Dz(Hz),controlOperator:Dz(Hz),punctuation:Xz,separator:Dz(Xz),bracket:Fz,angleBracket:Dz(Fz),squareBracket:Dz(Fz),paren:Dz(Fz),brace:Dz(Fz),content:Vz,heading:jz,heading1:Dz(jz),heading2:Dz(jz),heading3:Dz(jz),heading4:Dz(jz),heading5:Dz(jz),heading6:Dz(jz),contentSeparator:Dz(Vz),list:Dz(Vz),quote:Dz(Vz),emphasis:Dz(Vz),strong:Dz(Vz),link:Dz(Vz),monospace:Dz(Vz),strikethrough:Dz(Vz),inserted:Dz(),deleted:Dz(),changed:Dz(),invalid:Dz(),meta:Zz,documentMeta:Dz(Zz),annotation:Dz(Zz),processingInstruction:Dz(Zz),definition:Tz.defineModifier(),constant:Tz.defineModifier(),function:Tz.defineModifier(),standard:Tz.defineModifier(),local:Tz.defineModifier(),special:Tz.defineModifier()};!function(t,e){let i=Object.create(null);for(let e of t)if(Array.isArray(e.tag))for(let t of e.tag)i[t.id]=e.class;else i[e.tag.id]=e.class;let{scope:n,all:r=null}=e||{}}([{tag:Gz.link,class:"tok-link"},{tag:Gz.heading,class:"tok-heading"},{tag:Gz.emphasis,class:"tok-emphasis"},{tag:Gz.strong,class:"tok-strong"},{tag:Gz.keyword,class:"tok-keyword"},{tag:Gz.atom,class:"tok-atom"},{tag:Gz.bool,class:"tok-bool"},{tag:Gz.url,class:"tok-url"},{tag:Gz.labelName,class:"tok-labelName"},{tag:Gz.inserted,class:"tok-inserted"},{tag:Gz.deleted,class:"tok-deleted"},{tag:Gz.literal,class:"tok-literal"},{tag:Gz.string,class:"tok-string"},{tag:Gz.number,class:"tok-number"},{tag:[Gz.regexp,Gz.escape,Gz.special(Gz.string)],class:"tok-string2"},{tag:Gz.variableName,class:"tok-variableName"},{tag:Gz.local(Gz.variableName),class:"tok-variableName tok-local"},{tag:Gz.definition(Gz.variableName),class:"tok-variableName tok-definition"},{tag:Gz.special(Gz.variableName),class:"tok-variableName2"},{tag:Gz.definition(Gz.propertyName),class:"tok-propertyName tok-definition"},{tag:Gz.typeName,class:"tok-typeName"},{tag:Gz.namespace,class:"tok-namespace"},{tag:Gz.className,class:"tok-className"},{tag:Gz.macroName,class:"tok-macroName"},{tag:Gz.propertyName,class:"tok-propertyName"},{tag:Gz.operator,class:"tok-operator"},{tag:Gz.comment,class:"tok-comment"},{tag:Gz.meta,class:"tok-meta"},{tag:Gz.invalid,class:"tok-invalid"},{tag:Gz.punctuation,class:"tok-punctuation"}]);class Uz{constructor(t,e,i,n,r,s,o){this.type=t,this.value=e,this.from=i,this.hash=n,this.end=r,this.children=s,this.positions=o,this.hashProp=[[VI.contextHash,n]]}static create(t,e,i,n,r){return new Uz(t,e,i,n+(n<<8)+t+(e<<4)|0,r,[],[])}addChild(t,e){t.prop(VI.contextHash)!=this.hash&&(t=new UI(t.type,t.children,t.positions,t.length,this.hashProp)),this.children.push(t),this.positions.push(e)}toTree(t,e=this.end){let i=this.children.length-1;i>=0&&(e=Math.max(e,this.positions[i]+this.children[i].length+this.from));let n=new UI(t.types[this.type],this.children,this.positions,e-this.from).balance({makeTree:(t,e,i)=>new UI(HI.none,t,e,i,this.hashProp)});return n}}var Yz;!function(t){t[t.Document=1]="Document",t[t.CodeBlock=2]="CodeBlock",t[t.FencedCode=3]="FencedCode",t[t.Blockquote=4]="Blockquote",t[t.HorizontalRule=5]="HorizontalRule",t[t.BulletList=6]="BulletList",t[t.OrderedList=7]="OrderedList",t[t.ListItem=8]="ListItem",t[t.ATXHeading1=9]="ATXHeading1",t[t.ATXHeading2=10]="ATXHeading2",t[t.ATXHeading3=11]="ATXHeading3",t[t.ATXHeading4=12]="ATXHeading4",t[t.ATXHeading5=13]="ATXHeading5",t[t.ATXHeading6=14]="ATXHeading6",t[t.SetextHeading1=15]="SetextHeading1",t[t.SetextHeading2=16]="SetextHeading2",t[t.HTMLBlock=17]="HTMLBlock",t[t.LinkReference=18]="LinkReference",t[t.Paragraph=19]="Paragraph",t[t.CommentBlock=20]="CommentBlock",t[t.ProcessingInstructionBlock=21]="ProcessingInstructionBlock",t[t.Escape=22]="Escape",t[t.Entity=23]="Entity",t[t.HardBreak=24]="HardBreak",t[t.Emphasis=25]="Emphasis",t[t.StrongEmphasis=26]="StrongEmphasis",t[t.Link=27]="Link",t[t.Image=28]="Image",t[t.InlineCode=29]="InlineCode",t[t.HTMLTag=30]="HTMLTag",t[t.Comment=31]="Comment",t[t.ProcessingInstruction=32]="ProcessingInstruction",t[t.URL=33]="URL",t[t.HeaderMark=34]="HeaderMark",t[t.QuoteMark=35]="QuoteMark",t[t.ListMark=36]="ListMark",t[t.LinkMark=37]="LinkMark",t[t.EmphasisMark=38]="EmphasisMark",t[t.CodeMark=39]="CodeMark",t[t.CodeText=40]="CodeText",t[t.CodeInfo=41]="CodeInfo",t[t.LinkTitle=42]="LinkTitle",t[t.LinkLabel=43]="LinkLabel"}(Yz||(Yz={}));class Kz{constructor(t,e){this.start=t,this.content=e,this.marks=[],this.parsers=[]}}class Jz{constructor(){this.text="",this.baseIndent=0,this.basePos=0,this.depth=0,this.markers=[],this.pos=0,this.indent=0,this.next=-1}forward(){this.basePos>this.pos&&this.forwardInner()}forwardInner(){let t=this.skipSpace(this.basePos);this.indent=this.countIndent(t,this.pos,this.indent),this.pos=t,this.next=t==this.text.length?-1:this.text.charCodeAt(t)}skipSpace(t){return nL(this.text,t)}reset(t){for(this.text=t,this.baseIndent=this.basePos=this.pos=this.indent=0,this.forwardInner(),this.depth=1;this.markers.length;)this.markers.pop()}moveBase(t){this.basePos=t,this.baseIndent=this.countIndent(t,this.pos,this.indent)}moveBaseColumn(t){this.baseIndent=t,this.basePos=this.findColumn(t)}addMarker(t){this.markers.push(t)}countIndent(t,e=0,i=0){for(let n=e;n<t;n++)i+=9==this.text.charCodeAt(n)?4-i%4:1;return i}findColumn(t){let e=0;for(let i=0;e<this.text.length&&i<t;e++)i+=9==this.text.charCodeAt(e)?4-i%4:1;return e}scrub(){if(!this.baseIndent)return this.text;let t="";for(let e=0;e<this.basePos;e++)t+=" ";return t+this.text.slice(this.basePos)}}function tL(t,e,i){if(i.pos==i.text.length||t!=e.block&&i.indent>=e.stack[i.depth+1].value+i.baseIndent)return!0;if(i.indent>=i.baseIndent+4)return!1;let n=(t.type==Yz.OrderedList?cL:hL)(i,e,!1);return n>0&&(t.type!=Yz.BulletList||lL(i,e,!1)<0)&&i.text.charCodeAt(i.pos+n-1)==t.value}const eL={[Yz.Blockquote]:(t,e,i)=>62==i.next&&(i.markers.push(IL(Yz.QuoteMark,e.lineStart+i.pos,e.lineStart+i.pos+1)),i.moveBase(i.pos+(iL(i.text.charCodeAt(i.pos+1))?2:1)),t.end=e.lineStart+i.text.length,!0),[Yz.ListItem]:(t,e,i)=>!(i.indent<i.baseIndent+t.value&&i.next>-1)&&(i.moveBaseColumn(i.baseIndent+t.value),!0),[Yz.OrderedList]:tL,[Yz.BulletList]:tL,[Yz.Document]:()=>!0};function iL(t){return 32==t||9==t||10==t||13==t}function nL(t,e=0){for(;e<t.length&&iL(t.charCodeAt(e));)e++;return e}function rL(t,e,i){for(;e>i&&iL(t.charCodeAt(e-1));)e--;return e}function sL(t){if(96!=t.next&&126!=t.next)return-1;let e=t.pos+1;for(;e<t.text.length&&t.text.charCodeAt(e)==t.next;)e++;if(e<t.pos+3)return-1;if(96==t.next)for(let i=e;i<t.text.length;i++)if(96==t.text.charCodeAt(i))return-1;return e}function oL(t){return 62!=t.next?-1:32==t.text.charCodeAt(t.pos+1)?2:1}function lL(t,e,i){if(42!=t.next&&45!=t.next&&95!=t.next)return-1;let n=1;for(let e=t.pos+1;e<t.text.length;e++){let i=t.text.charCodeAt(e);if(i==t.next)n++;else if(!iL(i))return-1}return i&&45==t.next&&fL(t)>-1&&t.depth==e.stack.length||n<3?-1:1}function aL(t,e){for(let i=t.stack.length-1;i>=0;i--)if(t.stack[i].type==e)return!0;return!1}function hL(t,e,i){return 45!=t.next&&43!=t.next&&42!=t.next||t.pos!=t.text.length-1&&!iL(t.text.charCodeAt(t.pos+1))||!(!i||aL(e,Yz.BulletList)||t.skipSpace(t.pos+2)<t.text.length)?-1:1}function cL(t,e,i){let n=t.pos,r=t.next;for(;r>=48&&r<=57;){if(n++,n==t.text.length)return-1;r=t.text.charCodeAt(n)}return n==t.pos||n>t.pos+9||46!=r&&41!=r||n<t.text.length-1&&!iL(t.text.charCodeAt(n+1))||i&&!aL(e,Yz.OrderedList)&&(t.skipSpace(n+1)==t.text.length||n>t.pos+1||49!=t.next)?-1:n+1-t.pos}function uL(t){if(35!=t.next)return-1;let e=t.pos+1;for(;e<t.text.length&&35==t.text.charCodeAt(e);)e++;if(e<t.text.length&&32!=t.text.charCodeAt(e))return-1;let i=e-t.pos;return i>6?-1:i}function fL(t){if(45!=t.next&&61!=t.next||t.indent>=t.baseIndent+4)return-1;let e=t.pos+1;for(;e<t.text.length&&t.text.charCodeAt(e)==t.next;)e++;let i=e;for(;e<t.text.length&&iL(t.text.charCodeAt(e));)e++;return e==t.text.length?i:-1}const dL=/^[ \t]*$/,pL=/-->/,gL=/\?>/,mL=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,pL],[/^\s*<\?/,gL],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,dL],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,dL]];function bL(t,e,i){if(60!=t.next)return-1;let n=t.text.slice(t.pos);for(let t=0,e=mL.length-(i?1:0);t<e;t++)if(mL[t][0].test(n))return t;return-1}function OL(t,e){let i=t.countIndent(e,t.pos,t.indent),n=t.countIndent(t.skipSpace(e),e,i);return n>=i+5?i+1:n}function vL(t,e,i){let n=t.length-1;n>=0&&t[n].to==e&&t[n].type==Yz.CodeText?t[n].to=i:t.push(IL(Yz.CodeText,e,i))}const wL={LinkReference:void 0,IndentedCode(t,e){let i=e.baseIndent+4;if(e.indent<i)return!1;let n=e.findColumn(i),r=t.lineStart+n,s=t.lineStart+e.text.length,o=[],l=[];for(vL(o,r,s);t.nextLine()&&e.depth>=t.stack.length;)if(e.pos==e.text.length){vL(l,t.lineStart-1,t.lineStart);for(let t of e.markers)l.push(t)}else{if(e.indent<i)break;{if(l.length){for(let t of l)t.type==Yz.CodeText?vL(o,t.from,t.to):o.push(t);l=[]}vL(o,t.lineStart-1,t.lineStart);for(let t of e.markers)o.push(t);s=t.lineStart+e.text.length;let i=t.lineStart+e.findColumn(e.baseIndent+4);i<s&&vL(o,i,s)}}return l.length&&(l=l.filter((t=>t.type!=Yz.CodeText)),l.length&&(e.markers=l.concat(e.markers))),t.addNode(t.buffer.writeElements(o,-r).finish(Yz.CodeBlock,s-r),r),!0},FencedCode(t,e){let i=sL(e);if(i<0)return!1;let n=t.lineStart+e.pos,r=e.next,s=i-e.pos,o=e.skipSpace(i),l=rL(e.text,e.text.length,o),a=[IL(Yz.CodeMark,n,n+s)];o<l&&a.push(IL(Yz.CodeInfo,t.lineStart+o,t.lineStart+l));for(let i=!0;t.nextLine()&&e.depth>=t.stack.length;i=!1){let n=e.pos;if(e.indent-e.baseIndent<4)for(;n<e.text.length&&e.text.charCodeAt(n)==r;)n++;if(n-e.pos>=s&&e.skipSpace(n)==e.text.length){for(let t of e.markers)a.push(t);a.push(IL(Yz.CodeMark,t.lineStart+e.pos,t.lineStart+n)),t.nextLine();break}{i||vL(a,t.lineStart-1,t.lineStart);for(let t of e.markers)a.push(t);let n=t.lineStart+e.basePos,r=t.lineStart+e.text.length;n<r&&vL(a,n,r)}}return t.addNode(t.buffer.writeElements(a,-n).finish(Yz.FencedCode,t.prevLineEnd()-n),n),!0},Blockquote(t,e){let i=oL(e);return!(i<0)&&(t.startContext(Yz.Blockquote,e.pos),t.addNode(Yz.QuoteMark,t.lineStart+e.pos,t.lineStart+e.pos+1),e.moveBase(e.pos+i),null)},HorizontalRule(t,e){if(lL(e,t,!1)<0)return!1;let i=t.lineStart+e.pos;return t.nextLine(),t.addNode(Yz.HorizontalRule,i),!0},BulletList(t,e){let i=hL(e,t,!1);if(i<0)return!1;t.block.type!=Yz.BulletList&&t.startContext(Yz.BulletList,e.basePos,e.next);let n=OL(e,e.pos+1);return t.startContext(Yz.ListItem,e.basePos,n-e.baseIndent),t.addNode(Yz.ListMark,t.lineStart+e.pos,t.lineStart+e.pos+i),e.moveBaseColumn(n),null},OrderedList(t,e){let i=cL(e,t,!1);if(i<0)return!1;t.block.type!=Yz.OrderedList&&t.startContext(Yz.OrderedList,e.basePos,e.text.charCodeAt(e.pos+i-1));let n=OL(e,e.pos+i);return t.startContext(Yz.ListItem,e.basePos,n-e.baseIndent),t.addNode(Yz.ListMark,t.lineStart+e.pos,t.lineStart+e.pos+i),e.moveBaseColumn(n),null},ATXHeading(t,e){let i=uL(e);if(i<0)return!1;let n=e.pos,r=t.lineStart+n,s=rL(e.text,e.text.length,n),o=s;for(;o>n&&e.text.charCodeAt(o-1)==e.next;)o--;o!=s&&o!=n&&iL(e.text.charCodeAt(o-1))||(o=e.text.length);let l=t.buffer.write(Yz.HeaderMark,0,i).writeElements(t.parser.parseInline(e.text.slice(n+i+1,o),r+i+1),-r);o<e.text.length&&l.write(Yz.HeaderMark,o-n,s-n);let a=l.finish(Yz.ATXHeading1-1+i,e.text.length-n);return t.nextLine(),t.addNode(a,r),!0},HTMLBlock(t,e){let i=bL(e,0,!1);if(i<0)return!1;let n=t.lineStart+e.pos,r=mL[i][1],s=[],o=r!=dL;for(;!r.test(e.text)&&t.nextLine();){if(e.depth<t.stack.length){o=!1;break}for(let t of e.markers)s.push(t)}o&&t.nextLine();let l=r==pL?Yz.CommentBlock:r==gL?Yz.ProcessingInstructionBlock:Yz.HTMLBlock,a=t.prevLineEnd();return t.addNode(t.buffer.writeElements(s,-n).finish(l,a-n),n),!0},SetextHeading:void 0};class yL{constructor(t){this.stage=0,this.elts=[],this.pos=0,this.start=t.start,this.advance(t.content)}nextLine(t,e,i){if(-1==this.stage)return!1;let n=i.content+"\n"+e.scrub(),r=this.advance(n);return r>-1&&r<n.length&&this.complete(t,i,r)}finish(t,e){return(2==this.stage||3==this.stage)&&nL(e.content,this.pos)==e.content.length&&this.complete(t,e,e.content.length)}complete(t,e,i){return t.addLeafElement(e,IL(Yz.LinkReference,this.start,this.start+i,this.elts)),!0}nextStage(t){return t?(this.pos=t.to-this.start,this.elts.push(t),this.stage++,!0):(!1===t&&(this.stage=-1),!1)}advance(t){for(;;){if(-1==this.stage)return-1;if(0==this.stage){if(!this.nextStage(UL(t,this.pos,this.start,!0)))return-1;if(58!=t.charCodeAt(this.pos))return this.stage=-1;this.elts.push(IL(Yz.LinkMark,this.pos+this.start,this.pos+this.start+1)),this.pos++}else{if(1!=this.stage){if(2==this.stage){let e=nL(t,this.pos),i=0;if(e>this.pos){let n=GL(t,e,this.start);if(n){let e=xL(t,n.to-this.start);e>0&&(this.nextStage(n),i=e)}}return i||(i=xL(t,this.pos)),i>0&&i<t.length?i:-1}return xL(t,this.pos)}if(!this.nextStage(ZL(t,nL(t,this.pos),this.start)))return-1}}}}function xL(t,e){for(;e<t.length;e++){let i=t.charCodeAt(e);if(10==i)break;if(!iL(i))return-1}return e}class kL{nextLine(t,e,i){let n=e.depth<t.stack.length?-1:fL(e),r=e.next;if(n<0)return!1;let s=IL(Yz.HeaderMark,t.lineStart+e.pos,t.lineStart+n);return t.nextLine(),t.addLeafElement(i,IL(61==r?Yz.SetextHeading1:Yz.SetextHeading2,i.start,t.prevLineEnd(),[...t.parser.parseInline(i.content,i.start),s])),!0}finish(){return!1}}const SL={LinkReference:(t,e)=>91==e.content.charCodeAt(0)?new yL(e):null,SetextHeading:()=>new kL},CL=[(t,e)=>uL(e)>=0,(t,e)=>sL(e)>=0,(t,e)=>oL(e)>=0,(t,e)=>hL(e,t,!0)>=0,(t,e)=>cL(e,t,!0)>=0,(t,e)=>lL(e,t,!0)>=0,(t,e)=>bL(e,0,!0)>=0],AL={text:"",end:0};class TL{constructor(t,e,i,n){this.parser=t,this.input=e,this.ranges=n,this.line=new Jz,this.atEnd=!1,this.dontInject=new Set,this.stoppedAt=null,this.rangeI=0,this.to=n[n.length-1].to,this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=n[0].from,this.block=Uz.create(Yz.Document,0,this.lineStart,0,0),this.stack=[this.block],this.fragments=i.length?new tW(i,e):null,this.readLine()}get parsedPos(){return this.absoluteLineStart}advance(){if(null!=this.stoppedAt&&this.absoluteLineStart>this.stoppedAt)return this.finish();let{line:t}=this;for(;;){for(;t.depth<this.stack.length;)this.finishContext();for(let e of t.markers)this.addNode(e.type,e.from,e.to);if(t.pos<t.text.length)break;if(!this.nextLine())return this.finish()}if(this.fragments&&this.reuseFragment(t.basePos))return null;t:for(;;){for(let e of this.parser.blockParsers)if(e){let i=e(this,t);if(0!=i){if(1==i)return null;t.forward();continue t}}break}let e=new Kz(this.lineStart+t.pos,t.text.slice(t.pos));for(let t of this.parser.leafBlockParsers)if(t){let i=t(this,e);i&&e.parsers.push(i)}t:for(;this.nextLine()&&t.pos!=t.text.length;){if(t.indent<t.baseIndent+4)for(let i of this.parser.endLeafBlock)if(i(this,t,e))break t;for(let i of e.parsers)if(i.nextLine(this,t,e))return null;e.content+="\n"+t.scrub();for(let i of t.markers)e.marks.push(i)}return this.finishLeaf(e),null}stopAt(t){if(null!=this.stoppedAt&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}reuseFragment(t){if(!this.fragments.moveTo(this.absoluteLineStart+t,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return!1;let e=this.fragments.takeNodes(this);if(!e)return!1;let i=e,n=this.absoluteLineStart+e;for(let t=1;t<this.ranges.length;t++){let e=this.ranges[t-1].to,r=this.ranges[t].from;e>=this.lineStart&&r<n&&(i-=r-e)}return this.lineStart+=i,this.absoluteLineStart+=e,this.moveRangeI(),this.absoluteLineStart<this.to?(this.lineStart++,this.absoluteLineStart++,this.readLine()):(this.atEnd=!0,this.readLine()),!0}get depth(){return this.stack.length}parentType(t=this.depth-1){return this.parser.nodeSet.types[this.stack[t].type]}nextLine(){return this.lineStart+=this.line.text.length,this.absoluteLineEnd>=this.to?(this.absoluteLineStart=this.absoluteLineEnd,this.atEnd=!0,this.readLine(),!1):(this.lineStart++,this.absoluteLineStart=this.absoluteLineEnd+1,this.moveRangeI(),this.readLine(),!0)}moveRangeI(){for(;this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to;)this.rangeI++,this.absoluteLineStart=Math.max(this.absoluteLineStart,this.ranges[this.rangeI].from)}scanLine(t){let e=AL;if(e.end=t,t>=this.to)e.text="";else if(e.text=this.lineChunkAt(t),e.end+=e.text.length,this.ranges.length>1){let t=this.absoluteLineStart,i=this.rangeI;for(;this.ranges[i].to<e.end;){i++;let n=this.ranges[i].from,r=this.lineChunkAt(n);e.end=n+r.length,e.text=e.text.slice(0,this.ranges[i-1].to-t)+r,t=e.end-e.text.length}}return e}readLine(){let{line:t}=this,{text:e,end:i}=this.scanLine(this.absoluteLineStart);for(this.absoluteLineEnd=i,t.reset(e);t.depth<this.stack.length;t.depth++){let e=this.stack[t.depth],i=this.parser.skipContextMarkup[e.type];if(!i)throw new Error("Unhandled block context "+Yz[e.type]);if(!i(e,this,t))break;t.forward()}}lineChunkAt(t){let e,i=this.input.chunk(t);if(this.input.lineChunks)e="\n"==i?"":i;else{let t=i.indexOf("\n");e=t<0?i:i.slice(0,t)}return t+e.length>this.to?e.slice(0,this.to-t):e}prevLineEnd(){return this.atEnd?this.lineStart:this.lineStart-1}startContext(t,e,i=0){this.block=Uz.create(t,i,this.lineStart+e,this.block.hash,this.lineStart+this.line.text.length),this.stack.push(this.block)}startComposite(t,e,i=0){this.startContext(this.parser.getNodeType(t),e,i)}addNode(t,e,i){"number"==typeof t&&(t=new UI(this.parser.nodeSet.types[t],DL,DL,(null!=i?i:this.prevLineEnd())-e)),this.block.addChild(t,e-this.block.from)}addElement(t){this.block.addChild(t.toTree(this.parser.nodeSet),t.from-this.block.from)}addLeafElement(t,e){this.addNode(this.buffer.writeElements(KL(e.children,t.marks),-e.from).finish(e.type,e.to-e.from),e.from)}finishContext(){let t=this.stack.pop(),e=this.stack[this.stack.length-1];e.addChild(t.toTree(this.parser.nodeSet),t.from-e.from),this.block=e}finish(){for(;this.stack.length>1;)this.finishContext();return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart))}addGaps(t){return this.ranges.length>1?PL(this.ranges,0,t.topNode,this.ranges[0].from,this.dontInject):t}finishLeaf(t){for(let e of t.parsers)if(e.finish(this,t))return;let e=KL(this.parser.parseInline(t.content,t.start),t.marks);this.addNode(this.buffer.writeElements(e,-t.start).finish(Yz.Paragraph,t.content.length),t.start)}elt(t,e,i,n){return"string"==typeof t?IL(this.parser.getNodeType(t),e,i,n):new BL(t,e)}get buffer(){return new EL(this.parser.nodeSet)}}function PL(t,e,i,n,r){if(r.has(i.tree))return i.tree;let s=t[e].to,o=[],l=[],a=i.from+n;function h(i,r){for(;r?i>=s:i>s;){let r=t[e+1].from-s;n+=r,i+=r,e++,s=t[e].to}}for(let c=i.firstChild;c;c=c.nextSibling){h(c.from+n,!0);let i,u=c.from+n;c.to+n>s?(i=PL(t,e,c,n,r),h(c.to+n,!1)):i=c.toTree(),o.push(i),l.push(u-a)}return h(i.to+n,!1),new UI(i.type,o,l,i.to+n-a,i.tree?i.tree.propValues:void 0)}class ML extends class{startParse(t,e,i){return"string"==typeof t&&(t=new dz(t)),i=i?i.length?i.map((t=>new WI(t.from,t.to))):[new WI(0,0)]:[new WI(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let t=n.advance();if(t)return t}}}{constructor(t,e,i,n,r,s,o,l,a){super(),this.nodeSet=t,this.blockParsers=e,this.leafBlockParsers=i,this.blockNames=n,this.endLeafBlock=r,this.skipContextMarkup=s,this.inlineParsers=o,this.inlineNames=l,this.wrappers=a,this.nodeTypes=Object.create(null);for(let e of t.types)this.nodeTypes[e.name]=e.id}createParse(t,e,i){let n=new TL(this,t,e,i);for(let r of this.wrappers)n=r(n,t,e,i);return n}configure(t){let e=RL(t);if(!e)return this;let{nodeSet:i,skipContextMarkup:n}=this,r=this.blockParsers.slice(),s=this.leafBlockParsers.slice(),o=this.blockNames.slice(),l=this.inlineParsers.slice(),a=this.inlineNames.slice(),h=this.endLeafBlock.slice(),c=this.wrappers;if(QL(e.defineNodes)){n=Object.assign({},n);let t,r=i.types.slice();for(let i of e.defineNodes){let{name:e,block:s,composite:o,style:l}="string"==typeof i?{name:i}:i;if(r.some((t=>t.name==e)))continue;o&&(n[r.length]=(t,e,i)=>o(e,i,t.value));let a=r.length,h=o?["Block","BlockContext"]:s?a>=Yz.ATXHeading1&&a<=Yz.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"]:void 0;r.push(HI.define({id:a,name:e,props:h&&[[VI.group,h]]})),l&&(t||(t={}),Array.isArray(l)||l instanceof Tz?t[e]=l:Object.assign(t,l))}i=new XI(r),t&&(i=i.extend(Rz(t)))}if(QL(e.props)&&(i=i.extend(...e.props)),QL(e.remove))for(let t of e.remove){let e=this.blockNames.indexOf(t),i=this.inlineNames.indexOf(t);e>-1&&(r[e]=s[e]=void 0),i>-1&&(l[i]=void 0)}if(QL(e.parseBlock))for(let t of e.parseBlock){let e=o.indexOf(t.name);if(e>-1)r[e]=t.parse,s[e]=t.leaf;else{let e=t.before?$L(o,t.before):t.after?$L(o,t.after)+1:o.length-1;r.splice(e,0,t.parse),s.splice(e,0,t.leaf),o.splice(e,0,t.name)}t.endLeaf&&h.push(t.endLeaf)}if(QL(e.parseInline))for(let t of e.parseInline){let e=a.indexOf(t.name);if(e>-1)l[e]=t.parse;else{let e=t.before?$L(a,t.before):t.after?$L(a,t.after)+1:a.length-1;l.splice(e,0,t.parse),a.splice(e,0,t.name)}}return e.wrap&&(c=c.concat(e.wrap)),new ML(i,r,s,o,h,n,l,a,c)}getNodeType(t){let e=this.nodeTypes[t];if(null==e)throw new RangeError(`Unknown node type '${t}'`);return e}parseInline(t,e){let i=new YL(this,t,e);t:for(let t=e;t<i.end;){let e=i.char(t);for(let n of this.inlineParsers)if(n){let r=n(i,e,t);if(r>=0){t=r;continue t}}t++}return i.resolveMarkers(0)}}function QL(t){return null!=t&&t.length>0}function RL(t){if(!Array.isArray(t))return t;if(0==t.length)return null;let e=RL(t[0]);if(1==t.length)return e;let i=RL(t.slice(1));if(!i||!e)return e||i;let n=(t,e)=>(t||DL).concat(e||DL),r=e.wrap,s=i.wrap;return{props:n(e.props,i.props),defineNodes:n(e.defineNodes,i.defineNodes),parseBlock:n(e.parseBlock,i.parseBlock),parseInline:n(e.parseInline,i.parseInline),remove:n(e.remove,i.remove),wrap:r?s?(t,e,i,n)=>r(s(t,e,i,n),e,i,n):r:s}}function $L(t,e){let i=t.indexOf(e);if(i<0)throw new RangeError(`Position specified relative to unknown parser ${e}`);return i}let _L=[HI.none];for(let t,e=1;t=Yz[e];e++)_L[e]=HI.define({id:e,name:t,props:e>=Yz.Escape?[]:[[VI.group,e in eL?["Block","BlockContext"]:["Block","LeafBlock"]]]});const DL=[];class EL{constructor(t){this.nodeSet=t,this.content=[],this.nodes=[]}write(t,e,i,n=0){return this.content.push(t,e,i,4+4*n),this}writeElements(t,e=0){for(let i of t)i.writeTo(this,e);return this}finish(t,e){return UI.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:t,length:e})}}class NL{constructor(t,e,i,n=DL){this.type=t,this.from=e,this.to=i,this.children=n}writeTo(t,e){let i=t.content.length;t.writeElements(this.children,e),t.content.push(this.type,this.from+e,this.to+e,t.content.length+4-i)}toTree(t){return new EL(t).writeElements(this.children,-this.from).finish(this.type,this.to-this.from)}}class BL{constructor(t,e){this.tree=t,this.from=e}get to(){return this.from+this.tree.length}get type(){return this.tree.type.id}get children(){return DL}writeTo(t,e){t.nodes.push(this.tree),t.content.push(t.nodes.length-1,this.from+e,this.to+e,-1)}toTree(){return this.tree}}function IL(t,e,i,n){return new NL(t,e,i,n)}const zL={resolve:"Emphasis",mark:"EmphasisMark"},LL={resolve:"Emphasis",mark:"EmphasisMark"},WL={},VL={};class jL{constructor(t,e,i,n){this.type=t,this.from=e,this.to=i,this.side=n}}const qL="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~";let HL=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{HL=new RegExp("[\\p{Pc}|\\p{Pd}|\\p{Pe}|\\p{Pf}|\\p{Pi}|\\p{Po}|\\p{Ps}]","u")}catch(t){}const XL={Escape(t,e,i){if(92!=e||i==t.end-1)return-1;let n=t.char(i+1);for(let e=0;e<qL.length;e++)if(qL.charCodeAt(e)==n)return t.append(IL(Yz.Escape,i,i+2));return-1},Entity(t,e,i){if(38!=e)return-1;let n=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(t.slice(i+1,i+31));return n?t.append(IL(Yz.Entity,i,i+1+n[0].length)):-1},InlineCode(t,e,i){if(96!=e||i&&96==t.char(i-1))return-1;let n=i+1;for(;n<t.end&&96==t.char(n);)n++;let r=n-i,s=0;for(;n<t.end;n++)if(96==t.char(n)){if(s++,s==r&&96!=t.char(n+1))return t.append(IL(Yz.InlineCode,i,n+1,[IL(Yz.CodeMark,i,i+r),IL(Yz.CodeMark,n+1-r,n+1)]))}else s=0;return-1},HTMLTag(t,e,i){if(60!=e||i==t.end-1)return-1;let n=t.slice(i+1,t.end),r=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(n);if(r)return t.append(IL(Yz.URL,i,i+1+r[0].length));let s=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(n);if(s)return t.append(IL(Yz.Comment,i,i+1+s[0].length));let o=/^\?[^]*?\?>/.exec(n);if(o)return t.append(IL(Yz.ProcessingInstruction,i,i+1+o[0].length));let l=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(n);return l?t.append(IL(Yz.HTMLTag,i,i+1+l[0].length)):-1},Emphasis(t,e,i){if(95!=e&&42!=e)return-1;let n=i+1;for(;t.char(n)==e;)n++;let r=t.slice(i-1,i),s=t.slice(n,n+1),o=HL.test(r),l=HL.test(s),a=/\s|^$/.test(r),h=/\s|^$/.test(s),c=!h&&(!l||a||o),u=!a&&(!o||h||l),f=c&&(42==e||!u||o),d=u&&(42==e||!c||l);return t.append(new jL(95==e?zL:LL,i,n,(f?1:0)|(d?2:0)))},HardBreak(t,e,i){if(92==e&&10==t.char(i+1))return t.append(IL(Yz.HardBreak,i,i+2));if(32==e){let e=i+1;for(;32==t.char(e);)e++;if(10==t.char(e)&&e>=i+2)return t.append(IL(Yz.HardBreak,i,e+1))}return-1},Link:(t,e,i)=>91==e?t.append(new jL(WL,i,i+1,1)):-1,Image:(t,e,i)=>33==e&&91==t.char(i+1)?t.append(new jL(VL,i,i+2,1)):-1,LinkEnd(t,e,i){if(93!=e)return-1;for(let e=t.parts.length-1;e>=0;e--){let n=t.parts[e];if(n instanceof jL&&(n.type==WL||n.type==VL)){if(!n.side||t.skipSpace(n.to)==i&&!/[(\[]/.test(t.slice(i+1,i+2)))return t.parts[e]=null,-1;let r=t.takeContent(e),s=t.parts[e]=FL(t,r,n.type==WL?Yz.Link:Yz.Image,n.from,i+1);if(n.type==WL)for(let i=0;i<e;i++){let e=t.parts[i];e instanceof jL&&e.type==WL&&(e.side=0)}return s.to}}return-1}};function FL(t,e,i,n,r){let{text:s}=t,o=t.char(r),l=r;if(e.unshift(IL(Yz.LinkMark,n,n+(i==Yz.Image?2:1))),e.push(IL(Yz.LinkMark,r-1,r)),40==o){let i,n=t.skipSpace(r+1),o=ZL(s,n-t.offset,t.offset);o&&(n=t.skipSpace(o.to),i=GL(s,n-t.offset,t.offset),i&&(n=t.skipSpace(i.to))),41==t.char(n)&&(e.push(IL(Yz.LinkMark,r,r+1)),l=n+1,o&&e.push(o),i&&e.push(i),e.push(IL(Yz.LinkMark,n,l)))}else if(91==o){let i=UL(s,r-t.offset,t.offset,!1);i&&(e.push(i),l=i.to)}return IL(i,n,l,e)}function ZL(t,e,i){if(60==t.charCodeAt(e)){for(let n=e+1;n<t.length;n++){let r=t.charCodeAt(n);if(62==r)return IL(Yz.URL,e+i,n+1+i);if(60==r||10==r)return!1}return null}{let n=0,r=e;for(let e=!1;r<t.length;r++){let i=t.charCodeAt(r);if(iL(i))break;if(e)e=!1;else if(40==i)n++;else if(41==i){if(!n)break;n--}else 92==i&&(e=!0)}return r>e?IL(Yz.URL,e+i,r+i):r==t.length&&null}}function GL(t,e,i){let n=t.charCodeAt(e);if(39!=n&&34!=n&&40!=n)return!1;let r=40==n?41:n;for(let n=e+1,s=!1;n<t.length;n++){let o=t.charCodeAt(n);if(s)s=!1;else{if(o==r)return IL(Yz.LinkTitle,e+i,n+1+i);92==o&&(s=!0)}}return null}function UL(t,e,i,n){for(let r=!1,s=e+1,o=Math.min(t.length,s+999);s<o;s++){let o=t.charCodeAt(s);if(r)r=!1;else{if(93==o)return!n&&IL(Yz.LinkLabel,e+i,s+1+i);if(n&&!iL(o)&&(n=!1),91==o)return!1;92==o&&(r=!0)}}return null}class YL{constructor(t,e,i){this.parser=t,this.text=e,this.offset=i,this.parts=[]}char(t){return t>=this.end?-1:this.text.charCodeAt(t-this.offset)}get end(){return this.offset+this.text.length}slice(t,e){return this.text.slice(t-this.offset,e-this.offset)}append(t){return this.parts.push(t),t.to}addDelimiter(t,e,i,n,r){return this.append(new jL(t,e,i,(n?1:0)|(r?2:0)))}addElement(t){return this.append(t)}resolveMarkers(t){for(let e=t;e<this.parts.length;e++){let i=this.parts[e];if(!(i instanceof jL&&i.type.resolve&&2&i.side))continue;let n,r=i.type==zL||i.type==LL,s=i.to-i.from,o=e-1;for(;o>=t;o--){let t=this.parts[o];if(t instanceof jL&&1&t.side&&t.type==i.type&&!(r&&(1&i.side||2&t.side)&&(t.to-t.from+s)%3==0&&((t.to-t.from)%3||s%3))){n=t;break}}if(!n)continue;let l=i.type.resolve,a=[],h=n.from,c=i.to;if(r){let t=Math.min(2,n.to-n.from,s);h=n.to-t,c=i.from+t,l=1==t?"Emphasis":"StrongEmphasis"}n.type.mark&&a.push(this.elt(n.type.mark,h,n.to));for(let t=o+1;t<e;t++)this.parts[t]instanceof NL&&a.push(this.parts[t]),this.parts[t]=null;i.type.mark&&a.push(this.elt(i.type.mark,i.from,c));let u=this.elt(l,h,c,a);this.parts[o]=r&&n.from!=h?new jL(n.type,n.from,h,n.side):null,(this.parts[e]=r&&i.to!=c?new jL(i.type,c,i.to,i.side):null)?this.parts.splice(e,0,u):this.parts[e]=u}let e=[];for(let i=t;i<this.parts.length;i++){let t=this.parts[i];t instanceof NL&&e.push(t)}return e}findOpeningDelimiter(t){for(let e=this.parts.length-1;e>=0;e--){let i=this.parts[e];if(i instanceof jL&&i.type==t)return e}return null}takeContent(t){let e=this.resolveMarkers(t);return this.parts.length=t,e}skipSpace(t){return nL(this.text,t-this.offset)+this.offset}elt(t,e,i,n){return"string"==typeof t?IL(this.parser.getNodeType(t),e,i,n):new BL(t,e)}}function KL(t,e){if(!e.length)return t;if(!t.length)return e;let i=t.slice(),n=0;for(let t of e){for(;n<i.length&&i[n].to<t.to;)n++;if(n<i.length&&i[n].from<t.from){let e=i[n];e instanceof NL&&(i[n]=new NL(e.type,e.from,e.to,KL(e.children,[t])))}else i.splice(n++,0,t)}return i}const JL=[Yz.CodeBlock,Yz.ListItem,Yz.OrderedList,Yz.BulletList];class tW{constructor(t,e){this.fragments=t,this.input=e,this.i=0,this.fragment=null,this.fragmentEnd=-1,this.cursor=null,t.length&&(this.fragment=t[this.i++])}nextFragment(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null,this.cursor=null,this.fragmentEnd=-1}moveTo(t,e){for(;this.fragment&&this.fragment.to<=t;)this.nextFragment();if(!this.fragment||this.fragment.from>(t?t-1:0))return!1;if(this.fragmentEnd<0){let t=this.fragment.to;for(;t>0&&"\n"!=this.input.read(t-1,t);)t--;this.fragmentEnd=t?t-1:0}let i=this.cursor;i||(i=this.cursor=this.fragment.tree.cursor(),i.firstChild());let n=t+this.fragment.offset;for(;i.to<=n;)if(!i.parent())return!1;for(;;){if(i.from>=n)return this.fragment.from<=e;if(!i.childAfter(n))return!1}}matches(t){let e=this.cursor.tree;return e&&e.prop(VI.contextHash)==t}takeNodes(t){let e=this.cursor,i=this.fragment.offset,n=this.fragmentEnd-(this.fragment.openEnd?1:0),r=t.absoluteLineStart,s=r,o=t.block.children.length,l=s,a=o;for(;;){if(e.to-i>n){if(e.type.isAnonymous&&e.firstChild())continue;break}if(t.dontInject.add(e.tree),t.addNode(e.tree,e.from-i),e.type.is("Block")&&(JL.indexOf(e.type.id)<0?(s=e.to-i,o=t.block.children.length):(s=l,o=a,l=e.to-i,a=t.block.children.length)),!e.nextSibling())break}for(;t.block.children.length>o;)t.block.children.pop(),t.block.positions.pop();return s-r}}const eW=Rz({"Blockquote/...":Gz.quote,HorizontalRule:Gz.contentSeparator,"ATXHeading1/... SetextHeading1/...":Gz.heading1,"ATXHeading2/... SetextHeading2/...":Gz.heading2,"ATXHeading3/...":Gz.heading3,"ATXHeading4/...":Gz.heading4,"ATXHeading5/...":Gz.heading5,"ATXHeading6/...":Gz.heading6,"Comment CommentBlock":Gz.comment,Escape:Gz.escape,Entity:Gz.character,"Emphasis/...":Gz.emphasis,"StrongEmphasis/...":Gz.strong,"Link/... Image/...":Gz.link,"OrderedList/... BulletList/...":Gz.list,"BlockQuote/...":Gz.quote,"InlineCode CodeText":Gz.monospace,URL:Gz.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":Gz.processingInstruction,"CodeInfo LinkLabel":Gz.labelName,LinkTitle:Gz.string,Paragraph:Gz.content}),iW=new ML(new XI(_L).extend(eW),Object.keys(wL).map((t=>wL[t])),Object.keys(wL).map((t=>SL[t])),Object.keys(wL),CL,eL,Object.keys(XL).map((t=>XL[t])),Object.keys(XL),[]);function nW(t,e,i){let n=[];for(let r=t.firstChild,s=e;;r=r.nextSibling){let t=r?r.from:i;if(t>s&&n.push({from:s,to:t}),!r)break;s=r.to}return n}function rW(t){let{codeParser:e,htmlParser:i}=t,n=(r=(t,n)=>{let r=t.type.id;if(!e||r!=Yz.CodeBlock&&r!=Yz.FencedCode){if(i&&(r==Yz.HTMLBlock||r==Yz.HTMLTag))return{parser:i,overlay:nW(t.node,t.from,t.to)}}else{let i="";if(r==Yz.FencedCode){let e=t.node.getChild(Yz.CodeInfo);e&&(i=n.read(e.from,e.to))}let s=e(i);if(s)return{parser:s,overlay:t=>t.type.id==Yz.CodeText}}return null},(t,e,i,n)=>new bz(t,r,e,i,n));var r;return{wrap:n}}const sW={resolve:"Strikethrough",mark:"StrikethroughMark"},oW={defineNodes:[{name:"Strikethrough",style:{"Strikethrough/...":Gz.strikethrough}},{name:"StrikethroughMark",style:Gz.processingInstruction}],parseInline:[{name:"Strikethrough",parse:(t,e,i)=>126!=e||126!=t.char(i+1)?-1:t.addDelimiter(sW,i,i+2,!0,!0),after:"Emphasis"}]};function lW(t,e,i=0,n,r=0){let s=0,o=!0,l=-1,a=-1,h=!1,c=()=>{n.push(t.elt("TableCell",r+l,r+a,t.parser.parseInline(e.slice(l,a),r+l)))};for(let u=i;u<e.length;u++){let i=e.charCodeAt(u);124!=i||h?(h||32!=i&&9!=i)&&(l<0&&(l=u),a=u+1):((!o||l>-1)&&s++,o=!1,n&&(l>-1&&c(),n.push(t.elt("TableDelimiter",u+r,u+r+1))),l=a=-1),h=!h&&92==i}return l>-1&&(s++,n&&c()),s}function aW(t,e){for(let i=e;i<t.length;i++){let e=t.charCodeAt(i);if(124==e)return!0;92==e&&i++}return!1}const hW=/^\|?(\s*:?-+:?\s*\|)+(\s*:?-+:?\s*)?$/;class cW{constructor(){this.rows=null}nextLine(t,e,i){if(null==this.rows){let n;if(this.rows=!1,(45==e.next||58==e.next||124==e.next)&&hW.test(n=e.text.slice(e.pos))){let r=[];lW(t,i.content,0,r,i.start)==lW(t,n,e.pos)&&(this.rows=[t.elt("TableHeader",i.start,i.start+i.content.length,r),t.elt("TableDelimiter",t.lineStart+e.pos,t.lineStart+e.text.length)])}}else if(this.rows){let i=[];lW(t,e.text,e.pos,i,t.lineStart),this.rows.push(t.elt("TableRow",t.lineStart+e.pos,t.lineStart+e.text.length,i))}return!1}finish(t,e){return!!this.rows&&(t.addLeafElement(e,t.elt("Table",e.start,e.start+e.content.length,this.rows)),!0)}}const uW={defineNodes:[{name:"Table",block:!0},{name:"TableHeader",style:{"TableHeader/...":Gz.heading}},"TableRow",{name:"TableCell",style:Gz.content},{name:"TableDelimiter",style:Gz.processingInstruction}],parseBlock:[{name:"Table",leaf:(t,e)=>aW(e.content,0)?new cW:null,endLeaf(t,e,i){if(i.parsers.some((t=>t instanceof cW))||!aW(e.text,e.basePos))return!1;let n=t.scanLine(t.absoluteLineEnd+1).text;return hW.test(n)&&lW(t,e.text,e.basePos)==lW(t,n,e.basePos)},before:"SetextHeading"}]};class fW{nextLine(){return!1}finish(t,e){return t.addLeafElement(e,t.elt("Task",e.start,e.start+e.content.length,[t.elt("TaskMarker",e.start,e.start+3),...t.parser.parseInline(e.content.slice(3),e.start+3)])),!0}}const dW=[uW,{defineNodes:[{name:"Task",block:!0,style:Gz.list},{name:"TaskMarker",style:Gz.atom}],parseBlock:[{name:"TaskList",leaf:(t,e)=>/^\[[ xX]\]/.test(e.content)&&"ListItem"==t.parentType().name?new fW:null,after:"SetextHeading"}]},oW];function pW(t,e,i){return(n,r,s)=>{if(r!=t||n.char(s+1)==t)return-1;let o=[n.elt(i,s,s+1)];for(let r=s+1;r<n.end;r++){let l=n.char(r);if(l==t)return n.addElement(n.elt(e,s,r+1,o.concat(n.elt(i,r,r+1))));if(92==l&&o.push(n.elt("Escape",r,2+r++)),iL(l))break}return-1}}const gW={defineNodes:[{name:"Superscript",style:Gz.special(Gz.content)},{name:"SuperscriptMark",style:Gz.processingInstruction}],parseInline:[{name:"Superscript",parse:pW(94,"Superscript","SuperscriptMark")}]},mW={defineNodes:[{name:"Subscript",style:Gz.special(Gz.content)},{name:"SubscriptMark",style:Gz.processingInstruction}],parseInline:[{name:"Subscript",parse:pW(126,"Subscript","SubscriptMark")}]},bW={defineNodes:[{name:"Emoji",style:Gz.character}],parseInline:[{name:"Emoji",parse(t,e,i){let n;return 58==e&&(n=/^[a-zA-Z_0-9]+:/.exec(t.slice(i+1,t.end)))?t.addElement(t.elt("Emoji",i,i+1+n[0].length)):-1}}]},OW=1024;let vW=0;class wW{constructor(t,e){this.from=t,this.to=e}}class yW{constructor(t={}){this.id=vW++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=SW.match(t)),e=>{let i=t(e);return void 0===i?null:[this,i]}}}yW.closedBy=new yW({deserialize:t=>t.split(" ")}),yW.openedBy=new yW({deserialize:t=>t.split(" ")}),yW.group=new yW({deserialize:t=>t.split(" ")}),yW.contextHash=new yW({perNode:!0}),yW.lookAhead=new yW({perNode:!0}),yW.mounted=new yW({perNode:!0});class xW{constructor(t,e,i){this.tree=t,this.overlay=e,this.parser=i}}const kW=Object.create(null);class SW{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):kW,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),n=new SW(t.name||"",e,t.id,i);if(t.props)for(let i of t.props)if(Array.isArray(i)||(i=i(n)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[i[0].id]=i[1]}return n}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop(yW.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return t=>{for(let i=t.prop(yW.group),n=-1;n<(i?i.length:0);n++){let r=e[n<0?t.name:i[n]];if(r)return r}}}}SW.none=new SW("",Object.create(null),0,8);class CW{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let i of this.types){let n=null;for(let e of t){let t=e(i);t&&(n||(n=Object.assign({},i.props)),n[t[0].id]=t[1])}e.push(n?new SW(i.name,n,i.id,i.flags):i)}return new CW(e)}}const AW=new WeakMap,TW=new WeakMap;var PW;!function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"}(PW||(PW={}));class MW{constructor(t,e,i,n,r){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,r&&r.length){this.props=Object.create(null);for(let[t,e]of r)this.props["number"==typeof t?t:t.id]=e}}toString(){let t=this.prop(yW.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let i=t.toString();i&&(e&&(e+=","),e+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new LW(this.topNode,t)}cursorAt(t,e=0,i=0){let n=AW.get(this)||this.topNode,r=new LW(n);return r.moveTo(t,e),AW.set(this,r._tree),r}get topNode(){return new EW(this,0,0,null)}resolve(t,e=0){let i=DW(AW.get(this)||this.topNode,t,e,!1);return AW.set(this,i),i}resolveInner(t,e=0){let i=DW(TW.get(this)||this.topNode,t,e,!0);return TW.set(this,i),i}iterate(t){let{enter:e,leave:i,from:n=0,to:r=this.length}=t;for(let s=this.cursor((t.mode||0)|PW.IncludeAnonymous);;){let t=!1;if(s.from<=r&&s.to>=n&&(s.type.isAnonymous||!1!==e(s))){if(s.firstChild())continue;t=!0}for(;t&&i&&!s.type.isAnonymous&&i(s),!s.nextSibling();){if(!s.parent())return;t=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:qW(SW.none,this.children,this.positions,0,this.children.length,0,this.length,((t,e,i)=>new MW(this.type,t,e,i,this.propValues)),t.makeTree||((t,e,i)=>new MW(SW.none,t,e,i)))}static build(t){return function(t){var e;let{buffer:i,nodeSet:n,maxBufferLength:r=OW,reused:s=[],minRepeatType:o=n.types.length}=t,l=Array.isArray(i)?new QW(i,i.length):i,a=n.types,h=0,c=0;function u(t,e,i,b,O){let{id:v,start:w,end:y,size:x}=l,k=c;for(;x<0;){if(l.next(),-1==x){let e=s[v];return i.push(e),void b.push(w-t)}if(-3==x)return void(h=v);if(-4==x)return void(c=v);throw new RangeError(`Unrecognized record size: ${x}`)}let S,C,A=a[v],T=w-t;if(y-w<=r&&(C=g(l.pos-e,O))){let e=new Uint16Array(C.size-C.skip),i=l.pos-C.size,r=e.length;for(;l.pos>i;)r=m(C.start,e,r);S=new RW(e,y-C.start,n),T=C.start-t}else{let t=l.pos-x;l.next();let e=[],i=[],n=v>=o?v:-1,s=0,a=y;for(;l.pos>t;)n>=0&&l.id==n&&l.size>=0?(l.end<=a-r&&(d(e,i,w,s,l.end,a,n,k),s=e.length,a=l.end),l.next()):u(w,t,e,i,n);if(n>=0&&s>0&&s<e.length&&d(e,i,w,s,w,a,n,k),e.reverse(),i.reverse(),n>-1&&s>0){let t=f(A);S=qW(A,e,i,0,e.length,0,y-w,t,t)}else S=p(A,e,i,y-w,k-y)}i.push(S),b.push(T)}function f(t){return(e,i,n)=>{let r,s,o=0,l=e.length-1;if(l>=0&&(r=e[l])instanceof MW){if(!l&&r.type==t&&r.length==n)return r;(s=r.prop(yW.lookAhead))&&(o=i[l]+r.length+s)}return p(t,e,i,n,o)}}function d(t,e,i,r,s,o,l,a){let h=[],c=[];for(;t.length>r;)h.push(t.pop()),c.push(e.pop()+i-s);t.push(p(n.types[l],h,c,o-s,a-o)),e.push(s-i)}function p(t,e,i,n,r=0,s){if(h){let t=[yW.contextHash,h];s=s?[t].concat(s):[t]}if(r>25){let t=[yW.lookAhead,r];s=s?[t].concat(s):[t]}return new MW(t,e,i,n,s)}function g(t,e){let i=l.fork(),n=0,s=0,a=0,h=i.end-r,c={size:0,start:0,skip:0};t:for(let r=i.pos-t;i.pos>r;){let t=i.size;if(i.id==e&&t>=0){c.size=n,c.start=s,c.skip=a,a+=4,n+=4,i.next();continue}let l=i.pos-t;if(t<0||l<r||i.start<h)break;let u=i.id>=o?4:0,f=i.start;for(i.next();i.pos>l;){if(i.size<0){if(-3!=i.size)break t;u+=4}else i.id>=o&&(u+=4);i.next()}s=f,n+=t,a+=u}return(e<0||n==t)&&(c.size=n,c.start=s,c.skip=a),c.size>4?c:void 0}function m(t,e,i){let{id:n,start:r,end:s,size:a}=l;if(l.next(),a>=0&&n<o){let o=i;if(a>4){let n=l.pos-(a-4);for(;l.pos>n;)i=m(t,e,i)}e[--i]=o,e[--i]=s-t,e[--i]=r-t,e[--i]=n}else-3==a?h=n:-4==a&&(c=n);return i}let b=[],O=[];for(;l.pos>0;)u(t.start||0,t.bufferStart||0,b,O,-1);let v=null!==(e=t.length)&&void 0!==e?e:b.length?O[0]+b[0].length:0;return new MW(a[t.topID],b.reverse(),O.reverse(),v)}(t)}}MW.empty=new MW(SW.none,[],[],0);class QW{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new QW(this.buffer,this.index)}}class RW{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return SW.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],r=n.name;if(/\W/.test(r)&&!n.isError&&(r=JSON.stringify(r)),i==(t+=4))return r;let s=[];for(;t<i;)s.push(this.childString(t)),t=this.buffer[t+3];return r+"("+s.join(",")+")"}findChild(t,e,i,n,r){let{buffer:s}=this,o=-1;for(let l=t;l!=e&&!($W(r,n,s[l+1],s[l+2])&&(o=l,i>0));l=s[l+3]);return o}slice(t,e,i,n){let r=this.buffer,s=new Uint16Array(e-t);for(let n=t,o=0;n<e;)s[o++]=r[n++],s[o++]=r[n++]-i,s[o++]=r[n++]-i,s[o++]=r[n++]-t;return new RW(s,n-i,this.set)}}function $W(t,e,i,n){switch(t){case-2:return i<e;case-1:return n>=e&&i<e;case 0:return i<e&&n>e;case 1:return i<=e&&n>e;case 2:return n>e;case 4:return!0}}function _W(t,e){let i=t.childBefore(e);for(;i;){let e=i.lastChild;if(!e||e.to!=i.to)break;e.type.isError&&e.from==e.to?(t=i,i=e.prevSibling):i=e}return t}function DW(t,e,i,n){for(var r;t.from==t.to||(i<1?t.from>=e:t.from>e)||(i>-1?t.to<=e:t.to<e);){let e=!n&&t instanceof EW&&t.index<0?null:t.parent;if(!e)return t;t=e}let s=n?0:PW.IgnoreOverlays;if(n)for(let n=t,o=n.parent;o;n=o,o=n.parent)n instanceof EW&&n.index<0&&(null===(r=o.enter(e,i,s))||void 0===r?void 0:r.from)!=n.from&&(t=o);for(;;){let n=t.enter(e,i,s);if(!n)return t;t=n}}class EW{constructor(t,e,i,n){this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,r=0){for(let s=this;;){for(let{children:o,positions:l}=s._tree,a=e>0?o.length:-1;t!=a;t+=e){let a=o[t],h=l[t]+s.from;if($W(n,i,h,h+a.length))if(a instanceof RW){if(r&PW.ExcludeBuffers)continue;let o=a.findChild(0,a.buffer.length,e,i-h,n);if(o>-1)return new zW(new IW(s,a,t,h),null,o)}else if(r&PW.IncludeAnonymous||!a.type.isAnonymous||WW(a)){let o;if(!(r&PW.IgnoreMounts)&&a.props&&(o=a.prop(yW.mounted))&&!o.overlay)return new EW(o.tree,h,t,s);let l=new EW(a,h,t,s);return r&PW.IncludeAnonymous||!l.type.isAnonymous?l:l.nextChild(e<0?a.children.length-1:0,e,i,n)}}if(r&PW.IncludeAnonymous||!s.type.isAnonymous)return null;if(t=s.index>=0?s.index+e:e<0?-1:s._parent._tree.children.length,s=s._parent,!s)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&PW.IgnoreOverlays)&&(n=this._tree.prop(yW.mounted))&&n.overlay){let i=t-this.from;for(let{from:t,to:r}of n.overlay)if((e>0?t<=i:t<i)&&(e<0?r>=i:r>i))return new EW(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new LW(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return DW(this,t,e,!1)}resolveInner(t,e=0){return DW(this,t,e,!0)}enterUnfinishedNodesBefore(t){return _W(this,t)}getChild(t,e=null,i=null){let n=NW(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return NW(this,t,e,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return BW(this,t)}}function NW(t,e,i,n){let r=t.cursor(),s=[];if(!r.firstChild())return s;if(null!=i)for(;!r.type.is(i);)if(!r.nextSibling())return s;for(;;){if(null!=n&&r.type.is(n))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return null==n?s:[]}}function BW(t,e,i=e.length-1){for(let n=t.parent;i>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[i]&&e[i]!=n.name)return!1;i--}}return!0}class IW{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class zW{constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(t,e,i){let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return r<0?null:new zW(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&PW.ExcludeBuffers)return null;let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new zW(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new zW(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new zW(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new LW(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,r=i.buffer[this.index+3];if(r>n){let s=i.buffer[this.index+1],o=i.buffer[this.index+2];t.push(i.slice(n,r,s,o)),e.push(0)}return new MW(this.type,t,e,this.to-this.from)}resolve(t,e=0){return DW(this,t,e,!1)}resolveInner(t,e=0){return DW(this,t,e,!0)}enterUnfinishedNodesBefore(t){return _W(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let n=NW(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return NW(this,t,e,i)}get node(){return this}matchContext(t){return BW(this,t)}}class LW{constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof EW)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}get name(){return this.type.name}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return!!t&&(t instanceof EW?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?!(i&PW.ExcludeBuffers)&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&PW.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&PW.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let t=i<0?0:this.stack[i]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(t)}return i<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(n.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;({index:e,_parent:i}=i))if(e>-1)for(let n=e+t,r=t<0?-1:i._tree.children.length;n!=r;n+=t){let t=i._tree.children[n];if(this.mode&PW.IncludeAnonymous||t instanceof RW||!t.type.isAnonymous||WW(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,r=this.stack.length;r>=0;){for(let s=t;s;s=s._parent)if(s.index==n){if(n==this.index)return s;e=s,i=r+1;break t}n=this.stack[--r]}for(let t=i;t<this.stack.length;t++)e=new zW(this.buffer,e,this.stack[t]);return this.bufferNode=new zW(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||!1!==t(this)){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;n&&e&&e(this),n=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return BW(this.node,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,r=this.stack.length-1;n>=0;r--){if(r<0)return BW(this.node,t,n);let s=i[e.buffer[this.stack[r]]];if(!s.isAnonymous){if(t[n]&&t[n]!=s.name)return!1;n--}}return!0}}function WW(t){return t.children.some((t=>t instanceof RW||!t.type.isAnonymous||WW(t)))}const VW=new WeakMap;function jW(t,e){if(!t.isAnonymous||e instanceof RW||e.type!=t)return 1;let i=VW.get(e);if(null==i){i=1;for(let n of e.children){if(n.type!=t||!(n instanceof MW)){i=1;break}i+=jW(t,n)}VW.set(e,i)}return i}function qW(t,e,i,n,r,s,o,l,a){let h=0;for(let i=n;i<r;i++)h+=jW(t,e[i]);let c=Math.ceil(1.5*h/8),u=[],f=[];return function e(i,n,r,o,l){for(let h=r;h<o;){let r=h,d=n[h],p=jW(t,i[h]);for(h++;h<o;h++){let e=jW(t,i[h]);if(p+e>=c)break;p+=e}if(h==r+1){if(p>c){let t=i[r];e(t.children,t.positions,0,t.children.length,n[r]+l);continue}u.push(i[r])}else{let e=n[h-1]+i[h-1].length-d;u.push(qW(t,i,n,r,h,d,e,null,a))}f.push(d+l-s)}}(e,i,n,r,0),(l||a)(u,f,o)}class HW{constructor(t,e,i,n,r=!1,s=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(r?1:0)|(s?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(t,e=[],i=!1){let n=[new HW(0,t.length,t,0,!1,i)];for(let i of e)i.to>t.length&&n.push(i);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],r=1,s=t.length?t[0]:null;for(let o=0,l=0,a=0;;o++){let h=o<e.length?e[o]:null,c=h?h.fromA:1e9;if(c-l>=i)for(;s&&s.from<c;){let e=s;if(l>=e.from||c<=e.to||a){let t=Math.max(e.from,l)-a,i=Math.min(e.to,c)-a;e=t>=i?null:new HW(t,i,e.tree,e.offset+a,o>0,!!h)}if(e&&n.push(e),s.to>c)break;s=r<t.length?t[r++]:null}if(!h)break;l=h.toA,a=h.toA-h.toB}return n}}class XW{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}class FW{constructor(t,e,i,n,r){this.parser=t,this.parse=e,this.overlay=i,this.target=n,this.ranges=r}}class ZW{constructor(t,e,i,n,r,s,o){this.parser=t,this.predicate=e,this.mounts=i,this.index=n,this.start=r,this.target=s,this.prev=o,this.depth=0,this.ranges=[]}}const GW=new yW({perNode:!0});class UW{constructor(t,e,i,n,r){this.nest=e,this.input=i,this.fragments=n,this.ranges=r,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=t}advance(){if(this.baseParse){let t=this.baseParse.advance();if(!t)return null;if(this.baseParse=null,this.baseTree=t,this.startInner(),null!=this.stoppedAt)for(let t of this.inner)t.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let t=this.baseTree;return null!=this.stoppedAt&&(t=new MW(t.type,t.children,t.positions,t.length,t.propValues.concat([[GW,this.stoppedAt]]))),t}let t=this.inner[this.innerDone],e=t.parse.advance();if(e){this.innerDone++;let i=Object.assign(Object.create(null),t.target.props);i[yW.mounted.id]=new xW(e,t.overlay,t.parser),t.target.props=i}return null}get parsedPos(){if(this.baseParse)return 0;let t=this.input.length;for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].ranges[0].from<t&&(t=Math.min(t,this.inner[e].parse.parsedPos));return t}stopAt(t){if(this.stoppedAt=t,this.baseParse)this.baseParse.stopAt(t);else for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].parse.stopAt(t)}startInner(){let t=new eV(this.fragments),e=null,i=null,n=new LW(new EW(this.baseTree,this.ranges[0].from,0,null),PW.IncludeAnonymous|PW.IgnoreMounts);t:for(let r,s;null==this.stoppedAt||n.from<this.stoppedAt;){let o,l=!0;if(t.hasNode(n)){if(e){let t=e.mounts.find((t=>t.frag.from<=n.from&&t.frag.to>=n.to&&t.mount.overlay));if(t)for(let i of t.mount.overlay){let r=i.from+t.pos,s=i.to+t.pos;r>=n.from&&s<=n.to&&!e.ranges.some((t=>t.from<s&&t.to>r))&&e.ranges.push({from:r,to:s})}}l=!1}else if(i&&(s=YW(i.ranges,n.from,n.to)))l=2!=s;else if(!n.type.isAnonymous&&n.from<n.to&&(r=this.nest(n,this.input))){n.tree||JW(n);let s=t.findMounts(n.from,r.parser);if("function"==typeof r.overlay)e=new ZW(r.parser,r.overlay,s,this.inner.length,n.from,n.tree,e);else{let t=iV(this.ranges,r.overlay||[new wW(n.from,n.to)]);t.length&&this.inner.push(new FW(r.parser,r.parser.startParse(this.input,rV(s,t),t),r.overlay?r.overlay.map((t=>new wW(t.from-n.from,t.to-n.from))):null,n.tree,t)),r.overlay?t.length&&(i={ranges:t,depth:0,prev:i}):l=!1}}else e&&(o=e.predicate(n))&&(!0===o&&(o=new wW(n.from,n.to)),o.from<o.to&&e.ranges.push(o));if(l&&n.firstChild())e&&e.depth++,i&&i.depth++;else for(;!n.nextSibling();){if(!n.parent())break t;if(e&&!--e.depth){let t=iV(this.ranges,e.ranges);t.length&&this.inner.splice(e.index,0,new FW(e.parser,e.parser.startParse(this.input,rV(e.mounts,t),t),e.ranges.map((t=>new wW(t.from-e.start,t.to-e.start))),e.target,t)),e=e.prev}i&&!--i.depth&&(i=i.prev)}}}}function YW(t,e,i){for(let n of t){if(n.from>=i)break;if(n.to>e)return n.from<=e&&n.to>=i?2:1}return 0}function KW(t,e,i,n,r,s){if(e<i){let o=t.buffer[e+1],l=t.buffer[i-2];n.push(t.slice(e,i,o,l)),r.push(o-s)}}function JW(t){let{node:e}=t,i=0;do{t.parent(),i++}while(!t.tree);let n=0,r=t.tree,s=0;for(;s=r.positions[n]+t.from,!(s<=e.from&&s+r.children[n].length>=e.to);n++);let o=r.children[n],l=o.buffer;r.children[n]=function t(i,n,r,a,h){let c=i;for(;l[c+2]+s<=e.from;)c=l[c+3];let u=[],f=[];KW(o,i,c,u,f,a);let d=l[c+1],p=l[c+2],g=d+s==e.from&&p+s==e.to&&l[c]==e.type.id;return u.push(g?e.toTree():t(c+4,l[c+3],o.set.types[l[c]],d,p-d)),f.push(d-a),KW(o,l[c+3],n,u,f,a),new MW(r,u,f,h)}(0,l.length,SW.none,0,o.length);for(let n=0;n<=i;n++)t.childAfter(e.from)}class tV{constructor(t,e){this.offset=e,this.done=!1,this.cursor=t.cursor(PW.IncludeAnonymous|PW.IgnoreMounts)}moveTo(t){let{cursor:e}=this,i=t-this.offset;for(;!this.done&&e.from<i;)e.to>=t&&e.enter(i,1,PW.IgnoreOverlays|PW.ExcludeBuffers)||e.next(!1)||(this.done=!0)}hasNode(t){if(this.moveTo(t.from),!this.done&&this.cursor.from+this.offset==t.from&&this.cursor.tree)for(let e=this.cursor.tree;;){if(e==t.tree)return!0;if(!(e.children.length&&0==e.positions[0]&&e.children[0]instanceof MW))break;e=e.children[0]}return!1}}class eV{constructor(t){var e;if(this.fragments=t,this.curTo=0,this.fragI=0,t.length){let i=this.curFrag=t[0];this.curTo=null!==(e=i.tree.prop(GW))&&void 0!==e?e:i.to,this.inner=new tV(i.tree,-i.offset)}else this.curFrag=this.inner=null}hasNode(t){for(;this.curFrag&&t.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=t.from&&this.curTo>=t.to&&this.inner.hasNode(t)}nextFrag(){var t;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let e=this.curFrag=this.fragments[this.fragI];this.curTo=null!==(t=e.tree.prop(GW))&&void 0!==t?t:e.to,this.inner=new tV(e.tree,-e.offset)}}findMounts(t,e){var i;let n=[];if(this.inner){this.inner.cursor.moveTo(t,1);for(let t=this.inner.cursor.node;t;t=t.parent){let r=null===(i=t.tree)||void 0===i?void 0:i.prop(yW.mounted);if(r&&r.parser==e)for(let e=this.fragI;e<this.fragments.length;e++){let i=this.fragments[e];if(i.from>=t.to)break;i.tree==this.curFrag.tree&&n.push({frag:i,pos:t.from-i.offset,mount:r})}}}return n}}function iV(t,e){let i=null,n=e;for(let r=1,s=0;r<t.length;r++){let o=t[r-1].to,l=t[r].from;for(;s<n.length;s++){let t=n[s];if(t.from>=l)break;t.to<=o||(i||(n=i=e.slice()),t.from<o?(i[s]=new wW(t.from,o),t.to>l&&i.splice(s+1,0,new wW(l,t.to))):t.to>l?i[s--]=new wW(l,t.to):i.splice(s--,1))}}return n}function nV(t,e,i,n){let r=0,s=0,o=!1,l=!1,a=-1e9,h=[];for(;;){let c=r==t.length?1e9:o?t[r].to:t[r].from,u=s==e.length?1e9:l?e[s].to:e[s].from;if(o!=l){let t=Math.max(a,i),e=Math.min(c,u,n);t<e&&h.push(new wW(t,e))}if(a=Math.min(c,u),1e9==a)break;c==a&&(o?(o=!1,r++):o=!0),u==a&&(l?(l=!1,s++):l=!0)}return h}function rV(t,e){let i=[];for(let{pos:n,mount:r,frag:s}of t){let t=n+(r.overlay?r.overlay[0].from:0),o=t+r.tree.length,l=Math.max(s.from,t),a=Math.min(s.to,o);if(r.overlay){let o=nV(e,r.overlay.map((t=>new wW(t.from+n,t.to+n))),l,a);for(let e=0,n=l;;e++){let l=e==o.length,h=l?a:o[e].from;if(h>n&&i.push(new HW(n,h,r.tree,-t,s.from>=n,s.to<=h)),l)break;n=o[e].to}}else i.push(new HW(l,a,r.tree,-t,s.from>=t,s.to<=o))}return i}class sV{constructor(t,e,i,n,r,s,o,l,a,h=0,c){this.p=t,this.stack=e,this.state=i,this.reducePos=n,this.pos=r,this.score=s,this.buffer=o,this.bufferBase=l,this.curContext=a,this.lookAhead=h,this.parent=c}toString(){return`[${this.stack.filter(((t,e)=>e%3==0)).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,e,i=0){let n=t.parser.context;return new sV(t,[],e,i,i,0,[],0,n?new oV(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(t,e){this.stack.push(this.state,e,this.bufferBase+this.buffer.length),this.state=t}reduce(t){let e=t>>19,i=65535&t,{parser:n}=this.p,r=n.dynamicPrecedence(i);if(r&&(this.score+=r),0==e)return this.pushState(n.getGoto(this.state,i,!0),this.reducePos),i<n.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,4,!0),void this.reduceContext(i,this.reducePos);let s=this.stack.length-3*(e-1)-(262144&t?6:0),o=this.stack[s-2],l=this.stack[s-1],a=this.bufferBase+this.buffer.length-l;if(i<n.minRepeatTerm||131072&t){let t=n.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,o,t,a+4,!0)}if(262144&t)this.state=this.stack[s];else{let t=this.stack[s-3];this.state=n.getGoto(t,i,!0)}for(;this.stack.length>s;)this.stack.pop();this.reduceContext(i,o)}storeNode(t,e,i,n=4,r=!1){if(0==t&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let t=this,n=this.buffer.length;if(0==n&&t.parent&&(n=t.bufferBase-t.parent.bufferBase,t=t.parent),n>0&&0==t.buffer[n-4]&&t.buffer[n-1]>-1){if(e==i)return;if(t.buffer[n-2]>=e)return void(t.buffer[n-2]=i)}}if(r&&this.pos!=i){let r=this.buffer.length;if(r>0&&0!=this.buffer[r-4])for(;r>0&&this.buffer[r-2]>i;)this.buffer[r]=this.buffer[r-4],this.buffer[r+1]=this.buffer[r-3],this.buffer[r+2]=this.buffer[r-2],this.buffer[r+3]=this.buffer[r-1],r-=4,n>4&&(n-=4);this.buffer[r]=t,this.buffer[r+1]=e,this.buffer[r+2]=i,this.buffer[r+3]=n}else this.buffer.push(t,e,i,n)}shift(t,e,i){let n=this.pos;if(131072&t)this.pushState(65535&t,this.pos);else if(0==(262144&t)){let r=t,{parser:s}=this.p;(i>this.pos||e<=s.maxNode)&&(this.pos=i,s.stateFlag(r,1)||(this.reducePos=i)),this.pushState(r,n),this.shiftContext(e,n),e<=s.maxNode&&this.buffer.push(e,n,i,4)}else this.pos=i,this.shiftContext(e,n),e<=this.p.parser.maxNode&&this.buffer.push(e,n,i,4)}apply(t,e,i){65536&t?this.reduce(t):this.shift(t,e,i)}useNode(t,e){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=t)&&(this.p.reused.push(t),i++);let n=this.pos;this.reducePos=this.pos=n+t.length,this.pushState(e,n),this.buffer.push(i,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,t,this,this.p.stream.reset(this.pos-t.length)))}split(){let t=this,e=t.buffer.length;for(;e>0&&t.buffer[e-2]>t.reducePos;)e-=4;let i=t.buffer.slice(e),n=t.bufferBase+e;for(;t&&n==t.bufferBase;)t=t.parent;return new sV(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,n,this.curContext,this.lookAhead,t)}recoverByDelete(t,e){let i=t<=this.p.parser.maxNode;i&&this.storeNode(t,this.pos,e,4),this.storeNode(0,this.pos,e,i?8:4),this.pos=this.reducePos=e,this.score-=190}canShift(t){for(let e=new aV(this);;){let i=this.p.parser.stateSlot(e.state,4)||this.p.parser.hasAction(e.state,t);if(0==(65536&i))return!0;if(0==i)return!1;e.reduce(i)}}recoverByInsert(t){if(this.stack.length>=300)return[];let e=this.p.parser.nextStates(this.state);if(e.length>8||this.stack.length>=120){let i=[];for(let n,r=0;r<e.length;r+=2)(n=e[r+1])!=this.state&&this.p.parser.hasAction(n,t)&&i.push(e[r],n);if(this.stack.length<120)for(let t=0;i.length<8&&t<e.length;t+=2){let n=e[t+1];i.some(((t,e)=>1&e&&t==n))||i.push(e[t],n)}e=i}let i=[];for(let t=0;t<e.length&&i.length<4;t+=2){let n=e[t+1];if(n==this.state)continue;let r=this.split();r.pushState(n,this.pos),r.storeNode(0,r.pos,r.pos,4,!0),r.shiftContext(e[t],this.pos),r.score-=200,i.push(r)}return i}forceReduce(){let t=this.p.parser.stateSlot(this.state,5);if(0==(65536&t))return!1;let{parser:e}=this.p;if(!e.validAction(this.state,t)){let i=t>>19,n=65535&t,r=this.stack.length-3*i;if(r<0||e.getGoto(this.stack[r],n,!1)<0)return!1;this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:t}=this.p;return 65535==t.data[t.stateSlot(this.state,1)]&&!t.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(t){if(this.state!=t.state||this.stack.length!=t.stack.length)return!1;for(let e=0;e<this.stack.length;e+=3)if(this.stack[e]!=t.stack[e])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(t){return this.p.parser.dialect.flags[t]}shiftContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,t,this,this.p.stream.reset(e)))}reduceContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,t,this,this.p.stream.reset(e)))}emitContext(){let t=this.buffer.length-1;(t<0||-3!=this.buffer[t])&&this.buffer.push(this.curContext.hash,this.reducePos,this.reducePos,-3)}emitLookAhead(){let t=this.buffer.length-1;(t<0||-4!=this.buffer[t])&&this.buffer.push(this.lookAhead,this.reducePos,this.reducePos,-4)}updateContext(t){if(t!=this.curContext.context){let e=new oV(this.curContext.tracker,t);e.hash!=this.curContext.hash&&this.emitContext(),this.curContext=e}}setLookAhead(t){t>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=t)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class oV{constructor(t,e){this.tracker=t,this.context=e,this.hash=t.strict?t.hash(e):0}}var lV;!function(t){t[t.Insert=200]="Insert",t[t.Delete=190]="Delete",t[t.Reduce=100]="Reduce",t[t.MaxNext=4]="MaxNext",t[t.MaxInsertStackDepth=300]="MaxInsertStackDepth",t[t.DampenInsertStackDepth=120]="DampenInsertStackDepth"}(lV||(lV={}));class aV{constructor(t){this.start=t,this.state=t.state,this.stack=t.stack,this.base=this.stack.length}reduce(t){let e=65535&t,i=t>>19;0==i?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(i-1);let n=this.start.p.parser.getGoto(this.stack[this.base-3],e,!0);this.state=n}}class hV{constructor(t,e,i){this.stack=t,this.pos=e,this.index=i,this.buffer=t.buffer,0==this.index&&this.maybeNext()}static create(t,e=t.bufferBase+t.buffer.length){return new hV(t,e,e-t.bufferBase)}maybeNext(){let t=this.stack.parent;null!=t&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new hV(this.stack,this.pos,this.index)}}class cV{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const uV=new cV;class fV{constructor(t,e){this.input=t,this.ranges=e,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=uV,this.rangeIndex=0,this.pos=this.chunkPos=e[0].from,this.range=e[0],this.end=e[e.length-1].to,this.readNext()}resolveOffset(t,e){let i=this.range,n=this.rangeIndex,r=this.pos+t;for(;r<i.from;){if(!n)return null;let t=this.ranges[--n];r-=i.from-t.to,i=t}for(;e<0?r>i.to:r>=i.to;){if(n==this.ranges.length-1)return null;let t=this.ranges[++n];r+=t.from-i.to,i=t}return r}peek(t){let e,i,n=this.chunkOff+t;if(n>=0&&n<this.chunk.length)e=this.pos+t,i=this.chunk.charCodeAt(n);else{let n=this.resolveOffset(t,1);if(null==n)return-1;if(e=n,e>=this.chunk2Pos&&e<this.chunk2Pos+this.chunk2.length)i=this.chunk2.charCodeAt(e-this.chunk2Pos);else{let t=this.rangeIndex,n=this.range;for(;n.to<=e;)n=this.ranges[++t];this.chunk2=this.input.chunk(this.chunk2Pos=e),e+this.chunk2.length>n.to&&(this.chunk2=this.chunk2.slice(0,n.to-e)),i=this.chunk2.charCodeAt(0)}}return e>=this.token.lookAhead&&(this.token.lookAhead=e+1),i}acceptToken(t,e=0){let i=e?this.resolveOffset(e,-1):this.pos;if(null==i||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=t,this.token.end=i}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:t,chunkPos:e}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=t,this.chunk2Pos=e,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let t=this.input.chunk(this.pos),e=this.pos+t.length;this.chunk=e>this.range.to?t.slice(0,this.range.to-this.pos):t,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(t=1){for(this.chunkOff+=t;this.pos+t>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();t-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=t,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(t,e){if(e?(this.token=e,e.start=t,e.lookAhead=t+1,e.value=e.extended=-1):this.token=uV,this.pos!=t){if(this.pos=t,t==this.end)return this.setDone(),this;for(;t<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;t>=this.range.to;)this.range=this.ranges[++this.rangeIndex];t>=this.chunkPos&&t<this.chunkPos+this.chunk.length?this.chunkOff=t-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(t,e){if(t>=this.chunkPos&&e<=this.chunkPos+this.chunk.length)return this.chunk.slice(t-this.chunkPos,e-this.chunkPos);if(t>=this.chunk2Pos&&e<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(t-this.chunk2Pos,e-this.chunk2Pos);if(t>=this.range.from&&e<=this.range.to)return this.input.read(t,e);let i="";for(let n of this.ranges){if(n.from>=e)break;n.to>t&&(i+=this.input.read(Math.max(n.from,t),Math.min(n.to,e)))}return i}}class dV{constructor(t,e){this.data=t,this.id=e}token(t,e){!function(t,e,i,n){let r=0,s=1<<n,{parser:o}=i.p,{dialect:l}=o;t:for(;0!=(s&t[r]);){let i=t[r+1];for(let n=r+3;n<i;n+=2)if((t[n+1]&s)>0){let i=t[n];if(l.allows(i)&&(-1==e.token.value||e.token.value==i||o.overrides(i,e.token.value))){e.acceptToken(i);break}}let n=e.next,a=0,h=t[r+2];if(!(e.next<0&&h>a&&65535==t[i+3*h-3])){for(;a<h;){let s=a+h>>1,o=i+s+(s<<1),l=t[o],c=t[o+1];if(n<l)h=s;else{if(!(n>=c)){r=t[o+2],e.advance();continue t}a=s+1}}break}r=t[i+3*h-1]}}(this.data,t,e,this.id)}}dV.prototype.contextual=dV.prototype.fallback=dV.prototype.extend=!1;class pV{constructor(t,e={}){this.token=t,this.contextual=!!e.contextual,this.fallback=!!e.fallback,this.extend=!!e.extend}}function gV(t,e=Uint16Array){if("string"!=typeof t)return t;let i=null;for(let n=0,r=0;n<t.length;){let s=0;for(;;){let e=t.charCodeAt(n++),i=!1;if(126==e){s=65535;break}e>=92&&e--,e>=34&&e--;let r=e-32;if(r>=46&&(r-=46,i=!0),s+=r,i)break;s*=46}i?i[r++]=s:i=new e(s)}return i}const mV="undefined"!=typeof process&&process.env&&/\bparse\b/.test(process.env.LOG);let bV=null;var OV,vV;function wV(t,e,i){let n=t.cursor(PW.IncludeAnonymous);for(n.moveTo(e);;)if(!(i<0?n.childBefore(e):n.childAfter(e)))for(;;){if((i<0?n.to<e:n.from>e)&&!n.type.isError)return i<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(t.length,Math.max(n.from+1,e+25));if(i<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return i<0?0:t.length}}!function(t){t[t.Margin=25]="Margin"}(OV||(OV={}));class yV{constructor(t,e){this.fragments=t,this.nodeSet=e,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let t=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(t){for(this.safeFrom=t.openStart?wV(t.tree,t.from+t.offset,1)-t.offset:t.from,this.safeTo=t.openEnd?wV(t.tree,t.to+t.offset,-1)-t.offset:t.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(t.tree),this.start.push(-t.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(t){if(t<this.nextStart)return null;for(;this.fragment&&this.safeTo<=t;)this.nextFragment();if(!this.fragment)return null;for(;;){let e=this.trees.length-1;if(e<0)return this.nextFragment(),null;let i=this.trees[e],n=this.index[e];if(n==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let r=i.children[n],s=this.start[e]+i.positions[n];if(s>t)return this.nextStart=s,null;if(r instanceof MW){if(s==t){if(s<this.safeFrom)return null;let t=s+r.length;if(t<=this.safeTo){let e=r.prop(yW.lookAhead);if(!e||t+e<this.fragment.to)return r}}this.index[e]++,s+r.length>=Math.max(this.safeFrom,t)&&(this.trees.push(r),this.start.push(s),this.index.push(0))}else this.index[e]++,this.nextStart=s+r.length}}}class xV{constructor(t,e){this.stream=e,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=t.tokenizers.map((t=>new cV))}getActions(t){let e=0,i=null,{parser:n}=t.p,{tokenizers:r}=n,s=n.stateSlot(t.state,3),o=t.curContext?t.curContext.hash:0,l=0;for(let n=0;n<r.length;n++){if(0==(1<<n&s))continue;let a=r[n],h=this.tokens[n];if((!i||a.fallback)&&((a.contextual||h.start!=t.pos||h.mask!=s||h.context!=o)&&(this.updateCachedToken(h,a,t),h.mask=s,h.context=o),h.lookAhead>h.end+25&&(l=Math.max(h.lookAhead,l)),0!=h.value)){let n=e;if(h.extended>-1&&(e=this.addActions(t,h.extended,h.end,e)),e=this.addActions(t,h.value,h.end,e),!a.extend&&(i=h,e>n))break}}for(;this.actions.length>e;)this.actions.pop();return l&&t.setLookAhead(l),i||t.pos!=this.stream.end||(i=new cV,i.value=t.p.parser.eofTerm,i.start=i.end=t.pos,e=this.addActions(t,i.value,i.end,e)),this.mainToken=i,this.actions}getMainToken(t){if(this.mainToken)return this.mainToken;let e=new cV,{pos:i,p:n}=t;return e.start=i,e.end=Math.min(i+1,n.stream.end),e.value=i==n.stream.end?n.parser.eofTerm:0,e}updateCachedToken(t,e,i){if(e.token(this.stream.reset(i.pos,t),i),t.value>-1){let{parser:e}=i.p;for(let n=0;n<e.specialized.length;n++)if(e.specialized[n]==t.value){let r=e.specializers[n](this.stream.read(t.start,t.end),i);if(r>=0&&i.p.parser.dialect.allows(r>>1)){0==(1&r)?t.value=r>>1:t.extended=r>>1;break}}}else t.value=0,t.end=Math.min(i.p.stream.end,i.pos+1)}putAction(t,e,i,n){for(let e=0;e<n;e+=3)if(this.actions[e]==t)return n;return this.actions[n++]=t,this.actions[n++]=e,this.actions[n++]=i,n}addActions(t,e,i,n){let{state:r}=t,{parser:s}=t.p,{data:o}=s;for(let t=0;t<2;t++)for(let l=s.stateSlot(r,t?2:1);;l+=3){if(65535==o[l]){if(1!=o[l+1]){0==n&&2==o[l+1]&&(n=this.putAction(PV(o,l+2),e,i,n));break}l=PV(o,l+2)}o[l]==e&&(n=this.putAction(PV(o,l+1),e,i,n))}return n}}!function(t){t[t.Distance=5]="Distance",t[t.MaxRemainingPerStep=3]="MaxRemainingPerStep",t[t.MinBufferLengthPrune=500]="MinBufferLengthPrune",t[t.ForceReduceLimit=10]="ForceReduceLimit",t[t.CutDepth=15e3]="CutDepth",t[t.CutTo=9e3]="CutTo"}(vV||(vV={}));class kV{constructor(t,e,i,n){this.parser=t,this.input=e,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.stream=new fV(e,n),this.tokens=new xV(t,this.stream),this.topTerm=t.top[1];let{from:r}=n[0];this.stacks=[sV.start(this,t.top[0],r)],this.fragments=i.length&&this.stream.end-r>4*t.bufferLength?new yV(i,t.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let t,e,i=this.stacks,n=this.minStackPos,r=this.stacks=[];for(let s=0;s<i.length;s++){let o=i[s];for(;;){if(this.tokens.mainToken=null,o.pos>n)r.push(o);else{if(this.advanceStack(o,r,i))continue;{t||(t=[],e=[]),t.push(o);let i=this.tokens.getMainToken(o);e.push(i.value,i.end)}}break}}if(!r.length){let e=t&&function(t){let e=null;for(let i of t){let t=i.p.stoppedAt;(i.pos==i.p.stream.end||null!=t&&i.pos>t)&&i.p.parser.stateFlag(i.state,2)&&(!e||e.score<i.score)&&(e=i)}return e}(t);if(e)return this.stackToTree(e);if(this.parser.strict)throw mV&&t&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+n);this.recovering||(this.recovering=5)}if(this.recovering&&t){let i=null!=this.stoppedAt&&t[0].pos>this.stoppedAt?t[0]:this.runRecovery(t,e,r);if(i)return this.stackToTree(i.forceAll())}if(this.recovering){let t=1==this.recovering?1:3*this.recovering;if(r.length>t)for(r.sort(((t,e)=>e.score-t.score));r.length>t;)r.pop();r.some((t=>t.reducePos>n))&&this.recovering--}else if(r.length>1)t:for(let t=0;t<r.length-1;t++){let e=r[t];for(let i=t+1;i<r.length;i++){let n=r[i];if(e.sameState(n)||e.buffer.length>500&&n.buffer.length>500){if(!((e.score-n.score||e.buffer.length-n.buffer.length)>0)){r.splice(t--,1);continue t}r.splice(i--,1)}}}this.minStackPos=r[0].pos;for(let t=1;t<r.length;t++)r[t].pos<this.minStackPos&&(this.minStackPos=r[t].pos);return null}stopAt(t){if(null!=this.stoppedAt&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}advanceStack(t,e,i){let n=t.pos,{parser:r}=this,s=mV?this.stackID(t)+" -> ":"";if(null!=this.stoppedAt&&n>this.stoppedAt)return t.forceReduce()?t:null;if(this.fragments){let e=t.curContext&&t.curContext.tracker.strict,i=e?t.curContext.hash:0;for(let o=this.fragments.nodeAt(n);o;){let n=this.parser.nodeSet.types[o.type.id]==o.type?r.getGoto(t.state,o.type.id):-1;if(n>-1&&o.length&&(!e||(o.prop(yW.contextHash)||0)==i))return t.useNode(o,n),mV&&console.log(s+this.stackID(t)+` (via reuse of ${r.getName(o.type.id)})`),!0;if(!(o instanceof MW)||0==o.children.length||o.positions[0]>0)break;let l=o.children[0];if(!(l instanceof MW&&0==o.positions[0]))break;o=l}}let o=r.stateSlot(t.state,4);if(o>0)return t.reduce(o),mV&&console.log(s+this.stackID(t)+` (via always-reduce ${r.getName(65535&o)})`),!0;if(t.stack.length>=15e3)for(;t.stack.length>9e3&&t.forceReduce(););let l=this.tokens.getActions(t);for(let o=0;o<l.length;){let a=l[o++],h=l[o++],c=l[o++],u=o==l.length||!i,f=u?t:t.split();if(f.apply(a,h,c),mV&&console.log(s+this.stackID(f)+` (via ${0==(65536&a)?"shift":`reduce of ${r.getName(65535&a)}`} for ${r.getName(h)} @ ${n}${f==t?"":", split"})`),u)return!0;f.pos>n?e.push(f):i.push(f)}return!1}advanceFully(t,e){let i=t.pos;for(;;){if(!this.advanceStack(t,null,null))return!1;if(t.pos>i)return SV(t,e),!0}}runRecovery(t,e,i){let n=null,r=!1;for(let s=0;s<t.length;s++){let o=t[s],l=e[s<<1],a=e[1+(s<<1)],h=mV?this.stackID(o)+" -> ":"";if(o.deadEnd){if(r)continue;if(r=!0,o.restart(),mV&&console.log(h+this.stackID(o)+" (restarted)"),this.advanceFully(o,i))continue}let c=o.split(),u=h;for(let t=0;c.forceReduce()&&t<10;t++){if(mV&&console.log(u+this.stackID(c)+" (via force-reduce)"),this.advanceFully(c,i))break;mV&&(u=this.stackID(c)+" -> ")}for(let t of o.recoverByInsert(l))mV&&console.log(h+this.stackID(t)+" (via recover-insert)"),this.advanceFully(t,i);this.stream.end>o.pos?(a==o.pos&&(a++,l=0),o.recoverByDelete(l,a),mV&&console.log(h+this.stackID(o)+` (via recover-delete ${this.parser.getName(l)})`),SV(o,i)):(!n||n.score<o.score)&&(n=o)}return n}stackToTree(t){return t.close(),MW.build({buffer:hV.create(t),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:t.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(t){let e=(bV||(bV=new WeakMap)).get(t);return e||bV.set(t,e=String.fromCodePoint(this.nextStackID++)),e+t}}function SV(t,e){for(let i=0;i<e.length;i++){let n=e[i];if(n.pos==t.pos&&n.sameState(t))return void(e[i].score<t.score&&(e[i]=t))}e.push(t)}class CV{constructor(t,e,i){this.source=t,this.flags=e,this.disabled=i}allows(t){return!this.disabled||0==this.disabled[t]}}const AV=t=>t;class TV extends class{startParse(t,e,i){return"string"==typeof t&&(t=new XW(t)),i=i?i.length?i.map((t=>new wW(t.from,t.to))):[new wW(0,0)]:[new wW(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let t=n.advance();if(t)return t}}}{constructor(t){if(super(),this.wrappers=[],14!=t.version)throw new RangeError(`Parser version (${t.version}) doesn't match runtime version (14)`);let e=t.nodeNames.split(" ");this.minRepeatTerm=e.length;for(let i=0;i<t.repeatNodeCount;i++)e.push("");let i=Object.keys(t.topRules).map((e=>t.topRules[e][1])),n=[];for(let t=0;t<e.length;t++)n.push([]);function r(t,e,i){n[t].push([e,e.deserialize(String(i))])}if(t.nodeProps)for(let e of t.nodeProps){let t=e[0];"string"==typeof t&&(t=yW[t]);for(let i=1;i<e.length;){let n=e[i++];if(n>=0)r(n,t,e[i++]);else{let s=e[i+-n];for(let o=-n;o>0;o--)r(e[i++],t,s);i++}}}this.nodeSet=new CW(e.map(((e,r)=>SW.define({name:r>=this.minRepeatTerm?void 0:e,id:r,props:n[r],top:i.indexOf(r)>-1,error:0==r,skipped:t.skippedNodes&&t.skippedNodes.indexOf(r)>-1})))),t.propSources&&(this.nodeSet=this.nodeSet.extend(...t.propSources)),this.strict=!1,this.bufferLength=OW;let s=gV(t.tokenData);if(this.context=t.context,this.specialized=new Uint16Array(t.specialized?t.specialized.length:0),this.specializers=[],t.specialized)for(let e=0;e<t.specialized.length;e++)this.specialized[e]=t.specialized[e].term,this.specializers[e]=t.specialized[e].get;this.states=gV(t.states,Uint32Array),this.data=gV(t.stateData),this.goto=gV(t.goto),this.maxTerm=t.maxTerm,this.tokenizers=t.tokenizers.map((t=>"number"==typeof t?new dV(s,t):t)),this.topRules=t.topRules,this.dialects=t.dialects||{},this.dynamicPrecedences=t.dynamicPrecedences||null,this.tokenPrecTable=t.tokenPrec,this.termNames=t.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(t,e,i){let n=new kV(this,t,e,i);for(let r of this.wrappers)n=r(n,t,e,i);return n}getGoto(t,e,i=!1){let n=this.goto;if(e>=n[0])return-1;for(let r=n[e+1];;){let e=n[r++],s=1&e,o=n[r++];if(s&&i)return o;for(let i=r+(e>>1);r<i;r++)if(n[r]==t)return o;if(s)return-1}}hasAction(t,e){let i=this.data;for(let n=0;n<2;n++)for(let r,s=this.stateSlot(t,n?2:1);;s+=3){if(65535==(r=i[s])){if(1!=i[s+1]){if(2==i[s+1])return PV(i,s+2);break}r=i[s=PV(i,s+2)]}if(r==e||0==r)return PV(i,s+1)}return 0}stateSlot(t,e){return this.states[6*t+e]}stateFlag(t,e){return(this.stateSlot(t,0)&e)>0}validAction(t,e){if(e==this.stateSlot(t,4))return!0;for(let i=this.stateSlot(t,1);;i+=3){if(65535==this.data[i]){if(1!=this.data[i+1])return!1;i=PV(this.data,i+2)}if(e==PV(this.data,i+1))return!0}}nextStates(t){let e=[];for(let i=this.stateSlot(t,1);;i+=3){if(65535==this.data[i]){if(1!=this.data[i+1])break;i=PV(this.data,i+2)}if(0==(1&this.data[i+2])){let t=this.data[i+1];e.some(((e,i)=>1&i&&e==t))||e.push(this.data[i],t)}}return e}overrides(t,e){let i=MV(this.data,this.tokenPrecTable,e);return i<0||MV(this.data,this.tokenPrecTable,t)<i}configure(t){let e=Object.assign(Object.create(TV.prototype),this);if(t.props&&(e.nodeSet=this.nodeSet.extend(...t.props)),t.top){let i=this.topRules[t.top];if(!i)throw new RangeError(`Invalid top rule name ${t.top}`);e.top=i}return t.tokenizers&&(e.tokenizers=this.tokenizers.map((e=>{let i=t.tokenizers.find((t=>t.from==e));return i?i.to:e}))),t.specializers&&(e.specializers=this.specializers.map((e=>{let i=t.specializers.find((t=>t.from==e));return i?i.to:e}))),t.contextTracker&&(e.context=t.contextTracker),t.dialect&&(e.dialect=this.parseDialect(t.dialect)),null!=t.strict&&(e.strict=t.strict),t.wrap&&(e.wrappers=e.wrappers.concat(t.wrap)),null!=t.bufferLength&&(e.bufferLength=t.bufferLength),e}hasWrappers(){return this.wrappers.length>0}getName(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.nodeSet.types[t].name||t)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(t){let e=this.dynamicPrecedences;return null==e?0:e[t]||0}parseDialect(t){let e=Object.keys(this.dialects),i=e.map((()=>!1));if(t)for(let n of t.split(" ")){let t=e.indexOf(n);t>=0&&(i[t]=!0)}let n=null;for(let t=0;t<e.length;t++)if(!i[t])for(let i,r=this.dialects[e[t]];65535!=(i=this.data[r++]);)(n||(n=new Uint8Array(this.maxTerm+1)))[i]=1;return new CV(t,i,n)}static deserialize(t){return new TV(t)}}function PV(t,e){return t[e]|t[e+1]<<16}function MV(t,e,i){for(let n,r=e;65535!=(n=t[r]);r++)if(n==i)return r-e;return-1}let QV=0;class RV{constructor(t,e,i){this.set=t,this.base=e,this.modified=i,this.id=QV++}static define(t){if(null==t?void 0:t.base)throw new Error("Can not derive from a modified tag");let e=new RV([],null,[]);if(e.set.push(e),t)for(let i of t.set)e.set.push(i);return e}static defineModifier(){let t=new _V;return e=>e.modified.indexOf(t)>-1?e:_V.get(e.base||e,e.modified.concat(t).sort(((t,e)=>t.id-e.id)))}}let $V=0;class _V{constructor(){this.instances=[],this.id=$V++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find((i=>{return i.base==t&&(n=e,r=i.modified,n.length==r.length&&n.every(((t,e)=>t==r[e])));var n,r}));if(i)return i;let n=[],r=new RV(n,t,e);for(let t of e)t.instances.push(r);let s=DV(e);for(let e of t.set)for(let t of s)n.push(_V.get(e,t));return r}}function DV(t){let e=[t];for(let i=0;i<t.length;i++)for(let n of DV(t.slice(0,i).concat(t.slice(i+1))))e.push(n);return e}const EV=new yW;class NV{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}const BV=RV.define,IV=BV(),zV=BV(),LV=BV(zV),WV=BV(zV),VV=BV(),jV=BV(VV),qV=BV(VV),HV=BV(),XV=BV(HV),FV=BV(),ZV=BV(),GV=BV(),UV=BV(GV),YV=BV(),KV={comment:IV,lineComment:BV(IV),blockComment:BV(IV),docComment:BV(IV),name:zV,variableName:BV(zV),typeName:LV,tagName:BV(LV),propertyName:WV,attributeName:BV(WV),className:BV(zV),labelName:BV(zV),namespace:BV(zV),macroName:BV(zV),literal:VV,string:jV,docString:BV(jV),character:BV(jV),attributeValue:BV(jV),number:qV,integer:BV(qV),float:BV(qV),bool:BV(VV),regexp:BV(VV),escape:BV(VV),color:BV(VV),url:BV(VV),keyword:FV,self:BV(FV),null:BV(FV),atom:BV(FV),unit:BV(FV),modifier:BV(FV),operatorKeyword:BV(FV),controlKeyword:BV(FV),definitionKeyword:BV(FV),moduleKeyword:BV(FV),operator:ZV,derefOperator:BV(ZV),arithmeticOperator:BV(ZV),logicOperator:BV(ZV),bitwiseOperator:BV(ZV),compareOperator:BV(ZV),updateOperator:BV(ZV),definitionOperator:BV(ZV),typeOperator:BV(ZV),controlOperator:BV(ZV),punctuation:GV,separator:BV(GV),bracket:UV,angleBracket:BV(UV),squareBracket:BV(UV),paren:BV(UV),brace:BV(UV),content:HV,heading:XV,heading1:BV(XV),heading2:BV(XV),heading3:BV(XV),heading4:BV(XV),heading5:BV(XV),heading6:BV(XV),contentSeparator:BV(HV),list:BV(HV),quote:BV(HV),emphasis:BV(HV),strong:BV(HV),link:BV(HV),monospace:BV(HV),strikethrough:BV(HV),inserted:BV(),deleted:BV(),changed:BV(),invalid:BV(),meta:YV,documentMeta:BV(YV),annotation:BV(YV),processingInstruction:BV(YV),definition:RV.defineModifier(),constant:RV.defineModifier(),function:RV.defineModifier(),standard:RV.defineModifier(),local:RV.defineModifier(),special:RV.defineModifier()};!function(t,e){let i=Object.create(null);for(let e of t)if(Array.isArray(e.tag))for(let t of e.tag)i[t.id]=e.class;else i[e.tag.id]=e.class;let{scope:n,all:r=null}=e||{}}([{tag:KV.link,class:"tok-link"},{tag:KV.heading,class:"tok-heading"},{tag:KV.emphasis,class:"tok-emphasis"},{tag:KV.strong,class:"tok-strong"},{tag:KV.keyword,class:"tok-keyword"},{tag:KV.atom,class:"tok-atom"},{tag:KV.bool,class:"tok-bool"},{tag:KV.url,class:"tok-url"},{tag:KV.labelName,class:"tok-labelName"},{tag:KV.inserted,class:"tok-inserted"},{tag:KV.deleted,class:"tok-deleted"},{tag:KV.literal,class:"tok-literal"},{tag:KV.string,class:"tok-string"},{tag:KV.number,class:"tok-number"},{tag:[KV.regexp,KV.escape,KV.special(KV.string)],class:"tok-string2"},{tag:KV.variableName,class:"tok-variableName"},{tag:KV.local(KV.variableName),class:"tok-variableName tok-local"},{tag:KV.definition(KV.variableName),class:"tok-variableName tok-definition"},{tag:KV.special(KV.variableName),class:"tok-variableName2"},{tag:KV.definition(KV.propertyName),class:"tok-propertyName tok-definition"},{tag:KV.typeName,class:"tok-typeName"},{tag:KV.namespace,class:"tok-namespace"},{tag:KV.className,class:"tok-className"},{tag:KV.macroName,class:"tok-macroName"},{tag:KV.propertyName,class:"tok-propertyName"},{tag:KV.operator,class:"tok-operator"},{tag:KV.comment,class:"tok-comment"},{tag:KV.meta,class:"tok-meta"},{tag:KV.invalid,class:"tok-invalid"},{tag:KV.punctuation,class:"tok-punctuation"}]);const JV={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},tj={dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},ej={dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}};function ij(t){return 9==t||10==t||13==t||32==t}let nj=null,rj=null,sj=0;function oj(t,e){let i=t.pos+e;if(sj==i&&rj==t)return nj;let n=t.peek(e);for(;ij(n);)n=t.peek(++e);let r="";for(;45==(s=n)||46==s||58==s||s>=65&&s<=90||95==s||s>=97&&s<=122||s>=161;)r+=String.fromCharCode(n),n=t.peek(++e);var s;return rj=t,sj=i,nj=r?r.toLowerCase():n==lj||n==aj?void 0:null}const lj=63,aj=33;function hj(t,e){this.name=t,this.parent=e,this.hash=e?e.hash:0;for(let e=0;e<t.length;e++)this.hash+=(this.hash<<4)+t.charCodeAt(e)+(t.charCodeAt(e)<<8)}const cj=[4,8,5,6,7],uj=new class{constructor(t){this.start=t.start,this.shift=t.shift||AV,this.reduce=t.reduce||AV,this.reuse=t.reuse||AV,this.hash=t.hash||(()=>0),this.strict=!1!==t.strict}}({start:null,shift:(t,e,i,n)=>cj.indexOf(e)>-1?new hj(oj(n,1)||"",t):t,reduce:(t,e)=>18==e&&t?t.parent:t,reuse(t,e,i,n){let r=e.type.id;return 4==r||35==r?new hj(oj(n,1)||"",t):t},hash:t=>t?t.hash:0,strict:!1}),fj=new pV(((t,e)=>{if(60!=t.next)return void(t.next<0&&e.context&&t.acceptToken(56));t.advance();let i=47==t.next;i&&t.advance();let n=oj(t,0);if(void 0===n)return;if(!n)return t.acceptToken(i?12:4);let r=e.context?e.context.name:null;if(i){if(n==r)return t.acceptToken(9);if(r&&tj[r])return t.acceptToken(56,-2);if(e.dialectEnabled(0))return t.acceptToken(10);for(let t=e.context;t;t=t.parent)if(t.name==n)return;t.acceptToken(11)}else{if("script"==n)return t.acceptToken(5);if("style"==n)return t.acceptToken(6);if("textarea"==n)return t.acceptToken(7);if(JV.hasOwnProperty(n))return t.acceptToken(8);r&&ej[r]&&ej[r][n]?t.acceptToken(56,-1):t.acceptToken(4)}}),{contextual:!0}),dj=new pV((t=>{for(let e=0,i=0;;i++){if(t.next<0){i&&t.acceptToken(57);break}if(45==t.next)e++;else{if(62==t.next&&e>=2){i>3&&t.acceptToken(57,-2);break}e=0}t.advance()}}));function pj(t,e,i){let n=2+t.length;return new pV((r=>{for(let s=0,o=0,l=0;;l++){if(r.next<0){l&&r.acceptToken(e);break}if(0==s&&60==r.next||1==s&&47==r.next||s>=2&&s<n&&r.next==t.charCodeAt(s-2))s++,o++;else if(2!=s&&s!=n||!ij(r.next)){if(s==n&&62==r.next){l>o?r.acceptToken(e,-o):r.acceptToken(i,-(o-2));break}if((10==r.next||13==r.next)&&l){r.acceptToken(e,1);break}s=o=0}else o++;r.advance()}}))}const gj=pj("script",53,1),mj=pj("style",54,2),bj=pj("textarea",55,3),Oj=function(t){let e=Object.create(null);for(let i in t){let n=t[i];Array.isArray(n)||(n=[n]);for(let t of i.split(" "))if(t){let i=[],r=2,s=t;for(let e=0;;){if("..."==s&&e>0&&e+3==t.length){r=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!n)throw new RangeError("Invalid path: "+t);if(i.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),e+=n[0].length,e==t.length)break;let o=t[e++];if(e==t.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+t);s=t.slice(e)}let o=i.length-1,l=i[o];if(!l)throw new RangeError("Invalid path: "+t);let a=new NV(n,r,o>0?i.slice(0,o):null);e[l]=a.sort(e[l])}}return EV.add(e)}({"Text RawText":KV.content,"StartTag StartCloseTag SelfCloserEndTag EndTag SelfCloseEndTag":KV.angleBracket,TagName:KV.tagName,"MismatchedCloseTag/TagName":[KV.tagName,KV.invalid],AttributeName:KV.attributeName,"AttributeValue UnquotedAttributeValue":KV.attributeValue,Is:KV.definitionOperator,"EntityReference CharacterReference":KV.character,Comment:KV.blockComment,ProcessingInst:KV.processingInstruction,DoctypeDecl:KV.documentMeta}),vj=TV.deserialize({version:14,states:",xOVOxOOO!WQ!bO'#CoO!]Q!bO'#CyO!bQ!bO'#C|O!gQ!bO'#DPO!lQ!bO'#DRO!qOXO'#CnO!|OYO'#CnO#XO[O'#CnO$eOxO'#CnOOOW'#Cn'#CnO$lO!rO'#DSO$tQ!bO'#DUO$yQ!bO'#DVOOOW'#Dj'#DjOOOW'#DX'#DXQVOxOOO%OQ#tO,59ZO%WQ#tO,59eO%`Q#tO,59hO%hQ#tO,59kO%pQ#tO,59mOOOX'#D]'#D]O%xOXO'#CwO&TOXO,59YOOOY'#D^'#D^O&]OYO'#CzO&hOYO,59YOOO['#D_'#D_O&pO[O'#C}O&{O[O,59YOOOW'#D`'#D`O'TOxO,59YO'[Q!bO'#DQOOOW,59Y,59YOOO`'#Da'#DaO'aO!rO,59nOOOW,59n,59nO'iQ!bO,59pO'nQ!bO,59qOOOW-E7V-E7VO'sQ#tO'#CqOOQO'#DY'#DYO(OQ#tO1G.uOOOX1G.u1G.uO(WQ#tO1G/POOOY1G/P1G/PO(`Q#tO1G/SOOO[1G/S1G/SO(hQ#tO1G/VOOOW1G/V1G/VO(pQ#tO1G/XOOOW1G/X1G/XOOOX-E7Z-E7ZO(xQ!bO'#CxOOOW1G.t1G.tOOOY-E7[-E7[O(}Q!bO'#C{OOO[-E7]-E7]O)SQ!bO'#DOOOOW-E7^-E7^O)XQ!bO,59lOOO`-E7_-E7_OOOW1G/Y1G/YOOOW1G/[1G/[OOOW1G/]1G/]O)^Q&jO,59]OOQO-E7W-E7WOOOX7+$a7+$aOOOY7+$k7+$kOOO[7+$n7+$nOOOW7+$q7+$qOOOW7+$s7+$sO)iQ!bO,59dO)nQ!bO,59gO)sQ!bO,59jOOOW1G/W1G/WO)xO,UO'#CtO*WO7[O'#CtOOQO1G.w1G.wOOOW1G/O1G/OOOOW1G/R1G/ROOOW1G/U1G/UOOOO'#DZ'#DZO*fO,UO,59`OOQO,59`,59`OOOO'#D['#D[O*tO7[O,59`OOOO-E7X-E7XOOQO1G.z1G.zOOOO-E7Y-E7Y",stateData:"+[~O!]OS~OSSOTPOUQOVROWTOY]OZ[O[^O^^O_^O`^Oa^Ow^Oz_O!cZO~OdaO~OdbO~OdcO~OddO~OdeO~O!VfOPkP!YkP~O!WiOQnP!YnP~O!XlORqP!YqP~OSSOTPOUQOVROWTOXqOY]OZ[O[^O^^O_^O`^Oa^Ow^O!cZO~O!YrO~P#dO!ZsO!duO~OdvO~OdwO~OfyOj|O~OfyOj!OO~OfyOj!QO~OfyOj!SO~OfyOj!UO~O!VfOPkX!YkX~OP!WO!Y!XO~O!WiOQnX!YnX~OQ!ZO!Y!XO~O!XlORqX!YqX~OR!]O!Y!XO~O!Y!XO~P#dOd!_O~O!ZsO!d!aO~Oj!bO~Oj!cO~Og!dOfeXjeX~OfyOj!fO~OfyOj!gO~OfyOj!hO~OfyOj!iO~OfyOj!jO~Od!kO~Od!lO~Od!mO~Oj!nO~Oi!qO!_!oO!a!pO~Oj!rO~Oj!sO~Oj!tO~O_!uO`!uO!_!wO!`!uO~O_!xO`!xO!a!wO!b!xO~O_!uO`!uO!_!{O!`!uO~O_!xO`!xO!a!{O!b!xO~O`_a!cwz!c~",goto:"%o!_PPPPPPPPPPPPPPPPPP!`!fP!lPP!xPP!{#O#R#X#[#_#e#h#k#q#w!`P!`!`P#}$T$k$q$w$}%T%Z%aPPPPPPPP%gX^OX`pXUOX`pezabcde{}!P!R!TR!q!dRhUR!XhXVOX`pRkVR!XkXWOX`pRnWR!XnXXOX`pQrXR!XpXYOX`pQ`ORx`Q{aQ}bQ!PcQ!RdQ!TeZ!e{}!P!R!TQ!v!oR!z!vQ!y!pR!|!yQgUR!VgQjVR!YjQmWR![mQpXR!^pQtZR!`tS_O`ToXp",nodeNames:"⚠ StartCloseTag StartCloseTag StartCloseTag StartTag StartTag StartTag StartTag StartTag StartCloseTag StartCloseTag StartCloseTag IncompleteCloseTag Document Text EntityReference CharacterReference InvalidEntity Element OpenTag TagName Attribute AttributeName Is AttributeValue UnquotedAttributeValue EndTag ScriptText CloseTag OpenTag StyleText CloseTag OpenTag TextareaText CloseTag OpenTag CloseTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag CloseTag DoctypeDecl",maxTerm:66,context:uj,nodeProps:[["closedBy",-11,1,2,3,4,5,6,7,8,9,10,11,"EndTag",-4,19,29,32,35,"CloseTag"],["group",-9,12,15,16,17,18,38,39,40,41,"Entity",14,"Entity TextContent",-3,27,30,33,"TextContent Entity"],["openedBy",26,"StartTag StartCloseTag",-4,28,31,34,36,"OpenTag"]],propSources:[Oj],skippedNodes:[0],repeatNodeCount:9,tokenData:"!#b!aR!WOX$kXY)sYZ)sZ]$k]^)s^p$kpq)sqr$krs*zsv$kvw+dwx2yx}$k}!O3f!O!P$k!P!Q7_!Q![$k![!]8u!]!^$k!^!_>b!_!`!!p!`!a8T!a!c$k!c!}8u!}#R$k#R#S8u#S#T$k#T#o8u#o$f$k$f$g&R$g%W$k%W%o8u%o%p$k%p&a8u&a&b$k&b1p8u1p4U$k4U4d8u4d4e$k4e$IS8u$IS$I`$k$I`$Ib8u$Ib$Kh$k$Kh%#t8u%#t&/x$k&/x&Et8u&Et&FV$k&FV;'S8u;'S;:j<t;:j?&r$k?&r?Ah8u?Ah?BY$k?BY?Mn8u?Mn~$k!Z$vc^PiW!``!bpOX$kXZ&RZ]$k]^&R^p$kpq&Rqr$krs&qsv$kvw)Rwx'rx!P$k!P!Q&R!Q!^$k!^!_(k!_!a&R!a$f$k$f$g&R$g~$k!R&[V^P!``!bpOr&Rrs&qsv&Rwx'rx!^&R!^!_(k!_~&Rq&xT^P!bpOv&qwx'Xx!^&q!^!_'g!_~&qP'^R^POv'Xw!^'X!_~'Xp'lQ!bpOv'gx~'ga'yU^P!``Or'rrs'Xsv'rw!^'r!^!_(]!_~'r`(bR!``Or(]sv(]w~(]!Q(rT!``!bpOr(krs'gsv(kwx(]x~(kW)WXiWOX)RZ])R^p)Rqr)Rsw)Rx!P)R!Q!^)R!a$f)R$g~)R!a*O^^P!``!bp!]^OX&RXY)sYZ)sZ]&R]^)s^p&Rpq)sqr&Rrs&qsv&Rwx'rx!^&R!^!_(k!_~&R!Z+TT!_h^P!bpOv&qwx'Xx!^&q!^!_'g!_~&q!Z+kbiWaPOX,sXZ.QZ],s]^.Q^p,sqr,srs.Qst/]tw,swx.Qx!P,s!P!Q.Q!Q!],s!]!^)R!^!a.Q!a$f,s$f$g.Q$g~,s!Z,xbiWOX,sXZ.QZ],s]^.Q^p,sqr,srs.Qst)Rtw,swx.Qx!P,s!P!Q.Q!Q!],s!]!^.i!^!a.Q!a$f,s$f$g.Q$g~,s!R.TTOp.Qqs.Qt!].Q!]!^.d!^~.Q!R.iO_!R!Z.pXiW_!ROX)RZ])R^p)Rqr)Rsw)Rx!P)R!Q!^)R!a$f)R$g~)R!Z/baiWOX0gXZ1qZ]0g]^1q^p0gqr0grs1qsw0gwx1qx!P0g!P!Q1q!Q!]0g!]!^)R!^!a1q!a$f0g$f$g1q$g~0g!Z0laiWOX0gXZ1qZ]0g]^1q^p0gqr0grs1qsw0gwx1qx!P0g!P!Q1q!Q!]0g!]!^2V!^!a1q!a$f0g$f$g1q$g~0g!R1tSOp1qq!]1q!]!^2Q!^~1q!R2VO`!R!Z2^XiW`!ROX)RZ])R^p)Rqr)Rsw)Rx!P)R!Q!^)R!a$f)R$g~)R!Z3SU!ax^P!``Or'rrs'Xsv'rw!^'r!^!_(]!_~'r!]3qe^PiW!``!bpOX$kXZ&RZ]$k]^&R^p$kpq&Rqr$krs&qsv$kvw)Rwx'rx}$k}!O5S!O!P$k!P!Q&R!Q!^$k!^!_(k!_!a&R!a$f$k$f$g&R$g~$k!]5_d^PiW!``!bpOX$kXZ&RZ]$k]^&R^p$kpq&Rqr$krs&qsv$kvw)Rwx'rx!P$k!P!Q&R!Q!^$k!^!_(k!_!`&R!`!a6m!a$f$k$f$g&R$g~$k!T6xV^P!``!bp!dQOr&Rrs&qsv&Rwx'rx!^&R!^!_(k!_~&R!X7hX^P!``!bpOr&Rrs&qsv&Rwx'rx!^&R!^!_(k!_!`&R!`!a8T!a~&R!X8`VjU^P!``!bpOr&Rrs&qsv&Rwx'rx!^&R!^!_(k!_~&R!a9U!YfSdQ^PiW!``!bpOX$kXZ&RZ]$k]^&R^p$kpq&Rqr$krs&qsv$kvw)Rwx'rx}$k}!O8u!O!P8u!P!Q&R!Q![8u![!]8u!]!^$k!^!_(k!_!a&R!a!c$k!c!}8u!}#R$k#R#S8u#S#T$k#T#o8u#o$f$k$f$g&R$g$}$k$}%O8u%O%W$k%W%o8u%o%p$k%p&a8u&a&b$k&b1p8u1p4U8u4U4d8u4d4e$k4e$IS8u$IS$I`$k$I`$Ib8u$Ib$Je$k$Je$Jg8u$Jg$Kh$k$Kh%#t8u%#t&/x$k&/x&Et8u&Et&FV$k&FV;'S8u;'S;:j<t;:j?&r$k?&r?Ah8u?Ah?BY$k?BY?Mn8u?Mn~$k!a=Pe^PiW!``!bpOX$kXZ&RZ]$k]^&R^p$kpq&Rqr$krs&qsv$kvw)Rwx'rx!P$k!P!Q&R!Q!^$k!^!_(k!_!a&R!a$f$k$f$g&R$g;=`$k;=`<%l8u<%l~$k!R>iW!``!bpOq(kqr?Rrs'gsv(kwx(]x!a(k!a!bKj!b~(k!R?YZ!``!bpOr(krs'gsv(kwx(]x}(k}!O?{!O!f(k!f!gAR!g#W(k#W#XGz#X~(k!R@SV!``!bpOr(krs'gsv(kwx(]x}(k}!O@i!O~(k!R@rT!``!bp!cPOr(krs'gsv(kwx(]x~(k!RAYV!``!bpOr(krs'gsv(kwx(]x!q(k!q!rAo!r~(k!RAvV!``!bpOr(krs'gsv(kwx(]x!e(k!e!fB]!f~(k!RBdV!``!bpOr(krs'gsv(kwx(]x!v(k!v!wBy!w~(k!RCQV!``!bpOr(krs'gsv(kwx(]x!{(k!{!|Cg!|~(k!RCnV!``!bpOr(krs'gsv(kwx(]x!r(k!r!sDT!s~(k!RD[V!``!bpOr(krs'gsv(kwx(]x!g(k!g!hDq!h~(k!RDxW!``!bpOrDqrsEbsvDqvwEvwxFfx!`Dq!`!aGb!a~DqqEgT!bpOvEbvxEvx!`Eb!`!aFX!a~EbPEyRO!`Ev!`!aFS!a~EvPFXOzPqF`Q!bpzPOv'gx~'gaFkV!``OrFfrsEvsvFfvwEvw!`Ff!`!aGQ!a~FfaGXR!``zPOr(]sv(]w~(]!RGkT!``!bpzPOr(krs'gsv(kwx(]x~(k!RHRV!``!bpOr(krs'gsv(kwx(]x#c(k#c#dHh#d~(k!RHoV!``!bpOr(krs'gsv(kwx(]x#V(k#V#WIU#W~(k!RI]V!``!bpOr(krs'gsv(kwx(]x#h(k#h#iIr#i~(k!RIyV!``!bpOr(krs'gsv(kwx(]x#m(k#m#nJ`#n~(k!RJgV!``!bpOr(krs'gsv(kwx(]x#d(k#d#eJ|#e~(k!RKTV!``!bpOr(krs'gsv(kwx(]x#X(k#X#YDq#Y~(k!RKqW!``!bpOrKjrsLZsvKjvwLowxNPx!aKj!a!b! g!b~KjqL`T!bpOvLZvxLox!aLZ!a!bM^!b~LZPLrRO!aLo!a!bL{!b~LoPMORO!`Lo!`!aMX!a~LoPM^OwPqMcT!bpOvLZvxLox!`LZ!`!aMr!a~LZqMyQ!bpwPOv'gx~'gaNUV!``OrNPrsLosvNPvwLow!aNP!a!bNk!b~NPaNpV!``OrNPrsLosvNPvwLow!`NP!`!a! V!a~NPa! ^R!``wPOr(]sv(]w~(]!R! nW!``!bpOrKjrsLZsvKjvwLowxNPx!`Kj!`!a!!W!a~Kj!R!!aT!``!bpwPOr(krs'gsv(kwx(]x~(k!V!!{VgS^P!``!bpOr&Rrs&qsv&Rwx'rx!^&R!^!_(k!_~&R",tokenizers:[gj,mj,bj,fj,dj,0,1,2,3,4,5],topRules:{Document:[0,13]},dialects:{noMatch:0},tokenPrec:464});function wj(t,e){let i=Object.create(null);for(let n of t.firstChild.getChildren("Attribute")){let t=n.getChild("AttributeName"),r=n.getChild("AttributeValue")||n.getChild("UnquotedAttributeValue");t&&(i[e.read(t.from,t.to)]=r?"AttributeValue"==r.name?e.read(r.from+1,r.to-1):e.read(r.from,r.to):"")}return i}function yj(t,e,i){let n;for(let r of i)if(!r.attrs||r.attrs(n||(n=wj(t.node.parent,e))))return{parser:r.parser};return null}function xj(t){let e=[],i=[],n=[];for(let r of t){let t="script"==r.tag?e:"style"==r.tag?i:"textarea"==r.tag?n:null;if(!t)throw new RangeError("Only script, style, and textarea tags can host nested parsers");t.push(r)}return r=(t,r)=>{let s=t.type.id;return 27==s?yj(t,r,e):30==s?yj(t,r,i):33==s?yj(t,r,n):null},(t,e,i,n)=>new UW(t,r,e,i,n);var r}const kj=1024;let Sj=0;class Cj{constructor(t,e){this.from=t,this.to=e}}class Aj{constructor(t={}){this.id=Sj++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=Pj.match(t)),e=>{let i=t(e);return void 0===i?null:[this,i]}}}Aj.closedBy=new Aj({deserialize:t=>t.split(" ")}),Aj.openedBy=new Aj({deserialize:t=>t.split(" ")}),Aj.group=new Aj({deserialize:t=>t.split(" ")}),Aj.contextHash=new Aj({perNode:!0}),Aj.lookAhead=new Aj({perNode:!0}),Aj.mounted=new Aj({perNode:!0});const Tj=Object.create(null);class Pj{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):Tj,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),n=new Pj(t.name||"",e,t.id,i);if(t.props)for(let i of t.props)if(Array.isArray(i)||(i=i(n)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[i[0].id]=i[1]}return n}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop(Aj.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return t=>{for(let i=t.prop(Aj.group),n=-1;n<(i?i.length:0);n++){let r=e[n<0?t.name:i[n]];if(r)return r}}}}Pj.none=new Pj("",Object.create(null),0,8);class Mj{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let i of this.types){let n=null;for(let e of t){let t=e(i);t&&(n||(n=Object.assign({},i.props)),n[t[0].id]=t[1])}e.push(n?new Pj(i.name,n,i.id,i.flags):i)}return new Mj(e)}}const Qj=new WeakMap,Rj=new WeakMap;var $j;!function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"}($j||($j={}));class _j{constructor(t,e,i,n,r){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,r&&r.length){this.props=Object.create(null);for(let[t,e]of r)this.props["number"==typeof t?t:t.id]=e}}toString(){let t=this.prop(Aj.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let i=t.toString();i&&(e&&(e+=","),e+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new qj(this.topNode,t)}cursorAt(t,e=0,i=0){let n=Qj.get(this)||this.topNode,r=new qj(n);return r.moveTo(t,e),Qj.set(this,r._tree),r}get topNode(){return new zj(this,0,0,null)}resolve(t,e=0){let i=Ij(Qj.get(this)||this.topNode,t,e,!1);return Qj.set(this,i),i}resolveInner(t,e=0){let i=Ij(Rj.get(this)||this.topNode,t,e,!0);return Rj.set(this,i),i}iterate(t){let{enter:e,leave:i,from:n=0,to:r=this.length}=t;for(let s=this.cursor((t.mode||0)|$j.IncludeAnonymous);;){let t=!1;if(s.from<=r&&s.to>=n&&(s.type.isAnonymous||!1!==e(s))){if(s.firstChild())continue;t=!0}for(;t&&i&&!s.type.isAnonymous&&i(s),!s.nextSibling();){if(!s.parent())return;t=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:Zj(Pj.none,this.children,this.positions,0,this.children.length,0,this.length,((t,e,i)=>new _j(this.type,t,e,i,this.propValues)),t.makeTree||((t,e,i)=>new _j(Pj.none,t,e,i)))}static build(t){return function(t){var e;let{buffer:i,nodeSet:n,maxBufferLength:r=kj,reused:s=[],minRepeatType:o=n.types.length}=t,l=Array.isArray(i)?new Dj(i,i.length):i,a=n.types,h=0,c=0;function u(t,e,i,b,O){let{id:v,start:w,end:y,size:x}=l,k=c;for(;x<0;){if(l.next(),-1==x){let e=s[v];return i.push(e),void b.push(w-t)}if(-3==x)return void(h=v);if(-4==x)return void(c=v);throw new RangeError(`Unrecognized record size: ${x}`)}let S,C,A=a[v],T=w-t;if(y-w<=r&&(C=g(l.pos-e,O))){let e=new Uint16Array(C.size-C.skip),i=l.pos-C.size,r=e.length;for(;l.pos>i;)r=m(C.start,e,r);S=new Ej(e,y-C.start,n),T=C.start-t}else{let t=l.pos-x;l.next();let e=[],i=[],n=v>=o?v:-1,s=0,a=y;for(;l.pos>t;)n>=0&&l.id==n&&l.size>=0?(l.end<=a-r&&(d(e,i,w,s,l.end,a,n,k),s=e.length,a=l.end),l.next()):u(w,t,e,i,n);if(n>=0&&s>0&&s<e.length&&d(e,i,w,s,w,a,n,k),e.reverse(),i.reverse(),n>-1&&s>0){let t=f(A);S=Zj(A,e,i,0,e.length,0,y-w,t,t)}else S=p(A,e,i,y-w,k-y)}i.push(S),b.push(T)}function f(t){return(e,i,n)=>{let r,s,o=0,l=e.length-1;if(l>=0&&(r=e[l])instanceof _j){if(!l&&r.type==t&&r.length==n)return r;(s=r.prop(Aj.lookAhead))&&(o=i[l]+r.length+s)}return p(t,e,i,n,o)}}function d(t,e,i,r,s,o,l,a){let h=[],c=[];for(;t.length>r;)h.push(t.pop()),c.push(e.pop()+i-s);t.push(p(n.types[l],h,c,o-s,a-o)),e.push(s-i)}function p(t,e,i,n,r=0,s){if(h){let t=[Aj.contextHash,h];s=s?[t].concat(s):[t]}if(r>25){let t=[Aj.lookAhead,r];s=s?[t].concat(s):[t]}return new _j(t,e,i,n,s)}function g(t,e){let i=l.fork(),n=0,s=0,a=0,h=i.end-r,c={size:0,start:0,skip:0};t:for(let r=i.pos-t;i.pos>r;){let t=i.size;if(i.id==e&&t>=0){c.size=n,c.start=s,c.skip=a,a+=4,n+=4,i.next();continue}let l=i.pos-t;if(t<0||l<r||i.start<h)break;let u=i.id>=o?4:0,f=i.start;for(i.next();i.pos>l;){if(i.size<0){if(-3!=i.size)break t;u+=4}else i.id>=o&&(u+=4);i.next()}s=f,n+=t,a+=u}return(e<0||n==t)&&(c.size=n,c.start=s,c.skip=a),c.size>4?c:void 0}function m(t,e,i){let{id:n,start:r,end:s,size:a}=l;if(l.next(),a>=0&&n<o){let o=i;if(a>4){let n=l.pos-(a-4);for(;l.pos>n;)i=m(t,e,i)}e[--i]=o,e[--i]=s-t,e[--i]=r-t,e[--i]=n}else-3==a?h=n:-4==a&&(c=n);return i}let b=[],O=[];for(;l.pos>0;)u(t.start||0,t.bufferStart||0,b,O,-1);let v=null!==(e=t.length)&&void 0!==e?e:b.length?O[0]+b[0].length:0;return new _j(a[t.topID],b.reverse(),O.reverse(),v)}(t)}}_j.empty=new _j(Pj.none,[],[],0);class Dj{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Dj(this.buffer,this.index)}}class Ej{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return Pj.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],r=n.name;if(/\W/.test(r)&&!n.isError&&(r=JSON.stringify(r)),i==(t+=4))return r;let s=[];for(;t<i;)s.push(this.childString(t)),t=this.buffer[t+3];return r+"("+s.join(",")+")"}findChild(t,e,i,n,r){let{buffer:s}=this,o=-1;for(let l=t;l!=e&&!(Nj(r,n,s[l+1],s[l+2])&&(o=l,i>0));l=s[l+3]);return o}slice(t,e,i,n){let r=this.buffer,s=new Uint16Array(e-t);for(let n=t,o=0;n<e;)s[o++]=r[n++],s[o++]=r[n++]-i,s[o++]=r[n++]-i,s[o++]=r[n++]-t;return new Ej(s,n-i,this.set)}}function Nj(t,e,i,n){switch(t){case-2:return i<e;case-1:return n>=e&&i<e;case 0:return i<e&&n>e;case 1:return i<=e&&n>e;case 2:return n>e;case 4:return!0}}function Bj(t,e){let i=t.childBefore(e);for(;i;){let e=i.lastChild;if(!e||e.to!=i.to)break;e.type.isError&&e.from==e.to?(t=i,i=e.prevSibling):i=e}return t}function Ij(t,e,i,n){for(var r;t.from==t.to||(i<1?t.from>=e:t.from>e)||(i>-1?t.to<=e:t.to<e);){let e=!n&&t instanceof zj&&t.index<0?null:t.parent;if(!e)return t;t=e}let s=n?0:$j.IgnoreOverlays;if(n)for(let n=t,o=n.parent;o;n=o,o=n.parent)n instanceof zj&&n.index<0&&(null===(r=o.enter(e,i,s))||void 0===r?void 0:r.from)!=n.from&&(t=o);for(;;){let n=t.enter(e,i,s);if(!n)return t;t=n}}class zj{constructor(t,e,i,n){this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,r=0){for(let s=this;;){for(let{children:o,positions:l}=s._tree,a=e>0?o.length:-1;t!=a;t+=e){let a=o[t],h=l[t]+s.from;if(Nj(n,i,h,h+a.length))if(a instanceof Ej){if(r&$j.ExcludeBuffers)continue;let o=a.findChild(0,a.buffer.length,e,i-h,n);if(o>-1)return new jj(new Vj(s,a,t,h),null,o)}else if(r&$j.IncludeAnonymous||!a.type.isAnonymous||Hj(a)){let o;if(!(r&$j.IgnoreMounts)&&a.props&&(o=a.prop(Aj.mounted))&&!o.overlay)return new zj(o.tree,h,t,s);let l=new zj(a,h,t,s);return r&$j.IncludeAnonymous||!l.type.isAnonymous?l:l.nextChild(e<0?a.children.length-1:0,e,i,n)}}if(r&$j.IncludeAnonymous||!s.type.isAnonymous)return null;if(t=s.index>=0?s.index+e:e<0?-1:s._parent._tree.children.length,s=s._parent,!s)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&$j.IgnoreOverlays)&&(n=this._tree.prop(Aj.mounted))&&n.overlay){let i=t-this.from;for(let{from:t,to:r}of n.overlay)if((e>0?t<=i:t<i)&&(e<0?r>=i:r>i))return new zj(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new qj(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return Ij(this,t,e,!1)}resolveInner(t,e=0){return Ij(this,t,e,!0)}enterUnfinishedNodesBefore(t){return Bj(this,t)}getChild(t,e=null,i=null){let n=Lj(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return Lj(this,t,e,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return Wj(this,t)}}function Lj(t,e,i,n){let r=t.cursor(),s=[];if(!r.firstChild())return s;if(null!=i)for(;!r.type.is(i);)if(!r.nextSibling())return s;for(;;){if(null!=n&&r.type.is(n))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return null==n?s:[]}}function Wj(t,e,i=e.length-1){for(let n=t.parent;i>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[i]&&e[i]!=n.name)return!1;i--}}return!0}class Vj{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class jj{constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(t,e,i){let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return r<0?null:new jj(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&$j.ExcludeBuffers)return null;let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new jj(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new jj(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new jj(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new qj(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,r=i.buffer[this.index+3];if(r>n){let s=i.buffer[this.index+1],o=i.buffer[this.index+2];t.push(i.slice(n,r,s,o)),e.push(0)}return new _j(this.type,t,e,this.to-this.from)}resolve(t,e=0){return Ij(this,t,e,!1)}resolveInner(t,e=0){return Ij(this,t,e,!0)}enterUnfinishedNodesBefore(t){return Bj(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let n=Lj(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return Lj(this,t,e,i)}get node(){return this}matchContext(t){return Wj(this,t)}}class qj{constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof zj)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}get name(){return this.type.name}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return!!t&&(t instanceof zj?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?!(i&$j.ExcludeBuffers)&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&$j.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&$j.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let t=i<0?0:this.stack[i]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(t)}return i<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(n.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;({index:e,_parent:i}=i))if(e>-1)for(let n=e+t,r=t<0?-1:i._tree.children.length;n!=r;n+=t){let t=i._tree.children[n];if(this.mode&$j.IncludeAnonymous||t instanceof Ej||!t.type.isAnonymous||Hj(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,r=this.stack.length;r>=0;){for(let s=t;s;s=s._parent)if(s.index==n){if(n==this.index)return s;e=s,i=r+1;break t}n=this.stack[--r]}for(let t=i;t<this.stack.length;t++)e=new jj(this.buffer,e,this.stack[t]);return this.bufferNode=new jj(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||!1!==t(this)){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;n&&e&&e(this),n=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return Wj(this.node,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,r=this.stack.length-1;n>=0;r--){if(r<0)return Wj(this.node,t,n);let s=i[e.buffer[this.stack[r]]];if(!s.isAnonymous){if(t[n]&&t[n]!=s.name)return!1;n--}}return!0}}function Hj(t){return t.children.some((t=>t instanceof Ej||!t.type.isAnonymous||Hj(t)))}const Xj=new WeakMap;function Fj(t,e){if(!t.isAnonymous||e instanceof Ej||e.type!=t)return 1;let i=Xj.get(e);if(null==i){i=1;for(let n of e.children){if(n.type!=t||!(n instanceof _j)){i=1;break}i+=Fj(t,n)}Xj.set(e,i)}return i}function Zj(t,e,i,n,r,s,o,l,a){let h=0;for(let i=n;i<r;i++)h+=Fj(t,e[i]);let c=Math.ceil(1.5*h/8),u=[],f=[];return function e(i,n,r,o,l){for(let h=r;h<o;){let r=h,d=n[h],p=Fj(t,i[h]);for(h++;h<o;h++){let e=Fj(t,i[h]);if(p+e>=c)break;p+=e}if(h==r+1){if(p>c){let t=i[r];e(t.children,t.positions,0,t.children.length,n[r]+l);continue}u.push(i[r])}else{let e=n[h-1]+i[h-1].length-d;u.push(Zj(t,i,n,r,h,d,e,null,a))}f.push(d+l-s)}}(e,i,n,r,0),(l||a)(u,f,o)}class Gj{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new Aj({perNode:!0});class Uj{constructor(t,e,i,n,r,s,o,l,a,h=0,c){this.p=t,this.stack=e,this.state=i,this.reducePos=n,this.pos=r,this.score=s,this.buffer=o,this.bufferBase=l,this.curContext=a,this.lookAhead=h,this.parent=c}toString(){return`[${this.stack.filter(((t,e)=>e%3==0)).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,e,i=0){let n=t.parser.context;return new Uj(t,[],e,i,i,0,[],0,n?new Yj(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(t,e){this.stack.push(this.state,e,this.bufferBase+this.buffer.length),this.state=t}reduce(t){let e=t>>19,i=65535&t,{parser:n}=this.p,r=n.dynamicPrecedence(i);if(r&&(this.score+=r),0==e)return this.pushState(n.getGoto(this.state,i,!0),this.reducePos),i<n.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,4,!0),void this.reduceContext(i,this.reducePos);let s=this.stack.length-3*(e-1)-(262144&t?6:0),o=this.stack[s-2],l=this.stack[s-1],a=this.bufferBase+this.buffer.length-l;if(i<n.minRepeatTerm||131072&t){let t=n.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,o,t,a+4,!0)}if(262144&t)this.state=this.stack[s];else{let t=this.stack[s-3];this.state=n.getGoto(t,i,!0)}for(;this.stack.length>s;)this.stack.pop();this.reduceContext(i,o)}storeNode(t,e,i,n=4,r=!1){if(0==t&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let t=this,n=this.buffer.length;if(0==n&&t.parent&&(n=t.bufferBase-t.parent.bufferBase,t=t.parent),n>0&&0==t.buffer[n-4]&&t.buffer[n-1]>-1){if(e==i)return;if(t.buffer[n-2]>=e)return void(t.buffer[n-2]=i)}}if(r&&this.pos!=i){let r=this.buffer.length;if(r>0&&0!=this.buffer[r-4])for(;r>0&&this.buffer[r-2]>i;)this.buffer[r]=this.buffer[r-4],this.buffer[r+1]=this.buffer[r-3],this.buffer[r+2]=this.buffer[r-2],this.buffer[r+3]=this.buffer[r-1],r-=4,n>4&&(n-=4);this.buffer[r]=t,this.buffer[r+1]=e,this.buffer[r+2]=i,this.buffer[r+3]=n}else this.buffer.push(t,e,i,n)}shift(t,e,i){let n=this.pos;if(131072&t)this.pushState(65535&t,this.pos);else if(0==(262144&t)){let r=t,{parser:s}=this.p;(i>this.pos||e<=s.maxNode)&&(this.pos=i,s.stateFlag(r,1)||(this.reducePos=i)),this.pushState(r,n),this.shiftContext(e,n),e<=s.maxNode&&this.buffer.push(e,n,i,4)}else this.pos=i,this.shiftContext(e,n),e<=this.p.parser.maxNode&&this.buffer.push(e,n,i,4)}apply(t,e,i){65536&t?this.reduce(t):this.shift(t,e,i)}useNode(t,e){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=t)&&(this.p.reused.push(t),i++);let n=this.pos;this.reducePos=this.pos=n+t.length,this.pushState(e,n),this.buffer.push(i,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,t,this,this.p.stream.reset(this.pos-t.length)))}split(){let t=this,e=t.buffer.length;for(;e>0&&t.buffer[e-2]>t.reducePos;)e-=4;let i=t.buffer.slice(e),n=t.bufferBase+e;for(;t&&n==t.bufferBase;)t=t.parent;return new Uj(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,n,this.curContext,this.lookAhead,t)}recoverByDelete(t,e){let i=t<=this.p.parser.maxNode;i&&this.storeNode(t,this.pos,e,4),this.storeNode(0,this.pos,e,i?8:4),this.pos=this.reducePos=e,this.score-=190}canShift(t){for(let e=new Jj(this);;){let i=this.p.parser.stateSlot(e.state,4)||this.p.parser.hasAction(e.state,t);if(0==(65536&i))return!0;if(0==i)return!1;e.reduce(i)}}recoverByInsert(t){if(this.stack.length>=300)return[];let e=this.p.parser.nextStates(this.state);if(e.length>8||this.stack.length>=120){let i=[];for(let n,r=0;r<e.length;r+=2)(n=e[r+1])!=this.state&&this.p.parser.hasAction(n,t)&&i.push(e[r],n);if(this.stack.length<120)for(let t=0;i.length<8&&t<e.length;t+=2){let n=e[t+1];i.some(((t,e)=>1&e&&t==n))||i.push(e[t],n)}e=i}let i=[];for(let t=0;t<e.length&&i.length<4;t+=2){let n=e[t+1];if(n==this.state)continue;let r=this.split();r.pushState(n,this.pos),r.storeNode(0,r.pos,r.pos,4,!0),r.shiftContext(e[t],this.pos),r.score-=200,i.push(r)}return i}forceReduce(){let t=this.p.parser.stateSlot(this.state,5);if(0==(65536&t))return!1;let{parser:e}=this.p;if(!e.validAction(this.state,t)){let i=t>>19,n=65535&t,r=this.stack.length-3*i;if(r<0||e.getGoto(this.stack[r],n,!1)<0)return!1;this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:t}=this.p;return 65535==t.data[t.stateSlot(this.state,1)]&&!t.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(t){if(this.state!=t.state||this.stack.length!=t.stack.length)return!1;for(let e=0;e<this.stack.length;e+=3)if(this.stack[e]!=t.stack[e])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(t){return this.p.parser.dialect.flags[t]}shiftContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,t,this,this.p.stream.reset(e)))}reduceContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,t,this,this.p.stream.reset(e)))}emitContext(){let t=this.buffer.length-1;(t<0||-3!=this.buffer[t])&&this.buffer.push(this.curContext.hash,this.reducePos,this.reducePos,-3)}emitLookAhead(){let t=this.buffer.length-1;(t<0||-4!=this.buffer[t])&&this.buffer.push(this.lookAhead,this.reducePos,this.reducePos,-4)}updateContext(t){if(t!=this.curContext.context){let e=new Yj(this.curContext.tracker,t);e.hash!=this.curContext.hash&&this.emitContext(),this.curContext=e}}setLookAhead(t){t>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=t)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class Yj{constructor(t,e){this.tracker=t,this.context=e,this.hash=t.strict?t.hash(e):0}}var Kj;!function(t){t[t.Insert=200]="Insert",t[t.Delete=190]="Delete",t[t.Reduce=100]="Reduce",t[t.MaxNext=4]="MaxNext",t[t.MaxInsertStackDepth=300]="MaxInsertStackDepth",t[t.DampenInsertStackDepth=120]="DampenInsertStackDepth"}(Kj||(Kj={}));class Jj{constructor(t){this.start=t,this.state=t.state,this.stack=t.stack,this.base=this.stack.length}reduce(t){let e=65535&t,i=t>>19;0==i?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(i-1);let n=this.start.p.parser.getGoto(this.stack[this.base-3],e,!0);this.state=n}}class tq{constructor(t,e,i){this.stack=t,this.pos=e,this.index=i,this.buffer=t.buffer,0==this.index&&this.maybeNext()}static create(t,e=t.bufferBase+t.buffer.length){return new tq(t,e,e-t.bufferBase)}maybeNext(){let t=this.stack.parent;null!=t&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new tq(this.stack,this.pos,this.index)}}class eq{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const iq=new eq;class nq{constructor(t,e){this.input=t,this.ranges=e,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=iq,this.rangeIndex=0,this.pos=this.chunkPos=e[0].from,this.range=e[0],this.end=e[e.length-1].to,this.readNext()}resolveOffset(t,e){let i=this.range,n=this.rangeIndex,r=this.pos+t;for(;r<i.from;){if(!n)return null;let t=this.ranges[--n];r-=i.from-t.to,i=t}for(;e<0?r>i.to:r>=i.to;){if(n==this.ranges.length-1)return null;let t=this.ranges[++n];r+=t.from-i.to,i=t}return r}peek(t){let e,i,n=this.chunkOff+t;if(n>=0&&n<this.chunk.length)e=this.pos+t,i=this.chunk.charCodeAt(n);else{let n=this.resolveOffset(t,1);if(null==n)return-1;if(e=n,e>=this.chunk2Pos&&e<this.chunk2Pos+this.chunk2.length)i=this.chunk2.charCodeAt(e-this.chunk2Pos);else{let t=this.rangeIndex,n=this.range;for(;n.to<=e;)n=this.ranges[++t];this.chunk2=this.input.chunk(this.chunk2Pos=e),e+this.chunk2.length>n.to&&(this.chunk2=this.chunk2.slice(0,n.to-e)),i=this.chunk2.charCodeAt(0)}}return e>=this.token.lookAhead&&(this.token.lookAhead=e+1),i}acceptToken(t,e=0){let i=e?this.resolveOffset(e,-1):this.pos;if(null==i||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=t,this.token.end=i}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:t,chunkPos:e}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=t,this.chunk2Pos=e,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let t=this.input.chunk(this.pos),e=this.pos+t.length;this.chunk=e>this.range.to?t.slice(0,this.range.to-this.pos):t,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(t=1){for(this.chunkOff+=t;this.pos+t>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();t-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=t,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(t,e){if(e?(this.token=e,e.start=t,e.lookAhead=t+1,e.value=e.extended=-1):this.token=iq,this.pos!=t){if(this.pos=t,t==this.end)return this.setDone(),this;for(;t<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;t>=this.range.to;)this.range=this.ranges[++this.rangeIndex];t>=this.chunkPos&&t<this.chunkPos+this.chunk.length?this.chunkOff=t-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(t,e){if(t>=this.chunkPos&&e<=this.chunkPos+this.chunk.length)return this.chunk.slice(t-this.chunkPos,e-this.chunkPos);if(t>=this.chunk2Pos&&e<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(t-this.chunk2Pos,e-this.chunk2Pos);if(t>=this.range.from&&e<=this.range.to)return this.input.read(t,e);let i="";for(let n of this.ranges){if(n.from>=e)break;n.to>t&&(i+=this.input.read(Math.max(n.from,t),Math.min(n.to,e)))}return i}}class rq{constructor(t,e){this.data=t,this.id=e}token(t,e){!function(t,e,i,n){let r=0,s=1<<n,{parser:o}=i.p,{dialect:l}=o;t:for(;0!=(s&t[r]);){let i=t[r+1];for(let n=r+3;n<i;n+=2)if((t[n+1]&s)>0){let i=t[n];if(l.allows(i)&&(-1==e.token.value||e.token.value==i||o.overrides(i,e.token.value))){e.acceptToken(i);break}}let n=e.next,a=0,h=t[r+2];if(!(e.next<0&&h>a&&65535==t[i+3*h-3])){for(;a<h;){let s=a+h>>1,o=i+s+(s<<1),l=t[o],c=t[o+1];if(n<l)h=s;else{if(!(n>=c)){r=t[o+2],e.advance();continue t}a=s+1}}break}r=t[i+3*h-1]}}(this.data,t,e,this.id)}}rq.prototype.contextual=rq.prototype.fallback=rq.prototype.extend=!1;class sq{constructor(t,e={}){this.token=t,this.contextual=!!e.contextual,this.fallback=!!e.fallback,this.extend=!!e.extend}}function oq(t,e=Uint16Array){if("string"!=typeof t)return t;let i=null;for(let n=0,r=0;n<t.length;){let s=0;for(;;){let e=t.charCodeAt(n++),i=!1;if(126==e){s=65535;break}e>=92&&e--,e>=34&&e--;let r=e-32;if(r>=46&&(r-=46,i=!0),s+=r,i)break;s*=46}i?i[r++]=s:i=new e(s)}return i}const lq="undefined"!=typeof process&&process.env&&/\bparse\b/.test(process.env.LOG);let aq=null;var hq,cq;function uq(t,e,i){let n=t.cursor($j.IncludeAnonymous);for(n.moveTo(e);;)if(!(i<0?n.childBefore(e):n.childAfter(e)))for(;;){if((i<0?n.to<e:n.from>e)&&!n.type.isError)return i<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(t.length,Math.max(n.from+1,e+25));if(i<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return i<0?0:t.length}}!function(t){t[t.Margin=25]="Margin"}(hq||(hq={}));class fq{constructor(t,e){this.fragments=t,this.nodeSet=e,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let t=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(t){for(this.safeFrom=t.openStart?uq(t.tree,t.from+t.offset,1)-t.offset:t.from,this.safeTo=t.openEnd?uq(t.tree,t.to+t.offset,-1)-t.offset:t.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(t.tree),this.start.push(-t.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(t){if(t<this.nextStart)return null;for(;this.fragment&&this.safeTo<=t;)this.nextFragment();if(!this.fragment)return null;for(;;){let e=this.trees.length-1;if(e<0)return this.nextFragment(),null;let i=this.trees[e],n=this.index[e];if(n==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let r=i.children[n],s=this.start[e]+i.positions[n];if(s>t)return this.nextStart=s,null;if(r instanceof _j){if(s==t){if(s<this.safeFrom)return null;let t=s+r.length;if(t<=this.safeTo){let e=r.prop(Aj.lookAhead);if(!e||t+e<this.fragment.to)return r}}this.index[e]++,s+r.length>=Math.max(this.safeFrom,t)&&(this.trees.push(r),this.start.push(s),this.index.push(0))}else this.index[e]++,this.nextStart=s+r.length}}}class dq{constructor(t,e){this.stream=e,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=t.tokenizers.map((t=>new eq))}getActions(t){let e=0,i=null,{parser:n}=t.p,{tokenizers:r}=n,s=n.stateSlot(t.state,3),o=t.curContext?t.curContext.hash:0,l=0;for(let n=0;n<r.length;n++){if(0==(1<<n&s))continue;let a=r[n],h=this.tokens[n];if((!i||a.fallback)&&((a.contextual||h.start!=t.pos||h.mask!=s||h.context!=o)&&(this.updateCachedToken(h,a,t),h.mask=s,h.context=o),h.lookAhead>h.end+25&&(l=Math.max(h.lookAhead,l)),0!=h.value)){let n=e;if(h.extended>-1&&(e=this.addActions(t,h.extended,h.end,e)),e=this.addActions(t,h.value,h.end,e),!a.extend&&(i=h,e>n))break}}for(;this.actions.length>e;)this.actions.pop();return l&&t.setLookAhead(l),i||t.pos!=this.stream.end||(i=new eq,i.value=t.p.parser.eofTerm,i.start=i.end=t.pos,e=this.addActions(t,i.value,i.end,e)),this.mainToken=i,this.actions}getMainToken(t){if(this.mainToken)return this.mainToken;let e=new eq,{pos:i,p:n}=t;return e.start=i,e.end=Math.min(i+1,n.stream.end),e.value=i==n.stream.end?n.parser.eofTerm:0,e}updateCachedToken(t,e,i){if(e.token(this.stream.reset(i.pos,t),i),t.value>-1){let{parser:e}=i.p;for(let n=0;n<e.specialized.length;n++)if(e.specialized[n]==t.value){let r=e.specializers[n](this.stream.read(t.start,t.end),i);if(r>=0&&i.p.parser.dialect.allows(r>>1)){0==(1&r)?t.value=r>>1:t.extended=r>>1;break}}}else t.value=0,t.end=Math.min(i.p.stream.end,i.pos+1)}putAction(t,e,i,n){for(let e=0;e<n;e+=3)if(this.actions[e]==t)return n;return this.actions[n++]=t,this.actions[n++]=e,this.actions[n++]=i,n}addActions(t,e,i,n){let{state:r}=t,{parser:s}=t.p,{data:o}=s;for(let t=0;t<2;t++)for(let l=s.stateSlot(r,t?2:1);;l+=3){if(65535==o[l]){if(1!=o[l+1]){0==n&&2==o[l+1]&&(n=this.putAction(Oq(o,l+2),e,i,n));break}l=Oq(o,l+2)}o[l]==e&&(n=this.putAction(Oq(o,l+1),e,i,n))}return n}}!function(t){t[t.Distance=5]="Distance",t[t.MaxRemainingPerStep=3]="MaxRemainingPerStep",t[t.MinBufferLengthPrune=500]="MinBufferLengthPrune",t[t.ForceReduceLimit=10]="ForceReduceLimit",t[t.CutDepth=15e3]="CutDepth",t[t.CutTo=9e3]="CutTo"}(cq||(cq={}));class pq{constructor(t,e,i,n){this.parser=t,this.input=e,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.stream=new nq(e,n),this.tokens=new dq(t,this.stream),this.topTerm=t.top[1];let{from:r}=n[0];this.stacks=[Uj.start(this,t.top[0],r)],this.fragments=i.length&&this.stream.end-r>4*t.bufferLength?new fq(i,t.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let t,e,i=this.stacks,n=this.minStackPos,r=this.stacks=[];for(let s=0;s<i.length;s++){let o=i[s];for(;;){if(this.tokens.mainToken=null,o.pos>n)r.push(o);else{if(this.advanceStack(o,r,i))continue;{t||(t=[],e=[]),t.push(o);let i=this.tokens.getMainToken(o);e.push(i.value,i.end)}}break}}if(!r.length){let e=t&&function(t){let e=null;for(let i of t){let t=i.p.stoppedAt;(i.pos==i.p.stream.end||null!=t&&i.pos>t)&&i.p.parser.stateFlag(i.state,2)&&(!e||e.score<i.score)&&(e=i)}return e}(t);if(e)return this.stackToTree(e);if(this.parser.strict)throw lq&&t&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+n);this.recovering||(this.recovering=5)}if(this.recovering&&t){let i=null!=this.stoppedAt&&t[0].pos>this.stoppedAt?t[0]:this.runRecovery(t,e,r);if(i)return this.stackToTree(i.forceAll())}if(this.recovering){let t=1==this.recovering?1:3*this.recovering;if(r.length>t)for(r.sort(((t,e)=>e.score-t.score));r.length>t;)r.pop();r.some((t=>t.reducePos>n))&&this.recovering--}else if(r.length>1)t:for(let t=0;t<r.length-1;t++){let e=r[t];for(let i=t+1;i<r.length;i++){let n=r[i];if(e.sameState(n)||e.buffer.length>500&&n.buffer.length>500){if(!((e.score-n.score||e.buffer.length-n.buffer.length)>0)){r.splice(t--,1);continue t}r.splice(i--,1)}}}this.minStackPos=r[0].pos;for(let t=1;t<r.length;t++)r[t].pos<this.minStackPos&&(this.minStackPos=r[t].pos);return null}stopAt(t){if(null!=this.stoppedAt&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}advanceStack(t,e,i){let n=t.pos,{parser:r}=this,s=lq?this.stackID(t)+" -> ":"";if(null!=this.stoppedAt&&n>this.stoppedAt)return t.forceReduce()?t:null;if(this.fragments){let e=t.curContext&&t.curContext.tracker.strict,i=e?t.curContext.hash:0;for(let o=this.fragments.nodeAt(n);o;){let n=this.parser.nodeSet.types[o.type.id]==o.type?r.getGoto(t.state,o.type.id):-1;if(n>-1&&o.length&&(!e||(o.prop(Aj.contextHash)||0)==i))return t.useNode(o,n),lq&&console.log(s+this.stackID(t)+` (via reuse of ${r.getName(o.type.id)})`),!0;if(!(o instanceof _j)||0==o.children.length||o.positions[0]>0)break;let l=o.children[0];if(!(l instanceof _j&&0==o.positions[0]))break;o=l}}let o=r.stateSlot(t.state,4);if(o>0)return t.reduce(o),lq&&console.log(s+this.stackID(t)+` (via always-reduce ${r.getName(65535&o)})`),!0;if(t.stack.length>=15e3)for(;t.stack.length>9e3&&t.forceReduce(););let l=this.tokens.getActions(t);for(let o=0;o<l.length;){let a=l[o++],h=l[o++],c=l[o++],u=o==l.length||!i,f=u?t:t.split();if(f.apply(a,h,c),lq&&console.log(s+this.stackID(f)+` (via ${0==(65536&a)?"shift":`reduce of ${r.getName(65535&a)}`} for ${r.getName(h)} @ ${n}${f==t?"":", split"})`),u)return!0;f.pos>n?e.push(f):i.push(f)}return!1}advanceFully(t,e){let i=t.pos;for(;;){if(!this.advanceStack(t,null,null))return!1;if(t.pos>i)return gq(t,e),!0}}runRecovery(t,e,i){let n=null,r=!1;for(let s=0;s<t.length;s++){let o=t[s],l=e[s<<1],a=e[1+(s<<1)],h=lq?this.stackID(o)+" -> ":"";if(o.deadEnd){if(r)continue;if(r=!0,o.restart(),lq&&console.log(h+this.stackID(o)+" (restarted)"),this.advanceFully(o,i))continue}let c=o.split(),u=h;for(let t=0;c.forceReduce()&&t<10;t++){if(lq&&console.log(u+this.stackID(c)+" (via force-reduce)"),this.advanceFully(c,i))break;lq&&(u=this.stackID(c)+" -> ")}for(let t of o.recoverByInsert(l))lq&&console.log(h+this.stackID(t)+" (via recover-insert)"),this.advanceFully(t,i);this.stream.end>o.pos?(a==o.pos&&(a++,l=0),o.recoverByDelete(l,a),lq&&console.log(h+this.stackID(o)+` (via recover-delete ${this.parser.getName(l)})`),gq(o,i)):(!n||n.score<o.score)&&(n=o)}return n}stackToTree(t){return t.close(),_j.build({buffer:tq.create(t),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:t.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(t){let e=(aq||(aq=new WeakMap)).get(t);return e||aq.set(t,e=String.fromCodePoint(this.nextStackID++)),e+t}}function gq(t,e){for(let i=0;i<e.length;i++){let n=e[i];if(n.pos==t.pos&&n.sameState(t))return void(e[i].score<t.score&&(e[i]=t))}e.push(t)}class mq{constructor(t,e,i){this.source=t,this.flags=e,this.disabled=i}allows(t){return!this.disabled||0==this.disabled[t]}}class bq extends class{startParse(t,e,i){return"string"==typeof t&&(t=new Gj(t)),i=i?i.length?i.map((t=>new Cj(t.from,t.to))):[new Cj(0,0)]:[new Cj(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let t=n.advance();if(t)return t}}}{constructor(t){if(super(),this.wrappers=[],14!=t.version)throw new RangeError(`Parser version (${t.version}) doesn't match runtime version (14)`);let e=t.nodeNames.split(" ");this.minRepeatTerm=e.length;for(let i=0;i<t.repeatNodeCount;i++)e.push("");let i=Object.keys(t.topRules).map((e=>t.topRules[e][1])),n=[];for(let t=0;t<e.length;t++)n.push([]);function r(t,e,i){n[t].push([e,e.deserialize(String(i))])}if(t.nodeProps)for(let e of t.nodeProps){let t=e[0];"string"==typeof t&&(t=Aj[t]);for(let i=1;i<e.length;){let n=e[i++];if(n>=0)r(n,t,e[i++]);else{let s=e[i+-n];for(let o=-n;o>0;o--)r(e[i++],t,s);i++}}}this.nodeSet=new Mj(e.map(((e,r)=>Pj.define({name:r>=this.minRepeatTerm?void 0:e,id:r,props:n[r],top:i.indexOf(r)>-1,error:0==r,skipped:t.skippedNodes&&t.skippedNodes.indexOf(r)>-1})))),t.propSources&&(this.nodeSet=this.nodeSet.extend(...t.propSources)),this.strict=!1,this.bufferLength=kj;let s=oq(t.tokenData);if(this.context=t.context,this.specialized=new Uint16Array(t.specialized?t.specialized.length:0),this.specializers=[],t.specialized)for(let e=0;e<t.specialized.length;e++)this.specialized[e]=t.specialized[e].term,this.specializers[e]=t.specialized[e].get;this.states=oq(t.states,Uint32Array),this.data=oq(t.stateData),this.goto=oq(t.goto),this.maxTerm=t.maxTerm,this.tokenizers=t.tokenizers.map((t=>"number"==typeof t?new rq(s,t):t)),this.topRules=t.topRules,this.dialects=t.dialects||{},this.dynamicPrecedences=t.dynamicPrecedences||null,this.tokenPrecTable=t.tokenPrec,this.termNames=t.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(t,e,i){let n=new pq(this,t,e,i);for(let r of this.wrappers)n=r(n,t,e,i);return n}getGoto(t,e,i=!1){let n=this.goto;if(e>=n[0])return-1;for(let r=n[e+1];;){let e=n[r++],s=1&e,o=n[r++];if(s&&i)return o;for(let i=r+(e>>1);r<i;r++)if(n[r]==t)return o;if(s)return-1}}hasAction(t,e){let i=this.data;for(let n=0;n<2;n++)for(let r,s=this.stateSlot(t,n?2:1);;s+=3){if(65535==(r=i[s])){if(1!=i[s+1]){if(2==i[s+1])return Oq(i,s+2);break}r=i[s=Oq(i,s+2)]}if(r==e||0==r)return Oq(i,s+1)}return 0}stateSlot(t,e){return this.states[6*t+e]}stateFlag(t,e){return(this.stateSlot(t,0)&e)>0}validAction(t,e){if(e==this.stateSlot(t,4))return!0;for(let i=this.stateSlot(t,1);;i+=3){if(65535==this.data[i]){if(1!=this.data[i+1])return!1;i=Oq(this.data,i+2)}if(e==Oq(this.data,i+1))return!0}}nextStates(t){let e=[];for(let i=this.stateSlot(t,1);;i+=3){if(65535==this.data[i]){if(1!=this.data[i+1])break;i=Oq(this.data,i+2)}if(0==(1&this.data[i+2])){let t=this.data[i+1];e.some(((e,i)=>1&i&&e==t))||e.push(this.data[i],t)}}return e}overrides(t,e){let i=vq(this.data,this.tokenPrecTable,e);return i<0||vq(this.data,this.tokenPrecTable,t)<i}configure(t){let e=Object.assign(Object.create(bq.prototype),this);if(t.props&&(e.nodeSet=this.nodeSet.extend(...t.props)),t.top){let i=this.topRules[t.top];if(!i)throw new RangeError(`Invalid top rule name ${t.top}`);e.top=i}return t.tokenizers&&(e.tokenizers=this.tokenizers.map((e=>{let i=t.tokenizers.find((t=>t.from==e));return i?i.to:e}))),t.specializers&&(e.specializers=this.specializers.map((e=>{let i=t.specializers.find((t=>t.from==e));return i?i.to:e}))),t.contextTracker&&(e.context=t.contextTracker),t.dialect&&(e.dialect=this.parseDialect(t.dialect)),null!=t.strict&&(e.strict=t.strict),t.wrap&&(e.wrappers=e.wrappers.concat(t.wrap)),null!=t.bufferLength&&(e.bufferLength=t.bufferLength),e}hasWrappers(){return this.wrappers.length>0}getName(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.nodeSet.types[t].name||t)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(t){let e=this.dynamicPrecedences;return null==e?0:e[t]||0}parseDialect(t){let e=Object.keys(this.dialects),i=e.map((()=>!1));if(t)for(let n of t.split(" ")){let t=e.indexOf(n);t>=0&&(i[t]=!0)}let n=null;for(let t=0;t<e.length;t++)if(!i[t])for(let i,r=this.dialects[e[t]];65535!=(i=this.data[r++]);)(n||(n=new Uint8Array(this.maxTerm+1)))[i]=1;return new mq(t,i,n)}static deserialize(t){return new bq(t)}}function Oq(t,e){return t[e]|t[e+1]<<16}function vq(t,e,i){for(let n,r=e;65535!=(n=t[r]);r++)if(n==i)return r-e;return-1}let wq=0;class yq{constructor(t,e,i){this.set=t,this.base=e,this.modified=i,this.id=wq++}static define(t){if(null==t?void 0:t.base)throw new Error("Can not derive from a modified tag");let e=new yq([],null,[]);if(e.set.push(e),t)for(let i of t.set)e.set.push(i);return e}static defineModifier(){let t=new kq;return e=>e.modified.indexOf(t)>-1?e:kq.get(e.base||e,e.modified.concat(t).sort(((t,e)=>t.id-e.id)))}}let xq=0;class kq{constructor(){this.instances=[],this.id=xq++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find((i=>{return i.base==t&&(n=e,r=i.modified,n.length==r.length&&n.every(((t,e)=>t==r[e])));var n,r}));if(i)return i;let n=[],r=new yq(n,t,e);for(let t of e)t.instances.push(r);let s=Sq(e);for(let e of t.set)for(let t of s)n.push(kq.get(e,t));return r}}function Sq(t){let e=[t];for(let i=0;i<t.length;i++)for(let n of Sq(t.slice(0,i).concat(t.slice(i+1))))e.push(n);return e}const Cq=new Aj;class Aq{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}const Tq=yq.define,Pq=Tq(),Mq=Tq(),Qq=Tq(Mq),Rq=Tq(Mq),$q=Tq(),_q=Tq($q),Dq=Tq($q),Eq=Tq(),Nq=Tq(Eq),Bq=Tq(),Iq=Tq(),zq=Tq(),Lq=Tq(zq),Wq=Tq(),Vq={comment:Pq,lineComment:Tq(Pq),blockComment:Tq(Pq),docComment:Tq(Pq),name:Mq,variableName:Tq(Mq),typeName:Qq,tagName:Tq(Qq),propertyName:Rq,attributeName:Tq(Rq),className:Tq(Mq),labelName:Tq(Mq),namespace:Tq(Mq),macroName:Tq(Mq),literal:$q,string:_q,docString:Tq(_q),character:Tq(_q),attributeValue:Tq(_q),number:Dq,integer:Tq(Dq),float:Tq(Dq),bool:Tq($q),regexp:Tq($q),escape:Tq($q),color:Tq($q),url:Tq($q),keyword:Bq,self:Tq(Bq),null:Tq(Bq),atom:Tq(Bq),unit:Tq(Bq),modifier:Tq(Bq),operatorKeyword:Tq(Bq),controlKeyword:Tq(Bq),definitionKeyword:Tq(Bq),moduleKeyword:Tq(Bq),operator:Iq,derefOperator:Tq(Iq),arithmeticOperator:Tq(Iq),logicOperator:Tq(Iq),bitwiseOperator:Tq(Iq),compareOperator:Tq(Iq),updateOperator:Tq(Iq),definitionOperator:Tq(Iq),typeOperator:Tq(Iq),controlOperator:Tq(Iq),punctuation:zq,separator:Tq(zq),bracket:Lq,angleBracket:Tq(Lq),squareBracket:Tq(Lq),paren:Tq(Lq),brace:Tq(Lq),content:Eq,heading:Nq,heading1:Tq(Nq),heading2:Tq(Nq),heading3:Tq(Nq),heading4:Tq(Nq),heading5:Tq(Nq),heading6:Tq(Nq),contentSeparator:Tq(Eq),list:Tq(Eq),quote:Tq(Eq),emphasis:Tq(Eq),strong:Tq(Eq),link:Tq(Eq),monospace:Tq(Eq),strikethrough:Tq(Eq),inserted:Tq(),deleted:Tq(),changed:Tq(),invalid:Tq(),meta:Wq,documentMeta:Tq(Wq),annotation:Tq(Wq),processingInstruction:Tq(Wq),definition:yq.defineModifier(),constant:yq.defineModifier(),function:yq.defineModifier(),standard:yq.defineModifier(),local:yq.defineModifier(),special:yq.defineModifier()};!function(t,e){let i=Object.create(null);for(let e of t)if(Array.isArray(e.tag))for(let t of e.tag)i[t.id]=e.class;else i[e.tag.id]=e.class;let{scope:n,all:r=null}=e||{}}([{tag:Vq.link,class:"tok-link"},{tag:Vq.heading,class:"tok-heading"},{tag:Vq.emphasis,class:"tok-emphasis"},{tag:Vq.strong,class:"tok-strong"},{tag:Vq.keyword,class:"tok-keyword"},{tag:Vq.atom,class:"tok-atom"},{tag:Vq.bool,class:"tok-bool"},{tag:Vq.url,class:"tok-url"},{tag:Vq.labelName,class:"tok-labelName"},{tag:Vq.inserted,class:"tok-inserted"},{tag:Vq.deleted,class:"tok-deleted"},{tag:Vq.literal,class:"tok-literal"},{tag:Vq.string,class:"tok-string"},{tag:Vq.number,class:"tok-number"},{tag:[Vq.regexp,Vq.escape,Vq.special(Vq.string)],class:"tok-string2"},{tag:Vq.variableName,class:"tok-variableName"},{tag:Vq.local(Vq.variableName),class:"tok-variableName tok-local"},{tag:Vq.definition(Vq.variableName),class:"tok-variableName tok-definition"},{tag:Vq.special(Vq.variableName),class:"tok-variableName2"},{tag:Vq.definition(Vq.propertyName),class:"tok-propertyName tok-definition"},{tag:Vq.typeName,class:"tok-typeName"},{tag:Vq.namespace,class:"tok-namespace"},{tag:Vq.className,class:"tok-className"},{tag:Vq.macroName,class:"tok-macroName"},{tag:Vq.propertyName,class:"tok-propertyName"},{tag:Vq.operator,class:"tok-operator"},{tag:Vq.comment,class:"tok-comment"},{tag:Vq.meta,class:"tok-meta"},{tag:Vq.invalid,class:"tok-invalid"},{tag:Vq.punctuation,class:"tok-punctuation"}]);const jq=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288];function qq(t){return t>=65&&t<=90||t>=97&&t<=122||t>=161}const Hq=new sq(((t,e)=>{for(let n=!1,r=0,s=0;;s++){let{next:o}=t;if(!(qq(o)||45==o||95==o||n&&(i=o,i>=48&&i<=57))){n&&t.acceptToken(40==o?94:2==r&&e.canShift(2)?2:95);break}!n&&(45!=o||s>0)&&(n=!0),r===s&&45==o&&r++,t.advance()}var i})),Xq=new sq((t=>{if(jq.includes(t.peek(-1))){let{next:e}=t;(qq(e)||95==e||35==e||46==e||91==e||58==e||45==e)&&t.acceptToken(93)}})),Fq=new sq((t=>{if(!jq.includes(t.peek(-1))){let{next:e}=t;if(37==e&&(t.advance(),t.acceptToken(1)),qq(e)){do{t.advance()}while(qq(t.next));t.acceptToken(1)}}})),Zq=function(t){let e=Object.create(null);for(let i in t){let n=t[i];Array.isArray(n)||(n=[n]);for(let t of i.split(" "))if(t){let i=[],r=2,s=t;for(let e=0;;){if("..."==s&&e>0&&e+3==t.length){r=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!n)throw new RangeError("Invalid path: "+t);if(i.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),e+=n[0].length,e==t.length)break;let o=t[e++];if(e==t.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+t);s=t.slice(e)}let o=i.length-1,l=i[o];if(!l)throw new RangeError("Invalid path: "+t);let a=new Aq(n,r,o>0?i.slice(0,o):null);e[l]=a.sort(e[l])}}return Cq.add(e)}({"import charset namespace keyframes":Vq.definitionKeyword,"media supports":Vq.controlKeyword,"from to selector":Vq.keyword,NamespaceName:Vq.namespace,KeyframeName:Vq.labelName,TagName:Vq.tagName,ClassName:Vq.className,PseudoClassName:Vq.constant(Vq.className),IdName:Vq.labelName,"FeatureName PropertyName":Vq.propertyName,AttributeName:Vq.attributeName,NumberLiteral:Vq.number,KeywordQuery:Vq.keyword,UnaryQueryOp:Vq.operatorKeyword,"CallTag ValueName":Vq.atom,VariableName:Vq.variableName,Callee:Vq.operatorKeyword,Unit:Vq.unit,"UniversalSelector NestingSelector":Vq.definitionOperator,AtKeyword:Vq.keyword,MatchOp:Vq.compareOperator,"ChildOp SiblingOp, LogicOp":Vq.logicOperator,BinOp:Vq.arithmeticOperator,Important:Vq.modifier,Comment:Vq.blockComment,ParenthesizedContent:Vq.special(Vq.name),ColorLiteral:Vq.color,StringLiteral:Vq.string,":":Vq.punctuation,"PseudoOp #":Vq.derefOperator,"; ,":Vq.separator,"( )":Vq.paren,"[ ]":Vq.squareBracket,"{ }":Vq.brace}),Gq={__proto__:null,lang:32,"nth-child":32,"nth-last-child":32,"nth-of-type":32,dir:32,url:60,"url-prefix":60,domain:60,regexp:60,selector:134},Uq={__proto__:null,"@import":114,"@media":138,"@charset":142,"@namespace":146,"@keyframes":152,"@supports":164},Yq={__proto__:null,not:128,only:128,from:158,to:160},Kq=bq.deserialize({version:14,states:"7WOYQ[OOOOQP'#Cd'#CdOOQP'#Cc'#CcO!ZQ[O'#CfO!}QXO'#CaO#UQ[O'#ChO#aQ[O'#DPO#fQ[O'#DTOOQP'#Ec'#EcO#kQdO'#DeO$VQ[O'#DrO#kQdO'#DtO$hQ[O'#DvO$sQ[O'#DyO$xQ[O'#EPO%WQ[O'#EROOQS'#Eb'#EbOOQS'#ES'#ESQYQ[OOOOQP'#Cg'#CgOOQP,59Q,59QO!ZQ[O,59QO%_Q[O'#EVO%yQWO,58{O&RQ[O,59SO#aQ[O,59kO#fQ[O,59oO%_Q[O,59sO%_Q[O,59uO%_Q[O,59vO'bQ[O'#D`OOQS,58{,58{OOQP'#Ck'#CkOOQO'#C}'#C}OOQP,59S,59SO'iQWO,59SO'nQWO,59SOOQP'#DR'#DROOQP,59k,59kOOQO'#DV'#DVO'sQ`O,59oOOQS'#Cp'#CpO#kQdO'#CqO'{QvO'#CsO)VQtO,5:POOQO'#Cx'#CxO'iQWO'#CwO)kQWO'#CyOOQS'#Ef'#EfOOQO'#Dh'#DhO)pQ[O'#DoO*OQWO'#EiO$xQ[O'#DmO*^QWO'#DpOOQO'#Ej'#EjO%|QWO,5:^O*cQpO,5:`OOQS'#Dx'#DxO*kQWO,5:bO*pQ[O,5:bOOQO'#D{'#D{O*xQWO,5:eO*}QWO,5:kO+VQWO,5:mOOQS-E8Q-E8QOOQP1G.l1G.lO+yQXO,5:qOOQO-E8T-E8TOOQS1G.g1G.gOOQP1G.n1G.nO'iQWO1G.nO'nQWO1G.nOOQP1G/V1G/VO,WQ`O1G/ZO,qQXO1G/_O-XQXO1G/aO-oQXO1G/bO.VQXO'#CdO.zQWO'#DaOOQS,59z,59zO/PQWO,59zO/XQ[O,59zO/`QdO'#CoO/gQ[O'#DOOOQP1G/Z1G/ZO#kQdO1G/ZO/nQpO,59]OOQS,59_,59_O#kQdO,59aO/vQWO1G/kOOQS,59c,59cO/{Q!bO,59eO0TQWO'#DhO0`QWO,5:TO0eQWO,5:ZO$xQ[O,5:VO$xQ[O'#EYO0mQWO,5;TO0xQWO,5:XO%_Q[O,5:[OOQS1G/x1G/xOOQS1G/z1G/zOOQS1G/|1G/|O1ZQWO1G/|O1`QdO'#D|OOQS1G0P1G0POOQS1G0V1G0VOOQS1G0X1G0XOOQP7+$Y7+$YOOQP7+$u7+$uO#kQdO7+$uO#kQdO,59{O1nQ[O'#EXO1xQWO1G/fOOQS1G/f1G/fO1xQWO1G/fO2QQtO'#ETO2uQdO'#EeO3PQWO,59ZO3UQXO'#EhO3]QWO,59jO3bQpO7+$uOOQS1G.w1G.wOOQS1G.{1G.{OOQS7+%V7+%VO3jQWO1G/PO#kQdO1G/oOOQO1G/u1G/uOOQO1G/q1G/qO3oQWO,5:tOOQO-E8W-E8WO3}QXO1G/vOOQS7+%h7+%hO4UQYO'#CsO%|QWO'#EZO4^QdO,5:hOOQS,5:h,5:hO4lQpO<<HaO4tQtO1G/gOOQO,5:s,5:sO5XQ[O,5:sOOQO-E8V-E8VOOQS7+%Q7+%QO5cQWO7+%QOOQS-E8R-E8RO#kQdO'#EUO5kQWO,5;POOQT1G.u1G.uO5sQWO,5;SOOQP1G/U1G/UOOQP<<Ha<<HaOOQS7+$k7+$kO5{QdO7+%ZOOQO7+%b7+%bOOQS,5:u,5:uOOQS-E8X-E8XOOQS1G0S1G0SOOQPAN={AN={O6SQtO'#EWO#kQdO'#EWO6}QdO7+%ROOQO7+%R7+%ROOQO1G0_1G0_OOQS<<Hl<<HlO7_QdO,5:pOOQO-E8S-E8SOOQO<<Hu<<HuO7iQtO,5:rOOQS-E8U-E8UOOQO<<Hm<<Hm",stateData:"8j~O#TOSROS~OUWOXWO]TO^TOtUOxVO!Y_O!ZXO!gYO!iZO!k[O!n]O!t^O#RPO#WRO~O#RcO~O]hO^hOpfOtiOxjO|kO!PmO#PlO#WeO~O!RnO~P!`O`sO#QqO#RpO~O#RuO~O#RwO~OQ!QObzOf!QOh!QOn!PO#Q}O#RyO#Z{O~Ob!SO!b!UO!e!VO#R!RO!R#]P~Oh![On!PO#R!ZO~O#R!^O~Ob!SO!b!UO!e!VO#R!RO~O!W#]P~P$VOUWOXWO]TO^TOtUOxVO#RPO#WRO~OpfO!RnO~O`!hO#QqO#RpO~OQ!pOUWOXWO]TO^TOtUOxVO!Y_O!ZXO!gYO!iZO!k[O!n]O!t^O#R!oO#WRO~O!Q!qO~P&^Ob!tO~Ob!uO~Ov!vOz!wO~OP!yObgXjgX!WgX!bgX!egX#RgXagXQgXfgXhgXngXpgX#QgX#ZgXvgX!QgX!VgX~Ob!SOj!zO!b!UO!e!VO#R!RO!W#]P~Ob!}O~Ob!SO!b!UO!e!VO#R#OO~Op#SO!`#RO!R#]X!W#]X~Ob#VO~Oj!zO!W#XO~O!W#YO~Oh#ZOn!PO~O!R#[O~O!RnO!`#RO~O!RnO!W#_O~O]hO^hOtiOxjO|kO!PmO#PlO#WeO~Op!ya!R!yaa!ya~P+_Ov#aOz#bO~O]hO^hOtiOxjO#WeO~Op{i|{i!P{i!R{i#P{ia{i~P,`Op}i|}i!P}i!R}i#P}ia}i~P,`Op!Oi|!Oi!P!Oi!R!Oi#P!Oia!Oi~P,`O]WX]!UX^WXpWXtWXxWX|WX!PWX!RWX#PWX#WWX~O]#cO~O!Q#fO!W#dO~O!Q#fO~P&^Oa#XP~P#kOa#[P~P%_Oa#nOj!zO~O!W#pO~Oh#qOo#qO~O]!^Xa![X!`![X~O]#rO~Oa#sO!`#RO~Op#SO!R#]a!W#]a~O!`#ROp!aa!R!aa!W!aaa!aa~O!W#xO~O!Q#|O!q#zO!r#zO#Z#yO~O!Q!{X!W!{X~P&^O!Q$SO!W#dO~Oj!zOQ!wXa!wXb!wXf!wXh!wXn!wXp!wX#Q!wX#R!wX#Z!wX~Op$VOa#XX~P#kOa$XO~Oa#[X~P!`Oa$ZO~Oj!zOv$[O~Oa$]O~O!`#ROp!|a!R!|a!W!|a~Oa$_O~P+_OP!yO!RgX~O!Q$bO!q#zO!r#zO#Z#yO~Oj!zOv$cO~Oj!zOp$eO!V$gO!Q!Ti!W!Ti~P#kO!Q!{a!W!{a~P&^O!Q$iO!W#dO~Op$VOa#Xa~OpfOa#[a~Oa$lO~P#kOj!zOQ!zXb!zXf!zXh!zXn!zXp!zX!Q!zX!V!zX!W!zX#Q!zX#R!zX#Z!zX~Op$eO!V$oO!Q!Tq!W!Tq~P#kOa!xap!xa~P#kOj!zOQ!zab!zaf!zah!zan!zap!za!Q!za!V!za!W!za#Q!za#R!za#Z!za~Oo#Zj!Pj~",goto:",O#_PPPPP#`P#h#vP#h$U#hPP$[PPP$b$k$kP$}P$kP$k%e%wPPP&a&g#hP&mP#hP&sP#hP#h#hPPP&y']'iPP#`PP'o'o'y'oP'oP'o'oP#`P#`P#`P'|#`P(P(SPP#`P#`(V(e(s(y)T)Z)e)kPPPPPP)q)yP*e*hP+^+a+j]`Obn!s#d$QiWObfklmn!s!u#V#d$QiQObfklmn!s!u#V#d$QQdRR!ceQrTR!ghQ!gsQ!|!OR#`!hq!QXZz!t!w!z#b#c#i#r$O$V$^$e$f$jp!QXZz!t!w!z#b#c#i#r$O$V$^$e$f$jT#z#[#{q!OXZz!t!w!z#b#c#i#r$O$V$^$e$f$jp!QXZz!t!w!z#b#c#i#r$O$V$^$e$f$jQ![[R#Z!]QtTR!ihQ!gtR#`!iQvUR!jiQxVR!kjQoSQ!fgQ#W!XQ#^!`Q#_!aR$`#zQ!rnQ#g!sQ$P#dR$h$QX!pn!s#d$Qa!WY^_|!S!U#R#SR#P!SR!][R!_]R#]!_QbOU!bb!s$QQ!snR$Q#dQ#i!tU$U#i$^$jQ$^#rR$j$VQ$W#iR$k$WQgSS!eg$YR$Y#kQ$f$OR$n$fQ#e!rS$R#e$TR$T#gQ#T!TR#v#TQ#{#[R$a#{]aObn!s#d$Q[SObn!s#d$QQ!dfQ!lkQ!mlQ!nmQ#k!uR#w#VR#j!tQ|XQ!YZQ!xz[#h!t#i#r$V$^$jQ#m!wQ#o!zQ#}#bQ$O#cS$d$O$fR$m$eR#l!uQ!XYQ!a_R!{|U!TY_|Q!`^Q#Q!SQ#U!UQ#t#RR#u#S",nodeNames:"⚠ Unit VariableName Comment StyleSheet RuleSet UniversalSelector TagSelector TagName NestingSelector ClassSelector ClassName PseudoClassSelector : :: PseudoClassName PseudoClassName ) ( ArgList ValueName ParenthesizedValue ColorLiteral NumberLiteral StringLiteral BinaryExpression BinOp CallExpression Callee CallLiteral CallTag ParenthesizedContent , PseudoClassName ArgList IdSelector # IdName ] AttributeSelector [ AttributeName MatchOp ChildSelector ChildOp DescendantSelector SiblingSelector SiblingOp } { Block Declaration PropertyName Important ; ImportStatement AtKeyword import KeywordQuery FeatureQuery FeatureName BinaryQuery LogicOp UnaryQuery UnaryQueryOp ParenthesizedQuery SelectorQuery selector MediaStatement media CharsetStatement charset NamespaceStatement namespace NamespaceName KeyframesStatement keyframes KeyframeName KeyframeList from to SupportsStatement supports AtRule",maxTerm:106,nodeProps:[["openedBy",17,"(",48,"{"],["closedBy",18,")",49,"}"]],propSources:[Zq],skippedNodes:[0,3],repeatNodeCount:8,tokenData:"Ay~R![OX$wX^%]^p$wpq%]qr(crs+}st,otu2Uuv$wvw2rwx2}xy3jyz3uz{3z{|4_|}8U}!O8a!O!P8x!P!Q9Z!Q![;e![!]<Y!]!^<x!^!_$w!_!`=T!`!a=`!a!b$w!b!c>O!c!}$w!}#O?[#O#P$w#P#Q?g#Q#R2U#R#T$w#T#U?r#U#c$w#c#d@q#d#o$w#o#pAQ#p#q2U#q#rA]#r#sAh#s#y$w#y#z%]#z$f$w$f$g%]$g#BY$w#BY#BZ%]#BZ$IS$w$IS$I_%]$I_$I|$w$I|$JO%]$JO$JT$w$JT$JU%]$JU$KV$w$KV$KW%]$KW&FU$w&FU&FV%]&FV~$wW$zQOy%Qz~%QW%VQoWOy%Qz~%Q~%bf#T~OX%QX^&v^p%Qpq&vqy%Qz#y%Q#y#z&v#z$f%Q$f$g&v$g#BY%Q#BY#BZ&v#BZ$IS%Q$IS$I_&v$I_$I|%Q$I|$JO&v$JO$JT%Q$JT$JU&v$JU$KV%Q$KV$KW&v$KW&FU%Q&FU&FV&v&FV~%Q~&}f#T~oWOX%QX^&v^p%Qpq&vqy%Qz#y%Q#y#z&v#z$f%Q$f$g&v$g#BY%Q#BY#BZ&v#BZ$IS%Q$IS$I_&v$I_$I|%Q$I|$JO&v$JO$JT%Q$JT$JU&v$JU$KV%Q$KV$KW&v$KW&FU%Q&FU&FV&v&FV~%Q^(fSOy%Qz#]%Q#]#^(r#^~%Q^(wSoWOy%Qz#a%Q#a#b)T#b~%Q^)YSoWOy%Qz#d%Q#d#e)f#e~%Q^)kSoWOy%Qz#c%Q#c#d)w#d~%Q^)|SoWOy%Qz#f%Q#f#g*Y#g~%Q^*_SoWOy%Qz#h%Q#h#i*k#i~%Q^*pSoWOy%Qz#T%Q#T#U*|#U~%Q^+RSoWOy%Qz#b%Q#b#c+_#c~%Q^+dSoWOy%Qz#h%Q#h#i+p#i~%Q^+wQ!VUoWOy%Qz~%Q~,QUOY+}Zr+}rs,ds#O+}#O#P,i#P~+}~,iOh~~,lPO~+}_,tWtPOy%Qz!Q%Q!Q![-^![!c%Q!c!i-^!i#T%Q#T#Z-^#Z~%Q^-cWoWOy%Qz!Q%Q!Q![-{![!c%Q!c!i-{!i#T%Q#T#Z-{#Z~%Q^.QWoWOy%Qz!Q%Q!Q![.j![!c%Q!c!i.j!i#T%Q#T#Z.j#Z~%Q^.qWfUoWOy%Qz!Q%Q!Q![/Z![!c%Q!c!i/Z!i#T%Q#T#Z/Z#Z~%Q^/bWfUoWOy%Qz!Q%Q!Q![/z![!c%Q!c!i/z!i#T%Q#T#Z/z#Z~%Q^0PWoWOy%Qz!Q%Q!Q![0i![!c%Q!c!i0i!i#T%Q#T#Z0i#Z~%Q^0pWfUoWOy%Qz!Q%Q!Q![1Y![!c%Q!c!i1Y!i#T%Q#T#Z1Y#Z~%Q^1_WoWOy%Qz!Q%Q!Q![1w![!c%Q!c!i1w!i#T%Q#T#Z1w#Z~%Q^2OQfUoWOy%Qz~%QY2XSOy%Qz!_%Q!_!`2e!`~%QY2lQzQoWOy%Qz~%QX2wQXPOy%Qz~%Q~3QUOY2}Zw2}wx,dx#O2}#O#P3d#P~2}~3gPO~2}_3oQbVOy%Qz~%Q~3zOa~_4RSUPjSOy%Qz!_%Q!_!`2e!`~%Q_4fUjS!PPOy%Qz!O%Q!O!P4x!P!Q%Q!Q![7_![~%Q^4}SoWOy%Qz!Q%Q!Q![5Z![~%Q^5bWoW#ZUOy%Qz!Q%Q!Q![5Z![!g%Q!g!h5z!h#X%Q#X#Y5z#Y~%Q^6PWoWOy%Qz{%Q{|6i|}%Q}!O6i!O!Q%Q!Q![6z![~%Q^6nSoWOy%Qz!Q%Q!Q![6z![~%Q^7RSoW#ZUOy%Qz!Q%Q!Q![6z![~%Q^7fYoW#ZUOy%Qz!O%Q!O!P5Z!P!Q%Q!Q![7_![!g%Q!g!h5z!h#X%Q#X#Y5z#Y~%Q_8ZQpVOy%Qz~%Q^8fUjSOy%Qz!O%Q!O!P4x!P!Q%Q!Q![7_![~%Q_8}S#WPOy%Qz!Q%Q!Q![5Z![~%Q~9`RjSOy%Qz{9i{~%Q~9nSoWOy9iyz9zz{:o{~9i~9}ROz9zz{:W{~9z~:ZTOz9zz{:W{!P9z!P!Q:j!Q~9z~:oOR~~:tUoWOy9iyz9zz{:o{!P9i!P!Q;W!Q~9i~;_QoWR~Oy%Qz~%Q^;jY#ZUOy%Qz!O%Q!O!P5Z!P!Q%Q!Q![7_![!g%Q!g!h5z!h#X%Q#X#Y5z#Y~%QX<_S]POy%Qz![%Q![!]<k!]~%QX<rQ^PoWOy%Qz~%Q_<}Q!WVOy%Qz~%QY=YQzQOy%Qz~%QX=eS|POy%Qz!`%Q!`!a=q!a~%QX=xQ|PoWOy%Qz~%QX>RUOy%Qz!c%Q!c!}>e!}#T%Q#T#o>e#o~%QX>lY!YPoWOy%Qz}%Q}!O>e!O!Q%Q!Q![>e![!c%Q!c!}>e!}#T%Q#T#o>e#o~%QX?aQxPOy%Qz~%Q^?lQvUOy%Qz~%QX?uSOy%Qz#b%Q#b#c@R#c~%QX@WSoWOy%Qz#W%Q#W#X@d#X~%QX@kQ!`PoWOy%Qz~%QX@tSOy%Qz#f%Q#f#g@d#g~%QXAVQ!RPOy%Qz~%Q_AbQ!QVOy%Qz~%QZAmS!PPOy%Qz!_%Q!_!`2e!`~%Q",tokenizers:[Xq,Fq,Hq,0,1,2,3],topRules:{StyleSheet:[0,4]},specialized:[{term:94,get:t=>Gq[t]||-1},{term:56,get:t=>Uq[t]||-1},{term:95,get:t=>Yq[t]||-1}],tokenPrec:1078}),Jq=1024;let tH=0;class eH{constructor(t,e){this.from=t,this.to=e}}class iH{constructor(t={}){this.id=tH++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=rH.match(t)),e=>{let i=t(e);return void 0===i?null:[this,i]}}}iH.closedBy=new iH({deserialize:t=>t.split(" ")}),iH.openedBy=new iH({deserialize:t=>t.split(" ")}),iH.group=new iH({deserialize:t=>t.split(" ")}),iH.contextHash=new iH({perNode:!0}),iH.lookAhead=new iH({perNode:!0}),iH.mounted=new iH({perNode:!0});const nH=Object.create(null);class rH{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):nH,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),n=new rH(t.name||"",e,t.id,i);if(t.props)for(let i of t.props)if(Array.isArray(i)||(i=i(n)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[i[0].id]=i[1]}return n}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop(iH.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return t=>{for(let i=t.prop(iH.group),n=-1;n<(i?i.length:0);n++){let r=e[n<0?t.name:i[n]];if(r)return r}}}}rH.none=new rH("",Object.create(null),0,8);const sH=new WeakMap,oH=new WeakMap;var lH;!function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"}(lH||(lH={}));class aH{constructor(t,e,i,n,r){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,r&&r.length){this.props=Object.create(null);for(let[t,e]of r)this.props["number"==typeof t?t:t.id]=e}}toString(){let t=this.prop(iH.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let i=t.toString();i&&(e&&(e+=","),e+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new vH(this.topNode,t)}cursorAt(t,e=0,i=0){let n=sH.get(this)||this.topNode,r=new vH(n);return r.moveTo(t,e),sH.set(this,r._tree),r}get topNode(){return new pH(this,0,0,null)}resolve(t,e=0){let i=dH(sH.get(this)||this.topNode,t,e,!1);return sH.set(this,i),i}resolveInner(t,e=0){let i=dH(oH.get(this)||this.topNode,t,e,!0);return oH.set(this,i),i}iterate(t){let{enter:e,leave:i,from:n=0,to:r=this.length}=t;for(let s=this.cursor((t.mode||0)|lH.IncludeAnonymous);;){let t=!1;if(s.from<=r&&s.to>=n&&(s.type.isAnonymous||!1!==e(s))){if(s.firstChild())continue;t=!0}for(;t&&i&&!s.type.isAnonymous&&i(s),!s.nextSibling();){if(!s.parent())return;t=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:kH(rH.none,this.children,this.positions,0,this.children.length,0,this.length,((t,e,i)=>new aH(this.type,t,e,i,this.propValues)),t.makeTree||((t,e,i)=>new aH(rH.none,t,e,i)))}static build(t){return function(t){var e;let{buffer:i,nodeSet:n,maxBufferLength:r=Jq,reused:s=[],minRepeatType:o=n.types.length}=t,l=Array.isArray(i)?new hH(i,i.length):i,a=n.types,h=0,c=0;function u(t,e,i,b,O){let{id:v,start:w,end:y,size:x}=l,k=c;for(;x<0;){if(l.next(),-1==x){let e=s[v];return i.push(e),void b.push(w-t)}if(-3==x)return void(h=v);if(-4==x)return void(c=v);throw new RangeError(`Unrecognized record size: ${x}`)}let S,C,A=a[v],T=w-t;if(y-w<=r&&(C=g(l.pos-e,O))){let e=new Uint16Array(C.size-C.skip),i=l.pos-C.size,r=e.length;for(;l.pos>i;)r=m(C.start,e,r);S=new cH(e,y-C.start,n),T=C.start-t}else{let t=l.pos-x;l.next();let e=[],i=[],n=v>=o?v:-1,s=0,a=y;for(;l.pos>t;)n>=0&&l.id==n&&l.size>=0?(l.end<=a-r&&(d(e,i,w,s,l.end,a,n,k),s=e.length,a=l.end),l.next()):u(w,t,e,i,n);if(n>=0&&s>0&&s<e.length&&d(e,i,w,s,w,a,n,k),e.reverse(),i.reverse(),n>-1&&s>0){let t=f(A);S=kH(A,e,i,0,e.length,0,y-w,t,t)}else S=p(A,e,i,y-w,k-y)}i.push(S),b.push(T)}function f(t){return(e,i,n)=>{let r,s,o=0,l=e.length-1;if(l>=0&&(r=e[l])instanceof aH){if(!l&&r.type==t&&r.length==n)return r;(s=r.prop(iH.lookAhead))&&(o=i[l]+r.length+s)}return p(t,e,i,n,o)}}function d(t,e,i,r,s,o,l,a){let h=[],c=[];for(;t.length>r;)h.push(t.pop()),c.push(e.pop()+i-s);t.push(p(n.types[l],h,c,o-s,a-o)),e.push(s-i)}function p(t,e,i,n,r=0,s){if(h){let t=[iH.contextHash,h];s=s?[t].concat(s):[t]}if(r>25){let t=[iH.lookAhead,r];s=s?[t].concat(s):[t]}return new aH(t,e,i,n,s)}function g(t,e){let i=l.fork(),n=0,s=0,a=0,h=i.end-r,c={size:0,start:0,skip:0};t:for(let r=i.pos-t;i.pos>r;){let t=i.size;if(i.id==e&&t>=0){c.size=n,c.start=s,c.skip=a,a+=4,n+=4,i.next();continue}let l=i.pos-t;if(t<0||l<r||i.start<h)break;let u=i.id>=o?4:0,f=i.start;for(i.next();i.pos>l;){if(i.size<0){if(-3!=i.size)break t;u+=4}else i.id>=o&&(u+=4);i.next()}s=f,n+=t,a+=u}return(e<0||n==t)&&(c.size=n,c.start=s,c.skip=a),c.size>4?c:void 0}function m(t,e,i){let{id:n,start:r,end:s,size:a}=l;if(l.next(),a>=0&&n<o){let o=i;if(a>4){let n=l.pos-(a-4);for(;l.pos>n;)i=m(t,e,i)}e[--i]=o,e[--i]=s-t,e[--i]=r-t,e[--i]=n}else-3==a?h=n:-4==a&&(c=n);return i}let b=[],O=[];for(;l.pos>0;)u(t.start||0,t.bufferStart||0,b,O,-1);let v=null!==(e=t.length)&&void 0!==e?e:b.length?O[0]+b[0].length:0;return new aH(a[t.topID],b.reverse(),O.reverse(),v)}(t)}}aH.empty=new aH(rH.none,[],[],0);class hH{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new hH(this.buffer,this.index)}}class cH{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return rH.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],r=n.name;if(/\W/.test(r)&&!n.isError&&(r=JSON.stringify(r)),i==(t+=4))return r;let s=[];for(;t<i;)s.push(this.childString(t)),t=this.buffer[t+3];return r+"("+s.join(",")+")"}findChild(t,e,i,n,r){let{buffer:s}=this,o=-1;for(let l=t;l!=e&&!(uH(r,n,s[l+1],s[l+2])&&(o=l,i>0));l=s[l+3]);return o}slice(t,e,i,n){let r=this.buffer,s=new Uint16Array(e-t);for(let n=t,o=0;n<e;)s[o++]=r[n++],s[o++]=r[n++]-i,s[o++]=r[n++]-i,s[o++]=r[n++]-t;return new cH(s,n-i,this.set)}}function uH(t,e,i,n){switch(t){case-2:return i<e;case-1:return n>=e&&i<e;case 0:return i<e&&n>e;case 1:return i<=e&&n>e;case 2:return n>e;case 4:return!0}}function fH(t,e){let i=t.childBefore(e);for(;i;){let e=i.lastChild;if(!e||e.to!=i.to)break;e.type.isError&&e.from==e.to?(t=i,i=e.prevSibling):i=e}return t}function dH(t,e,i,n){for(var r;t.from==t.to||(i<1?t.from>=e:t.from>e)||(i>-1?t.to<=e:t.to<e);){let e=!n&&t instanceof pH&&t.index<0?null:t.parent;if(!e)return t;t=e}let s=n?0:lH.IgnoreOverlays;if(n)for(let n=t,o=n.parent;o;n=o,o=n.parent)n instanceof pH&&n.index<0&&(null===(r=o.enter(e,i,s))||void 0===r?void 0:r.from)!=n.from&&(t=o);for(;;){let n=t.enter(e,i,s);if(!n)return t;t=n}}class pH{constructor(t,e,i,n){this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,r=0){for(let s=this;;){for(let{children:o,positions:l}=s._tree,a=e>0?o.length:-1;t!=a;t+=e){let a=o[t],h=l[t]+s.from;if(uH(n,i,h,h+a.length))if(a instanceof cH){if(r&lH.ExcludeBuffers)continue;let o=a.findChild(0,a.buffer.length,e,i-h,n);if(o>-1)return new OH(new bH(s,a,t,h),null,o)}else if(r&lH.IncludeAnonymous||!a.type.isAnonymous||wH(a)){let o;if(!(r&lH.IgnoreMounts)&&a.props&&(o=a.prop(iH.mounted))&&!o.overlay)return new pH(o.tree,h,t,s);let l=new pH(a,h,t,s);return r&lH.IncludeAnonymous||!l.type.isAnonymous?l:l.nextChild(e<0?a.children.length-1:0,e,i,n)}}if(r&lH.IncludeAnonymous||!s.type.isAnonymous)return null;if(t=s.index>=0?s.index+e:e<0?-1:s._parent._tree.children.length,s=s._parent,!s)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&lH.IgnoreOverlays)&&(n=this._tree.prop(iH.mounted))&&n.overlay){let i=t-this.from;for(let{from:t,to:r}of n.overlay)if((e>0?t<=i:t<i)&&(e<0?r>=i:r>i))return new pH(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new vH(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return dH(this,t,e,!1)}resolveInner(t,e=0){return dH(this,t,e,!0)}enterUnfinishedNodesBefore(t){return fH(this,t)}getChild(t,e=null,i=null){let n=gH(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return gH(this,t,e,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return mH(this,t)}}function gH(t,e,i,n){let r=t.cursor(),s=[];if(!r.firstChild())return s;if(null!=i)for(;!r.type.is(i);)if(!r.nextSibling())return s;for(;;){if(null!=n&&r.type.is(n))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return null==n?s:[]}}function mH(t,e,i=e.length-1){for(let n=t.parent;i>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[i]&&e[i]!=n.name)return!1;i--}}return!0}class bH{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class OH{constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(t,e,i){let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return r<0?null:new OH(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&lH.ExcludeBuffers)return null;let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new OH(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new OH(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new OH(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new vH(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,r=i.buffer[this.index+3];if(r>n){let s=i.buffer[this.index+1],o=i.buffer[this.index+2];t.push(i.slice(n,r,s,o)),e.push(0)}return new aH(this.type,t,e,this.to-this.from)}resolve(t,e=0){return dH(this,t,e,!1)}resolveInner(t,e=0){return dH(this,t,e,!0)}enterUnfinishedNodesBefore(t){return fH(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let n=gH(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return gH(this,t,e,i)}get node(){return this}matchContext(t){return mH(this,t)}}class vH{constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof pH)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}get name(){return this.type.name}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return!!t&&(t instanceof pH?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?!(i&lH.ExcludeBuffers)&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&lH.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&lH.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let t=i<0?0:this.stack[i]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(t)}return i<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(n.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;({index:e,_parent:i}=i))if(e>-1)for(let n=e+t,r=t<0?-1:i._tree.children.length;n!=r;n+=t){let t=i._tree.children[n];if(this.mode&lH.IncludeAnonymous||t instanceof cH||!t.type.isAnonymous||wH(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,r=this.stack.length;r>=0;){for(let s=t;s;s=s._parent)if(s.index==n){if(n==this.index)return s;e=s,i=r+1;break t}n=this.stack[--r]}for(let t=i;t<this.stack.length;t++)e=new OH(this.buffer,e,this.stack[t]);return this.bufferNode=new OH(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||!1!==t(this)){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;n&&e&&e(this),n=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return mH(this.node,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,r=this.stack.length-1;n>=0;r--){if(r<0)return mH(this.node,t,n);let s=i[e.buffer[this.stack[r]]];if(!s.isAnonymous){if(t[n]&&t[n]!=s.name)return!1;n--}}return!0}}function wH(t){return t.children.some((t=>t instanceof cH||!t.type.isAnonymous||wH(t)))}const yH=new WeakMap;function xH(t,e){if(!t.isAnonymous||e instanceof cH||e.type!=t)return 1;let i=yH.get(e);if(null==i){i=1;for(let n of e.children){if(n.type!=t||!(n instanceof aH)){i=1;break}i+=xH(t,n)}yH.set(e,i)}return i}function kH(t,e,i,n,r,s,o,l,a){let h=0;for(let i=n;i<r;i++)h+=xH(t,e[i]);let c=Math.ceil(1.5*h/8),u=[],f=[];return function e(i,n,r,o,l){for(let h=r;h<o;){let r=h,d=n[h],p=xH(t,i[h]);for(h++;h<o;h++){let e=xH(t,i[h]);if(p+e>=c)break;p+=e}if(h==r+1){if(p>c){let t=i[r];e(t.children,t.positions,0,t.children.length,n[r]+l);continue}u.push(i[r])}else{let e=n[h-1]+i[h-1].length-d;u.push(kH(t,i,n,r,h,d,e,null,a))}f.push(d+l-s)}}(e,i,n,r,0),(l||a)(u,f,o)}class SH{constructor(t,e,i,n,r=!1,s=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(r?1:0)|(s?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(t,e=[],i=!1){let n=[new SH(0,t.length,t,0,!1,i)];for(let i of e)i.to>t.length&&n.push(i);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],r=1,s=t.length?t[0]:null;for(let o=0,l=0,a=0;;o++){let h=o<e.length?e[o]:null,c=h?h.fromA:1e9;if(c-l>=i)for(;s&&s.from<c;){let e=s;if(l>=e.from||c<=e.to||a){let t=Math.max(e.from,l)-a,i=Math.min(e.to,c)-a;e=t>=i?null:new SH(t,i,e.tree,e.offset+a,o>0,!!h)}if(e&&n.push(e),s.to>c)break;s=r<t.length?t[r++]:null}if(!h)break;l=h.toA,a=h.toA-h.toB}return n}}class CH{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new iH({perNode:!0});let AH=0;class TH{constructor(t,e,i){this.set=t,this.base=e,this.modified=i,this.id=AH++}static define(t){if(null==t?void 0:t.base)throw new Error("Can not derive from a modified tag");let e=new TH([],null,[]);if(e.set.push(e),t)for(let i of t.set)e.set.push(i);return e}static defineModifier(){let t=new MH;return e=>e.modified.indexOf(t)>-1?e:MH.get(e.base||e,e.modified.concat(t).sort(((t,e)=>t.id-e.id)))}}let PH=0;class MH{constructor(){this.instances=[],this.id=PH++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find((i=>{return i.base==t&&(n=e,r=i.modified,n.length==r.length&&n.every(((t,e)=>t==r[e])));var n,r}));if(i)return i;let n=[],r=new TH(n,t,e);for(let t of e)t.instances.push(r);let s=QH(e);for(let e of t.set)for(let t of s)n.push(MH.get(e,t));return r}}function QH(t){let e=[t];for(let i=0;i<t.length;i++)for(let n of QH(t.slice(0,i).concat(t.slice(i+1))))e.push(n);return e}function RH(t){let e=Object.create(null);for(let i in t){let n=t[i];Array.isArray(n)||(n=[n]);for(let t of i.split(" "))if(t){let i=[],r=2,s=t;for(let e=0;;){if("..."==s&&e>0&&e+3==t.length){r=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!n)throw new RangeError("Invalid path: "+t);if(i.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),e+=n[0].length,e==t.length)break;let o=t[e++];if(e==t.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+t);s=t.slice(e)}let o=i.length-1,l=i[o];if(!l)throw new RangeError("Invalid path: "+t);let a=new _H(n,r,o>0?i.slice(0,o):null);e[l]=a.sort(e[l])}}return $H.add(e)}const $H=new iH;class _H{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}const DH=TH.define,EH=DH(),NH=DH(),BH=DH(NH),IH=DH(NH),zH=DH(),LH=DH(zH),WH=DH(zH),VH=DH(),jH=DH(VH),qH=DH(),HH=DH(),XH=DH(),FH=DH(XH),ZH=DH(),GH={comment:EH,lineComment:DH(EH),blockComment:DH(EH),docComment:DH(EH),name:NH,variableName:DH(NH),typeName:BH,tagName:DH(BH),propertyName:IH,attributeName:DH(IH),className:DH(NH),labelName:DH(NH),namespace:DH(NH),macroName:DH(NH),literal:zH,string:LH,docString:DH(LH),character:DH(LH),attributeValue:DH(LH),number:WH,integer:DH(WH),float:DH(WH),bool:DH(zH),regexp:DH(zH),escape:DH(zH),color:DH(zH),url:DH(zH),keyword:qH,self:DH(qH),null:DH(qH),atom:DH(qH),unit:DH(qH),modifier:DH(qH),operatorKeyword:DH(qH),controlKeyword:DH(qH),definitionKeyword:DH(qH),moduleKeyword:DH(qH),operator:HH,derefOperator:DH(HH),arithmeticOperator:DH(HH),logicOperator:DH(HH),bitwiseOperator:DH(HH),compareOperator:DH(HH),updateOperator:DH(HH),definitionOperator:DH(HH),typeOperator:DH(HH),controlOperator:DH(HH),punctuation:XH,separator:DH(XH),bracket:FH,angleBracket:DH(FH),squareBracket:DH(FH),paren:DH(FH),brace:DH(FH),content:VH,heading:jH,heading1:DH(jH),heading2:DH(jH),heading3:DH(jH),heading4:DH(jH),heading5:DH(jH),heading6:DH(jH),contentSeparator:DH(VH),list:DH(VH),quote:DH(VH),emphasis:DH(VH),strong:DH(VH),link:DH(VH),monospace:DH(VH),strikethrough:DH(VH),inserted:DH(),deleted:DH(),changed:DH(),invalid:DH(),meta:ZH,documentMeta:DH(ZH),annotation:DH(ZH),processingInstruction:DH(ZH),definition:TH.defineModifier(),constant:TH.defineModifier(),function:TH.defineModifier(),standard:TH.defineModifier(),local:TH.defineModifier(),special:TH.defineModifier()};var UH;!function(t,e){let i=Object.create(null);for(let e of t)if(Array.isArray(e.tag))for(let t of e.tag)i[t.id]=e.class;else i[e.tag.id]=e.class;let{scope:n,all:r=null}=e||{}}([{tag:GH.link,class:"tok-link"},{tag:GH.heading,class:"tok-heading"},{tag:GH.emphasis,class:"tok-emphasis"},{tag:GH.strong,class:"tok-strong"},{tag:GH.keyword,class:"tok-keyword"},{tag:GH.atom,class:"tok-atom"},{tag:GH.bool,class:"tok-bool"},{tag:GH.url,class:"tok-url"},{tag:GH.labelName,class:"tok-labelName"},{tag:GH.inserted,class:"tok-inserted"},{tag:GH.deleted,class:"tok-deleted"},{tag:GH.literal,class:"tok-literal"},{tag:GH.string,class:"tok-string"},{tag:GH.number,class:"tok-number"},{tag:[GH.regexp,GH.escape,GH.special(GH.string)],class:"tok-string2"},{tag:GH.variableName,class:"tok-variableName"},{tag:GH.local(GH.variableName),class:"tok-variableName tok-local"},{tag:GH.definition(GH.variableName),class:"tok-variableName tok-definition"},{tag:GH.special(GH.variableName),class:"tok-variableName2"},{tag:GH.definition(GH.propertyName),class:"tok-propertyName tok-definition"},{tag:GH.typeName,class:"tok-typeName"},{tag:GH.namespace,class:"tok-namespace"},{tag:GH.className,class:"tok-className"},{tag:GH.macroName,class:"tok-macroName"},{tag:GH.propertyName,class:"tok-propertyName"},{tag:GH.operator,class:"tok-operator"},{tag:GH.comment,class:"tok-comment"},{tag:GH.meta,class:"tok-meta"},{tag:GH.invalid,class:"tok-invalid"},{tag:GH.punctuation,class:"tok-punctuation"}]);const YH=new iH;class KH{constructor(t,e,i=[]){this.data=t,Qe.prototype.hasOwnProperty("tree")||Object.defineProperty(Qe.prototype,"tree",{get(){return eX(this)}}),this.parser=e,this.extension=[cX.of(this),Qe.languageData.of(((t,e,i)=>t.facet(JH(t,e,i))))].concat(i)}isActiveAt(t,e,i=-1){return JH(t,e,i)==this.data}findRegions(t){let e=t.facet(cX);if((null==e?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let i=[],n=(t,e)=>{if(t.prop(YH)==this.data)return void i.push({from:e,to:e+t.length});let r=t.prop(iH.mounted);if(r){if(r.tree.prop(YH)==this.data){if(r.overlay)for(let t of r.overlay)i.push({from:t.from+e,to:t.to+e});else i.push({from:e,to:e+t.length});return}if(r.overlay){let t=i.length;if(n(r.tree,r.overlay[0].from+e),i.length>t)return}}for(let i=0;i<t.children.length;i++){let r=t.children[i];r instanceof aH&&n(r,t.positions[i]+e)}};return n(eX(t),0),i}get allowsNesting(){return!0}}function JH(t,e,i){let n=t.facet(cX);if(!n)return null;let r=n.data;if(n.allowsNesting)for(let n=eX(t).topNode;n;n=n.enter(e,i,lH.ExcludeBuffers))r=n.type.prop(YH)||r;return r}KH.setState=Oe.define();class tX extends KH{constructor(t,e){super(t,e),this.parser=e}static define(t){let e=(i=t.languageData,Vt.define({combine:i?t=>t.concat(i):void 0}));var i;return new tX(e,t.parser.configure({props:[YH.add((t=>t.isTop?e:void 0))]}))}configure(t){return new tX(this.data,this.parser.configure(t))}get allowsNesting(){return this.parser.hasWrappers()}}function eX(t){let e=t.field(KH.state,!1);return e?e.tree:aH.empty}class iX{constructor(t,e=t.length){this.doc=t,this.length=e,this.cursorPos=0,this.string="",this.cursor=t.iter()}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-i,e-i)}}let nX=null;class rX{constructor(t,e,i=[],n,r,s,o,l){this.parser=t,this.state=e,this.fragments=i,this.tree=n,this.treeLen=r,this.viewport=s,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(t,e,i){return new rX(t,e,[],aH.empty,0,i,[],null)}startParse(){return this.parser.startParse(new iX(this.state.doc),this.fragments)}work(t,e){return null!=e&&e>=this.state.doc.length&&(e=void 0),this.tree!=aH.empty&&this.isDone(null!=e?e:this.state.doc.length)?(this.takeTree(),!0):this.withContext((()=>{var i;if("number"==typeof t){let e=Date.now()+t;t=()=>Date.now()>e}for(this.parse||(this.parse=this.startParse()),null!=e&&(null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n){if(this.fragments=this.withoutTempSkipped(SH.addTree(n,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(i=this.parse.stoppedAt)&&void 0!==i?i:this.state.doc.length,this.tree=n,this.parse=null,!(this.treeLen<(null!=e?e:this.state.doc.length)))return!0;this.parse=this.startParse()}if(t())return!1}}))}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext((()=>{for(;!(e=this.parse.advance()););})),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(SH.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=nX;nX=this;try{return t()}finally{nX=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=sX(t,e.from,e.to);return t}changes(t,e){let{fragments:i,tree:n,treeLen:r,viewport:s,skipped:o}=this;if(this.takeTree(),!t.empty){let e=[];if(t.iterChangedRanges(((t,i,n,r)=>e.push({fromA:t,toA:i,fromB:n,toB:r}))),i=SH.applyChanges(i,e),n=aH.empty,r=0,s={from:t.mapPos(s.from,-1),to:t.mapPos(s.to,1)},this.skipped.length){o=[];for(let e of this.skipped){let i=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);i<n&&o.push({from:i,to:n})}}}return new rX(this.parser,e,i,n,r,s,o,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let e=0;e<this.skipped.length;e++){let{from:i,to:n}=this.skipped[e];i<t.to&&n>t.from&&(this.fragments=sX(this.fragments,i,n),this.skipped.splice(e--,1))}return!(this.skipped.length>=e)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends class{startParse(t,e,i){return"string"==typeof t&&(t=new CH(t)),i=i?i.length?i.map((t=>new eH(t.from,t.to))):[new eH(0,0)]:[new eH(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let t=n.advance();if(t)return t}}}{createParse(e,i,n){let r=n[0].from,s=n[n.length-1].to;return{parsedPos:r,advance(){let e=nX;if(e){for(let t of n)e.tempSkipped.push(t);t&&(e.scheduleOn=e.scheduleOn?Promise.all([e.scheduleOn,t]):t)}return this.parsedPos=s,new aH(rH.none,[],[],s-r)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&0==e[0].from&&e[0].to>=t}static get(){return nX}}function sX(t,e,i){return SH.applyChanges(t,[{fromA:e,toA:i,fromB:e,toB:i}])}class oX{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,i)||e.takeTree(),new oX(e)}static init(t){let e=Math.min(3e3,t.doc.length),i=rX.create(t.facet(cX).parser,t,{from:0,to:e});return i.work(20,e)||i.takeTree(),new oX(i)}}KH.state=Gt.define({create:oX.init,update(t,e){for(let t of e.effects)if(t.is(KH.setState))return t.value;return e.startState.facet(cX)!=e.state.facet(cX)?oX.init(e.state):t.apply(e)}});let lX=t=>{let e=setTimeout((()=>t()),500);return()=>clearTimeout(e)};"undefined"!=typeof requestIdleCallback&&(lX=t=>{let e=-1,i=setTimeout((()=>{e=requestIdleCallback(t,{timeout:400})}),100);return()=>e<0?clearTimeout(i):cancelIdleCallback(e)});const aX="undefined"!=typeof navigator&&(null===(UH=navigator.scheduling)||void 0===UH?void 0:UH.isInputPending)?()=>navigator.scheduling.isInputPending():null,hX=Bn.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(KH.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),t.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(KH.state);e.tree==e.context.tree&&e.context.isDone(t.doc.length)||(this.working=lX(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,r=i.field(KH.state);if(r.tree==r.context.tree&&r.context.isDone(n+1e5))return;let s=Date.now()+Math.min(this.chunkBudget,100,t&&!aX?Math.max(25,t.timeRemaining()-5):1e9),o=r.context.treeLen<n&&i.doc.length>n+1e3,l=r.context.work((()=>aX&&aX()||Date.now()>s),n+(o?0:1e5));this.chunkBudget-=Date.now()-e,(l||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:KH.setState.of(new oX(r.context))})),this.chunkBudget>0&&(!l||o)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then((()=>this.scheduleWork())).catch((t=>_n(this.view.state,t))).then((()=>this.workScheduled--)),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),cX=Vt.define({combine:t=>t.length?t[0]:null,enables:[KH.state,hX]});class uX{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}}const fX=new iH;function dX({except:t,units:e=1}={}){return i=>{let n=t&&t.test(i.textAfter);return i.baseIndent+(n?0:e*i.unit)}}const pX=new iH;const gX=Object.create(null),mX=[rH.none],bX=[],OX=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])OX[t]=wX(gX,e);function vX(t,e){bX.indexOf(t)>-1||(bX.push(t),console.warn(e))}function wX(t,e){let i=null;for(let n of e.split(".")){let e=t[n]||GH[n];e?"function"==typeof e?i?i=e(i):vX(n,`Modifier ${n} used at start of tag`):i?vX(n,`Tag ${n} used as modifier`):i=e:vX(n,`Unknown highlighting tag ${n}`)}if(!i)return 0;let n=e.replace(/ /g,"_"),r=rH.define({id:mX.length,name:n,props:[RH({[n]:i})]});return mX.push(r),r.id}let yX=null;function xX(){if(!yX&&"object"==typeof document&&document.body){let t=[];for(let e in document.body.style)/[A-Z]|^-|^(item|length)$/.test(e)||t.push(e);yX=t.sort().map((t=>({type:"property",label:t})))}return yX||[]}const kX=["active","after","before","checked","default","disabled","empty","enabled","first-child","first-letter","first-line","first-of-type","focus","hover","in-range","indeterminate","invalid","lang","last-child","last-of-type","link","not","nth-child","nth-last-child","nth-last-of-type","nth-of-type","only-of-type","only-child","optional","out-of-range","placeholder","read-only","read-write","required","root","selection","target","valid","visited"].map((t=>({type:"class",label:t}))),SX=["above","absolute","activeborder","additive","activecaption","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","antialiased","appworkspace","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic-abegede-gez","ethiopic-halehame-aa-er","ethiopic-halehame-gez","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","graytext","grid","groove","hand","hard-light","help","hidden","hide","higher","highlight","highlighttext","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","justify","keep-all","landscape","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-hexadecimal","lower-latin","lower-norwegian","lowercase","ltr","luminosity","manipulation","match","matrix","matrix3d","medium","menu","menutext","message-box","middle","min-intrinsic","mix","monospace","move","multiple","multiple_mask_images","multiply","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","opacity","open-quote","optimizeLegibility","optimizeSpeed","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","text","text-bottom","text-top","textarea","textfield","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","to","top","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-latin","uppercase","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"].map((t=>({type:"keyword",label:t}))).concat(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"].map((t=>({type:"constant",label:t})))),CX=["a","abbr","address","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","main","meter","nav","ol","output","p","pre","ruby","section","select","small","source","span","strong","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","tr","u","ul"].map((t=>({type:"type",label:t}))),AX=/^[\w-]*/,TX=t=>{let{state:e,pos:i}=t,n=eX(e).resolveInner(i,-1);if("PropertyName"==n.name)return{from:n.from,options:xX(),validFor:AX};if("ValueName"==n.name)return{from:n.from,options:SX,validFor:AX};if("PseudoClassName"==n.name)return{from:n.from,options:kX,validFor:AX};if("TagName"==n.name){for(let{parent:t}=n;t;t=t.parent)if("Block"==t.name)return{from:n.from,options:xX(),validFor:AX};return{from:n.from,options:CX,validFor:AX}}if(!t.explicit)return null;let r=n.resolve(i),s=r.childBefore(i);return s&&":"==s.name&&"PseudoClassSelector"==r.name?{from:i,options:kX,validFor:AX}:s&&":"==s.name&&"Declaration"==r.name||"ArgList"==r.name?{from:i,options:SX,validFor:AX}:"Block"==r.name?{from:i,options:xX(),validFor:AX}:null},PX=tX.define({parser:Kq.configure({props:[fX.add({Declaration:dX()}),pX.add({Block:function(t){let e=t.firstChild,i=t.lastChild;return e&&e.to<i.from?{from:e.to,to:i.type.isError?t.to:i.from}:null}})]}),languageData:{commentTokens:{block:{open:"/*",close:"*/"}},indentOnInput:/^\s*\}$/,wordChars:"-"}});const MX=1024;let QX=0;class RX{constructor(t,e){this.from=t,this.to=e}}class $X{constructor(t={}){this.id=QX++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=DX.match(t)),e=>{let i=t(e);return void 0===i?null:[this,i]}}}$X.closedBy=new $X({deserialize:t=>t.split(" ")}),$X.openedBy=new $X({deserialize:t=>t.split(" ")}),$X.group=new $X({deserialize:t=>t.split(" ")}),$X.contextHash=new $X({perNode:!0}),$X.lookAhead=new $X({perNode:!0}),$X.mounted=new $X({perNode:!0});const _X=Object.create(null);class DX{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):_X,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),n=new DX(t.name||"",e,t.id,i);if(t.props)for(let i of t.props)if(Array.isArray(i)||(i=i(n)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[i[0].id]=i[1]}return n}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop($X.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return t=>{for(let i=t.prop($X.group),n=-1;n<(i?i.length:0);n++){let r=e[n<0?t.name:i[n]];if(r)return r}}}}DX.none=new DX("",Object.create(null),0,8);class EX{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let i of this.types){let n=null;for(let e of t){let t=e(i);t&&(n||(n=Object.assign({},i.props)),n[t[0].id]=t[1])}e.push(n?new DX(i.name,n,i.id,i.flags):i)}return new EX(e)}}const NX=new WeakMap,BX=new WeakMap;var IX;!function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"}(IX||(IX={}));class zX{constructor(t,e,i,n,r){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,r&&r.length){this.props=Object.create(null);for(let[t,e]of r)this.props["number"==typeof t?t:t.id]=e}}toString(){let t=this.prop($X.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let i=t.toString();i&&(e&&(e+=","),e+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new UX(this.topNode,t)}cursorAt(t,e=0,i=0){let n=NX.get(this)||this.topNode,r=new UX(n);return r.moveTo(t,e),NX.set(this,r._tree),r}get topNode(){return new HX(this,0,0,null)}resolve(t,e=0){let i=qX(NX.get(this)||this.topNode,t,e,!1);return NX.set(this,i),i}resolveInner(t,e=0){let i=qX(BX.get(this)||this.topNode,t,e,!0);return BX.set(this,i),i}iterate(t){let{enter:e,leave:i,from:n=0,to:r=this.length}=t;for(let s=this.cursor((t.mode||0)|IX.IncludeAnonymous);;){let t=!1;if(s.from<=r&&s.to>=n&&(s.type.isAnonymous||!1!==e(s))){if(s.firstChild())continue;t=!0}for(;t&&i&&!s.type.isAnonymous&&i(s),!s.nextSibling();){if(!s.parent())return;t=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:tF(DX.none,this.children,this.positions,0,this.children.length,0,this.length,((t,e,i)=>new zX(this.type,t,e,i,this.propValues)),t.makeTree||((t,e,i)=>new zX(DX.none,t,e,i)))}static build(t){return function(t){var e;let{buffer:i,nodeSet:n,maxBufferLength:r=MX,reused:s=[],minRepeatType:o=n.types.length}=t,l=Array.isArray(i)?new LX(i,i.length):i,a=n.types,h=0,c=0;function u(t,e,i,b,O){let{id:v,start:w,end:y,size:x}=l,k=c;for(;x<0;){if(l.next(),-1==x){let e=s[v];return i.push(e),void b.push(w-t)}if(-3==x)return void(h=v);if(-4==x)return void(c=v);throw new RangeError(`Unrecognized record size: ${x}`)}let S,C,A=a[v],T=w-t;if(y-w<=r&&(C=g(l.pos-e,O))){let e=new Uint16Array(C.size-C.skip),i=l.pos-C.size,r=e.length;for(;l.pos>i;)r=m(C.start,e,r);S=new WX(e,y-C.start,n),T=C.start-t}else{let t=l.pos-x;l.next();let e=[],i=[],n=v>=o?v:-1,s=0,a=y;for(;l.pos>t;)n>=0&&l.id==n&&l.size>=0?(l.end<=a-r&&(d(e,i,w,s,l.end,a,n,k),s=e.length,a=l.end),l.next()):u(w,t,e,i,n);if(n>=0&&s>0&&s<e.length&&d(e,i,w,s,w,a,n,k),e.reverse(),i.reverse(),n>-1&&s>0){let t=f(A);S=tF(A,e,i,0,e.length,0,y-w,t,t)}else S=p(A,e,i,y-w,k-y)}i.push(S),b.push(T)}function f(t){return(e,i,n)=>{let r,s,o=0,l=e.length-1;if(l>=0&&(r=e[l])instanceof zX){if(!l&&r.type==t&&r.length==n)return r;(s=r.prop($X.lookAhead))&&(o=i[l]+r.length+s)}return p(t,e,i,n,o)}}function d(t,e,i,r,s,o,l,a){let h=[],c=[];for(;t.length>r;)h.push(t.pop()),c.push(e.pop()+i-s);t.push(p(n.types[l],h,c,o-s,a-o)),e.push(s-i)}function p(t,e,i,n,r=0,s){if(h){let t=[$X.contextHash,h];s=s?[t].concat(s):[t]}if(r>25){let t=[$X.lookAhead,r];s=s?[t].concat(s):[t]}return new zX(t,e,i,n,s)}function g(t,e){let i=l.fork(),n=0,s=0,a=0,h=i.end-r,c={size:0,start:0,skip:0};t:for(let r=i.pos-t;i.pos>r;){let t=i.size;if(i.id==e&&t>=0){c.size=n,c.start=s,c.skip=a,a+=4,n+=4,i.next();continue}let l=i.pos-t;if(t<0||l<r||i.start<h)break;let u=i.id>=o?4:0,f=i.start;for(i.next();i.pos>l;){if(i.size<0){if(-3!=i.size)break t;u+=4}else i.id>=o&&(u+=4);i.next()}s=f,n+=t,a+=u}return(e<0||n==t)&&(c.size=n,c.start=s,c.skip=a),c.size>4?c:void 0}function m(t,e,i){let{id:n,start:r,end:s,size:a}=l;if(l.next(),a>=0&&n<o){let o=i;if(a>4){let n=l.pos-(a-4);for(;l.pos>n;)i=m(t,e,i)}e[--i]=o,e[--i]=s-t,e[--i]=r-t,e[--i]=n}else-3==a?h=n:-4==a&&(c=n);return i}let b=[],O=[];for(;l.pos>0;)u(t.start||0,t.bufferStart||0,b,O,-1);let v=null!==(e=t.length)&&void 0!==e?e:b.length?O[0]+b[0].length:0;return new zX(a[t.topID],b.reverse(),O.reverse(),v)}(t)}}zX.empty=new zX(DX.none,[],[],0);class LX{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new LX(this.buffer,this.index)}}class WX{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return DX.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],r=n.name;if(/\W/.test(r)&&!n.isError&&(r=JSON.stringify(r)),i==(t+=4))return r;let s=[];for(;t<i;)s.push(this.childString(t)),t=this.buffer[t+3];return r+"("+s.join(",")+")"}findChild(t,e,i,n,r){let{buffer:s}=this,o=-1;for(let l=t;l!=e&&!(VX(r,n,s[l+1],s[l+2])&&(o=l,i>0));l=s[l+3]);return o}slice(t,e,i,n){let r=this.buffer,s=new Uint16Array(e-t);for(let n=t,o=0;n<e;)s[o++]=r[n++],s[o++]=r[n++]-i,s[o++]=r[n++]-i,s[o++]=r[n++]-t;return new WX(s,n-i,this.set)}}function VX(t,e,i,n){switch(t){case-2:return i<e;case-1:return n>=e&&i<e;case 0:return i<e&&n>e;case 1:return i<=e&&n>e;case 2:return n>e;case 4:return!0}}function jX(t,e){let i=t.childBefore(e);for(;i;){let e=i.lastChild;if(!e||e.to!=i.to)break;e.type.isError&&e.from==e.to?(t=i,i=e.prevSibling):i=e}return t}function qX(t,e,i,n){for(var r;t.from==t.to||(i<1?t.from>=e:t.from>e)||(i>-1?t.to<=e:t.to<e);){let e=!n&&t instanceof HX&&t.index<0?null:t.parent;if(!e)return t;t=e}let s=n?0:IX.IgnoreOverlays;if(n)for(let n=t,o=n.parent;o;n=o,o=n.parent)n instanceof HX&&n.index<0&&(null===(r=o.enter(e,i,s))||void 0===r?void 0:r.from)!=n.from&&(t=o);for(;;){let n=t.enter(e,i,s);if(!n)return t;t=n}}class HX{constructor(t,e,i,n){this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,r=0){for(let s=this;;){for(let{children:o,positions:l}=s._tree,a=e>0?o.length:-1;t!=a;t+=e){let a=o[t],h=l[t]+s.from;if(VX(n,i,h,h+a.length))if(a instanceof WX){if(r&IX.ExcludeBuffers)continue;let o=a.findChild(0,a.buffer.length,e,i-h,n);if(o>-1)return new GX(new ZX(s,a,t,h),null,o)}else if(r&IX.IncludeAnonymous||!a.type.isAnonymous||YX(a)){let o;if(!(r&IX.IgnoreMounts)&&a.props&&(o=a.prop($X.mounted))&&!o.overlay)return new HX(o.tree,h,t,s);let l=new HX(a,h,t,s);return r&IX.IncludeAnonymous||!l.type.isAnonymous?l:l.nextChild(e<0?a.children.length-1:0,e,i,n)}}if(r&IX.IncludeAnonymous||!s.type.isAnonymous)return null;if(t=s.index>=0?s.index+e:e<0?-1:s._parent._tree.children.length,s=s._parent,!s)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&IX.IgnoreOverlays)&&(n=this._tree.prop($X.mounted))&&n.overlay){let i=t-this.from;for(let{from:t,to:r}of n.overlay)if((e>0?t<=i:t<i)&&(e<0?r>=i:r>i))return new HX(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new UX(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return qX(this,t,e,!1)}resolveInner(t,e=0){return qX(this,t,e,!0)}enterUnfinishedNodesBefore(t){return jX(this,t)}getChild(t,e=null,i=null){let n=XX(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return XX(this,t,e,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return FX(this,t)}}function XX(t,e,i,n){let r=t.cursor(),s=[];if(!r.firstChild())return s;if(null!=i)for(;!r.type.is(i);)if(!r.nextSibling())return s;for(;;){if(null!=n&&r.type.is(n))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return null==n?s:[]}}function FX(t,e,i=e.length-1){for(let n=t.parent;i>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[i]&&e[i]!=n.name)return!1;i--}}return!0}class ZX{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class GX{constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(t,e,i){let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return r<0?null:new GX(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&IX.ExcludeBuffers)return null;let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new GX(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new GX(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new GX(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new UX(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,r=i.buffer[this.index+3];if(r>n){let s=i.buffer[this.index+1],o=i.buffer[this.index+2];t.push(i.slice(n,r,s,o)),e.push(0)}return new zX(this.type,t,e,this.to-this.from)}resolve(t,e=0){return qX(this,t,e,!1)}resolveInner(t,e=0){return qX(this,t,e,!0)}enterUnfinishedNodesBefore(t){return jX(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let n=XX(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return XX(this,t,e,i)}get node(){return this}matchContext(t){return FX(this,t)}}class UX{constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof HX)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}get name(){return this.type.name}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return!!t&&(t instanceof HX?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?!(i&IX.ExcludeBuffers)&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&IX.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&IX.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let t=i<0?0:this.stack[i]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(t)}return i<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(n.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;({index:e,_parent:i}=i))if(e>-1)for(let n=e+t,r=t<0?-1:i._tree.children.length;n!=r;n+=t){let t=i._tree.children[n];if(this.mode&IX.IncludeAnonymous||t instanceof WX||!t.type.isAnonymous||YX(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,r=this.stack.length;r>=0;){for(let s=t;s;s=s._parent)if(s.index==n){if(n==this.index)return s;e=s,i=r+1;break t}n=this.stack[--r]}for(let t=i;t<this.stack.length;t++)e=new GX(this.buffer,e,this.stack[t]);return this.bufferNode=new GX(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||!1!==t(this)){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;n&&e&&e(this),n=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return FX(this.node,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,r=this.stack.length-1;n>=0;r--){if(r<0)return FX(this.node,t,n);let s=i[e.buffer[this.stack[r]]];if(!s.isAnonymous){if(t[n]&&t[n]!=s.name)return!1;n--}}return!0}}function YX(t){return t.children.some((t=>t instanceof WX||!t.type.isAnonymous||YX(t)))}const KX=new WeakMap;function JX(t,e){if(!t.isAnonymous||e instanceof WX||e.type!=t)return 1;let i=KX.get(e);if(null==i){i=1;for(let n of e.children){if(n.type!=t||!(n instanceof zX)){i=1;break}i+=JX(t,n)}KX.set(e,i)}return i}function tF(t,e,i,n,r,s,o,l,a){let h=0;for(let i=n;i<r;i++)h+=JX(t,e[i]);let c=Math.ceil(1.5*h/8),u=[],f=[];return function e(i,n,r,o,l){for(let h=r;h<o;){let r=h,d=n[h],p=JX(t,i[h]);for(h++;h<o;h++){let e=JX(t,i[h]);if(p+e>=c)break;p+=e}if(h==r+1){if(p>c){let t=i[r];e(t.children,t.positions,0,t.children.length,n[r]+l);continue}u.push(i[r])}else{let e=n[h-1]+i[h-1].length-d;u.push(tF(t,i,n,r,h,d,e,null,a))}f.push(d+l-s)}}(e,i,n,r,0),(l||a)(u,f,o)}class eF{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new $X({perNode:!0});class iF{constructor(t,e,i,n,r,s,o,l,a,h=0,c){this.p=t,this.stack=e,this.state=i,this.reducePos=n,this.pos=r,this.score=s,this.buffer=o,this.bufferBase=l,this.curContext=a,this.lookAhead=h,this.parent=c}toString(){return`[${this.stack.filter(((t,e)=>e%3==0)).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,e,i=0){let n=t.parser.context;return new iF(t,[],e,i,i,0,[],0,n?new nF(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(t,e){this.stack.push(this.state,e,this.bufferBase+this.buffer.length),this.state=t}reduce(t){let e=t>>19,i=65535&t,{parser:n}=this.p,r=n.dynamicPrecedence(i);if(r&&(this.score+=r),0==e)return this.pushState(n.getGoto(this.state,i,!0),this.reducePos),i<n.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,4,!0),void this.reduceContext(i,this.reducePos);let s=this.stack.length-3*(e-1)-(262144&t?6:0),o=this.stack[s-2],l=this.stack[s-1],a=this.bufferBase+this.buffer.length-l;if(i<n.minRepeatTerm||131072&t){let t=n.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,o,t,a+4,!0)}if(262144&t)this.state=this.stack[s];else{let t=this.stack[s-3];this.state=n.getGoto(t,i,!0)}for(;this.stack.length>s;)this.stack.pop();this.reduceContext(i,o)}storeNode(t,e,i,n=4,r=!1){if(0==t&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let t=this,n=this.buffer.length;if(0==n&&t.parent&&(n=t.bufferBase-t.parent.bufferBase,t=t.parent),n>0&&0==t.buffer[n-4]&&t.buffer[n-1]>-1){if(e==i)return;if(t.buffer[n-2]>=e)return void(t.buffer[n-2]=i)}}if(r&&this.pos!=i){let r=this.buffer.length;if(r>0&&0!=this.buffer[r-4])for(;r>0&&this.buffer[r-2]>i;)this.buffer[r]=this.buffer[r-4],this.buffer[r+1]=this.buffer[r-3],this.buffer[r+2]=this.buffer[r-2],this.buffer[r+3]=this.buffer[r-1],r-=4,n>4&&(n-=4);this.buffer[r]=t,this.buffer[r+1]=e,this.buffer[r+2]=i,this.buffer[r+3]=n}else this.buffer.push(t,e,i,n)}shift(t,e,i){let n=this.pos;if(131072&t)this.pushState(65535&t,this.pos);else if(0==(262144&t)){let r=t,{parser:s}=this.p;(i>this.pos||e<=s.maxNode)&&(this.pos=i,s.stateFlag(r,1)||(this.reducePos=i)),this.pushState(r,n),this.shiftContext(e,n),e<=s.maxNode&&this.buffer.push(e,n,i,4)}else this.pos=i,this.shiftContext(e,n),e<=this.p.parser.maxNode&&this.buffer.push(e,n,i,4)}apply(t,e,i){65536&t?this.reduce(t):this.shift(t,e,i)}useNode(t,e){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=t)&&(this.p.reused.push(t),i++);let n=this.pos;this.reducePos=this.pos=n+t.length,this.pushState(e,n),this.buffer.push(i,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,t,this,this.p.stream.reset(this.pos-t.length)))}split(){let t=this,e=t.buffer.length;for(;e>0&&t.buffer[e-2]>t.reducePos;)e-=4;let i=t.buffer.slice(e),n=t.bufferBase+e;for(;t&&n==t.bufferBase;)t=t.parent;return new iF(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,n,this.curContext,this.lookAhead,t)}recoverByDelete(t,e){let i=t<=this.p.parser.maxNode;i&&this.storeNode(t,this.pos,e,4),this.storeNode(0,this.pos,e,i?8:4),this.pos=this.reducePos=e,this.score-=190}canShift(t){for(let e=new sF(this);;){let i=this.p.parser.stateSlot(e.state,4)||this.p.parser.hasAction(e.state,t);if(0==(65536&i))return!0;if(0==i)return!1;e.reduce(i)}}recoverByInsert(t){if(this.stack.length>=300)return[];let e=this.p.parser.nextStates(this.state);if(e.length>8||this.stack.length>=120){let i=[];for(let n,r=0;r<e.length;r+=2)(n=e[r+1])!=this.state&&this.p.parser.hasAction(n,t)&&i.push(e[r],n);if(this.stack.length<120)for(let t=0;i.length<8&&t<e.length;t+=2){let n=e[t+1];i.some(((t,e)=>1&e&&t==n))||i.push(e[t],n)}e=i}let i=[];for(let t=0;t<e.length&&i.length<4;t+=2){let n=e[t+1];if(n==this.state)continue;let r=this.split();r.pushState(n,this.pos),r.storeNode(0,r.pos,r.pos,4,!0),r.shiftContext(e[t],this.pos),r.score-=200,i.push(r)}return i}forceReduce(){let t=this.p.parser.stateSlot(this.state,5);if(0==(65536&t))return!1;let{parser:e}=this.p;if(!e.validAction(this.state,t)){let i=t>>19,n=65535&t,r=this.stack.length-3*i;if(r<0||e.getGoto(this.stack[r],n,!1)<0)return!1;this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:t}=this.p;return 65535==t.data[t.stateSlot(this.state,1)]&&!t.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(t){if(this.state!=t.state||this.stack.length!=t.stack.length)return!1;for(let e=0;e<this.stack.length;e+=3)if(this.stack[e]!=t.stack[e])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(t){return this.p.parser.dialect.flags[t]}shiftContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,t,this,this.p.stream.reset(e)))}reduceContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,t,this,this.p.stream.reset(e)))}emitContext(){let t=this.buffer.length-1;(t<0||-3!=this.buffer[t])&&this.buffer.push(this.curContext.hash,this.reducePos,this.reducePos,-3)}emitLookAhead(){let t=this.buffer.length-1;(t<0||-4!=this.buffer[t])&&this.buffer.push(this.lookAhead,this.reducePos,this.reducePos,-4)}updateContext(t){if(t!=this.curContext.context){let e=new nF(this.curContext.tracker,t);e.hash!=this.curContext.hash&&this.emitContext(),this.curContext=e}}setLookAhead(t){t>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=t)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class nF{constructor(t,e){this.tracker=t,this.context=e,this.hash=t.strict?t.hash(e):0}}var rF;!function(t){t[t.Insert=200]="Insert",t[t.Delete=190]="Delete",t[t.Reduce=100]="Reduce",t[t.MaxNext=4]="MaxNext",t[t.MaxInsertStackDepth=300]="MaxInsertStackDepth",t[t.DampenInsertStackDepth=120]="DampenInsertStackDepth"}(rF||(rF={}));class sF{constructor(t){this.start=t,this.state=t.state,this.stack=t.stack,this.base=this.stack.length}reduce(t){let e=65535&t,i=t>>19;0==i?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(i-1);let n=this.start.p.parser.getGoto(this.stack[this.base-3],e,!0);this.state=n}}class oF{constructor(t,e,i){this.stack=t,this.pos=e,this.index=i,this.buffer=t.buffer,0==this.index&&this.maybeNext()}static create(t,e=t.bufferBase+t.buffer.length){return new oF(t,e,e-t.bufferBase)}maybeNext(){let t=this.stack.parent;null!=t&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new oF(this.stack,this.pos,this.index)}}class lF{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const aF=new lF;class hF{constructor(t,e){this.input=t,this.ranges=e,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=aF,this.rangeIndex=0,this.pos=this.chunkPos=e[0].from,this.range=e[0],this.end=e[e.length-1].to,this.readNext()}resolveOffset(t,e){let i=this.range,n=this.rangeIndex,r=this.pos+t;for(;r<i.from;){if(!n)return null;let t=this.ranges[--n];r-=i.from-t.to,i=t}for(;e<0?r>i.to:r>=i.to;){if(n==this.ranges.length-1)return null;let t=this.ranges[++n];r+=t.from-i.to,i=t}return r}peek(t){let e,i,n=this.chunkOff+t;if(n>=0&&n<this.chunk.length)e=this.pos+t,i=this.chunk.charCodeAt(n);else{let n=this.resolveOffset(t,1);if(null==n)return-1;if(e=n,e>=this.chunk2Pos&&e<this.chunk2Pos+this.chunk2.length)i=this.chunk2.charCodeAt(e-this.chunk2Pos);else{let t=this.rangeIndex,n=this.range;for(;n.to<=e;)n=this.ranges[++t];this.chunk2=this.input.chunk(this.chunk2Pos=e),e+this.chunk2.length>n.to&&(this.chunk2=this.chunk2.slice(0,n.to-e)),i=this.chunk2.charCodeAt(0)}}return e>=this.token.lookAhead&&(this.token.lookAhead=e+1),i}acceptToken(t,e=0){let i=e?this.resolveOffset(e,-1):this.pos;if(null==i||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=t,this.token.end=i}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:t,chunkPos:e}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=t,this.chunk2Pos=e,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let t=this.input.chunk(this.pos),e=this.pos+t.length;this.chunk=e>this.range.to?t.slice(0,this.range.to-this.pos):t,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(t=1){for(this.chunkOff+=t;this.pos+t>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();t-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=t,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(t,e){if(e?(this.token=e,e.start=t,e.lookAhead=t+1,e.value=e.extended=-1):this.token=aF,this.pos!=t){if(this.pos=t,t==this.end)return this.setDone(),this;for(;t<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;t>=this.range.to;)this.range=this.ranges[++this.rangeIndex];t>=this.chunkPos&&t<this.chunkPos+this.chunk.length?this.chunkOff=t-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(t,e){if(t>=this.chunkPos&&e<=this.chunkPos+this.chunk.length)return this.chunk.slice(t-this.chunkPos,e-this.chunkPos);if(t>=this.chunk2Pos&&e<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(t-this.chunk2Pos,e-this.chunk2Pos);if(t>=this.range.from&&e<=this.range.to)return this.input.read(t,e);let i="";for(let n of this.ranges){if(n.from>=e)break;n.to>t&&(i+=this.input.read(Math.max(n.from,t),Math.min(n.to,e)))}return i}}class cF{constructor(t,e){this.data=t,this.id=e}token(t,e){!function(t,e,i,n){let r=0,s=1<<n,{parser:o}=i.p,{dialect:l}=o;t:for(;0!=(s&t[r]);){let i=t[r+1];for(let n=r+3;n<i;n+=2)if((t[n+1]&s)>0){let i=t[n];if(l.allows(i)&&(-1==e.token.value||e.token.value==i||o.overrides(i,e.token.value))){e.acceptToken(i);break}}let n=e.next,a=0,h=t[r+2];if(!(e.next<0&&h>a&&65535==t[i+3*h-3])){for(;a<h;){let s=a+h>>1,o=i+s+(s<<1),l=t[o],c=t[o+1];if(n<l)h=s;else{if(!(n>=c)){r=t[o+2],e.advance();continue t}a=s+1}}break}r=t[i+3*h-1]}}(this.data,t,e,this.id)}}cF.prototype.contextual=cF.prototype.fallback=cF.prototype.extend=!1;class uF{constructor(t,e={}){this.token=t,this.contextual=!!e.contextual,this.fallback=!!e.fallback,this.extend=!!e.extend}}function fF(t,e=Uint16Array){if("string"!=typeof t)return t;let i=null;for(let n=0,r=0;n<t.length;){let s=0;for(;;){let e=t.charCodeAt(n++),i=!1;if(126==e){s=65535;break}e>=92&&e--,e>=34&&e--;let r=e-32;if(r>=46&&(r-=46,i=!0),s+=r,i)break;s*=46}i?i[r++]=s:i=new e(s)}return i}const dF="undefined"!=typeof process&&process.env&&/\bparse\b/.test(process.env.LOG);let pF=null;var gF,mF;function bF(t,e,i){let n=t.cursor(IX.IncludeAnonymous);for(n.moveTo(e);;)if(!(i<0?n.childBefore(e):n.childAfter(e)))for(;;){if((i<0?n.to<e:n.from>e)&&!n.type.isError)return i<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(t.length,Math.max(n.from+1,e+25));if(i<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return i<0?0:t.length}}!function(t){t[t.Margin=25]="Margin"}(gF||(gF={}));class OF{constructor(t,e){this.fragments=t,this.nodeSet=e,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let t=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(t){for(this.safeFrom=t.openStart?bF(t.tree,t.from+t.offset,1)-t.offset:t.from,this.safeTo=t.openEnd?bF(t.tree,t.to+t.offset,-1)-t.offset:t.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(t.tree),this.start.push(-t.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(t){if(t<this.nextStart)return null;for(;this.fragment&&this.safeTo<=t;)this.nextFragment();if(!this.fragment)return null;for(;;){let e=this.trees.length-1;if(e<0)return this.nextFragment(),null;let i=this.trees[e],n=this.index[e];if(n==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let r=i.children[n],s=this.start[e]+i.positions[n];if(s>t)return this.nextStart=s,null;if(r instanceof zX){if(s==t){if(s<this.safeFrom)return null;let t=s+r.length;if(t<=this.safeTo){let e=r.prop($X.lookAhead);if(!e||t+e<this.fragment.to)return r}}this.index[e]++,s+r.length>=Math.max(this.safeFrom,t)&&(this.trees.push(r),this.start.push(s),this.index.push(0))}else this.index[e]++,this.nextStart=s+r.length}}}class vF{constructor(t,e){this.stream=e,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=t.tokenizers.map((t=>new lF))}getActions(t){let e=0,i=null,{parser:n}=t.p,{tokenizers:r}=n,s=n.stateSlot(t.state,3),o=t.curContext?t.curContext.hash:0,l=0;for(let n=0;n<r.length;n++){if(0==(1<<n&s))continue;let a=r[n],h=this.tokens[n];if((!i||a.fallback)&&((a.contextual||h.start!=t.pos||h.mask!=s||h.context!=o)&&(this.updateCachedToken(h,a,t),h.mask=s,h.context=o),h.lookAhead>h.end+25&&(l=Math.max(h.lookAhead,l)),0!=h.value)){let n=e;if(h.extended>-1&&(e=this.addActions(t,h.extended,h.end,e)),e=this.addActions(t,h.value,h.end,e),!a.extend&&(i=h,e>n))break}}for(;this.actions.length>e;)this.actions.pop();return l&&t.setLookAhead(l),i||t.pos!=this.stream.end||(i=new lF,i.value=t.p.parser.eofTerm,i.start=i.end=t.pos,e=this.addActions(t,i.value,i.end,e)),this.mainToken=i,this.actions}getMainToken(t){if(this.mainToken)return this.mainToken;let e=new lF,{pos:i,p:n}=t;return e.start=i,e.end=Math.min(i+1,n.stream.end),e.value=i==n.stream.end?n.parser.eofTerm:0,e}updateCachedToken(t,e,i){if(e.token(this.stream.reset(i.pos,t),i),t.value>-1){let{parser:e}=i.p;for(let n=0;n<e.specialized.length;n++)if(e.specialized[n]==t.value){let r=e.specializers[n](this.stream.read(t.start,t.end),i);if(r>=0&&i.p.parser.dialect.allows(r>>1)){0==(1&r)?t.value=r>>1:t.extended=r>>1;break}}}else t.value=0,t.end=Math.min(i.p.stream.end,i.pos+1)}putAction(t,e,i,n){for(let e=0;e<n;e+=3)if(this.actions[e]==t)return n;return this.actions[n++]=t,this.actions[n++]=e,this.actions[n++]=i,n}addActions(t,e,i,n){let{state:r}=t,{parser:s}=t.p,{data:o}=s;for(let t=0;t<2;t++)for(let l=s.stateSlot(r,t?2:1);;l+=3){if(65535==o[l]){if(1!=o[l+1]){0==n&&2==o[l+1]&&(n=this.putAction(CF(o,l+2),e,i,n));break}l=CF(o,l+2)}o[l]==e&&(n=this.putAction(CF(o,l+1),e,i,n))}return n}}!function(t){t[t.Distance=5]="Distance",t[t.MaxRemainingPerStep=3]="MaxRemainingPerStep",t[t.MinBufferLengthPrune=500]="MinBufferLengthPrune",t[t.ForceReduceLimit=10]="ForceReduceLimit",t[t.CutDepth=15e3]="CutDepth",t[t.CutTo=9e3]="CutTo"}(mF||(mF={}));class wF{constructor(t,e,i,n){this.parser=t,this.input=e,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.stream=new hF(e,n),this.tokens=new vF(t,this.stream),this.topTerm=t.top[1];let{from:r}=n[0];this.stacks=[iF.start(this,t.top[0],r)],this.fragments=i.length&&this.stream.end-r>4*t.bufferLength?new OF(i,t.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let t,e,i=this.stacks,n=this.minStackPos,r=this.stacks=[];for(let s=0;s<i.length;s++){let o=i[s];for(;;){if(this.tokens.mainToken=null,o.pos>n)r.push(o);else{if(this.advanceStack(o,r,i))continue;{t||(t=[],e=[]),t.push(o);let i=this.tokens.getMainToken(o);e.push(i.value,i.end)}}break}}if(!r.length){let e=t&&function(t){let e=null;for(let i of t){let t=i.p.stoppedAt;(i.pos==i.p.stream.end||null!=t&&i.pos>t)&&i.p.parser.stateFlag(i.state,2)&&(!e||e.score<i.score)&&(e=i)}return e}(t);if(e)return this.stackToTree(e);if(this.parser.strict)throw dF&&t&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+n);this.recovering||(this.recovering=5)}if(this.recovering&&t){let i=null!=this.stoppedAt&&t[0].pos>this.stoppedAt?t[0]:this.runRecovery(t,e,r);if(i)return this.stackToTree(i.forceAll())}if(this.recovering){let t=1==this.recovering?1:3*this.recovering;if(r.length>t)for(r.sort(((t,e)=>e.score-t.score));r.length>t;)r.pop();r.some((t=>t.reducePos>n))&&this.recovering--}else if(r.length>1)t:for(let t=0;t<r.length-1;t++){let e=r[t];for(let i=t+1;i<r.length;i++){let n=r[i];if(e.sameState(n)||e.buffer.length>500&&n.buffer.length>500){if(!((e.score-n.score||e.buffer.length-n.buffer.length)>0)){r.splice(t--,1);continue t}r.splice(i--,1)}}}this.minStackPos=r[0].pos;for(let t=1;t<r.length;t++)r[t].pos<this.minStackPos&&(this.minStackPos=r[t].pos);return null}stopAt(t){if(null!=this.stoppedAt&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}advanceStack(t,e,i){let n=t.pos,{parser:r}=this,s=dF?this.stackID(t)+" -> ":"";if(null!=this.stoppedAt&&n>this.stoppedAt)return t.forceReduce()?t:null;if(this.fragments){let e=t.curContext&&t.curContext.tracker.strict,i=e?t.curContext.hash:0;for(let o=this.fragments.nodeAt(n);o;){let n=this.parser.nodeSet.types[o.type.id]==o.type?r.getGoto(t.state,o.type.id):-1;if(n>-1&&o.length&&(!e||(o.prop($X.contextHash)||0)==i))return t.useNode(o,n),dF&&console.log(s+this.stackID(t)+` (via reuse of ${r.getName(o.type.id)})`),!0;if(!(o instanceof zX)||0==o.children.length||o.positions[0]>0)break;let l=o.children[0];if(!(l instanceof zX&&0==o.positions[0]))break;o=l}}let o=r.stateSlot(t.state,4);if(o>0)return t.reduce(o),dF&&console.log(s+this.stackID(t)+` (via always-reduce ${r.getName(65535&o)})`),!0;if(t.stack.length>=15e3)for(;t.stack.length>9e3&&t.forceReduce(););let l=this.tokens.getActions(t);for(let o=0;o<l.length;){let a=l[o++],h=l[o++],c=l[o++],u=o==l.length||!i,f=u?t:t.split();if(f.apply(a,h,c),dF&&console.log(s+this.stackID(f)+` (via ${0==(65536&a)?"shift":`reduce of ${r.getName(65535&a)}`} for ${r.getName(h)} @ ${n}${f==t?"":", split"})`),u)return!0;f.pos>n?e.push(f):i.push(f)}return!1}advanceFully(t,e){let i=t.pos;for(;;){if(!this.advanceStack(t,null,null))return!1;if(t.pos>i)return yF(t,e),!0}}runRecovery(t,e,i){let n=null,r=!1;for(let s=0;s<t.length;s++){let o=t[s],l=e[s<<1],a=e[1+(s<<1)],h=dF?this.stackID(o)+" -> ":"";if(o.deadEnd){if(r)continue;if(r=!0,o.restart(),dF&&console.log(h+this.stackID(o)+" (restarted)"),this.advanceFully(o,i))continue}let c=o.split(),u=h;for(let t=0;c.forceReduce()&&t<10;t++){if(dF&&console.log(u+this.stackID(c)+" (via force-reduce)"),this.advanceFully(c,i))break;dF&&(u=this.stackID(c)+" -> ")}for(let t of o.recoverByInsert(l))dF&&console.log(h+this.stackID(t)+" (via recover-insert)"),this.advanceFully(t,i);this.stream.end>o.pos?(a==o.pos&&(a++,l=0),o.recoverByDelete(l,a),dF&&console.log(h+this.stackID(o)+` (via recover-delete ${this.parser.getName(l)})`),yF(o,i)):(!n||n.score<o.score)&&(n=o)}return n}stackToTree(t){return t.close(),zX.build({buffer:oF.create(t),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:t.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(t){let e=(pF||(pF=new WeakMap)).get(t);return e||pF.set(t,e=String.fromCodePoint(this.nextStackID++)),e+t}}function yF(t,e){for(let i=0;i<e.length;i++){let n=e[i];if(n.pos==t.pos&&n.sameState(t))return void(e[i].score<t.score&&(e[i]=t))}e.push(t)}class xF{constructor(t,e,i){this.source=t,this.flags=e,this.disabled=i}allows(t){return!this.disabled||0==this.disabled[t]}}const kF=t=>t;class SF extends class{startParse(t,e,i){return"string"==typeof t&&(t=new eF(t)),i=i?i.length?i.map((t=>new RX(t.from,t.to))):[new RX(0,0)]:[new RX(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let t=n.advance();if(t)return t}}}{constructor(t){if(super(),this.wrappers=[],14!=t.version)throw new RangeError(`Parser version (${t.version}) doesn't match runtime version (14)`);let e=t.nodeNames.split(" ");this.minRepeatTerm=e.length;for(let i=0;i<t.repeatNodeCount;i++)e.push("");let i=Object.keys(t.topRules).map((e=>t.topRules[e][1])),n=[];for(let t=0;t<e.length;t++)n.push([]);function r(t,e,i){n[t].push([e,e.deserialize(String(i))])}if(t.nodeProps)for(let e of t.nodeProps){let t=e[0];"string"==typeof t&&(t=$X[t]);for(let i=1;i<e.length;){let n=e[i++];if(n>=0)r(n,t,e[i++]);else{let s=e[i+-n];for(let o=-n;o>0;o--)r(e[i++],t,s);i++}}}this.nodeSet=new EX(e.map(((e,r)=>DX.define({name:r>=this.minRepeatTerm?void 0:e,id:r,props:n[r],top:i.indexOf(r)>-1,error:0==r,skipped:t.skippedNodes&&t.skippedNodes.indexOf(r)>-1})))),t.propSources&&(this.nodeSet=this.nodeSet.extend(...t.propSources)),this.strict=!1,this.bufferLength=MX;let s=fF(t.tokenData);if(this.context=t.context,this.specialized=new Uint16Array(t.specialized?t.specialized.length:0),this.specializers=[],t.specialized)for(let e=0;e<t.specialized.length;e++)this.specialized[e]=t.specialized[e].term,this.specializers[e]=t.specialized[e].get;this.states=fF(t.states,Uint32Array),this.data=fF(t.stateData),this.goto=fF(t.goto),this.maxTerm=t.maxTerm,this.tokenizers=t.tokenizers.map((t=>"number"==typeof t?new cF(s,t):t)),this.topRules=t.topRules,this.dialects=t.dialects||{},this.dynamicPrecedences=t.dynamicPrecedences||null,this.tokenPrecTable=t.tokenPrec,this.termNames=t.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(t,e,i){let n=new wF(this,t,e,i);for(let r of this.wrappers)n=r(n,t,e,i);return n}getGoto(t,e,i=!1){let n=this.goto;if(e>=n[0])return-1;for(let r=n[e+1];;){let e=n[r++],s=1&e,o=n[r++];if(s&&i)return o;for(let i=r+(e>>1);r<i;r++)if(n[r]==t)return o;if(s)return-1}}hasAction(t,e){let i=this.data;for(let n=0;n<2;n++)for(let r,s=this.stateSlot(t,n?2:1);;s+=3){if(65535==(r=i[s])){if(1!=i[s+1]){if(2==i[s+1])return CF(i,s+2);break}r=i[s=CF(i,s+2)]}if(r==e||0==r)return CF(i,s+1)}return 0}stateSlot(t,e){return this.states[6*t+e]}stateFlag(t,e){return(this.stateSlot(t,0)&e)>0}validAction(t,e){if(e==this.stateSlot(t,4))return!0;for(let i=this.stateSlot(t,1);;i+=3){if(65535==this.data[i]){if(1!=this.data[i+1])return!1;i=CF(this.data,i+2)}if(e==CF(this.data,i+1))return!0}}nextStates(t){let e=[];for(let i=this.stateSlot(t,1);;i+=3){if(65535==this.data[i]){if(1!=this.data[i+1])break;i=CF(this.data,i+2)}if(0==(1&this.data[i+2])){let t=this.data[i+1];e.some(((e,i)=>1&i&&e==t))||e.push(this.data[i],t)}}return e}overrides(t,e){let i=AF(this.data,this.tokenPrecTable,e);return i<0||AF(this.data,this.tokenPrecTable,t)<i}configure(t){let e=Object.assign(Object.create(SF.prototype),this);if(t.props&&(e.nodeSet=this.nodeSet.extend(...t.props)),t.top){let i=this.topRules[t.top];if(!i)throw new RangeError(`Invalid top rule name ${t.top}`);e.top=i}return t.tokenizers&&(e.tokenizers=this.tokenizers.map((e=>{let i=t.tokenizers.find((t=>t.from==e));return i?i.to:e}))),t.specializers&&(e.specializers=this.specializers.map((e=>{let i=t.specializers.find((t=>t.from==e));return i?i.to:e}))),t.contextTracker&&(e.context=t.contextTracker),t.dialect&&(e.dialect=this.parseDialect(t.dialect)),null!=t.strict&&(e.strict=t.strict),t.wrap&&(e.wrappers=e.wrappers.concat(t.wrap)),null!=t.bufferLength&&(e.bufferLength=t.bufferLength),e}hasWrappers(){return this.wrappers.length>0}getName(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.nodeSet.types[t].name||t)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(t){let e=this.dynamicPrecedences;return null==e?0:e[t]||0}parseDialect(t){let e=Object.keys(this.dialects),i=e.map((()=>!1));if(t)for(let n of t.split(" ")){let t=e.indexOf(n);t>=0&&(i[t]=!0)}let n=null;for(let t=0;t<e.length;t++)if(!i[t])for(let i,r=this.dialects[e[t]];65535!=(i=this.data[r++]);)(n||(n=new Uint8Array(this.maxTerm+1)))[i]=1;return new xF(t,i,n)}static deserialize(t){return new SF(t)}}function CF(t,e){return t[e]|t[e+1]<<16}function AF(t,e,i){for(let n,r=e;65535!=(n=t[r]);r++)if(n==i)return r-e;return-1}let TF=0;class PF{constructor(t,e,i){this.set=t,this.base=e,this.modified=i,this.id=TF++}static define(t){if(null==t?void 0:t.base)throw new Error("Can not derive from a modified tag");let e=new PF([],null,[]);if(e.set.push(e),t)for(let i of t.set)e.set.push(i);return e}static defineModifier(){let t=new QF;return e=>e.modified.indexOf(t)>-1?e:QF.get(e.base||e,e.modified.concat(t).sort(((t,e)=>t.id-e.id)))}}let MF=0;class QF{constructor(){this.instances=[],this.id=MF++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find((i=>{return i.base==t&&(n=e,r=i.modified,n.length==r.length&&n.every(((t,e)=>t==r[e])));var n,r}));if(i)return i;let n=[],r=new PF(n,t,e);for(let t of e)t.instances.push(r);let s=RF(e);for(let e of t.set)for(let t of s)n.push(QF.get(e,t));return r}}function RF(t){let e=[t];for(let i=0;i<t.length;i++)for(let n of RF(t.slice(0,i).concat(t.slice(i+1))))e.push(n);return e}const $F=new $X;class _F{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}const DF=PF.define,EF=DF(),NF=DF(),BF=DF(NF),IF=DF(NF),zF=DF(),LF=DF(zF),WF=DF(zF),VF=DF(),jF=DF(VF),qF=DF(),HF=DF(),XF=DF(),FF=DF(XF),ZF=DF(),GF={comment:EF,lineComment:DF(EF),blockComment:DF(EF),docComment:DF(EF),name:NF,variableName:DF(NF),typeName:BF,tagName:DF(BF),propertyName:IF,attributeName:DF(IF),className:DF(NF),labelName:DF(NF),namespace:DF(NF),macroName:DF(NF),literal:zF,string:LF,docString:DF(LF),character:DF(LF),attributeValue:DF(LF),number:WF,integer:DF(WF),float:DF(WF),bool:DF(zF),regexp:DF(zF),escape:DF(zF),color:DF(zF),url:DF(zF),keyword:qF,self:DF(qF),null:DF(qF),atom:DF(qF),unit:DF(qF),modifier:DF(qF),operatorKeyword:DF(qF),controlKeyword:DF(qF),definitionKeyword:DF(qF),moduleKeyword:DF(qF),operator:HF,derefOperator:DF(HF),arithmeticOperator:DF(HF),logicOperator:DF(HF),bitwiseOperator:DF(HF),compareOperator:DF(HF),updateOperator:DF(HF),definitionOperator:DF(HF),typeOperator:DF(HF),controlOperator:DF(HF),punctuation:XF,separator:DF(XF),bracket:FF,angleBracket:DF(FF),squareBracket:DF(FF),paren:DF(FF),brace:DF(FF),content:VF,heading:jF,heading1:DF(jF),heading2:DF(jF),heading3:DF(jF),heading4:DF(jF),heading5:DF(jF),heading6:DF(jF),contentSeparator:DF(VF),list:DF(VF),quote:DF(VF),emphasis:DF(VF),strong:DF(VF),link:DF(VF),monospace:DF(VF),strikethrough:DF(VF),inserted:DF(),deleted:DF(),changed:DF(),invalid:DF(),meta:ZF,documentMeta:DF(ZF),annotation:DF(ZF),processingInstruction:DF(ZF),definition:PF.defineModifier(),constant:PF.defineModifier(),function:PF.defineModifier(),standard:PF.defineModifier(),local:PF.defineModifier(),special:PF.defineModifier()};!function(t,e){let i=Object.create(null);for(let e of t)if(Array.isArray(e.tag))for(let t of e.tag)i[t.id]=e.class;else i[e.tag.id]=e.class;let{scope:n,all:r=null}=e||{}}([{tag:GF.link,class:"tok-link"},{tag:GF.heading,class:"tok-heading"},{tag:GF.emphasis,class:"tok-emphasis"},{tag:GF.strong,class:"tok-strong"},{tag:GF.keyword,class:"tok-keyword"},{tag:GF.atom,class:"tok-atom"},{tag:GF.bool,class:"tok-bool"},{tag:GF.url,class:"tok-url"},{tag:GF.labelName,class:"tok-labelName"},{tag:GF.inserted,class:"tok-inserted"},{tag:GF.deleted,class:"tok-deleted"},{tag:GF.literal,class:"tok-literal"},{tag:GF.string,class:"tok-string"},{tag:GF.number,class:"tok-number"},{tag:[GF.regexp,GF.escape,GF.special(GF.string)],class:"tok-string2"},{tag:GF.variableName,class:"tok-variableName"},{tag:GF.local(GF.variableName),class:"tok-variableName tok-local"},{tag:GF.definition(GF.variableName),class:"tok-variableName tok-definition"},{tag:GF.special(GF.variableName),class:"tok-variableName2"},{tag:GF.definition(GF.propertyName),class:"tok-propertyName tok-definition"},{tag:GF.typeName,class:"tok-typeName"},{tag:GF.namespace,class:"tok-namespace"},{tag:GF.className,class:"tok-className"},{tag:GF.macroName,class:"tok-macroName"},{tag:GF.propertyName,class:"tok-propertyName"},{tag:GF.operator,class:"tok-operator"},{tag:GF.comment,class:"tok-comment"},{tag:GF.meta,class:"tok-meta"},{tag:GF.invalid,class:"tok-invalid"},{tag:GF.punctuation,class:"tok-punctuation"}]);const UF=282,YF=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],KF=new class{constructor(t){this.start=t.start,this.shift=t.shift||kF,this.reduce=t.reduce||kF,this.reuse=t.reuse||kF,this.hash=t.hash||(()=>0),this.strict=!1!==t.strict}}({start:!1,shift:(t,e)=>5==e||6==e||286==e?t:287==e,strict:!1}),JF=new uF(((t,e)=>{let{next:i}=t;(125==i||-1==i||e.context)&&e.canShift(284)&&t.acceptToken(284)}),{contextual:!0,fallback:!0}),tZ=new uF(((t,e)=>{let i,{next:n}=t;YF.indexOf(n)>-1||(47!=n||47!=(i=t.peek(1))&&42!=i)&&125!=n&&59!=n&&-1!=n&&!e.context&&e.canShift(281)&&t.acceptToken(281)}),{contextual:!0}),eZ=new uF(((t,e)=>{let{next:i}=t;if((43==i||45==i)&&(t.advance(),i==t.next)){t.advance();let i=!e.context&&e.canShift(2);t.acceptToken(i?2:3)}}),{contextual:!0}),iZ=new uF((t=>{for(let e=!1,i=0;;i++){let{next:n}=t;if(n<0){i&&t.acceptToken(UF);break}if(96==n){i?t.acceptToken(UF):t.acceptToken(283,1);break}if(123==n&&e){1==i?t.acceptToken(4,1):t.acceptToken(UF,-1);break}if(10==n&&i){t.advance(),t.acceptToken(UF);break}92==n&&t.advance(),e=36==n,t.advance()}})),nZ=new uF(((t,e)=>{if(101==t.next&&e.dialectEnabled(1)){t.advance();for(let e=0;e<6;e++){if(t.next!="xtends".charCodeAt(e))return;t.advance()}t.next>=57&&t.next<=65||t.next>=48&&t.next<=90||95==t.next||t.next>=97&&t.next<=122||t.next>160||t.acceptToken(1)}})),rZ=function(t){let e=Object.create(null);for(let i in t){let n=t[i];Array.isArray(n)||(n=[n]);for(let t of i.split(" "))if(t){let i=[],r=2,s=t;for(let e=0;;){if("..."==s&&e>0&&e+3==t.length){r=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!n)throw new RangeError("Invalid path: "+t);if(i.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),e+=n[0].length,e==t.length)break;let o=t[e++];if(e==t.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+t);s=t.slice(e)}let o=i.length-1,l=i[o];if(!l)throw new RangeError("Invalid path: "+t);let a=new _F(n,r,o>0?i.slice(0,o):null);e[l]=a.sort(e[l])}}return $F.add(e)}({"get set async static":GF.modifier,"for while do if else switch try catch finally return throw break continue default case":GF.controlKeyword,"in of await yield void typeof delete instanceof":GF.operatorKeyword,"let var const function class extends":GF.definitionKeyword,"import export from":GF.moduleKeyword,"with debugger as new":GF.keyword,TemplateString:GF.special(GF.string),Super:GF.atom,BooleanLiteral:GF.bool,this:GF.self,null:GF.null,Star:GF.modifier,VariableName:GF.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":GF.function(GF.variableName),VariableDefinition:GF.definition(GF.variableName),Label:GF.labelName,PropertyName:GF.propertyName,PrivatePropertyName:GF.special(GF.propertyName),"CallExpression/MemberExpression/PropertyName":GF.function(GF.propertyName),"FunctionDeclaration/VariableDefinition":GF.function(GF.definition(GF.variableName)),"ClassDeclaration/VariableDefinition":GF.definition(GF.className),PropertyDefinition:GF.definition(GF.propertyName),PrivatePropertyDefinition:GF.definition(GF.special(GF.propertyName)),UpdateOp:GF.updateOperator,LineComment:GF.lineComment,BlockComment:GF.blockComment,Number:GF.number,String:GF.string,ArithOp:GF.arithmeticOperator,LogicOp:GF.logicOperator,BitOp:GF.bitwiseOperator,CompareOp:GF.compareOperator,RegExp:GF.regexp,Equals:GF.definitionOperator,"Arrow : Spread":GF.punctuation,"( )":GF.paren,"[ ]":GF.squareBracket,"{ }":GF.brace,"InterpolationStart InterpolationEnd":GF.special(GF.brace),".":GF.derefOperator,", ;":GF.separator,TypeName:GF.typeName,TypeDefinition:GF.definition(GF.typeName),"type enum interface implements namespace module declare":GF.definitionKeyword,"abstract global Privacy readonly override":GF.modifier,"is keyof unique infer":GF.operatorKeyword,JSXAttributeValue:GF.attributeValue,JSXText:GF.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":GF.angleBracket,"JSXIdentifier JSXNameSpacedName":GF.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":GF.attributeName}),sZ={__proto__:null,export:18,as:23,from:29,default:32,async:37,function:38,this:48,true:56,false:56,void:66,typeof:70,null:86,super:88,new:122,await:139,yield:141,delete:142,class:152,extends:154,public:197,private:197,protected:197,readonly:199,instanceof:220,in:222,const:224,import:256,keyof:307,unique:311,infer:317,is:351,abstract:371,implements:373,type:375,let:378,var:380,interface:387,enum:391,namespace:397,module:399,declare:403,global:407,for:428,of:437,while:440,with:444,do:448,if:452,else:454,switch:458,case:464,try:470,catch:474,finally:478,return:482,throw:486,break:490,continue:494,debugger:498},oZ={__proto__:null,async:109,get:111,set:113,public:161,private:161,protected:161,static:163,abstract:165,override:167,readonly:173,new:355},lZ={__proto__:null,"<":129},aZ=SF.deserialize({version:14,states:"$8SO`QdOOO'QQ(C|O'#ChO'XOWO'#DVO)dQdO'#D]O)tQdO'#DhO){QdO'#DrO-xQdO'#DxOOQO'#E]'#E]O.]Q`O'#E[O.bQ`O'#E[OOQ(C['#Ef'#EfO0aQ(C|O'#ItO2wQ(C|O'#IuO3eQ`O'#EzO3jQ!bO'#FaOOQ(C['#FS'#FSO3rO#tO'#FSO4QQ&jO'#FhO5bQ`O'#FgOOQ(C['#Iu'#IuOOQ(CW'#It'#ItOOQS'#J^'#J^O5gQ`O'#HpO5lQ(ChO'#HqOOQS'#Ih'#IhOOQS'#Hr'#HrQ`QdOOO){QdO'#DjO5tQ`O'#G[O5yQ&jO'#CmO6XQ`O'#EZO6dQ`O'#EgO6iQ,UO'#FRO7TQ`O'#G[O7YQ`O'#G`O7eQ`O'#G`O7sQ`O'#GcO7sQ`O'#GdO7sQ`O'#GfO5tQ`O'#GiO8dQ`O'#GlO9rQ`O'#CdO:SQ`O'#GyO:[Q`O'#HPO:[Q`O'#HRO`QdO'#HTO:[Q`O'#HVO:[Q`O'#HYO:aQ`O'#H`O:fQ(CjO'#HfO){QdO'#HhO:qQ(CjO'#HjO:|Q(CjO'#HlO5lQ(ChO'#HnO){QdO'#DWOOOW'#Ht'#HtO;XOWO,59qOOQ(C[,59q,59qO=jQtO'#ChO=tQdO'#HuO>XQ`O'#IvO@WQtO'#IvO'dQdO'#IvO@_Q`O,59wO@uQ7[O'#DbOAnQ`O'#E]OA{Q`O'#JROBWQ`O'#JQOBWQ`O'#JQOB`Q`O,5:yOBeQ`O'#JPOBlQaO'#DyO5yQ&jO'#EZOBzQ`O'#EZOCVQpO'#FROOQ(C[,5:S,5:SOC_QdO,5:SOE]Q(C|O,5:^OEyQ`O,5:dOFdQ(ChO'#JOO7YQ`O'#I}OFkQ`O'#I}OFsQ`O,5:xOFxQ`O'#I}OGWQdO,5:vOIWQ&jO'#EWOJeQ`O,5:vOKwQ&jO'#DlOLOQdO'#DqOLYQ7[O,5;PO){QdO,5;POOQS'#Er'#ErOOQS'#Et'#EtO){QdO,5;RO){QdO,5;RO){QdO,5;RO){QdO,5;RO){QdO,5;RO){QdO,5;RO){QdO,5;RO){QdO,5;RO){QdO,5;RO){QdO,5;RO){QdO,5;ROOQS'#Ex'#ExOLbQdO,5;cOOQ(C[,5;h,5;hOOQ(C[,5;i,5;iONbQ`O,5;iOOQ(C[,5;j,5;jO){QdO'#IPONgQ(ChO,5<TO! RQ&jO,5;RO){QdO,5;fO! kQ!bO'#JVO! YQ!bO'#JVO! rQ!bO'#JVO!!TQ!bO,5;qOOOO,5;{,5;{O!!cQdO'#FcOOOO'#IO'#IOO3rO#tO,5;nO!!jQ!bO'#FeOOQ(C[,5;n,5;nO!#WQ,VO'#CrOOQ(C]'#Cu'#CuO!#kQ`O'#CuO!#pOWO'#CyO!$^Q,VO,5<QO!$eQ`O,5<SO!%tQ&jO'#FrO!&RQ`O'#FsO!&WQ`O'#FsO!&]Q&jO'#FwO!'[Q7[O'#F{O!'}Q,VO'#IqOOQ(C]'#Iq'#IqO!(XQaO'#IpO!(gQ`O'#IoO!(oQ`O'#CqOOQ(C]'#Cs'#CsOOQ(C]'#C|'#C|O!(wQ`O'#DOOJjQ&jO'#FjOJjQ&jO'#FlO!(|Q`O'#FnO!)RQ`O'#FoO!&WQ`O'#FuOJjQ&jO'#FzO!)WQ`O'#E^O!)oQ`O,5<RO`QdO,5>[OOQS'#Ik'#IkOOQS,5>],5>]OOQS-E;p-E;pO!+kQ(C|O,5:UOOQ(CX'#Cp'#CpO!,[Q&kO,5<vOOQO'#Cf'#CfO!,mQ(ChO'#IlO5bQ`O'#IlO:aQ`O,59XO!-OQ!bO,59XO!-WQ&jO,59XO5yQ&jO,59XO!-cQ`O,5:vO!-kQ`O'#GxO!-yQ`O'#JbO){QdO,5;kO!.RQ7[O,5;mO!.WQ`O,5=cO!.]Q`O,5=cO!.bQ`O,5=cO5lQ(ChO,5=cO5tQ`O,5<vO!.pQ`O'#E_O!/UQ7[O'#E`OOQ(CW'#JP'#JPO!/gQ(ChO'#J_O5lQ(ChO,5<zO7sQ`O,5=QOOQP'#Cr'#CrO!/rQ!bO,5<}O!/zQ!cO,5=OO!0VQ`O,5=QO!0[QpO,5=TO:aQ`O'#GnO5tQ`O'#GpO!0dQ`O'#GpO5yQ&jO'#GsO!0iQ`O'#GsOOQS,5=W,5=WO!0nQ`O'#GtO!0vQ`O'#CmO!0{Q`O,59OO!1VQ`O,59OO!3XQdO,59OOOQS,59O,59OO!3fQ(ChO,59OO){QdO,59OO!3qQdO'#G{OOQS'#G|'#G|OOQS'#G}'#G}O`QdO,5=eO!4RQ`O,5=eO){QdO'#DxO`QdO,5=kO`QdO,5=mO!4WQ`O,5=oO`QdO,5=qO!4]Q`O,5=tO!4bQdO,5=zOOQS,5>Q,5>QO){QdO,5>QO5lQ(ChO,5>SOOQS,5>U,5>UO!8cQ`O,5>UOOQS,5>W,5>WO!8cQ`O,5>WOOQS,5>Y,5>YO!8hQpO,59rOOOW-E;r-E;rOOQ(C[1G/]1G/]O!8mQtO,5>aO'dQdO,5>aOOQO,5>f,5>fO!8wQdO'#HuOOQO-E;s-E;sO!9UQ`O,5?bO!9^QtO,5?bO!9eQ`O,5?lOOQ(C[1G/c1G/cO!9mQ!bO'#DTOOQO'#Ix'#IxO){QdO'#IxO!:[Q!bO'#IxO!:yQ!bO'#DcO!;[Q7[O'#DcO!=gQdO'#DcO!=nQ`O'#IwO!=vQ`O,59|O!={Q`O'#EaO!>ZQ`O'#JSO!>cQ`O,5:zO!>yQ7[O'#DcO){QdO,5?mO!?TQ`O'#HzOOQO-E;x-E;xO!9eQ`O,5?lOOQ(CW1G0e1G0eO!@aQ7[O'#D|OOQ(C[,5:e,5:eO){QdO,5:eOIWQ&jO,5:eO!@hQaO,5:eO:aQ`O,5:uO!-OQ!bO,5:uO!-WQ&jO,5:uO5yQ&jO,5:uOOQ(C[1G/n1G/nOOQ(C[1G0O1G0OOOQ(CW'#EV'#EVO){QdO,5?jO!@sQ(ChO,5?jO!AUQ(ChO,5?jO!A]Q`O,5?iO!AeQ`O'#H|O!A]Q`O,5?iOOQ(CW1G0d1G0dO7YQ`O,5?iOOQ(C[1G0b1G0bO!BPQ(C|O1G0bO!CRQ(CyO,5:rOOQ(C]'#Fq'#FqO!CoQ(C}O'#IqOGWQdO1G0bO!EqQ,VO'#IyO!E{Q`O,5:WO!FQQtO'#IzO){QdO'#IzO!F[Q`O,5:]OOQ(C]'#DT'#DTOOQ(C[1G0k1G0kO!FaQ`O1G0kO!HrQ(C|O1G0mO!HyQ(C|O1G0mO!K^Q(C|O1G0mO!KeQ(C|O1G0mO!MlQ(C|O1G0mO!NPQ(C|O1G0mO#!pQ(C|O1G0mO#!wQ(C|O1G0mO#%[Q(C|O1G0mO#%cQ(C|O1G0mO#'WQ(C|O1G0mO#*QQMlO'#ChO#+{QMlO1G0}O#-vQMlO'#IuOOQ(C[1G1T1G1TO#.ZQ(C|O,5>kOOQ(CW-E;}-E;}O#.zQ(C}O1G0mOOQ(C[1G0m1G0mO#1PQ(C|O1G1QO#1pQ!bO,5;sO#1uQ!bO,5;tO#1zQ!bO'#F[O#2`Q`O'#FZOOQO'#JW'#JWOOQO'#H}'#H}O#2eQ!bO1G1]OOQ(C[1G1]1G1]OOOO1G1f1G1fO#2sQMlO'#ItO#2}Q`O,5;}OLbQdO,5;}OOOO-E;|-E;|OOQ(C[1G1Y1G1YOOQ(C[,5<P,5<PO#3SQ!bO,5<POOQ(C],59a,59aOIWQ&jO'#C{OOOW'#Hs'#HsO#3XOWO,59eOOQ(C],59e,59eO){QdO1G1lO!)RQ`O'#IRO#3dQ`O,5<eOOQ(C],5<b,5<bOOQO'#GV'#GVOJjQ&jO,5<pOOQO'#GX'#GXOJjQ&jO,5<rOIWQ&jO,5<tOOQO1G1n1G1nO#3oQqO'#CpO#4SQqO,5<^O#4ZQ`O'#JZO5tQ`O'#JZO#4iQ`O,5<`OJjQ&jO,5<_O#4nQ`O'#FtO#4yQ`O,5<_O#5OQqO'#FqO#5]QqO'#J[O#5gQ`O'#J[OIWQ&jO'#J[O#5lQ`O,5<cOOQ(CW'#Dg'#DgO#5qQ!bO'#F|O!'VQ7[O'#F|O!'VQ7[O'#GOO#6SQ`O'#GPO!&WQ`O'#GSO#6XQ(ChO'#ITO#6dQ7[O,5<gOOQ(C],5<g,5<gO#6kQ7[O'#F|O#6yQ7[O'#F}O#7RQ7[O'#F}OOQ(C],5<u,5<uOJjQ&jO,5?[OJjQ&jO,5?[O#7WQ`O'#IUO#7cQ`O,5?ZO#7kQ`O,59]OOQ(C]'#Ch'#ChO#8[Q,VO,59jOOQ(C],59j,59jO#8}Q,VO,5<UO#9pQ,VO,5<WO#9zQ`O,5<YOOQ(C],5<Z,5<ZO#:PQ`O,5<aO#:UQ,VO,5<fOGWQdO1G1mO#:fQ`O1G1mOOQS1G3v1G3vOOQ(C[1G/p1G/pONbQ`O1G/pOOQS1G2b1G2bOIWQ&jO1G2bO){QdO1G2bOIWQ&jO1G2bO#:kQaO1G2bO#<QQ&jO'#EWOOQ(CW,5?W,5?WO#<[Q(ChO,5?WOOQS1G.s1G.sO:aQ`O1G.sO!-OQ!bO1G.sO!-WQ&jO1G.sO#<mQ`O1G0bO#<rQ`O'#ChO#<}Q`O'#JcO#=VQ`O,5=dO#=[Q`O'#JcO#=aQ`O'#JcO#=iQ`O'#I^O#=wQ`O,5?|O#>PQtO1G1VOOQ(C[1G1X1G1XO5tQ`O1G2}O#>WQ`O1G2}O#>]Q`O1G2}O#>bQ`O1G2}OOQS1G2}1G2}O#>gQ&kO1G2bO7YQ`O'#JQO7YQ`O'#EaO7YQ`O'#IWO#>xQ(ChO,5?yOOQS1G2f1G2fO!0VQ`O1G2lOIWQ&jO1G2iO#?TQ`O1G2iOOQS1G2j1G2jOIWQ&jO1G2jO#?YQaO1G2jO#?bQ7[O'#GhOOQS1G2l1G2lO!'VQ7[O'#IYO!0[QpO1G2oOOQS1G2o1G2oOOQS,5=Y,5=YO#?jQ&kO,5=[O5tQ`O,5=[O#6SQ`O,5=_O5bQ`O,5=_O!-OQ!bO,5=_O!-WQ&jO,5=_O5yQ&jO,5=_O#?{Q`O'#JaO#@WQ`O,5=`OOQS1G.j1G.jO#@]Q(ChO1G.jO#@hQ`O1G.jO#@mQ`O1G.jO5lQ(ChO1G.jO#@uQtO,5@OO#APQ`O,5@OO#A[QdO,5=gO#AcQ`O,5=gO7YQ`O,5@OOOQS1G3P1G3PO`QdO1G3POOQS1G3V1G3VOOQS1G3X1G3XO:[Q`O1G3ZO#AhQdO1G3]O#EcQdO'#H[OOQS1G3`1G3`O#EpQ`O'#HbO:aQ`O'#HdOOQS1G3f1G3fO#ExQdO1G3fO5lQ(ChO1G3lOOQS1G3n1G3nOOQ(CW'#Fx'#FxO5lQ(ChO1G3pO5lQ(ChO1G3rOOOW1G/^1G/^O#IvQpO,5<TO#JOQtO1G3{OOQO1G4Q1G4QO){QdO,5>aO#JYQ`O1G4|O#JbQ`O1G5WO#JjQ`O,5?dOLbQdO,5:{O7YQ`O,5:{O:aQ`O,59}OLbQdO,59}O!-OQ!bO,59}O#JoQMlO,59}OOQO,5:{,5:{O#JyQ7[O'#HvO#KaQ`O,5?cOOQ(C[1G/h1G/hO#KiQ7[O'#H{O#K}Q`O,5?nOOQ(CW1G0f1G0fO!;[Q7[O,59}O#LVQtO1G5XO7YQ`O,5>fOOQ(CW'#ES'#ESO#LaQ(DjO'#ETO!@XQ7[O'#D}OOQO'#Hy'#HyO#L{Q7[O,5:hOOQ(C[,5:h,5:hO#MSQ7[O'#D}O#MeQ7[O'#D}O#MlQ7[O'#EYO#MoQ7[O'#ETO#M|Q7[O'#ETO!@XQ7[O'#ETO#NaQ`O1G0PO#NfQqO1G0POOQ(C[1G0P1G0PO){QdO1G0POIWQ&jO1G0POOQ(C[1G0a1G0aO:aQ`O1G0aO!-OQ!bO1G0aO!-WQ&jO1G0aO#NmQ(C|O1G5UO){QdO1G5UO#N}Q(ChO1G5UO$ `Q`O1G5TO7YQ`O,5>hOOQO,5>h,5>hO$ hQ`O,5>hOOQO-E;z-E;zO$ `Q`O1G5TO$ vQ(C}O,59jO$#xQ(C}O,5<UO$%}Q(C}O,5<WO$(SQ(C}O,5<fOOQ(C[7+%|7+%|O$*_Q(C|O7+%|O$+OQ&jO'#HwO$+YQ`O,5?eOOQ(C]1G/r1G/rO$+bQdO'#HxO$+oQ`O,5?fO$+wQtO,5?fOOQ(C[1G/w1G/wOOQ(C[7+&V7+&VO$,RQMlO,5:^O){QdO7+&iO$,]QMlO,5:UOOQO1G1_1G1_OOQO1G1`1G1`O$,jQ!LQO,5;vOLbQdO,5;uOOQO-E;{-E;{OOQ(C[7+&w7+&wOOOO7+'Q7+'QOOOO1G1i1G1iO$,uQ`O1G1iOOQ(C[1G1k1G1kO$,zQqO,59gOOOW-E;q-E;qOOQ(C]1G/P1G/PO$-RQ(C|O7+'WOOQ(C],5>m,5>mO$-rQ`O,5>mOOQ(C]1G2P1G2PP$-wQ`O'#IRPOQ(C]-E<P-E<PO$.hQ,VO1G2[O$/ZQ,VO1G2^O$/eQqO1G2`OOQ(C]1G1x1G1xO$/lQ`O'#IQO$/zQ`O,5?uO$/zQ`O,5?uO$0SQ`O,5?uO$0_Q`O,5?uOOQO1G1z1G1zO$0mQ,VO1G1yOJjQ&jO1G1yO$0}Q&jO'#ISO$1_Q`O,5?vOIWQ&jO,5?vO$1gQqO,5?vOOQ(C]1G1}1G1}OOQ(CW,5<h,5<hOOQ(CW,5<i,5<iO$1qQ`O,5<iO#5}Q`O,5<iO!-OQ!bO,5<hO$1vQ`O,5<jOOQ(CW,5<k,5<kO$1qQ`O,5<nOOQO,5>o,5>oOOQO-E<R-E<ROOQ(C]1G2R1G2RO!'VQ7[O,5<hO$2OQ`O,5<iO!'VQ7[O,5<jO!'VQ7[O,5<iO$2ZQ,VO1G4vO$2eQ,VO1G4vOOQO,5>p,5>pOOQO-E<S-E<SOOQP1G.w1G.wO!.RQ7[O,59lO){QdO,59lO$2rQ`O1G1tOJjQ&jO1G1{O$2wQ(C|O7+'XOOQ(C[7+'X7+'XOGWQdO7+'XOOQ(C[7+%[7+%[O$3hQqO'#J]O#NaQ`O7+'|O$3rQ`O7+'|O$3zQqO7+'|OOQS7+'|7+'|OIWQ&jO7+'|O){QdO7+'|OIWQ&jO7+'|O$4UQ(CyO'#ChO$4iQ(CyO,5<lO$5ZQ`O,5<lOOQ(CW1G4r1G4rOOQS7+$_7+$_O:aQ`O7+$_O!-OQ!bO7+$_OGWQdO7+%|O$5`Q`O'#I]O$5qQ`O,5?}OOQO1G3O1G3OO5tQ`O,5?}O$5qQ`O,5?}O$5yQ`O,5?}OOQO,5>x,5>xOOQO-E<[-E<[OOQ(C[7+&q7+&qO$6OQ`O7+(iO5lQ(ChO7+(iO5tQ`O7+(iO$6TQ`O7+(iO$6YQaO7+'|OOQ(CW,5>r,5>rOOQ(CW-E<U-E<UOOQS7+(W7+(WO$6hQ(CyO7+(TOIWQ&jO7+(TO$6rQqO7+(UOOQS7+(U7+(UOIWQ&jO7+(UO$6yQ`O'#J`O$7UQ`O,5=SOOQO,5>t,5>tOOQO-E<W-E<WOOQS7+(Z7+(ZO$8OQ7[O'#GqOOQS1G2v1G2vOIWQ&jO1G2vO){QdO1G2vOIWQ&jO1G2vO$8VQaO1G2vO$8eQ&kO1G2vO5lQ(ChO1G2yO#6SQ`O1G2yO5bQ`O1G2yO!-OQ!bO1G2yO!-WQ&jO1G2yO$8vQ`O'#I[O$9RQ`O,5?{O$9ZQ7[O,5?{OOQ(CW1G2z1G2zOOQS7+$U7+$UO$9cQ`O7+$UO5lQ(ChO7+$UO$9hQ`O7+$UO){QdO1G5jO){QdO1G5kO$9mQdO1G3RO$9tQ`O1G3RO$9yQdO1G3RO$:QQ(ChO1G5jOOQS7+(k7+(kO5lQ(ChO7+(uO`QdO7+(wOOQS'#Jf'#JfOOQS'#I_'#I_O$:[QdO,5=vOOQS,5=v,5=vO){QdO'#H]O$:iQ`O'#H_OOQS,5=|,5=|O7YQ`O,5=|OOQS,5>O,5>OOOQS7+)Q7+)QOOQS7+)W7+)WOOQS7+)[7+)[OOQS7+)^7+)^OOQO1G5O1G5OO$:nQMlO1G0gO$:xQ`O1G0gOOQO1G/i1G/iO$;TQMlO1G/iO:aQ`O1G/iOLbQdO'#DcOOQO,5>b,5>bOOQO-E;t-E;tOOQO,5>g,5>gOOQO-E;y-E;yO!-OQ!bO1G/iO:aQ`O,5:iOOQO,5:o,5:oO){QdO,5:oO$;_Q(ChO,5:oO$;jQ(ChO,5:oO!-OQ!bO,5:iOOQO-E;w-E;wOOQ(C[1G0S1G0SO!@XQ7[O,5:iO$;xQ7[O,5:iO$<ZQ(DjO,5:oO$<uQ7[O,5:iO!@XQ7[O,5:oOOQO,5:t,5:tO$<|Q7[O,5:oO$=ZQ(ChO,5:oOOQ(C[7+%k7+%kO#NaQ`O7+%kO#NfQqO7+%kOOQ(C[7+%{7+%{O:aQ`O7+%{O!-OQ!bO7+%{O$=oQ(C|O7+*pO){QdO7+*pOOQO1G4S1G4SO7YQ`O1G4SO$>PQ`O7+*oO$>XQ(C}O1G2[O$@^Q(C}O1G2^O$BcQ(C}O1G1yO$DnQ,VO,5>cOOQO-E;u-E;uO$DxQtO,5>dO){QdO,5>dOOQO-E;v-E;vO$ESQ`O1G5QO$E[QMlO1G0bO$GcQMlO1G0mO$GjQMlO1G0mO$IkQMlO1G0mO$IrQMlO1G0mO$KgQMlO1G0mO$KzQMlO1G0mO$NXQMlO1G0mO$N`QMlO1G0mO%!aQMlO1G0mO%!hQMlO1G0mO%$]QMlO1G0mO%$pQ(C|O<<JTO%%rQMmO1G0mO%'|QMmO'#IqO%)iQMlO1G1QOLbQdO'#F^OOQO'#JX'#JXOOQO1G1b1G1bO%)vQ`O1G1aO%){QMlO,5>kOOOO7+'T7+'TOOOW1G/R1G/ROOQ(C]1G4X1G4XOJjQ&jO7+'zO%*VQ`O,5>lO5tQ`O,5>lOOQO-E<O-E<OO%*eQ`O1G5aO%*eQ`O1G5aO%*mQ`O1G5aO%*xQ,VO7+'eO%+YQqO,5>nO%+dQ`O,5>nOIWQ&jO,5>nOOQO-E<Q-E<QO%+iQqO1G5bO%+sQ`O1G5bOOQ(CW1G2T1G2TO$1qQ`O1G2TOOQ(CW1G2S1G2SO%+{Q`O1G2UOIWQ&jO1G2UOOQ(CW1G2Y1G2YO!-OQ!bO1G2SO#5}Q`O1G2TO%,QQ`O1G2UO%,YQ`O1G2TOJjQ&jO7+*bOOQ(C]1G/W1G/WO%,eQ`O1G/WOOQ(C]7+'`7+'`O%,jQ,VO7+'gO%,zQ(C|O<<JsOOQ(C[<<Js<<JsOIWQ&jO'#IVO%-kQ`O,5?wOOQS<<Kh<<KhOIWQ&jO<<KhO#NaQ`O<<KhO%-sQ`O<<KhO%-{QqO<<KhOIWQ&jO1G2WOOQS<<Gy<<GyO:aQ`O<<GyO%.VQ(C|O<<IhOOQ(C[<<Ih<<IhOOQO,5>w,5>wO%.vQ`O,5>wO%.{Q`O,5>wOOQO-E<Z-E<ZO%/TQ`O1G5iO%/TQ`O1G5iO5tQ`O1G5iO%/]Q`O<<LTOOQS<<LT<<LTO%/bQ`O<<LTO5lQ(ChO<<LTO){QdO<<KhOIWQ&jO<<KhOOQS<<Ko<<KoO$6hQ(CyO<<KoOOQS<<Kp<<KpO$6rQqO<<KpO%/gQ7[O'#IXO%/rQ`O,5?zOLbQdO,5?zOOQS1G2n1G2nO#LaQ(DjO'#ETO!@XQ7[O'#GrOOQO'#IZ'#IZO%/zQ7[O,5=]OOQS,5=],5=]O%0RQ7[O'#ETO%0^Q7[O'#ETO%0uQ7[O'#ETO%1PQ7[O'#GrO%1bQ`O7+(bO%1gQ`O7+(bO%1oQqO7+(bOOQS7+(b7+(bOIWQ&jO7+(bO){QdO7+(bOIWQ&jO7+(bO%1yQaO7+(bOOQS7+(e7+(eO5lQ(ChO7+(eO#6SQ`O7+(eO5bQ`O7+(eO!-OQ!bO7+(eO%2XQ`O,5>vOOQO-E<Y-E<YOOQO'#Gu'#GuO%2dQ`O1G5gO5lQ(ChO<<GpOOQS<<Gp<<GpO%2lQ`O<<GpO%2qQ`O7++UO%2vQ`O7++VOOQS7+(m7+(mO%2{Q`O7+(mO%3QQdO7+(mO%3XQ`O7+(mO){QdO7++UO){QdO7++VOOQS<<La<<LaOOQS<<Lc<<LcOOQS-E<]-E<]OOQS1G3b1G3bO%3^Q`O,5=wOOQS,5=y,5=yO%3cQ`O1G3hOLbQdO7+&ROOQO7+%T7+%TO%3hQMlO1G5XO:aQ`O7+%TOOQO1G0T1G0TO%3rQ(C|O1G0ZOOQO1G0Z1G0ZO){QdO1G0ZO%3|Q(ChO1G0ZO:aQ`O1G0TO!-OQ!bO1G0TO!@XQ7[O1G0TO%4XQ(ChO1G0ZO%4gQ7[O1G0TO%4xQ(ChO1G0ZO%5^Q(DjO1G0ZO%5hQ7[O1G0TO!@XQ7[O1G0ZOOQ(C[<<IV<<IVOOQ(C[<<Ig<<IgO:aQ`O<<IgO%5oQ(C|O<<N[OOQO7+)n7+)nO%6PQ(C}O7+'eO%8[Q(C}O7+'gO%:gQtO1G4OO%:qQMlO7+%|O%;gQMmO,59jO%=hQMmO,5<UO%?lQMmO,5<WO%A[QMmO,5<fO%B}QMlO7+'WO%C[QMlO7+'XO%CiQ`O,5;xOOQO7+&{7+&{O%CnQ,VO<<KfOOQO1G4W1G4WO%CuQ`O1G4WO%DQQ`O1G4WO%D`Q`O7+*{O%D`Q`O7+*{OIWQ&jO1G4YO%DhQqO1G4YO%DrQ`O7+*|OOQ(CW7+'o7+'oO$1qQ`O7+'pO%DzQqO7+'pOOQ(CW7+'n7+'nO$1qQ`O7+'oO%ERQ`O7+'pOIWQ&jO7+'pO#5}Q`O7+'oO%EWQ,VO<<M|OOQ(C]7+$r7+$rO%EbQqO,5>qOOQO-E<T-E<TO#NaQ`OANASOOQSANASANASOIWQ&jOANASO%ElQ(CyO7+'rOOQSAN=eAN=eO5tQ`O1G4cOOQO1G4c1G4cO%E|Q`O1G4cO%FRQ`O7++TO%FRQ`O7++TO5lQ(ChOANAoO%FZQ`OANAoOOQSANAoANAoO%F`Q`OANASO%FhQqOANASOOQSANAZANAZOOQSANA[ANA[O%FrQ`O,5>sOOQO-E<V-E<VO%F}QMlO1G5fO#6SQ`O,5=^O5bQ`O,5=^O!-OQ!bO,5=^OOQO-E<X-E<XOOQS1G2w1G2wO$<ZQ(DjO,5:oO!@XQ7[O,5=^O%GXQ7[O,5=^O%GjQ7[O,5:oOOQS<<K|<<K|OIWQ&jO<<K|O%1bQ`O<<K|O%GtQ`O<<K|O%G|QqO<<K|O){QdO<<K|OIWQ&jO<<K|OOQS<<LP<<LPO5lQ(ChO<<LPO#6SQ`O<<LPO5bQ`O<<LPO%HWQ7[O1G4bO%H`Q`O7++ROOQSAN=[AN=[O5lQ(ChOAN=[OOQS<<Np<<NpOOQS<<Nq<<NqOOQS<<LX<<LXO%HhQ`O<<LXO%HmQdO<<LXO%HtQ`O<<NpO%HyQ`O<<NqOOQS1G3c1G3cO:aQ`O7+)SO%IOQMlO<<ImOOQO<<Ho<<HoOOQO7+%u7+%uO%3rQ(C|O7+%uO){QdO7+%uOOQO7+%o7+%oO:aQ`O7+%oO!-OQ!bO7+%oO%IYQ(ChO7+%uO!@XQ7[O7+%oO%IeQ(ChO7+%uO%IsQ7[O7+%oO%JUQ(ChO7+%uOOQ(C[AN?RAN?RO%JjQMlO<<JTO%JwQMmO1G1yO%MOQMmO1G2[O& SQMmO1G2^O&!rQMlO<<JsO&#PQMlO<<IhOOQO1G1d1G1dOJjQ&jOANAQOOQO7+)r7+)rO&#^Q`O7+)rO&#iQ`O<<NgO&#qQqO7+)tOOQ(CW<<K[<<K[O$1qQ`O<<K[OOQ(CW<<KZ<<KZO&#{QqO<<K[O$1qQ`O<<KZOOQSG26nG26nO#NaQ`OG26nOOQO7+)}7+)}O5tQ`O7+)}O&$SQ`O<<NoOOQSG27ZG27ZO5lQ(ChOG27ZOIWQ&jOG26nOLbQdO1G4_O&$[Q`O7++QO5lQ(ChO1G2xO#6SQ`O1G2xO5bQ`O1G2xO!-OQ!bO1G2xO!@XQ7[O1G2xO%5^Q(DjO1G0ZO&$dQ7[O1G2xO%1bQ`OANAhOOQSANAhANAhOIWQ&jOANAhO&$uQ`OANAhO&$}QqOANAhOOQSANAkANAkO5lQ(ChOANAkO#6SQ`OANAkOOQO'#Gv'#GvOOQO7+)|7+)|OOQSG22vG22vOOQSANAsANAsO&%XQ`OANAsOOQSAND[AND[OOQSAND]AND]OOQS<<Ln<<LnOOQO<<Ia<<IaO%3rQ(C|O<<IaOOQO<<IZ<<IZO:aQ`O<<IZO){QdO<<IaO!-OQ!bO<<IZO&%^Q(ChO<<IaO!@XQ7[O<<IZO&%iQ(ChO<<IaO&%wQMmO7+'eO&'jQMmO7+'gO&)]Q,VOG26lOOQO<<M^<<M^OOQ(CWAN@vAN@vO$1qQ`OAN@vOOQ(CWAN@uAN@uOOQSLD,YLD,YOOQO<<Mi<<MiOOQSLD,uLD,uO#NaQ`OLD,YO&)mQMlO7+)yOOQO7+(d7+(dO5lQ(ChO7+(dO#6SQ`O7+(dO5bQ`O7+(dO!-OQ!bO7+(dO!@XQ7[O7+(dOOQSG27SG27SO%1bQ`OG27SOIWQ&jOG27SOOQSG27VG27VO5lQ(ChOG27VOOQSG27_G27_OOQOAN>{AN>{OOQOAN>uAN>uO%3rQ(C|OAN>{O:aQ`OAN>uO){QdOAN>{O!-OQ!bOAN>uO&)wQ(ChOAN>{O&*SQ(C}OG26lOOQ(CWG26bG26bOOQS!$( t!$( tOOQO<<LO<<LOO5lQ(ChO<<LOO#6SQ`O<<LOO5bQ`O<<LOO!-OQ!bO<<LOOOQSLD,nLD,nO%1bQ`OLD,nOOQSLD,qLD,qOOQOG24gG24gOOQOG24aG24aO%3rQ(C|OG24gO:aQ`OG24aO){QdOG24gO&,pQ!LRO,5:rO&-gQ$ITO'#IqOOQOANAjANAjO5lQ(ChOANAjO#6SQ`OANAjO5bQ`OANAjOOQS!$(!Y!$(!YOOQOLD*RLD*ROOQOLD){LD){O%3rQ(C|OLD*RO&.ZQMmOG26lO&/|Q!LRO,59jO&0pQ!LRO,5<UO&1dQ!LRO,5<WO&2WQ!LRO,5<fOOQOG27UG27UO5lQ(ChOG27UO#6SQ`OG27UOOQO!$'Mm!$'MmO&2}Q!LRO1G2[O&3qQ!LRO1G2^O&4eQ!LRO1G1yOOQOLD,pLD,pO5lQ(ChOLD,pO&5[Q!LRO7+'eO&6RQ!LRO7+'gOOQO!$(![!$(![O&6xQ!LROG26lOLbQdO'#DrO&7oQtO'#ItOLbQdO'#DjO&7vQ(C|O'#ChO&8aQtO'#ChO&8qQdO,5:vO&:qQ&jO'#EWOLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO'#IPO&<OQ`O,5<TO&=eQ&jO,5;ROLbQdO,5;fO!(wQ`O'#DOO!(wQ`O'#DOO!(wQ`O'#DOOIWQ&jO'#FjO&:qQ&jO'#FjO&<WQ&jO'#FjOIWQ&jO'#FlO&:qQ&jO'#FlO&<WQ&jO'#FlOIWQ&jO'#FzO&:qQ&jO'#FzO&<WQ&jO'#FzOLbQdO,5?mO&8qQdO1G0bO&=lQMlO'#ChOLbQdO1G1lOIWQ&jO,5<pO&:qQ&jO,5<pO&<WQ&jO,5<pOIWQ&jO,5<rO&:qQ&jO,5<rO&<WQ&jO,5<rOIWQ&jO,5<_O&:qQ&jO,5<_O&<WQ&jO,5<_O&8qQdO1G1mOLbQdO7+&iOIWQ&jO1G1yO&:qQ&jO1G1yO&<WQ&jO1G1yOIWQ&jO1G1{O&:qQ&jO1G1{O&<WQ&jO1G1{O&8qQdO7+'XO&8qQdO7+%|O&=vQ`O7+'pOIWQ&jOANAQO&:qQ&jOANAQO&<WQ&jOANAQO&=vQ`O<<K[O&=vQ`OAN@vO&={Q`O'#E[O&>QQ`O'#E[O&>YQ`O'#EzO&>_Q`O'#EgO&>dQ`O'#JRO&>oQ`O'#JPO&>zQ`O,5:vO&?PQ,VO,5<QO&?WQ`O'#FsO&?]Q`O'#FsO&?bQ`O'#FsO&?gQ`O,5<RO&?oQ`O,5:vO&?wQMlO1G0}O&@OQ`O,5<_O&@TQ`O,5<_O&@YQ`O,5<_O&@_Q`O,5<aO&@dQ`O,5<aO&@iQ`O,5<aO&@nQ`O1G1mO&@sQ`O1G0bO&@xQ`O1G2UO&@}Q,VO<<KfO&AUQ,VO<<KfO&A]Q,VO<<KfO&AdQqO7+'pO&AkQ`O7+'pO&ApQqO<<K[O4QQ&jO'#FhO5bQ`O'#FgOBzQ`O'#EZOLbQdO,5;cO!&WQ`O'#FsO!&WQ`O'#FsO!&WQ`O'#FsO!&WQ`O'#FuO!&WQ`O'#FuO!&WQ`O'#FuO&AwQ`O,5<jOJjQ&jO7+'zOJjQ&jO7+'zOJjQ&jO7+'zOIWQ&jO1G2UO&BPQ`O1G2UOIWQ&jO7+'pO!'VQ7[O'#GOO$/eQqO1G2`O$/eQqO1G2`O$/eQqO1G2`O!'VQ7[O,5<jOIWQ&jO,5<tOIWQ&jO,5<tOIWQ&jO,5<t",stateData:"&B}~O'YOS'ZOSTOSUOS~OQTORTOXyO]cO_hObnOcmOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!TSO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!nlO#dsO#tpO#x^O%PqO%RtO%TrO%UrO%XuO%ZvO%^wO%_wO%axO%nzO%t{O%v|O%x}O%z!OO%}!PO&T!QO&Z!RO&]!SO&_!TO&a!UO&c!VO']PO'fQO'oYO'|aO~OQ[XZ[X_[Xj[Xu[Xv[Xx[X!R[X!a[X!b[X!d[X!j[X!{[X#WdX#[[X#][X#^[X#_[X#`[X#a[X#b[X#c[X#e[X#g[X#i[X#j[X#o[X'W[X'f[X'p[X'w[X'x[X~O!]$lX~P$zOS!WO'U!XO'V!ZO~OQTORTO]cOb!kOc!jOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!T!bO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!n!iO#t!lO#x^O']![O'fQO'oYO'|aO~O!Q!`O!R!]O!O'jP!O'tP~P'dO!S!mO~P`OQTORTO]cOb!kOc!jOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!T!bO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!n!iO#t!lO#x^O']9aO'fQO'oYO'|aO~OQTORTO]cOb!kOc!jOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!T!bO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!n!iO#t!lO#x^O'fQO'oYO'|aO~O!Q!rO#U!uO#V!rO']9bO!c'qP~P+{O#W!vO~O!]!wO#W!vO~OQ#^OZ#dOj#ROu!{Ov!{Ox!|O!R#bO!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO#g#WO#i#YO#j#ZO'fQO'p#[O'w!}O'x#OO~O_'hX'W'hX!c'hX!O'hX!T'hX%Q'hX!]'hX~P.jO!{#eO#o#eOQ'iXZ'iX_'iXj'iXu'iXv'iXx'iX!R'iX!a'iX!b'iX!d'iX!j'iX#['iX#]'iX#^'iX#_'iX#`'iX#a'iX#b'iX#e'iX#g'iX#i'iX#j'iX'f'iX'p'iX'w'iX'x'iX~O#c'iX'W'iX!O'iX!c'iXn'iX!T'iX%Q'iX!]'iX~P0zO!{#eO~O#z#fO$R#jO~O!T#kO#x^O$U#lO$W#nO~O]#qOh$QOj#rOk#qOl#qOq$ROs$SOx#yO!T#zO!_$XO!d#vO#V$YO#t$VO$_$TO$a$UO$d$WO']#pO'b$PO'f#sO'a'cP~O!d$ZO~O!]$]O~O_$^O'W$^O~O']$bO~O!d$ZO']$bO'^$dO'b$PO~Oc$jO!d$ZO']$bO~O#c#TO~O]$sOu$oO!T$lO!d$nO%R$rO']$bO'^$dO^(UP~O!n$tO~Ox$uO!T$vO']$bO~Ox$uO!T$vO%Z$zO']$bO~O']${O~O#dsO%RtO%TrO%UrO%XuO%ZvO%^wO%_wO~Ob%UOc%TO!n%RO%P%SO%c%QO~P7xOb%XOcmO!T%WO!nlO#dsO%PqO%TrO%UrO%XuO%ZvO%^wO%_wO%axO~O`%[O!{%_O%R%YO'^$dO~P8wO!d%`O!g%dO~O!d%eO~O!TSO~O_$^O'T%mO'W$^O~O_$^O'T%pO'W$^O~O_$^O'T%rO'W$^O~OS!WO'U!XO'V%vO~OQ[XZ[Xj[Xu[Xv[Xx[X!R[X!RdX!a[X!b[X!d[X!j[X!{[X!{dX#WdX#[[X#][X#^[X#_[X#`[X#a[X#b[X#c[X#e[X#g[X#i[X#j[X#o[X'f[X'p[X'w[X'x[X~O!O[X!OdX~P;dO!Q%xO!O&iX!O&nX!R&iX!R&nX~P'dO!R%zO!O'jX~OQ#^OZ#dOj#ROu!{Ov!{Ox!|O!R%zO!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO#g#WO#i#YO#j#ZO'fQO'p#[O'w!}O'x#OO~O!O'jX~P>aO!O&PO~Ox&SO!W&^O!X&VO!Y&VO'^$dO~O]&TOk&TO!Q&WO'g&QO!S'kP!S'vP~P@dO!O'sX!R'sX!]'sX!c'sX'p'sX~O!{'sX#W#PX!S'sX~PA]O!{&_O!O'uX!R'uX~O!R&`O!O'tX~O!O&cO~O!{#eO~PA]OP&gO!T&dO!o&fO']$bO~Oc&lO!d$ZO']$bO~Ou$oO!d$nO~O!S&mO~P`Ou!{Ov!{Ox!|O!b!yO!d!zO'fQOQ!faZ!faj!fa!R!fa!a!fa!j!fa#[!fa#]!fa#^!fa#_!fa#`!fa#a!fa#b!fa#c!fa#e!fa#g!fa#i!fa#j!fa'p!fa'w!fa'x!fa~O_!fa'W!fa!O!fa!c!fan!fa!T!fa%Q!fa!]!fa~PCfO!c&nO~O!]!wO!{&pO'p&oO!R'rX_'rX'W'rX~O!c'rX~PFOO!R&tO!c'qX~O!c&vO~Ox$uO!T$vO#V&wO']$bO~OQTORTO]cOb!kOc!jOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!TSO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!n!iO#t!lO#x^O']9aO'fQO'oYO'|aO~O]#qOh$QOj#rOk#qOl#qOq$ROs9tOx#yO!T#zO!_;eO!d#vO#V9}O#t$VO$_9wO$a9zO$d$WO']&{O'b$PO'f#sO~O#W&}O~O]#qOh$QOj#rOk#qOl#qOq$ROs$SOx#yO!T#zO!_$XO!d#vO#V$YO#t$VO$_$TO$a$UO$d$WO']&{O'b$PO'f#sO~O'a'mP~PJjO!Q'RO!c'nP~P){O'g'TO'oYO~OQ9^OR9^O]cOb;`Oc!jOhcOj9^OkcOlcOq9^Os9^OxRO{cO|cO}cO!T!bO!_9`O!dUO!g9^O!h9^O!i9^O!j9^O!k9^O!n!iO#t!lO#x^O']'cO'fQO'oYO'|;^O~O!d!zO~O!R#bO_$]a'W$]a!c$]a!O$]a!T$]a%Q$]a!]$]a~O#d'jO~PIWO!]'lO!T'yX#w'yX#z'yX$R'yX~Ou'mO~P! YOu'mO!T'yX#w'yX#z'yX$R'yX~O!T'oO#w'sO#z'nO$R'tO~O!Q'wO~PLbO#z#fO$R'zO~OP$eXu$eXx$eX!b$eX'w$eX'x$eX~OPfX!RfX!{fX'afX'a$eX~P!!rOk'|O~OS'}O'U(OO'V(QO~OP(ZOu(SOx(TO'w(VO'x(XO~O'a(RO~P!#{O'a([O~O]#qOh$QOj#rOk#qOl#qOq$ROs9tOx#yO!T#zO!_;eO!d#vO#V9}O#t$VO$_9wO$a9zO$d$WO'b$PO'f#sO~O!Q(`O'](]O!c'}P~P!$jO#W(bO~O!d(cO~O!Q(hO'](eO!O(OP~P!$jOj(uOx(mO!W(sO!X(lO!Y(lO!d(cO!x(tO$w(oO'^$dO'g(jO~O!S(rO~P!&jO!b!yOP'eXu'eXx'eX'w'eX'x'eX!R'eX!{'eX~O'a'eX#m'eX~P!'cOP(xO!{(wO!R'dX'a'dX~O!R(yO'a'cX~O']${O'a'cP~O'](|O~O!d)RO~O']&{O~Ox$uO!Q!rO!T$vO#U!uO#V!rO']$bO!c'qP~O!]!wO#W)VO~OQ#^OZ#dOj#ROu!{Ov!{Ox!|O!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO#g#WO#i#YO#j#ZO'fQO'p#[O'w!}O'x#OO~O_!^a!R!^a'W!^a!O!^a!c!^an!^a!T!^a%Q!^a!]!^a~P!)wOP)_O!T&dO!o)^O%Q)]O'b$PO~O!])aO!T'`X_'`X!R'`X'W'`X~O!d$ZO'b$PO~O!d$ZO']$bO'b$PO~O!]!wO#W&}O~O])lO%R)mO'])iO!S(VP~O!R)nO^(UX~O'g'TO~OZ)rO~O^)sO~O!T$lO']$bO'^$dO^(UP~Ox$uO!Q)xO!R&`O!T$vO']$bO!O'tP~O]&ZOk&ZO!Q)yO'g'TO!S'vP~O!R)zO_(RX'W(RX~O!{*OO'b$PO~OP*RO!T#zO'b$PO~O!T*TO~Ou*VO!TSO~O!n*[O~Oc*aO~O'](|O!S(TP~Oc$jO~O%RtO']${O~P8wOZ*gO^*fO~OQTORTO]cObnOcmOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!nlO#x^O%PqO'fQO'oYO'|aO~O!T!bO#t!lO']9aO~P!1_O^*fO_$^O'W$^O~O_*kO#d*mO%T*mO%U*mO~P){O!d%`O~O%t*rO~O!T*tO~O&V*vO&X*wOQ&SaR&SaX&Sa]&Sa_&Sab&Sac&Sah&Saj&Sak&Sal&Saq&Sas&Sax&Sa{&Sa|&Sa}&Sa!T&Sa!_&Sa!d&Sa!g&Sa!h&Sa!i&Sa!j&Sa!k&Sa!n&Sa#d&Sa#t&Sa#x&Sa%P&Sa%R&Sa%T&Sa%U&Sa%X&Sa%Z&Sa%^&Sa%_&Sa%a&Sa%n&Sa%t&Sa%v&Sa%x&Sa%z&Sa%}&Sa&T&Sa&Z&Sa&]&Sa&_&Sa&a&Sa&c&Sa'S&Sa']&Sa'f&Sa'o&Sa'|&Sa!S&Sa%{&Sa`&Sa&Q&Sa~O']*|O~On+PO~O!O&ia!R&ia~P!)wO!Q+TO!O&iX!R&iX~P){O!R%zO!O'ja~O!O'ja~P>aO!R&`O!O'ta~O!RwX!R!ZX!SwX!S!ZX!]wX!]!ZX!d!ZX!{wX'b!ZX~O!]+YO!{+XO!R#TX!R'lX!S#TX!S'lX!]'lX!d'lX'b'lX~O!]+[O!d$ZO'b$PO!R!VX!S!VX~O]&ROk&ROx&SO'g(jO~OQ9^OR9^O]cOb;`Oc!jOhcOj9^OkcOlcOq9^Os9^OxRO{cO|cO}cO!T!bO!_9`O!dUO!g9^O!h9^O!i9^O!j9^O!k9^O!n!iO#t!lO#x^O'fQO'oYO'|;^O~O']:SO~P!;jO!R+`O!S'kX~O!S+bO~O!]+YO!{+XO!R#TX!S#TX~O!R+cO!S'vX~O!S+eO~O]&ROk&ROx&SO'^$dO'g(jO~O!X+fO!Y+fO~P!>hOx$uO!Q+hO!T$vO']$bO!O&nX!R&nX~O_+lO!W+oO!X+kO!Y+kO!r+sO!s+qO!t+rO!u+pO!x+tO'^$dO'g(jO'o+iO~O!S+nO~P!?iOP+yO!T&dO!o+xO~O!{,PO!R'ra!c'ra_'ra'W'ra~O!]!wO~P!@sO!R&tO!c'qa~Ox$uO!Q,SO!T$vO#U,UO#V,SO']$bO!R&pX!c&pX~O_#Oi!R#Oi'W#Oi!O#Oi!c#Oin#Oi!T#Oi%Q#Oi!]#Oi~P!)wOP;tOu(SOx(TO'w(VO'x(XO~O#W!za!R!za!c!za!{!za!T!za_!za'W!za!O!za~P!BpO#W'eXQ'eXZ'eX_'eXj'eXv'eX!a'eX!d'eX!j'eX#['eX#]'eX#^'eX#_'eX#`'eX#a'eX#b'eX#c'eX#e'eX#g'eX#i'eX#j'eX'W'eX'f'eX'p'eX!c'eX!O'eX!T'eXn'eX%Q'eX!]'eX~P!'cO!R,_O'a'mX~P!#{O'a,aO~O!R,bO!c'nX~P!)wO!c,eO~O!O,fO~OQ#^Ou!{Ov!{Ox!|O!b!yO!d!zO!j#^O'fQOZ#Zi_#Zij#Zi!R#Zi!a#Zi#]#Zi#^#Zi#_#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi'W#Zi'p#Zi'w#Zi'x#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~O#[#Zi~P!FfO#[#PO~P!FfOQ#^Ou!{Ov!{Ox!|O!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO'fQOZ#Zi_#Zi!R#Zi!a#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi'W#Zi'p#Zi'w#Zi'x#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~Oj#Zi~P!IQOj#RO~P!IQOQ#^Oj#ROu!{Ov!{Ox!|O!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO'fQO_#Zi!R#Zi#e#Zi#g#Zi#i#Zi#j#Zi'W#Zi'p#Zi'w#Zi'x#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~OZ#Zi!a#Zi#a#Zi#b#Zi#c#Zi~P!KlOZ#dO!a#TO#a#TO#b#TO#c#TO~P!KlOQ#^OZ#dOj#ROu!{Ov!{Ox!|O!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO'fQO_#Zi!R#Zi#g#Zi#i#Zi#j#Zi'W#Zi'p#Zi'x#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~O'w#Zi~P!NdO'w!}O~P!NdOQ#^OZ#dOj#ROu!{Ov!{Ox!|O!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO#g#WO'fQO'w!}O_#Zi!R#Zi#i#Zi#j#Zi'W#Zi'p#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~O'x#Zi~P##OO'x#OO~P##OOQ#^OZ#dOj#ROu!{Ov!{Ox!|O!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO#g#WO#i#YO'fQO'w!}O'x#OO~O_#Zi!R#Zi#j#Zi'W#Zi'p#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~P#%jOQ[XZ[Xj[Xu[Xv[Xx[X!a[X!b[X!d[X!j[X!{[X#WdX#[[X#][X#^[X#_[X#`[X#a[X#b[X#c[X#e[X#g[X#i[X#j[X#o[X'f[X'p[X'w[X'x[X!R[X!S[X~O#m[X~P#'}OQ#^OZ9rOj9gOu!{Ov!{Ox!|O!a9iO!b!yO!d!zO!j#^O#[9eO#]9fO#^9fO#_9fO#`9hO#a9iO#b9iO#c9iO#e9jO#g9lO#i9nO#j9oO'fQO'p#[O'w!}O'x#OO~O#m,hO~P#*XOQ'iXZ'iXj'iXu'iXv'iXx'iX!a'iX!b'iX!d'iX!j'iX#['iX#]'iX#^'iX#_'iX#`'iX#a'iX#b'iX#e'iX#g'iX#i'iX#j'iX'f'iX'p'iX'w'iX'x'iX!R'iX~O!{9sO#o9sO#c'iX#m'iX!S'iX~P#,SO_&sa!R&sa'W&sa!c&san&sa!O&sa!T&sa%Q&sa!]&sa~P!)wOQ#ZiZ#Zi_#Zij#Ziv#Zi!R#Zi!a#Zi!b#Zi!d#Zi!j#Zi#[#Zi#]#Zi#^#Zi#_#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi'W#Zi'f#Zi'p#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~P!BpO_#ni!R#ni'W#ni!O#ni!c#nin#ni!T#ni%Q#ni!]#ni~P!)wO#z,jO~O#z,kO~O!]'lO!{,lO!T$OX#w$OX#z$OX$R$OX~O!Q,mO~O!T'oO#w,oO#z'nO$R,pO~O!R9pO!S'hX~P#*XO!S,qO~O$R,sO~OS'}O'U(OO'V,vO~O],yOk,yO!O,zO~O!RdX!]dX!cdX!c$eX'pdX~P!!rO!c-QO~P!BpO!R-RO!]!wO'p&oO!c'}X~O!c-WO~O!Q(`O']$bO!c'}P~O#W-YO~O!O$eX!R$eX!]$lX~P!!rO!R-ZO!O(OX~P!BpO!]-]O~O!O-_O~Oj-cO!]!wO!d$ZO'b$PO'p&oO~O!])aO~O_$^O!R-hO'W$^O~O!S-jO~P!&jO!X-kO!Y-kO'^$dO'g(jO~Ox-mO'g(jO~O!x-nO~O']${O!R&xX'a&xX~O!R(yO'a'ca~O'a-sO~Ou-tOv-tOx-uOPra'wra'xra!Rra!{ra~O'ara#mra~P#7pOu(SOx(TOP$^a'w$^a'x$^a!R$^a!{$^a~O'a$^a#m$^a~P#8fOu(SOx(TOP$`a'w$`a'x$`a!R$`a!{$`a~O'a$`a#m$`a~P#9XO]-vO~O#W-wO~O'a$na!R$na!{$na#m$na~P!#{O#W-zO~OP.TO!T&dO!o.SO%Q.RO~O]#qOj#rOk#qOl#qOq$ROs9tOx#yO!T#zO!_;eO!d#vO#V9}O#t$VO$_9wO$a9zO$d$WO'b$PO'f#sO~Oh.VO'].UO~P#:yO!])aO!T'`a_'`a!R'`a'W'`a~O#W.]O~OZ[X!RdX!SdX~O!R.^O!S(VX~O!S.`O~OZ.aO~O].cO'])iO~O!T$lO']$bO^'QX!R'QX~O!R)nO^(Ua~O!c.fO~P!)wO].hO~OZ.iO~O^.jO~OP.TO!T&dO!o.SO%Q.RO'b$PO~O!R)zO_(Ra'W(Ra~O!{.pO~OP.sO!T#zO~O'g'TO!S(SP~OP.}O!T.yO!o.|O%Q.{O'b$PO~OZ/XO!R/VO!S(TX~O!S/YO~O^/[O_$^O'W$^O~O]/]O~O]/^O'](|O~O#c/_O%r/`O~P0zO!{#eO#c/_O%r/`O~O_/aO~P){O_/cO~O%{/gOQ%yiR%yiX%yi]%yi_%yib%yic%yih%yij%yik%yil%yiq%yis%yix%yi{%yi|%yi}%yi!T%yi!_%yi!d%yi!g%yi!h%yi!i%yi!j%yi!k%yi!n%yi#d%yi#t%yi#x%yi%P%yi%R%yi%T%yi%U%yi%X%yi%Z%yi%^%yi%_%yi%a%yi%n%yi%t%yi%v%yi%x%yi%z%yi%}%yi&T%yi&Z%yi&]%yi&_%yi&a%yi&c%yi'S%yi']%yi'f%yi'o%yi'|%yi!S%yi`%yi&Q%yi~O`/mO!S/kO&Q/lO~P`O!TSO!d/oO~O&X*wOQ&SiR&SiX&Si]&Si_&Sib&Sic&Sih&Sij&Sik&Sil&Siq&Sis&Six&Si{&Si|&Si}&Si!T&Si!_&Si!d&Si!g&Si!h&Si!i&Si!j&Si!k&Si!n&Si#d&Si#t&Si#x&Si%P&Si%R&Si%T&Si%U&Si%X&Si%Z&Si%^&Si%_&Si%a&Si%n&Si%t&Si%v&Si%x&Si%z&Si%}&Si&T&Si&Z&Si&]&Si&_&Si&a&Si&c&Si'S&Si']&Si'f&Si'o&Si'|&Si!S&Si%{&Si`&Si&Q&Si~O!R#bOn$]a~O!O&ii!R&ii~P!)wO!R%zO!O'ji~O!R&`O!O'ti~O!O/uO~O!R!Va!S!Va~P#*XO]&ROk&RO!Q/{O'g(jO!R&jX!S&jX~P@dO!R+`O!S'ka~O]&ZOk&ZO!Q)yO'g'TO!R&oX!S&oX~O!R+cO!S'va~O!O'ui!R'ui~P!)wO_$^O!]!wO!d$ZO!j0VO!{0TO'W$^O'b$PO'p&oO~O!S0YO~P!?iO!X0ZO!Y0ZO'^$dO'g(jO'o+iO~O!W0[O~P#MSO!TSO!W0[O!u0^O!x0_O~P#MSO!W0[O!s0aO!t0aO!u0^O!x0_O~P#MSO!T&dO~O!T&dO~P!BpO!R'ri!c'ri_'ri'W'ri~P!)wO!{0jO!R'ri!c'ri_'ri'W'ri~O!R&tO!c'qi~Ox$uO!T$vO#V0lO']$bO~O#WraQraZra_rajra!ara!bra!dra!jra#[ra#]ra#^ra#_ra#`ra#ara#bra#cra#era#gra#ira#jra'Wra'fra'pra!cra!Ora!Tranra%Qra!]ra~P#7pO#W$^aQ$^aZ$^a_$^aj$^av$^a!a$^a!b$^a!d$^a!j$^a#[$^a#]$^a#^$^a#_$^a#`$^a#a$^a#b$^a#c$^a#e$^a#g$^a#i$^a#j$^a'W$^a'f$^a'p$^a!c$^a!O$^a!T$^an$^a%Q$^a!]$^a~P#8fO#W$`aQ$`aZ$`a_$`aj$`av$`a!a$`a!b$`a!d$`a!j$`a#[$`a#]$`a#^$`a#_$`a#`$`a#a$`a#b$`a#c$`a#e$`a#g$`a#i$`a#j$`a'W$`a'f$`a'p$`a!c$`a!O$`a!T$`an$`a%Q$`a!]$`a~P#9XO#W$naQ$naZ$na_$naj$nav$na!R$na!a$na!b$na!d$na!j$na#[$na#]$na#^$na#_$na#`$na#a$na#b$na#c$na#e$na#g$na#i$na#j$na'W$na'f$na'p$na!c$na!O$na!T$na!{$nan$na%Q$na!]$na~P!BpO_#Oq!R#Oq'W#Oq!O#Oq!c#Oqn#Oq!T#Oq%Q#Oq!]#Oq~P!)wO!R&kX'a&kX~PJjO!R,_O'a'ma~O!Q0tO!R&lX!c&lX~P){O!R,bO!c'na~O!R,bO!c'na~P!)wO#m!fa!S!fa~PCfO#m!^a!R!^a!S!^a~P#*XO!T1XO#x^O$P1YO~O!S1^O~On1_O~P!BpO_$Yq!R$Yq'W$Yq!O$Yq!c$Yqn$Yq!T$Yq%Q$Yq!]$Yq~P!)wO!O1`O~O],yOk,yO~Ou(SOx(TO'x(XOP$xi'w$xi!R$xi!{$xi~O'a$xi#m$xi~P$.POu(SOx(TOP$zi'w$zi'x$zi!R$zi!{$zi~O'a$zi#m$zi~P$.rO'p#[O~P!BpO!Q1cO']$bO!R&tX!c&tX~O!R-RO!c'}a~O!R-RO!]!wO!c'}a~O!R-RO!]!wO'p&oO!c'}a~O'a$gi!R$gi!{$gi#m$gi~P!#{O!Q1kO'](eO!O&vX!R&vX~P!$jO!R-ZO!O(Oa~O!R-ZO!O(Oa~P!BpO!]!wO~O!]!wO#c1sO~Oj1vO!]!wO'p&oO~O!R'di'a'di~P!#{O!{1yO!R'di'a'di~P!#{O!c1|O~O_$Zq!R$Zq'W$Zq!O$Zq!c$Zqn$Zq!T$Zq%Q$Zq!]$Zq~P!)wO!R2QO!T(PX~P!BpO!T&dO%Q2TO~O!T&dO%Q2TO~P!BpO!T$eX$u[X_$eX!R$eX'W$eX~P!!rO$u2XOPgXugXxgX!TgX'wgX'xgX_gX!RgX'WgX~O$u2XO~O]2_O%R2`O'])iO!R'PX!S'PX~O!R.^O!S(Va~OZ2dO~O^2eO~O]2hO~OP2jO!T&dO!o2iO%Q2TO~O_$^O'W$^O~P!BpO!T#zO~P!BpO!R2oO!{2qO!S(SX~O!S2rO~Ox;oO!W2{O!X2tO!Y2tO!r2zO!s2yO!t2yO!x2xO'^$dO'g(jO'o+iO~O!S2wO~P$7ZOP3SO!T.yO!o3RO%Q3QO~OP3SO!T.yO!o3RO%Q3QO'b$PO~O'](|O!R'OX!S'OX~O!R/VO!S(Ta~O]3^O'g3]O~O]3_O~O^3aO~O!c3dO~P){O_3fO~O_3fO~P){O#c3hO%r3iO~PFOO`/mO!S3mO&Q/lO~P`O!]3oO~O!R#Ti!S#Ti~P#*XO!{3qO!R#Ti!S#Ti~O!R!Vi!S!Vi~P#*XO_$^O!{3xO'W$^O~O_$^O!]!wO!{3xO'W$^O~O!X3|O!Y3|O'^$dO'g(jO'o+iO~O_$^O!]!wO!d$ZO!j3}O!{3xO'W$^O'b$PO'p&oO~O!W4OO~P$;xO!W4OO!u4RO!x4SO~P$;xO_$^O!]!wO!j3}O!{3xO'W$^O'p&oO~O!R'rq!c'rq_'rq'W'rq~P!)wO!R&tO!c'qq~O#W$xiQ$xiZ$xi_$xij$xiv$xi!a$xi!b$xi!d$xi!j$xi#[$xi#]$xi#^$xi#_$xi#`$xi#a$xi#b$xi#c$xi#e$xi#g$xi#i$xi#j$xi'W$xi'f$xi'p$xi!c$xi!O$xi!T$xin$xi%Q$xi!]$xi~P$.PO#W$ziQ$ziZ$zi_$zij$ziv$zi!a$zi!b$zi!d$zi!j$zi#[$zi#]$zi#^$zi#_$zi#`$zi#a$zi#b$zi#c$zi#e$zi#g$zi#i$zi#j$zi'W$zi'f$zi'p$zi!c$zi!O$zi!T$zin$zi%Q$zi!]$zi~P$.rO#W$giQ$giZ$gi_$gij$giv$gi!R$gi!a$gi!b$gi!d$gi!j$gi#[$gi#]$gi#^$gi#_$gi#`$gi#a$gi#b$gi#c$gi#e$gi#g$gi#i$gi#j$gi'W$gi'f$gi'p$gi!c$gi!O$gi!T$gi!{$gin$gi%Q$gi!]$gi~P!BpO!R&ka'a&ka~P!#{O!R&la!c&la~P!)wO!R,bO!c'ni~O#m#Oi!R#Oi!S#Oi~P#*XOQ#^Ou!{Ov!{Ox!|O!b!yO!d!zO!j#^O'fQOZ#Zij#Zi!a#Zi#]#Zi#^#Zi#_#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi#m#Zi'p#Zi'w#Zi'x#Zi!R#Zi!S#Zi~O#[#Zi~P$EiO#[9eO~P$EiOQ#^Ou!{Ov!{Ox!|O!b!yO!d!zO!j#^O#[9eO#]9fO#^9fO#_9fO'fQOZ#Zi!a#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi#m#Zi'p#Zi'w#Zi'x#Zi!R#Zi!S#Zi~Oj#Zi~P$GqOj9gO~P$GqOQ#^Oj9gOu!{Ov!{Ox!|O!b!yO!d!zO!j#^O#[9eO#]9fO#^9fO#_9fO#`9hO'fQO#e#Zi#g#Zi#i#Zi#j#Zi#m#Zi'p#Zi'w#Zi'x#Zi!R#Zi!S#Zi~OZ#Zi!a#Zi#a#Zi#b#Zi#c#Zi~P$IyOZ9rO!a9iO#a9iO#b9iO#c9iO~P$IyOQ#^OZ9rOj9gOu!{Ov!{Ox!|O!a9iO!b!yO!d!zO!j#^O#[9eO#]9fO#^9fO#_9fO#`9hO#a9iO#b9iO#c9iO#e9jO'fQO#g#Zi#i#Zi#j#Zi#m#Zi'p#Zi'x#Zi!R#Zi!S#Zi~O'w#Zi~P$L_O'w!}O~P$L_OQ#^OZ9rOj9gOu!{Ov!{Ox!|O!a9iO!b!yO!d!zO!j#^O#[9eO#]9fO#^9fO#_9fO#`9hO#a9iO#b9iO#c9iO#e9jO#g9lO'fQO'w!}O#i#Zi#j#Zi#m#Zi'p#Zi!R#Zi!S#Zi~O'x#Zi~P$NgO'x#OO~P$NgOQ#^OZ9rOj9gOu!{Ov!{Ox!|O!a9iO!b!yO!d!zO!j#^O#[9eO#]9fO#^9fO#_9fO#`9hO#a9iO#b9iO#c9iO#e9jO#g9lO#i9nO'fQO'w!}O'x#OO~O#j#Zi#m#Zi'p#Zi!R#Zi!S#Zi~P%!oO_#ky!R#ky'W#ky!O#ky!c#kyn#ky!T#ky%Q#ky!]#ky~P!)wOP;vOu(SOx(TO'w(VO'x(XO~OQ#ZiZ#Zij#Ziv#Zi!a#Zi!b#Zi!d#Zi!j#Zi#[#Zi#]#Zi#^#Zi#_#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi#m#Zi'f#Zi'p#Zi!R#Zi!S#Zi~P%%aO!b!yOP'eXu'eXx'eX'w'eX'x'eX!S'eX~OQ'eXZ'eXj'eXv'eX!a'eX!d'eX!j'eX#['eX#]'eX#^'eX#_'eX#`'eX#a'eX#b'eX#c'eX#e'eX#g'eX#i'eX#j'eX#m'eX'f'eX'p'eX!R'eX~P%'eO#m#ni!R#ni!S#ni~P#*XO!S4eO~O!R&sa!S&sa~P#*XO!]!wO'p&oO!R&ta!c&ta~O!R-RO!c'}i~O!R-RO!]!wO!c'}i~O'a$gq!R$gq!{$gq#m$gq~P!#{O!O&va!R&va~P!BpO!]4lO~O!R-ZO!O(Oi~P!BpO!R-ZO!O(Oi~O!O4pO~O!]!wO#c4uO~Oj4vO!]!wO'p&oO~O!O4xO~O'a$iq!R$iq!{$iq#m$iq~P!#{O_$Zy!R$Zy'W$Zy!O$Zy!c$Zyn$Zy!T$Zy%Q$Zy!]$Zy~P!)wO!R2QO!T(Pa~O!T&dO%Q4}O~O!T&dO%Q4}O~P!BpO_#Oy!R#Oy'W#Oy!O#Oy!c#Oyn#Oy!T#Oy%Q#Oy!]#Oy~P!)wOZ5QO~O]5SO'])iO~O!R.^O!S(Vi~O]5VO~O^5WO~O'g'TO!R&{X!S&{X~O!R2oO!S(Sa~O!S5eO~P$7ZOx;sO'g(jO'o+iO~O!W5hO!X5gO!Y5gO!x0_O'^$dO'g(jO'o+iO~O!s5iO!t5iO~P%0^O!X5gO!Y5gO'^$dO'g(jO'o+iO~O!T.yO~O!T.yO%Q5kO~O!T.yO%Q5kO~P!BpOP5pO!T.yO!o5oO%Q5kO~OZ5uO!R'Oa!S'Oa~O!R/VO!S(Ti~O]5xO~O!c5yO~O!c5zO~O!c5{O~O!c5{O~P){O_5}O~O!]6QO~O!c6RO~O!R'ui!S'ui~P#*XO_$^O'W$^O~P!)wO_$^O!{6WO'W$^O~O_$^O!]!wO!{6WO'W$^O~O!X6]O!Y6]O'^$dO'g(jO'o+iO~O_$^O!]!wO!j6^O!{6WO'W$^O'p&oO~O!d$ZO'b$PO~P%4xO!W6_O~P%4gO!R'ry!c'ry_'ry'W'ry~P!)wO#W$gqQ$gqZ$gq_$gqj$gqv$gq!R$gq!a$gq!b$gq!d$gq!j$gq#[$gq#]$gq#^$gq#_$gq#`$gq#a$gq#b$gq#c$gq#e$gq#g$gq#i$gq#j$gq'W$gq'f$gq'p$gq!c$gq!O$gq!T$gq!{$gqn$gq%Q$gq!]$gq~P!BpO#W$iqQ$iqZ$iq_$iqj$iqv$iq!R$iq!a$iq!b$iq!d$iq!j$iq#[$iq#]$iq#^$iq#_$iq#`$iq#a$iq#b$iq#c$iq#e$iq#g$iq#i$iq#j$iq'W$iq'f$iq'p$iq!c$iq!O$iq!T$iq!{$iqn$iq%Q$iq!]$iq~P!BpO!R&li!c&li~P!)wO#m#Oq!R#Oq!S#Oq~P#*XOu-tOv-tOx-uOPra'wra'xra!Sra~OQraZrajra!ara!bra!dra!jra#[ra#]ra#^ra#_ra#`ra#ara#bra#cra#era#gra#ira#jra#mra'fra'pra!Rra~P%;OOu(SOx(TOP$^a'w$^a'x$^a!S$^a~OQ$^aZ$^aj$^av$^a!a$^a!b$^a!d$^a!j$^a#[$^a#]$^a#^$^a#_$^a#`$^a#a$^a#b$^a#c$^a#e$^a#g$^a#i$^a#j$^a#m$^a'f$^a'p$^a!R$^a~P%=SOu(SOx(TOP$`a'w$`a'x$`a!S$`a~OQ$`aZ$`aj$`av$`a!a$`a!b$`a!d$`a!j$`a#[$`a#]$`a#^$`a#_$`a#`$`a#a$`a#b$`a#c$`a#e$`a#g$`a#i$`a#j$`a#m$`a'f$`a'p$`a!R$`a~P%?WOQ$naZ$naj$nav$na!a$na!b$na!d$na!j$na#[$na#]$na#^$na#_$na#`$na#a$na#b$na#c$na#e$na#g$na#i$na#j$na#m$na'f$na'p$na!R$na!S$na~P%%aO#m$Yq!R$Yq!S$Yq~P#*XO#m$Zq!R$Zq!S$Zq~P#*XO!S6hO~O#m6iO~P!#{O!]!wO!R&ti!c&ti~O!]!wO'p&oO!R&ti!c&ti~O!R-RO!c'}q~O!O&vi!R&vi~P!BpO!R-ZO!O(Oq~O!O6oO~P!BpO!O6oO~O!R'dy'a'dy~P!#{O!R&ya!T&ya~P!BpO!T$tq_$tq!R$tq'W$tq~P!BpOZ6vO~O!R.^O!S(Vq~O]6yO~O!T&dO%Q6zO~O!T&dO%Q6zO~P!BpO!{6{O!R&{a!S&{a~O!R2oO!S(Si~P#*XO!X7RO!Y7RO'^$dO'g(jO'o+iO~O!W7TO!x4SO~P%GXO!T.yO%Q7WO~O!T.yO%Q7WO~P!BpO]7_O'g7^O~O!R/VO!S(Tq~O!c7aO~O!c7aO~P){O!c7cO~O!c7dO~O!R#Ty!S#Ty~P#*XO_$^O!{7jO'W$^O~O_$^O!]!wO!{7jO'W$^O~O!X7mO!Y7mO'^$dO'g(jO'o+iO~O_$^O!]!wO!j7nO!{7jO'W$^O'p&oO~O#m#ky!R#ky!S#ky~P#*XOQ$giZ$gij$giv$gi!a$gi!b$gi!d$gi!j$gi#[$gi#]$gi#^$gi#_$gi#`$gi#a$gi#b$gi#c$gi#e$gi#g$gi#i$gi#j$gi#m$gi'f$gi'p$gi!R$gi!S$gi~P%%aOu(SOx(TO'x(XOP$xi'w$xi!S$xi~OQ$xiZ$xij$xiv$xi!a$xi!b$xi!d$xi!j$xi#[$xi#]$xi#^$xi#_$xi#`$xi#a$xi#b$xi#c$xi#e$xi#g$xi#i$xi#j$xi#m$xi'f$xi'p$xi!R$xi~P%LjOu(SOx(TOP$zi'w$zi'x$zi!S$zi~OQ$ziZ$zij$ziv$zi!a$zi!b$zi!d$zi!j$zi#[$zi#]$zi#^$zi#_$zi#`$zi#a$zi#b$zi#c$zi#e$zi#g$zi#i$zi#j$zi#m$zi'f$zi'p$zi!R$zi~P%NnO#m$Zy!R$Zy!S$Zy~P#*XO#m#Oy!R#Oy!S#Oy~P#*XO!]!wO!R&tq!c&tq~O!R-RO!c'}y~O!O&vq!R&vq~P!BpO!O7tO~P!BpO!R.^O!S(Vy~O!R2oO!S(Sq~O!X8QO!Y8QO'^$dO'g(jO'o+iO~O!T.yO%Q8TO~O!T.yO%Q8TO~P!BpO!c8WO~O_$^O!{8]O'W$^O~O_$^O!]!wO!{8]O'W$^O~OQ$gqZ$gqj$gqv$gq!a$gq!b$gq!d$gq!j$gq#[$gq#]$gq#^$gq#_$gq#`$gq#a$gq#b$gq#c$gq#e$gq#g$gq#i$gq#j$gq#m$gq'f$gq'p$gq!R$gq!S$gq~P%%aOQ$iqZ$iqj$iqv$iq!a$iq!b$iq!d$iq!j$iq#[$iq#]$iq#^$iq#_$iq#`$iq#a$iq#b$iq#c$iq#e$iq#g$iq#i$iq#j$iq#m$iq'f$iq'p$iq!R$iq!S$iq~P%%aO'a$|!Z!R$|!Z!{$|!Z#m$|!Z~P!#{O!R&{q!S&{q~P#*XO_$^O!{8oO'W$^O~O#W$|!ZQ$|!ZZ$|!Z_$|!Zj$|!Zv$|!Z!R$|!Z!a$|!Z!b$|!Z!d$|!Z!j$|!Z#[$|!Z#]$|!Z#^$|!Z#_$|!Z#`$|!Z#a$|!Z#b$|!Z#c$|!Z#e$|!Z#g$|!Z#i$|!Z#j$|!Z'W$|!Z'f$|!Z'p$|!Z!c$|!Z!O$|!Z!T$|!Z!{$|!Zn$|!Z%Q$|!Z!]$|!Z~P!BpOP;uOu(SOx(TO'w(VO'x(XO~O!S!za!W!za!X!za!Y!za!r!za!s!za!t!za!x!za'^!za'g!za'o!za~P&,_O!W'eX!X'eX!Y'eX!r'eX!s'eX!t'eX!x'eX'^'eX'g'eX'o'eX~P%'eOQ$|!ZZ$|!Zj$|!Zv$|!Z!a$|!Z!b$|!Z!d$|!Z!j$|!Z#[$|!Z#]$|!Z#^$|!Z#_$|!Z#`$|!Z#a$|!Z#b$|!Z#c$|!Z#e$|!Z#g$|!Z#i$|!Z#j$|!Z#m$|!Z'f$|!Z'p$|!Z!R$|!Z!S$|!Z~P%%aO!Wra!Xra!Yra!rra!sra!tra!xra'^ra'gra'ora~P%;OO!W$^a!X$^a!Y$^a!r$^a!s$^a!t$^a!x$^a'^$^a'g$^a'o$^a~P%=SO!W$`a!X$`a!Y$`a!r$`a!s$`a!t$`a!x$`a'^$`a'g$`a'o$`a~P%?WO!S$na!W$na!X$na!Y$na!r$na!s$na!t$na!x$na'^$na'g$na'o$na~P&,_O!W$xi!X$xi!Y$xi!r$xi!s$xi!t$xi!x$xi'^$xi'g$xi'o$xi~P%LjO!W$zi!X$zi!Y$zi!r$zi!s$zi!t$zi!x$zi'^$zi'g$zi'o$zi~P%NnO!S$gi!W$gi!X$gi!Y$gi!r$gi!s$gi!t$gi!x$gi'^$gi'g$gi'o$gi~P&,_O!S$gq!W$gq!X$gq!Y$gq!r$gq!s$gq!t$gq!x$gq'^$gq'g$gq'o$gq~P&,_O!S$iq!W$iq!X$iq!Y$iq!r$iq!s$iq!t$iq!x$iq'^$iq'g$iq'o$iq~P&,_O!S$|!Z!W$|!Z!X$|!Z!Y$|!Z!r$|!Z!s$|!Z!t$|!Z!x$|!Z'^$|!Z'g$|!Z'o$|!Z~P&,_On'hX~P.jOn[X!O[X!c[X%r[X!T[X%Q[X!][X~P$zO!]dX!c[X!cdX'pdX~P;dOQ9^OR9^O]cOb;`Oc!jOhcOj9^OkcOlcOq9^Os9^OxRO{cO|cO}cO!TSO!_9`O!dUO!g9^O!h9^O!i9^O!j9^O!k9^O!n!iO#t!lO#x^O']'cO'fQO'oYO'|;^O~O]#qOh$QOj#rOk#qOl#qOq$ROs9uOx#yO!T#zO!_;fO!d#vO#V:OO#t$VO$_9xO$a9{O$d$WO']&{O'b$PO'f#sO~O!R9pO!S$]a~O]#qOh$QOj#rOk#qOl#qOq$ROs9vOx#yO!T#zO!_;gO!d#vO#V:PO#t$VO$_9yO$a9|O$d$WO']&{O'b$PO'f#sO~O#d'jO~P&<WO!S[X!SdX~P;dO!]9dO~O#W9cO~O!]!wO#W9cO~O!{9sO~O#c9iO~O!{:QO!R'uX!S'uX~O!{9sO!R'sX!S'sX~O#W:RO~O'a:TO~P!#{O#W:[O~O#W:]O~O#W:^O~O!]!wO#W:_O~O!]!wO#W:RO~O#m:`O~P#*XO#W:aO~O#W:bO~O#W:cO~O#W:dO~O#W:eO~O#W:fO~O#W:gO~O#W:hO~O!O:iO~O#m:jO~P!#{O#m:kO~P!#{O#m:lO~P!#{O!O:mO~P!BpO!O:mO~O!O:nO~P!BpO!]!wO#c;lO~O!]!wO#c;nO~O#x~!b!r!t!u#U#V'|$_$a$d$u%P%Q%R%X%Z%^%_%a%c~UT#x'|#]}'Y'Z#z'Y']'g~",goto:"#Kk(ZPPPPPPPP([P(lP*`PPPP-zPP.a3s7o8SP8SPPP8SP:U8SP8SP:YPP:`P:t?VPPPP?ZPPPP?ZA{PPPBRDdP?ZPFwPPPPHp?ZPPPPPJi?ZPPMjNgPPPPNk!!TP!!]!#^PNg?Z?Z!&n!)i!.[!.[!1kPPP!1r!4h?ZPPPPPPPPPP!7_P!8pPP?Z!9}P?ZP?Z?Z?Z?ZP?Z!;dPP!>]P!AQ!AY!A^!A^P!>YP!Ab!AbP!DVP!DZ?Z?Z!Da!GT8SP8SP8S8SP!HW8S8S!Jf8S!M_8S# g8S8S#!T#$c#$c#$g#$c#$oP#$cP8S#%k8S#'X8S8S-zPPP#(yPP#)c#)cP#)cP#)x#)cPP#*OP#)uP#)u#*b!!X#)u#+P#+V#+Y([#+]([P#+d#+d#+dP([P([P([P([PP([P#+j#+mP#+m([P#+qP#+tP([P([P([P([P([P([([#+z#,U#,[#,b#,p#,v#,|#-W#-^#-m#-s#.R#.X#._#.m#/S#0z#1Y#1`#1f#1l#1r#1|#2S#2Y#2d#2v#2|PPPPPPPP#3SPP#3v#7OPP#8f#8m#8uPP#>a#@t#Fp#Fs#Fv#GR#GUPP#GX#G]#Gz#Hq#Hu#IZPP#I_#Ie#IiP#Il#Ip#Is#Jc#Jy#KO#KR#KU#K[#K_#Kc#KgmhOSj}!n$]%c%f%g%i*o*t/g/jQ$imQ$ppQ%ZyS&V!b+`Q&k!jS(l#z(qQ)g$jQ)t$rQ*`%TQ+f&^S+k&d+mQ+}&lQ-k(sQ/U*aY0Z+o+p+q+r+sS2t.y2vU3|0[0^0aU5g2y2z2{S6]4O4RS7R5h5iQ7m6_R8Q7T$p[ORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$]$n%[%_%c%e%f%g%i%m%x%z&S&_&f&p&}'R(R)V)^*k*o*t+T+x,P,b,h-u-z.S.].|/_/`/a/c/g/j/l0T0j0t2i3R3f3h3i3x5o5}6W7j8]8o!j'e#]#k&W'w+X+[,m/{1X2q3q6{9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aQ(}$SQ)l$lQ*b%WQ*i%`Q,X9tQ.W)aQ.c)mQ/^*gQ2_.^Q3Z/VQ4^9vQ5S2`R8{9upeOSjy}!n$]%Y%c%f%g%i*o*t/g/jR*d%[&WVOSTjkn}!S!W!k!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k$]$n%[%_%`%c%e%f%g%i%m%z&S&_&f&p&}'R'w(R)V)^*k*o*t+T+X+[+x,P,b,h,m-u-z.S.].|/_/`/a/c/g/j/l/{0T0j0t1X2i2q3R3f3h3i3q3x5o5}6W6{7j8]8o9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;`;a[!cRU!]!`%x&WQ$clQ$hmS$mp$rv$wrs!r!u$Z$u&`&t&w)x)y)z*m+Y+h,S,U/o0lQ%PwQ&h!iQ&j!jS(_#v(cS)f$i$jQ)j$lQ)w$tQ*Z%RQ*_%TS+|&k&lQ-V(`Q.[)gQ.b)mQ.d)nQ.g)rQ/P*[S/T*`*aQ0h+}Q1b-RQ2^.^Q2b.aQ2g.iQ3Y/UQ4i1cQ5R2`Q5U2dQ6u5QR7w6vx#xa!y$T$U$Y(W(Y(b(w(x,_-Y-w1a1y6i;^;i;j;k!Y$fm!j$h$i$j&U&j&k&l(k)f)g+]+j+|+}-d.[0Q0W0]0h1u3{4Q6Z7k8^Q)`$cQ*P$|Q*S$}Q*^%TQ.k)wQ/O*ZU/S*_*`*aQ3T/PS3X/T/UQ5b2sQ5t3YS7P5c5fS8O7Q7SQ8f8PQ8u8g#[;b!w#d#v#y&g'}(Z(h)])_)a*O*R+y-Z-].R.T.p.s.{.}1k1s2Q2T2X2j3Q3S4l4u4}5k5p6z7W8T9w9z9}:U:X:[:a:d:j;l;n;t;u;vd;c9d9x9{:O:V:Y:]:b:e:ke;d9r9y9|:P:W:Z:^:c:f:lW#}a$P(y;^S$|t%YQ$}uQ%OvR)}$z%P#|a!w!y#d#v#y$T$U$Y&g'}(W(Y(Z(b(h(w(x)])_)a*O*R+y,_-Y-Z-]-w.R.T.p.s.{.}1a1k1s1y2Q2T2X2j3Q3S4l4u4}5k5p6i6z7W8T9d9r9w9x9y9z9{9|9}:O:P:U:V:W:X:Y:Z:[:]:^:a:b:c:d:e:f:j:k:l;^;i;j;k;l;n;t;u;vT(O#s(PX)O$S9t9u9vU&Z!b$v+cQ'U!{Q)q$oQ.t*TQ1z-tR5^2o&^cORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k$]$n%[%_%`%c%e%f%g%i%m%x%z&S&W&_&f&p&}'R'w(R)V)^*k*o*t+T+X+[+x,P,b,h,m-u-z.S.].|/_/`/a/c/g/j/l/{0T0j0t1X2i2q3R3f3h3i3q3x5o5}6W6{7j8]8o9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;a$]#aZ!_!o$a%w%}&y'Q'W'X'Y'Z'[']'^'_'`'a'b'd'g'k'u)p+R+^+g,O,^,d,g,i,w-x/v/y0i0s0w0x0y0z0{0|0}1O1P1Q1R1S1T1W1]2O2[3s3v4W4[4]4b4c5`6S6V6b6f6g7g7z8Z8m8y9_:|T!XQ!Y&_cORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k$]$n%[%_%`%c%e%f%g%i%m%x%z&S&W&_&f&p&}'R'w(R)V)^*k*o*t+T+X+[+x,P,b,h,m-u-z.S.].|/_/`/a/c/g/j/l/{0T0j0t1X2i2q3R3f3h3i3q3x5o5}6W6{7j8]8o9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aQ&X!bR/|+`Y&R!b&V&^+`+fS(k#z(qS+j&d+mS-d(l(sQ-e(mQ-l(tQ.v*VU0W+k+o+pU0]+q+r+sS0b+t2xQ1u-kQ1w-mQ1x-nS2s.y2vU3{0Z0[0^Q4P0_Q4Q0aS5c2t2{S5f2y2zU6Z3|4O4RQ6`4SS7Q5g5hQ7S5iS7k6]6_S8P7R7TQ8^7mQ8g8QQ;h;oR;m;slhOSj}!n$]%c%f%g%i*o*t/g/jQ%k!QS&x!v9cQ)d$gQ*X%PQ*Y%QQ+z&iS,]&}:RS-y)V:_Q.Y)eQ.x*WQ/n*vQ/p*wQ/x+ZQ0`+qQ0f+{S2P-z:gQ2Y.ZS2].]:hQ3r/zQ3u0RQ4U0gQ5P2ZQ6T3tQ6X3zQ6a4VQ7e6RQ7h6YQ8Y7iQ8l8[R8x8n$W#`Z!_!o%w%}&y'Q'W'X'Y'Z'[']'^'_'`'a'b'd'g'k'u)p+R+^+g,O,^,d,g,w-x/v/y0i0s0w0x0y0z0{0|0}1O1P1Q1R1S1T1W1]2O2[3s3v4W4[4]4b4c5`6S6V6b6f6g7g7z8Z8m8y9_:|W(v#{&|1V8qT)Z$a,i$W#_Z!_!o%w%}&y'Q'W'X'Y'Z'[']'^'_'`'a'b'd'g'k'u)p+R+^+g,O,^,d,g,w-x/v/y0i0s0w0x0y0z0{0|0}1O1P1Q1R1S1T1W1]2O2[3s3v4W4[4]4b4c5`6S6V6b6f6g7g7z8Z8m8y9_:|Q'f#`S)Y$a,iR-{)Z&^cORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k$]$n%[%_%`%c%e%f%g%i%m%x%z&S&W&_&f&p&}'R'w(R)V)^*k*o*t+T+X+[+x,P,b,h,m-u-z.S.].|/_/`/a/c/g/j/l/{0T0j0t1X2i2q3R3f3h3i3q3x5o5}6W6{7j8]8o9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aQ%f{Q%g|Q%i!OQ%j!PR/f*rQ&e!iQ)[$cQ+w&hS.Q)`)wS0c+u+vW2S-}.O.P.kS4T0d0eU4|2U2V2WU6s4{5Y5ZQ7v6tR8b7yT+l&d+mS+j&d+mU0W+k+o+pU0]+q+r+sS0b+t2xS2s.y2vU3{0Z0[0^Q4P0_Q4Q0aS5c2t2{S5f2y2zU6Z3|4O4RQ6`4SS7Q5g5hQ7S5iS7k6]6_S8P7R7TQ8^7mR8g8QS+l&d+mT2u.y2vS&r!q/dQ-U(_Q-b(kS0V+j2sQ1g-VS1p-c-lU3}0]0b5fQ4h1bS4s1v1xU6^4P4Q7SQ6k4iQ6r4vR7n6`Q!xXS&q!q/dQ)W$[Q)b$eQ)h$kQ,Q&rQ-T(_Q-a(kQ-f(nQ.X)cQ/Q*]S0U+j2sS1f-U-VS1o-b-lQ1r-eQ1t-gQ3V/RW3y0V0]0b5fQ4g1bQ4k1gS4o1p1xQ4t1wQ5r3WW6[3}4P4Q7SS6j4h4iS6n4p:iQ6p4sQ6}5aQ7[5sS7l6^6`Q7r6kS7s6o:mQ7u6rQ7|7OQ8V7]Q8_7nS8a7t:nQ8d7}Q8s8eQ9Q8tQ9X9RQ:u:pQ;T:zQ;U:{Q;V;hR;[;m$rWORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$]$n%[%_%`%c%e%f%g%i%m%x%z&S&_&f&p&}'R(R)V)^*k*o*t+T+x,P,b,h-u-z.S.].|/_/`/a/c/g/j/l0T0j0t2i3R3f3h3i3x5o5}6W7j8]8oS!xn!k!j:o#]#k&W'w+X+[,m/{1X2q3q6{9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aR:u;`$rXORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$]$n%[%_%`%c%e%f%g%i%m%x%z&S&_&f&p&}'R(R)V)^*k*o*t+T+x,P,b,h-u-z.S.].|/_/`/a/c/g/j/l0T0j0t2i3R3f3h3i3x5o5}6W7j8]8oQ$[b!Y$em!j$h$i$j&U&j&k&l(k)f)g+]+j+|+}-d.[0Q0W0]0h1u3{4Q6Z7k8^S$kn!kQ)c$fQ*]%TW/R*^*_*`*aU3W/S/T/UQ5a2sS5s3X3YU7O5b5c5fQ7]5tU7}7P7Q7SS8e8O8PS8t8f8gQ9R8u!j:p#]#k&W'w+X+[,m/{1X2q3q6{9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aQ:z;_R:{;`$f]OSTjk}!S!W!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$]$n%[%_%c%e%f%g%i%m%z&S&_&f&p&}'R(R)V)^*k*o*t+T+x,P,b,h-u-z.S.].|/_/`/a/c/g/j/l0T0j0t2i3R3f3h3i3x5o5}6W7j8]8oY!hRU!]!`%xv$wrs!r!u$Z$u&`&t&w)x)y)z*m+Y+h,S,U/o0lQ*j%`!h:q#]#k'w+X+[,m/{1X2q3q6{9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aR:t&WS&[!b$vR0O+c$p[ORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$]$n%[%_%c%e%f%g%i%m%x%z&S&_&f&p&}'R(R)V)^*k*o*t+T+x,P,b,h-u-z.S.].|/_/`/a/c/g/j/l0T0j0t2i3R3f3h3i3x5o5}6W7j8]8o!j'e#]#k&W'w+X+[,m/{1X2q3q6{9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aR*i%`$roORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$]$n%[%_%`%c%e%f%g%i%m%x%z&S&_&f&p&}'R(R)V)^*k*o*t+T+x,P,b,h-u-z.S.].|/_/`/a/c/g/j/l0T0j0t2i3R3f3h3i3x5o5}6W7j8]8oQ'U!{!k:r#]#k&W'w+X+[,m/{1X2q3q6{9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;a!h#VZ!_$a%w%}&y'Q'_'`'a'b'g'k)p+R+g,O,^,d,w-x0i0s1T2O2[3v4W4[6V7g8Z8m8y9_!R9k'd'u+^,i/v/y0w1P1Q1R1S1W1]3s4]4b4c5`6S6b6f6g7z:|!d#XZ!_$a%w%}&y'Q'a'b'g'k)p+R+g,O,^,d,w-x0i0s1T2O2[3v4W4[6V7g8Z8m8y9_}9m'd'u+^,i/v/y0w1R1S1W1]3s4]4b4c5`6S6b6f6g7z:|!`#]Z!_$a%w%}&y'Q'g'k)p+R+g,O,^,d,w-x0i0s1T2O2[3v4W4[6V7g8Z8m8y9_Q1a-Px;a'd'u+^,i/v/y0w1W1]3s4]4b4c5`6S6b6f6g7z:|Q;i;pQ;j;qR;k;r&^cORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k$]$n%[%_%`%c%e%f%g%i%m%x%z&S&W&_&f&p&}'R'w(R)V)^*k*o*t+T+X+[+x,P,b,h,m-u-z.S.].|/_/`/a/c/g/j/l/{0T0j0t1X2i2q3R3f3h3i3q3x5o5}6W6{7j8]8o9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aS#l`#mR1Y,l&e_ORSTU`jk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k#m$]$n%[%_%`%c%e%f%g%i%m%x%z&S&W&_&f&p&}'R'w(R)V)^*k*o*t+T+X+[+x,P,b,h,l,m-u-z.S.].|/_/`/a/c/g/j/l/{0T0j0t1X2i2q3R3f3h3i3q3x5o5}6W6{7j8]8o9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aS#g^#nT'n#i'rT#h^#nT'p#i'r&e`ORSTU`jk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k#m$]$n%[%_%`%c%e%f%g%i%m%x%z&S&W&_&f&p&}'R'w(R)V)^*k*o*t+T+X+[+x,P,b,h,l,m-u-z.S.].|/_/`/a/c/g/j/l/{0T0j0t1X2i2q3R3f3h3i3q3x5o5}6W6{7j8]8o9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aT#l`#mQ#o`R'y#m$rbORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$]$n%[%_%`%c%e%f%g%i%m%x%z&S&_&f&p&}'R(R)V)^*k*o*t+T+x,P,b,h-u-z.S.].|/_/`/a/c/g/j/l0T0j0t2i3R3f3h3i3x5o5}6W7j8]8o!k;_#]#k&W'w+X+[,m/{1X2q3q6{9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;a#RdOSUj}!S!W!n!|#k$]%[%_%`%c%e%f%g%i%m&S&f'w)^*k*o*t+x,m-u.S.|/_/`/a/c/g/j/l1X2i3R3f3h3i5o5}x#{a!y$T$U$Y(W(Y(b(w(x,_-Y-w1a1y6i;^;i;j;k#[&|!w#d#v#y&g'}(Z(h)])_)a*O*R+y-Z-].R.T.p.s.{.}1k1s2Q2T2X2j3Q3S4l4u4}5k5p6z7W8T9w9z9}:U:X:[:a:d:j;l;n;t;u;vQ)S$WQ,x(Sd1V9r9y9|:P:W:Z:^:c:f:le8q9d9x9{:O:V:Y:]:b:e:kx#wa!y$T$U$Y(W(Y(b(w(x,_-Y-w1a1y6i;^;i;j;kQ(d#xS(n#z(qQ)T$XQ-g(o#[:w!w#d#v#y&g'}(Z(h)])_)a*O*R+y-Z-].R.T.p.s.{.}1k1s2Q2T2X2j3Q3S4l4u4}5k5p6z7W8T9w9z9}:U:X:[:a:d:j;l;n;t;u;vd:x9d9x9{:O:V:Y:]:b:e:kd:y9r9y9|:P:W:Z:^:c:f:lQ:};bQ;O;cQ;P;dQ;Q;eQ;R;fR;S;gx#{a!y$T$U$Y(W(Y(b(w(x,_-Y-w1a1y6i;^;i;j;k#[&|!w#d#v#y&g'}(Z(h)])_)a*O*R+y-Z-].R.T.p.s.{.}1k1s2Q2T2X2j3Q3S4l4u4}5k5p6z7W8T9w9z9}:U:X:[:a:d:j;l;n;t;u;vd1V9r9y9|:P:W:Z:^:c:f:le8q9d9x9{:O:V:Y:]:b:e:klfOSj}!n$]%c%f%g%i*o*t/g/jQ(g#yQ*}%pQ+O%rR1j-Z%O#|a!w!y#d#v#y$T$U$Y&g'}(W(Y(Z(b(h(w(x)])_)a*O*R+y,_-Y-Z-]-w.R.T.p.s.{.}1a1k1s1y2Q2T2X2j3Q3S4l4u4}5k5p6i6z7W8T9d9r9w9x9y9z9{9|9}:O:P:U:V:W:X:Y:Z:[:]:^:a:b:c:d:e:f:j:k:l;^;i;j;k;l;n;t;u;vQ*Q$}Q.r*SQ2m.qR5]2nT(p#z(qS(p#z(qT2u.y2vQ)b$eQ-f(nQ.X)cQ/Q*]Q3V/RQ5r3WQ6}5aQ7[5sQ7|7OQ8V7]Q8d7}Q8s8eQ9Q8tR9X9Rp(W#t'O)U-X-o-p0q1h1}4f4w7q:v;W;X;Y!n:U&z'i(^(f+v,[,t-P-^-|.P.o.q0e0p1i1m2W2l2n3O4Y4Z4m4q4y5O5Z5n6m6q7Y8`;Z;];p;q;r[:V8p9O9V9Y9Z9]]:W1U4a6c7o7p8zr(Y#t'O)U,}-X-o-p0q1h1}4f4w7q:v;W;X;Y!p:X&z'i(^(f+v,[,t-P-^-|.P.o.q0e0n0p1i1m2W2l2n3O4Y4Z4m4q4y5O5Z5n6m6q7Y8`;Z;];p;q;r^:Y8p9O9T9V9Y9Z9]_:Z1U4a6c6d7o7p8zpeOSjy}!n$]%Y%c%f%g%i*o*t/g/jQ%VxR*k%`peOSjy}!n$]%Y%c%f%g%i*o*t/g/jR%VxQ*U%OR.n)}qeOSjy}!n$]%Y%c%f%g%i*o*t/g/jQ.z*ZS3P/O/PW5j2|2}3O3TU7V5l5m5nU8R7U7X7YQ8h8SR8v8iQ%^yR*e%YR3^/XR7_5uS$mp$rR.d)nQ%czR*o%dR*u%jT/h*t/jR*y%kQ*x%kR/q*yQjOQ!nST$`j!nQ(P#sR,u(PQ!YQR%u!YQ!^RU%{!^%|+UQ%|!_R+U%}Q+a&XR/}+aQ,`'OR0r,`Q,c'QS0u,c0vR0v,dQ+m&dR0X+mS!eR$uU&a!e&b+VQ&b!fR+V&OQ+d&[R0P+dQ&u!sQ,R&sU,V&u,R0mR0m,WQ'r#iR,n'rQ#m`R'x#mQ#cZU'h#c+Q9qQ+Q9_R9q'uQ-S(_W1d-S1e4j6lU1e-T-U-VS4j1f1gR6l4k$k(U#t&z'O'i(^(f)P)Q)U+v,Y,Z,[,t,}-O-P-X-^-o-p-|.P.o.q0e0n0o0p0q1U1h1i1m1}2W2l2n3O4Y4Z4_4`4a4f4m4q4w4y5O5Z5n6c6d6e6m6q7Y7o7p7q8`8p8z8|8}9O9T9U9V9Y9Z9]:v;W;X;Y;Z;];p;q;rQ-[(fU1l-[1n4nQ1n-^R4n1mQ(q#zR-i(qQ(z$OR-r(zQ2R-|R4z2RQ){$xR.m){Q2p.tS5_2p6|R6|5`Q*W%PR.w*WQ2v.yR5d2vQ/W*bS3[/W5vR5v3^Q._)jW2a._2c5T6wQ2c.bQ5T2bR6w5UQ)o$mR.e)oQ/j*tR3l/jWiOSj!nQ%h}Q)X$]Q*n%cQ*p%fQ*q%gQ*s%iQ/e*oS/h*t/jR3k/gQ$_gQ%l!RQ%o!TQ%q!UQ%s!VQ)v$sQ)|$yQ*d%^Q*{%nQ-h(pS/Z*e*hQ/r*zQ/s*}Q/t+OS0S+j2sQ2f.hQ2k.oQ3U/QQ3`/]Q3j/fY3w0U0V0]0b5fQ5X2hQ5[2lQ5q3VQ5w3_[6U3v3y3}4P4Q7SQ6x5VQ7Z5rQ7`5xW7f6V6[6^6`Q7x6yQ7{6}Q8U7[U8X7g7l7nQ8c7|Q8j8VS8k8Z8_Q8r8dQ8w8mQ9P8sQ9S8yQ9W9QR9[9XQ$gmQ&i!jU)e$h$i$jQ+Z&UU+{&j&k&lQ-`(kS.Z)f)gQ/z+]Q0R+jS0g+|+}Q1q-dQ2Z.[Q3t0QS3z0W0]Q4V0hQ4r1uS6Y3{4QQ7i6ZQ8[7kR8n8^S#ua;^R({$PU$Oa$P;^R-q(yQ#taS&z!w)aQ'O!yQ'i#dQ(^#vQ(f#yQ)P$TQ)Q$UQ)U$YQ+v&gQ,Y9wQ,Z9zQ,[9}Q,t'}Q,}(WQ-O(YQ-P(ZQ-X(bQ-^(hQ-o(wQ-p(xd-|)].R.{2T3Q4}5k6z7W8TQ.P)_Q.o*OQ.q*RQ0e+yQ0n:UQ0o:XQ0p:[Q0q,_Q1U9rQ1h-YQ1i-ZQ1m-]Q1}-wQ2W.TQ2l.pQ2n.sQ3O.}Q4Y:aQ4Z:dQ4_9yQ4`9|Q4a:PQ4f1aQ4m1kQ4q1sQ4w1yQ4y2QQ5O2XQ5Z2jQ5n3SQ6c:^Q6d:WQ6e:ZQ6m4lQ6q4uQ7Y5pQ7o:cQ7p:fQ7q6iQ8`:jQ8p9dQ8z:lQ8|9xQ8}9{Q9O:OQ9T:VQ9U:YQ9V:]Q9Y:bQ9Z:eQ9]:kQ:v;^Q;W;iQ;X;jQ;Y;kQ;Z;lQ;];nQ;p;tQ;q;uR;r;vlgOSj}!n$]%c%f%g%i*o*t/g/jS!pU%eQ%n!SQ%t!WQ'V!|Q'v#kS*h%[%_Q*l%`Q*z%mQ+W&SQ+u&fQ,r'wQ.O)^Q/b*kQ0d+xQ1[,mQ1{-uQ2V.SQ2}.|Q3b/_Q3c/`Q3e/aQ3g/cQ3n/lQ4d1XQ5Y2iQ5m3RQ5|3fQ6O3hQ6P3iQ7X5oR7b5}!vZOSUj}!S!n!|$]%[%_%`%c%e%f%g%i%m&S&f)^*k*o*t+x-u.S.|/_/`/a/c/g/j/l2i3R3f3h3i5o5}Q!_RQ!oTQ$akS%w!]%zQ%}!`Q&y!vQ'Q!zQ'W#PQ'X#QQ'Y#RQ'Z#SQ'[#TQ']#UQ'^#VQ'_#WQ'`#XQ'a#YQ'b#ZQ'd#]Q'g#bQ'k#eW'u#k'w,m1XQ)p$nS+R%x+TS+^&W/{Q+g&_Q,O&pQ,^&}Q,d'RQ,g9^Q,i9`Q,w(RQ-x)VQ/v+XQ/y+[Q0i,PQ0s,bQ0w9cQ0x9eQ0y9fQ0z9gQ0{9hQ0|9iQ0}9jQ1O9kQ1P9lQ1Q9mQ1R9nQ1S9oQ1T,hQ1W9sQ1]9pQ2O-zQ2[.]Q3s:QQ3v0TQ4W0jQ4[0tQ4]:RQ4b:TQ4c:_Q5`2qQ6S3qQ6V3xQ6b:`Q6f:gQ6g:hQ7g6WQ7z6{Q8Z7jQ8m8]Q8y8oQ9_!WR:|;aR!aRR&Y!bS&U!b+`S+]&V&^R0Q+fR'P!yR'S!zT!tU$ZS!sU$ZU$xrs*mS&s!r!uQ,T&tQ,W&wQ.l)zS0k,S,UR4X0l`!dR!]!`$u%x&`)x+hh!qUrs!r!u$Z&t&w)z,S,U0lQ/d*mQ/w+YQ3p/oT:s&W)yT!gR$uS!fR$uS%y!]&`S&O!`)xS+S%x+hT+_&W)yT&]!b$vQ#i^R'{#nT'q#i'rR1Z,lT(a#v(cR(i#yQ-})]Q2U.RQ2|.{Q4{2TQ5l3QQ6t4}Q7U5kQ7y6zQ8S7WR8i8TlhOSj}!n$]%c%f%g%i*o*t/g/jQ%]yR*d%YV$yrs*mR.u*TR*c%WQ$qpR)u$rR)k$lT%az%dT%bz%dT/i*t/j",nodeNames:"⚠ extends ArithOp ArithOp InterpolationStart LineComment BlockComment Script ExportDeclaration export Star as VariableName String from ; default FunctionDeclaration async function VariableDefinition TypeParamList TypeDefinition ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation VoidType void TypeofType typeof MemberExpression . ?. PropertyName [ TemplateString Interpolation null super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewExpression new TypeArgList CompareOp < ) ( ArgList UnaryExpression await yield delete LogicOp BitOp ParenthesizedExpression ClassExpression class extends ClassBody MethodDeclaration Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression PrivatePropertyName BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof in const CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXStartTag JSXSelfClosingTag JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast ArrowFunction TypeParamList SequenceExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature CallSignature TypePredicate is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody MethodDeclaration AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement",maxTerm:332,context:KF,nodeProps:[["closedBy",4,"InterpolationEnd",40,"]",51,"}",66,")",132,"JSXSelfCloseEndTag JSXEndTag",146,"JSXEndTag"],["group",-26,8,15,17,58,184,188,191,192,194,197,200,211,213,219,221,223,225,228,234,240,242,244,246,248,250,251,"Statement",-30,12,13,24,27,28,41,43,44,45,47,52,60,68,74,75,91,92,101,103,119,122,124,125,126,127,129,130,148,149,151,"Expression",-22,23,25,29,32,34,152,154,156,157,159,160,161,163,164,165,167,168,169,178,180,182,183,"Type",-3,79,85,90,"ClassItem"],["openedBy",30,"InterpolationStart",46,"[",50,"{",65,"(",131,"JSXStartTag",141,"JSXStartTag JSXStartCloseTag"]],propSources:[rZ],skippedNodes:[0,5,6],repeatNodeCount:28,tokenData:"!C}~R!`OX%TXY%cYZ'RZ[%c[]%T]^'R^p%Tpq%cqr'crs(kst0htu2`uv4pvw5ewx6cxy<yyz=Zz{=k{|>k|}?O}!O>k!O!P?`!P!QCl!Q!R!0[!R![!1q![!]!7s!]!^!8V!^!_!8g!_!`!9d!`!a!:[!a!b!<R!b!c%T!c!}2`!}#O!=d#O#P%T#P#Q!=t#Q#R!>U#R#S2`#S#T!>i#T#o2`#o#p!>y#p#q!?O#q#r!?f#r#s!?x#s$f%T$f$g%c$g#BY2`#BY#BZ!@Y#BZ$IS2`$IS$I_!@Y$I_$I|2`$I|$I}!Bq$I}$JO!Bq$JO$JT2`$JT$JU!@Y$JU$KV2`$KV$KW!@Y$KW&FU2`&FU&FV!@Y&FV?HT2`?HT?HU!@Y?HU~2`W%YR$UWO!^%T!_#o%T#p~%T7Z%jg$UW'Y7ROX%TXY%cYZ%TZ[%c[p%Tpq%cq!^%T!_#o%T#p$f%T$f$g%c$g#BY%T#BY#BZ%c#BZ$IS%T$IS$I_%c$I_$JT%T$JT$JU%c$JU$KV%T$KV$KW%c$KW&FU%T&FU&FV%c&FV?HT%T?HT?HU%c?HU~%T7Z'YR$UW'Z7RO!^%T!_#o%T#p~%T$T'jS$UW!j#{O!^%T!_!`'v!`#o%T#p~%T$O'}S#e#v$UWO!^%T!_!`(Z!`#o%T#p~%T$O(bR#e#v$UWO!^%T!_#o%T#p~%T)X(rZ$UW]#eOY(kYZ)eZr(krs*rs!^(k!^!_+U!_#O(k#O#P-b#P#o(k#o#p+U#p~(k&r)jV$UWOr)ers*Ps!^)e!^!_*a!_#o)e#o#p*a#p~)e&r*WR$P&j$UWO!^%T!_#o%T#p~%T&j*dROr*ars*ms~*a&j*rO$P&j)X*{R$P&j$UW]#eO!^%T!_#o%T#p~%T)P+ZV]#eOY+UYZ*aZr+Urs+ps#O+U#O#P+w#P~+U)P+wO$P&j]#e)P+zROr+Urs,Ts~+U)P,[U$P&j]#eOY,nZr,nrs-Vs#O,n#O#P-[#P~,n#e,sU]#eOY,nZr,nrs-Vs#O,n#O#P-[#P~,n#e-[O]#e#e-_PO~,n)X-gV$UWOr(krs-|s!^(k!^!_+U!_#o(k#o#p+U#p~(k)X.VZ$P&j$UW]#eOY.xYZ%TZr.xrs/rs!^.x!^!_,n!_#O.x#O#P0S#P#o.x#o#p,n#p~.x#m/PZ$UW]#eOY.xYZ%TZr.xrs/rs!^.x!^!_,n!_#O.x#O#P0S#P#o.x#o#p,n#p~.x#m/yR$UW]#eO!^%T!_#o%T#p~%T#m0XT$UWO!^.x!^!_,n!_#o.x#o#p,n#p~.x3]0mZ$UWOt%Ttu1`u!^%T!_!c%T!c!}1`!}#R%T#R#S1`#S#T%T#T#o1`#p$g%T$g~1`3]1g]$UW'o3TOt%Ttu1`u!Q%T!Q![1`![!^%T!_!c%T!c!}1`!}#R%T#R#S1`#S#T%T#T#o1`#p$g%T$g~1`7Z2k_$UW#zS']$y'g3SOt%Ttu2`u}%T}!O3j!O!Q%T!Q![2`![!^%T!_!c%T!c!}2`!}#R%T#R#S2`#S#T%T#T#o2`#p$g%T$g~2`[3q_$UW#zSOt%Ttu3ju}%T}!O3j!O!Q%T!Q![3j![!^%T!_!c%T!c!}3j!}#R%T#R#S3j#S#T%T#T#o3j#p$g%T$g~3j$O4wS#^#v$UWO!^%T!_!`5T!`#o%T#p~%T$O5[R$UW#o#vO!^%T!_#o%T#p~%T5b5lU'x5Y$UWOv%Tvw6Ow!^%T!_!`5T!`#o%T#p~%T$O6VS$UW#i#vO!^%T!_!`5T!`#o%T#p~%T)X6jZ$UW]#eOY6cYZ7]Zw6cwx*rx!^6c!^!_8T!_#O6c#O#P:T#P#o6c#o#p8T#p~6c&r7bV$UWOw7]wx*Px!^7]!^!_7w!_#o7]#o#p7w#p~7]&j7zROw7wwx*mx~7w)P8YV]#eOY8TYZ7wZw8Twx+px#O8T#O#P8o#P~8T)P8rROw8Twx8{x~8T)P9SU$P&j]#eOY9fZw9fwx-Vx#O9f#O#P9}#P~9f#e9kU]#eOY9fZw9fwx-Vx#O9f#O#P9}#P~9f#e:QPO~9f)X:YV$UWOw6cwx:ox!^6c!^!_8T!_#o6c#o#p8T#p~6c)X:xZ$P&j$UW]#eOY;kYZ%TZw;kwx/rx!^;k!^!_9f!_#O;k#O#P<e#P#o;k#o#p9f#p~;k#m;rZ$UW]#eOY;kYZ%TZw;kwx/rx!^;k!^!_9f!_#O;k#O#P<e#P#o;k#o#p9f#p~;k#m<jT$UWO!^;k!^!_9f!_#o;k#o#p9f#p~;k&i=QR!d&a$UWO!^%T!_#o%T#p~%Tk=bR!cc$UWO!^%T!_#o%T#p~%T7V=tU'^4V#_#v$UWOz%Tz{>W{!^%T!_!`5T!`#o%T#p~%T$O>_S#[#v$UWO!^%T!_!`5T!`#o%T#p~%T%w>rSj%o$UWO!^%T!_!`5T!`#o%T#p~%T&i?VR!R&a$UWO!^%T!_#o%T#p~%T7Z?gVu5^$UWO!O%T!O!P?|!P!Q%T!Q![@r![!^%T!_#o%T#p~%T!{@RT$UWO!O%T!O!P@b!P!^%T!_#o%T#p~%T!{@iR!Q!s$UWO!^%T!_#o%T#p~%T!{@yZ$UWk!sO!Q%T!Q![@r![!^%T!_!g%T!g!hAl!h#R%T#R#S@r#S#X%T#X#YAl#Y#o%T#p~%T!{AqZ$UWO{%T{|Bd|}%T}!OBd!O!Q%T!Q![CO![!^%T!_#R%T#R#SCO#S#o%T#p~%T!{BiV$UWO!Q%T!Q![CO![!^%T!_#R%T#R#SCO#S#o%T#p~%T!{CVV$UWk!sO!Q%T!Q![CO![!^%T!_#R%T#R#SCO#S#o%T#p~%T7ZCs`$UW#]#vOYDuYZ%TZzDuz{Jl{!PDu!P!Q!-e!Q!^Du!^!_Fx!_!`!.^!`!a!/]!a!}Du!}#OHq#O#PJQ#P#oDu#o#pFx#p~DuXD|[$UW}POYDuYZ%TZ!PDu!P!QEr!Q!^Du!^!_Fx!_!}Du!}#OHq#O#PJQ#P#oDu#o#pFx#p~DuXEy_$UW}PO!^%T!_#Z%T#Z#[Er#[#]%T#]#^Er#^#a%T#a#bEr#b#g%T#g#hEr#h#i%T#i#jEr#j#m%T#m#nEr#n#o%T#p~%TPF}V}POYFxZ!PFx!P!QGd!Q!}Fx!}#OG{#O#PHh#P~FxPGiU}P#Z#[Gd#]#^Gd#a#bGd#g#hGd#i#jGd#m#nGdPHOTOYG{Z#OG{#O#PH_#P#QFx#Q~G{PHbQOYG{Z~G{PHkQOYFxZ~FxXHvY$UWOYHqYZ%TZ!^Hq!^!_G{!_#OHq#O#PIf#P#QDu#Q#oHq#o#pG{#p~HqXIkV$UWOYHqYZ%TZ!^Hq!^!_G{!_#oHq#o#pG{#p~HqXJVV$UWOYDuYZ%TZ!^Du!^!_Fx!_#oDu#o#pFx#p~Du7ZJs^$UW}POYJlYZKoZzJlz{NQ{!PJl!P!Q!,R!Q!^Jl!^!_!!]!_!}Jl!}#O!'|#O#P!+a#P#oJl#o#p!!]#p~Jl7ZKtV$UWOzKoz{LZ{!^Ko!^!_M]!_#oKo#o#pM]#p~Ko7ZL`X$UWOzKoz{LZ{!PKo!P!QL{!Q!^Ko!^!_M]!_#oKo#o#pM]#p~Ko7ZMSR$UWU7RO!^%T!_#o%T#p~%T7RM`ROzM]z{Mi{~M]7RMlTOzM]z{Mi{!PM]!P!QM{!Q~M]7RNQOU7R7ZNX^$UW}POYJlYZKoZzJlz{NQ{!PJl!P!Q! T!Q!^Jl!^!_!!]!_!}Jl!}#O!'|#O#P!+a#P#oJl#o#p!!]#p~Jl7Z! ^_$UWU7R}PO!^%T!_#Z%T#Z#[Er#[#]%T#]#^Er#^#a%T#a#bEr#b#g%T#g#hEr#h#i%T#i#jEr#j#m%T#m#nEr#n#o%T#p~%T7R!!bY}POY!!]YZM]Zz!!]z{!#Q{!P!!]!P!Q!&x!Q!}!!]!}#O!$`#O#P!&f#P~!!]7R!#VY}POY!!]YZM]Zz!!]z{!#Q{!P!!]!P!Q!#u!Q!}!!]!}#O!$`#O#P!&f#P~!!]7R!#|UU7R}P#Z#[Gd#]#^Gd#a#bGd#g#hGd#i#jGd#m#nGd7R!$cWOY!$`YZM]Zz!$`z{!${{#O!$`#O#P!&S#P#Q!!]#Q~!$`7R!%OYOY!$`YZM]Zz!$`z{!${{!P!$`!P!Q!%n!Q#O!$`#O#P!&S#P#Q!!]#Q~!$`7R!%sTU7ROYG{Z#OG{#O#PH_#P#QFx#Q~G{7R!&VTOY!$`YZM]Zz!$`z{!${{~!$`7R!&iTOY!!]YZM]Zz!!]z{!#Q{~!!]7R!&}_}POzM]z{Mi{#ZM]#Z#[!&x#[#]M]#]#^!&x#^#aM]#a#b!&x#b#gM]#g#h!&x#h#iM]#i#j!&x#j#mM]#m#n!&x#n~M]7Z!(R[$UWOY!'|YZKoZz!'|z{!(w{!^!'|!^!_!$`!_#O!'|#O#P!*o#P#QJl#Q#o!'|#o#p!$`#p~!'|7Z!(|^$UWOY!'|YZKoZz!'|z{!(w{!P!'|!P!Q!)x!Q!^!'|!^!_!$`!_#O!'|#O#P!*o#P#QJl#Q#o!'|#o#p!$`#p~!'|7Z!*PY$UWU7ROYHqYZ%TZ!^Hq!^!_G{!_#OHq#O#PIf#P#QDu#Q#oHq#o#pG{#p~Hq7Z!*tX$UWOY!'|YZKoZz!'|z{!(w{!^!'|!^!_!$`!_#o!'|#o#p!$`#p~!'|7Z!+fX$UWOYJlYZKoZzJlz{NQ{!^Jl!^!_!!]!_#oJl#o#p!!]#p~Jl7Z!,Yc$UW}POzKoz{LZ{!^Ko!^!_M]!_#ZKo#Z#[!,R#[#]Ko#]#^!,R#^#aKo#a#b!,R#b#gKo#g#h!,R#h#iKo#i#j!,R#j#mKo#m#n!,R#n#oKo#o#pM]#p~Ko7Z!-lV$UWT7ROY!-eYZ%TZ!^!-e!^!_!.R!_#o!-e#o#p!.R#p~!-e7R!.WQT7ROY!.RZ~!.R$P!.g[$UW#o#v}POYDuYZ%TZ!PDu!P!QEr!Q!^Du!^!_Fx!_!}Du!}#OHq#O#PJQ#P#oDu#o#pFx#p~Du]!/f[#wS$UW}POYDuYZ%TZ!PDu!P!QEr!Q!^Du!^!_Fx!_!}Du!}#OHq#O#PJQ#P#oDu#o#pFx#p~Du!{!0cd$UWk!sO!O%T!O!P@r!P!Q%T!Q![!1q![!^%T!_!g%T!g!hAl!h#R%T#R#S!1q#S#U%T#U#V!3X#V#X%T#X#YAl#Y#b%T#b#c!2w#c#d!4m#d#l%T#l#m!5{#m#o%T#p~%T!{!1x_$UWk!sO!O%T!O!P@r!P!Q%T!Q![!1q![!^%T!_!g%T!g!hAl!h#R%T#R#S!1q#S#X%T#X#YAl#Y#b%T#b#c!2w#c#o%T#p~%T!{!3OR$UWk!sO!^%T!_#o%T#p~%T!{!3^W$UWO!Q%T!Q!R!3v!R!S!3v!S!^%T!_#R%T#R#S!3v#S#o%T#p~%T!{!3}Y$UWk!sO!Q%T!Q!R!3v!R!S!3v!S!^%T!_#R%T#R#S!3v#S#b%T#b#c!2w#c#o%T#p~%T!{!4rV$UWO!Q%T!Q!Y!5X!Y!^%T!_#R%T#R#S!5X#S#o%T#p~%T!{!5`X$UWk!sO!Q%T!Q!Y!5X!Y!^%T!_#R%T#R#S!5X#S#b%T#b#c!2w#c#o%T#p~%T!{!6QZ$UWO!Q%T!Q![!6s![!^%T!_!c%T!c!i!6s!i#R%T#R#S!6s#S#T%T#T#Z!6s#Z#o%T#p~%T!{!6z]$UWk!sO!Q%T!Q![!6s![!^%T!_!c%T!c!i!6s!i#R%T#R#S!6s#S#T%T#T#Z!6s#Z#b%T#b#c!2w#c#o%T#p~%T$u!7|R!]V$UW#m$fO!^%T!_#o%T#p~%T!q!8^R_!i$UWO!^%T!_#o%T#p~%T5w!8rR'bd!a/n#x&s'|P!P!Q!8{!^!_!9Q!_!`!9_W!9QO$WW#v!9VP#`#v!_!`!9Y#v!9_O#o#v#v!9dO#a#v$u!9kT!{$m$UWO!^%T!_!`'v!`!a!9z!a#o%T#p~%T$P!:RR#W#w$UWO!^%T!_#o%T#p~%T%V!:gT'a!R#a#v$RS$UWO!^%T!_!`!:v!`!a!;W!a#o%T#p~%T$O!:}R#a#v$UWO!^%T!_#o%T#p~%T$O!;_T#`#v$UWO!^%T!_!`5T!`!a!;n!a#o%T#p~%T$O!;uS#`#v$UWO!^%T!_!`5T!`#o%T#p~%T*a!<YV'p#{$UWO!O%T!O!P!<o!P!^%T!_!a%T!a!b!=P!b#o%T#p~%T*[!<vRv*S$UWO!^%T!_#o%T#p~%T$O!=WS$UW#j#vO!^%T!_!`5T!`#o%T#p~%T7V!=kRx6}$UWO!^%T!_#o%T#p~%Tk!={R!Oc$UWO!^%T!_#o%T#p~%T$O!>]S#g#v$UWO!^%T!_!`5T!`#o%T#p~%T$a!>pR$UW'f$XO!^%T!_#o%T#p~%T~!?OO!T~5b!?VT'w5Y$UWO!^%T!_!`5T!`#o%T#p#q!=P#q~%T6X!?oR!S5}nQ$UWO!^%T!_#o%T#p~%TX!@PR!kP$UWO!^%T!_#o%T#p~%T7Z!@gr$UW'Y7R#zS']$y'g3SOX%TXY%cYZ%TZ[%c[p%Tpq%cqt%Ttu2`u}%T}!O3j!O!Q%T!Q![2`![!^%T!_!c%T!c!}2`!}#R%T#R#S2`#S#T%T#T#o2`#p$f%T$f$g%c$g#BY2`#BY#BZ!@Y#BZ$IS2`$IS$I_!@Y$I_$JT2`$JT$JU!@Y$JU$KV2`$KV$KW!@Y$KW&FU2`&FU&FV!@Y&FV?HT2`?HT?HU!@Y?HU~2`7Z!CO_$UW'Z7R#zS']$y'g3SOt%Ttu2`u}%T}!O3j!O!Q%T!Q![2`![!^%T!_!c%T!c!}2`!}#R%T#R#S2`#S#T%T#T#o2`#p$g%T$g~2`",tokenizers:[nZ,tZ,eZ,iZ,0,1,2,3,4,5,6,7,8,9,JF],topRules:{Script:[0,7]},dialects:{jsx:12107,ts:12109},dynamicPrecedences:{149:1,176:1},specialized:[{term:289,get:t=>sZ[t]||-1},{term:299,get:t=>oZ[t]||-1},{term:63,get:t=>lZ[t]||-1}],tokenPrec:12130}),hZ=1024;let cZ=0;class uZ{constructor(t,e){this.from=t,this.to=e}}class fZ{constructor(t={}){this.id=cZ++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=pZ.match(t)),e=>{let i=t(e);return void 0===i?null:[this,i]}}}fZ.closedBy=new fZ({deserialize:t=>t.split(" ")}),fZ.openedBy=new fZ({deserialize:t=>t.split(" ")}),fZ.group=new fZ({deserialize:t=>t.split(" ")}),fZ.contextHash=new fZ({perNode:!0}),fZ.lookAhead=new fZ({perNode:!0}),fZ.mounted=new fZ({perNode:!0});const dZ=Object.create(null);class pZ{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):dZ,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),n=new pZ(t.name||"",e,t.id,i);if(t.props)for(let i of t.props)if(Array.isArray(i)||(i=i(n)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[i[0].id]=i[1]}return n}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop(fZ.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return t=>{for(let i=t.prop(fZ.group),n=-1;n<(i?i.length:0);n++){let r=e[n<0?t.name:i[n]];if(r)return r}}}}pZ.none=new pZ("",Object.create(null),0,8);const gZ=new WeakMap,mZ=new WeakMap;var bZ;!function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"}(bZ||(bZ={}));class OZ{constructor(t,e,i,n,r){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,r&&r.length){this.props=Object.create(null);for(let[t,e]of r)this.props["number"==typeof t?t:t.id]=e}}toString(){let t=this.prop(fZ.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let i=t.toString();i&&(e&&(e+=","),e+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new MZ(this.topNode,t)}cursorAt(t,e=0,i=0){let n=gZ.get(this)||this.topNode,r=new MZ(n);return r.moveTo(t,e),gZ.set(this,r._tree),r}get topNode(){return new SZ(this,0,0,null)}resolve(t,e=0){let i=kZ(gZ.get(this)||this.topNode,t,e,!1);return gZ.set(this,i),i}resolveInner(t,e=0){let i=kZ(mZ.get(this)||this.topNode,t,e,!0);return mZ.set(this,i),i}iterate(t){let{enter:e,leave:i,from:n=0,to:r=this.length}=t;for(let s=this.cursor((t.mode||0)|bZ.IncludeAnonymous);;){let t=!1;if(s.from<=r&&s.to>=n&&(s.type.isAnonymous||!1!==e(s))){if(s.firstChild())continue;t=!0}for(;t&&i&&!s.type.isAnonymous&&i(s),!s.nextSibling();){if(!s.parent())return;t=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:_Z(pZ.none,this.children,this.positions,0,this.children.length,0,this.length,((t,e,i)=>new OZ(this.type,t,e,i,this.propValues)),t.makeTree||((t,e,i)=>new OZ(pZ.none,t,e,i)))}static build(t){return function(t){var e;let{buffer:i,nodeSet:n,maxBufferLength:r=hZ,reused:s=[],minRepeatType:o=n.types.length}=t,l=Array.isArray(i)?new vZ(i,i.length):i,a=n.types,h=0,c=0;function u(t,e,i,b,O){let{id:v,start:w,end:y,size:x}=l,k=c;for(;x<0;){if(l.next(),-1==x){let e=s[v];return i.push(e),void b.push(w-t)}if(-3==x)return void(h=v);if(-4==x)return void(c=v);throw new RangeError(`Unrecognized record size: ${x}`)}let S,C,A=a[v],T=w-t;if(y-w<=r&&(C=g(l.pos-e,O))){let e=new Uint16Array(C.size-C.skip),i=l.pos-C.size,r=e.length;for(;l.pos>i;)r=m(C.start,e,r);S=new wZ(e,y-C.start,n),T=C.start-t}else{let t=l.pos-x;l.next();let e=[],i=[],n=v>=o?v:-1,s=0,a=y;for(;l.pos>t;)n>=0&&l.id==n&&l.size>=0?(l.end<=a-r&&(d(e,i,w,s,l.end,a,n,k),s=e.length,a=l.end),l.next()):u(w,t,e,i,n);if(n>=0&&s>0&&s<e.length&&d(e,i,w,s,w,a,n,k),e.reverse(),i.reverse(),n>-1&&s>0){let t=f(A);S=_Z(A,e,i,0,e.length,0,y-w,t,t)}else S=p(A,e,i,y-w,k-y)}i.push(S),b.push(T)}function f(t){return(e,i,n)=>{let r,s,o=0,l=e.length-1;if(l>=0&&(r=e[l])instanceof OZ){if(!l&&r.type==t&&r.length==n)return r;(s=r.prop(fZ.lookAhead))&&(o=i[l]+r.length+s)}return p(t,e,i,n,o)}}function d(t,e,i,r,s,o,l,a){let h=[],c=[];for(;t.length>r;)h.push(t.pop()),c.push(e.pop()+i-s);t.push(p(n.types[l],h,c,o-s,a-o)),e.push(s-i)}function p(t,e,i,n,r=0,s){if(h){let t=[fZ.contextHash,h];s=s?[t].concat(s):[t]}if(r>25){let t=[fZ.lookAhead,r];s=s?[t].concat(s):[t]}return new OZ(t,e,i,n,s)}function g(t,e){let i=l.fork(),n=0,s=0,a=0,h=i.end-r,c={size:0,start:0,skip:0};t:for(let r=i.pos-t;i.pos>r;){let t=i.size;if(i.id==e&&t>=0){c.size=n,c.start=s,c.skip=a,a+=4,n+=4,i.next();continue}let l=i.pos-t;if(t<0||l<r||i.start<h)break;let u=i.id>=o?4:0,f=i.start;for(i.next();i.pos>l;){if(i.size<0){if(-3!=i.size)break t;u+=4}else i.id>=o&&(u+=4);i.next()}s=f,n+=t,a+=u}return(e<0||n==t)&&(c.size=n,c.start=s,c.skip=a),c.size>4?c:void 0}function m(t,e,i){let{id:n,start:r,end:s,size:a}=l;if(l.next(),a>=0&&n<o){let o=i;if(a>4){let n=l.pos-(a-4);for(;l.pos>n;)i=m(t,e,i)}e[--i]=o,e[--i]=s-t,e[--i]=r-t,e[--i]=n}else-3==a?h=n:-4==a&&(c=n);return i}let b=[],O=[];for(;l.pos>0;)u(t.start||0,t.bufferStart||0,b,O,-1);let v=null!==(e=t.length)&&void 0!==e?e:b.length?O[0]+b[0].length:0;return new OZ(a[t.topID],b.reverse(),O.reverse(),v)}(t)}}OZ.empty=new OZ(pZ.none,[],[],0);class vZ{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new vZ(this.buffer,this.index)}}class wZ{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return pZ.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],r=n.name;if(/\W/.test(r)&&!n.isError&&(r=JSON.stringify(r)),i==(t+=4))return r;let s=[];for(;t<i;)s.push(this.childString(t)),t=this.buffer[t+3];return r+"("+s.join(",")+")"}findChild(t,e,i,n,r){let{buffer:s}=this,o=-1;for(let l=t;l!=e&&!(yZ(r,n,s[l+1],s[l+2])&&(o=l,i>0));l=s[l+3]);return o}slice(t,e,i,n){let r=this.buffer,s=new Uint16Array(e-t);for(let n=t,o=0;n<e;)s[o++]=r[n++],s[o++]=r[n++]-i,s[o++]=r[n++]-i,s[o++]=r[n++]-t;return new wZ(s,n-i,this.set)}}function yZ(t,e,i,n){switch(t){case-2:return i<e;case-1:return n>=e&&i<e;case 0:return i<e&&n>e;case 1:return i<=e&&n>e;case 2:return n>e;case 4:return!0}}function xZ(t,e){let i=t.childBefore(e);for(;i;){let e=i.lastChild;if(!e||e.to!=i.to)break;e.type.isError&&e.from==e.to?(t=i,i=e.prevSibling):i=e}return t}function kZ(t,e,i,n){for(var r;t.from==t.to||(i<1?t.from>=e:t.from>e)||(i>-1?t.to<=e:t.to<e);){let e=!n&&t instanceof SZ&&t.index<0?null:t.parent;if(!e)return t;t=e}let s=n?0:bZ.IgnoreOverlays;if(n)for(let n=t,o=n.parent;o;n=o,o=n.parent)n instanceof SZ&&n.index<0&&(null===(r=o.enter(e,i,s))||void 0===r?void 0:r.from)!=n.from&&(t=o);for(;;){let n=t.enter(e,i,s);if(!n)return t;t=n}}class SZ{constructor(t,e,i,n){this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,r=0){for(let s=this;;){for(let{children:o,positions:l}=s._tree,a=e>0?o.length:-1;t!=a;t+=e){let a=o[t],h=l[t]+s.from;if(yZ(n,i,h,h+a.length))if(a instanceof wZ){if(r&bZ.ExcludeBuffers)continue;let o=a.findChild(0,a.buffer.length,e,i-h,n);if(o>-1)return new PZ(new TZ(s,a,t,h),null,o)}else if(r&bZ.IncludeAnonymous||!a.type.isAnonymous||QZ(a)){let o;if(!(r&bZ.IgnoreMounts)&&a.props&&(o=a.prop(fZ.mounted))&&!o.overlay)return new SZ(o.tree,h,t,s);let l=new SZ(a,h,t,s);return r&bZ.IncludeAnonymous||!l.type.isAnonymous?l:l.nextChild(e<0?a.children.length-1:0,e,i,n)}}if(r&bZ.IncludeAnonymous||!s.type.isAnonymous)return null;if(t=s.index>=0?s.index+e:e<0?-1:s._parent._tree.children.length,s=s._parent,!s)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&bZ.IgnoreOverlays)&&(n=this._tree.prop(fZ.mounted))&&n.overlay){let i=t-this.from;for(let{from:t,to:r}of n.overlay)if((e>0?t<=i:t<i)&&(e<0?r>=i:r>i))return new SZ(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new MZ(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return kZ(this,t,e,!1)}resolveInner(t,e=0){return kZ(this,t,e,!0)}enterUnfinishedNodesBefore(t){return xZ(this,t)}getChild(t,e=null,i=null){let n=CZ(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return CZ(this,t,e,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return AZ(this,t)}}function CZ(t,e,i,n){let r=t.cursor(),s=[];if(!r.firstChild())return s;if(null!=i)for(;!r.type.is(i);)if(!r.nextSibling())return s;for(;;){if(null!=n&&r.type.is(n))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return null==n?s:[]}}function AZ(t,e,i=e.length-1){for(let n=t.parent;i>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[i]&&e[i]!=n.name)return!1;i--}}return!0}class TZ{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class PZ{constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(t,e,i){let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return r<0?null:new PZ(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&bZ.ExcludeBuffers)return null;let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new PZ(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new PZ(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new PZ(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new MZ(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,r=i.buffer[this.index+3];if(r>n){let s=i.buffer[this.index+1],o=i.buffer[this.index+2];t.push(i.slice(n,r,s,o)),e.push(0)}return new OZ(this.type,t,e,this.to-this.from)}resolve(t,e=0){return kZ(this,t,e,!1)}resolveInner(t,e=0){return kZ(this,t,e,!0)}enterUnfinishedNodesBefore(t){return xZ(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let n=CZ(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return CZ(this,t,e,i)}get node(){return this}matchContext(t){return AZ(this,t)}}class MZ{constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof SZ)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}get name(){return this.type.name}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return!!t&&(t instanceof SZ?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?!(i&bZ.ExcludeBuffers)&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&bZ.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&bZ.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let t=i<0?0:this.stack[i]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(t)}return i<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(n.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;({index:e,_parent:i}=i))if(e>-1)for(let n=e+t,r=t<0?-1:i._tree.children.length;n!=r;n+=t){let t=i._tree.children[n];if(this.mode&bZ.IncludeAnonymous||t instanceof wZ||!t.type.isAnonymous||QZ(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,r=this.stack.length;r>=0;){for(let s=t;s;s=s._parent)if(s.index==n){if(n==this.index)return s;e=s,i=r+1;break t}n=this.stack[--r]}for(let t=i;t<this.stack.length;t++)e=new PZ(this.buffer,e,this.stack[t]);return this.bufferNode=new PZ(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||!1!==t(this)){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;n&&e&&e(this),n=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return AZ(this.node,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,r=this.stack.length-1;n>=0;r--){if(r<0)return AZ(this.node,t,n);let s=i[e.buffer[this.stack[r]]];if(!s.isAnonymous){if(t[n]&&t[n]!=s.name)return!1;n--}}return!0}}function QZ(t){return t.children.some((t=>t instanceof wZ||!t.type.isAnonymous||QZ(t)))}const RZ=new WeakMap;function $Z(t,e){if(!t.isAnonymous||e instanceof wZ||e.type!=t)return 1;let i=RZ.get(e);if(null==i){i=1;for(let n of e.children){if(n.type!=t||!(n instanceof OZ)){i=1;break}i+=$Z(t,n)}RZ.set(e,i)}return i}function _Z(t,e,i,n,r,s,o,l,a){let h=0;for(let i=n;i<r;i++)h+=$Z(t,e[i]);let c=Math.ceil(1.5*h/8),u=[],f=[];return function e(i,n,r,o,l){for(let h=r;h<o;){let r=h,d=n[h],p=$Z(t,i[h]);for(h++;h<o;h++){let e=$Z(t,i[h]);if(p+e>=c)break;p+=e}if(h==r+1){if(p>c){let t=i[r];e(t.children,t.positions,0,t.children.length,n[r]+l);continue}u.push(i[r])}else{let e=n[h-1]+i[h-1].length-d;u.push(_Z(t,i,n,r,h,d,e,null,a))}f.push(d+l-s)}}(e,i,n,r,0),(l||a)(u,f,o)}class DZ{constructor(){this.map=new WeakMap}setBuffer(t,e,i){let n=this.map.get(t);n||this.map.set(t,n=new Map),n.set(e,i)}getBuffer(t,e){let i=this.map.get(t);return i&&i.get(e)}set(t,e){t instanceof PZ?this.setBuffer(t.context.buffer,t.index,e):t instanceof SZ&&this.map.set(t.tree,e)}get(t){return t instanceof PZ?this.getBuffer(t.context.buffer,t.index):t instanceof SZ?this.map.get(t.tree):void 0}cursorSet(t,e){t.buffer?this.setBuffer(t.buffer.buffer,t.index,e):this.map.set(t.tree,e)}cursorGet(t){return t.buffer?this.getBuffer(t.buffer.buffer,t.index):this.map.get(t.tree)}}class EZ{constructor(t,e,i,n,r=!1,s=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(r?1:0)|(s?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(t,e=[],i=!1){let n=[new EZ(0,t.length,t,0,!1,i)];for(let i of e)i.to>t.length&&n.push(i);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],r=1,s=t.length?t[0]:null;for(let o=0,l=0,a=0;;o++){let h=o<e.length?e[o]:null,c=h?h.fromA:1e9;if(c-l>=i)for(;s&&s.from<c;){let e=s;if(l>=e.from||c<=e.to||a){let t=Math.max(e.from,l)-a,i=Math.min(e.to,c)-a;e=t>=i?null:new EZ(t,i,e.tree,e.offset+a,o>0,!!h)}if(e&&n.push(e),s.to>c)break;s=r<t.length?t[r++]:null}if(!h)break;l=h.toA,a=h.toA-h.toB}return n}}class NZ{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new fZ({perNode:!0});let BZ=0;class IZ{constructor(t,e,i){this.set=t,this.base=e,this.modified=i,this.id=BZ++}static define(t){if(null==t?void 0:t.base)throw new Error("Can not derive from a modified tag");let e=new IZ([],null,[]);if(e.set.push(e),t)for(let i of t.set)e.set.push(i);return e}static defineModifier(){let t=new LZ;return e=>e.modified.indexOf(t)>-1?e:LZ.get(e.base||e,e.modified.concat(t).sort(((t,e)=>t.id-e.id)))}}let zZ=0;class LZ{constructor(){this.instances=[],this.id=zZ++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find((i=>{return i.base==t&&(n=e,r=i.modified,n.length==r.length&&n.every(((t,e)=>t==r[e])));var n,r}));if(i)return i;let n=[],r=new IZ(n,t,e);for(let t of e)t.instances.push(r);let s=WZ(e);for(let e of t.set)for(let t of s)n.push(LZ.get(e,t));return r}}function WZ(t){let e=[t];for(let i=0;i<t.length;i++)for(let n of WZ(t.slice(0,i).concat(t.slice(i+1))))e.push(n);return e}function VZ(t){let e=Object.create(null);for(let i in t){let n=t[i];Array.isArray(n)||(n=[n]);for(let t of i.split(" "))if(t){let i=[],r=2,s=t;for(let e=0;;){if("..."==s&&e>0&&e+3==t.length){r=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!n)throw new RangeError("Invalid path: "+t);if(i.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),e+=n[0].length,e==t.length)break;let o=t[e++];if(e==t.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+t);s=t.slice(e)}let o=i.length-1,l=i[o];if(!l)throw new RangeError("Invalid path: "+t);let a=new qZ(n,r,o>0?i.slice(0,o):null);e[l]=a.sort(e[l])}}return jZ.add(e)}const jZ=new fZ;class qZ{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}const HZ=IZ.define,XZ=HZ(),FZ=HZ(),ZZ=HZ(FZ),GZ=HZ(FZ),UZ=HZ(),YZ=HZ(UZ),KZ=HZ(UZ),JZ=HZ(),tG=HZ(JZ),eG=HZ(),iG=HZ(),nG=HZ(),rG=HZ(nG),sG=HZ(),oG={comment:XZ,lineComment:HZ(XZ),blockComment:HZ(XZ),docComment:HZ(XZ),name:FZ,variableName:HZ(FZ),typeName:ZZ,tagName:HZ(ZZ),propertyName:GZ,attributeName:HZ(GZ),className:HZ(FZ),labelName:HZ(FZ),namespace:HZ(FZ),macroName:HZ(FZ),literal:UZ,string:YZ,docString:HZ(YZ),character:HZ(YZ),attributeValue:HZ(YZ),number:KZ,integer:HZ(KZ),float:HZ(KZ),bool:HZ(UZ),regexp:HZ(UZ),escape:HZ(UZ),color:HZ(UZ),url:HZ(UZ),keyword:eG,self:HZ(eG),null:HZ(eG),atom:HZ(eG),unit:HZ(eG),modifier:HZ(eG),operatorKeyword:HZ(eG),controlKeyword:HZ(eG),definitionKeyword:HZ(eG),moduleKeyword:HZ(eG),operator:iG,derefOperator:HZ(iG),arithmeticOperator:HZ(iG),logicOperator:HZ(iG),bitwiseOperator:HZ(iG),compareOperator:HZ(iG),updateOperator:HZ(iG),definitionOperator:HZ(iG),typeOperator:HZ(iG),controlOperator:HZ(iG),punctuation:nG,separator:HZ(nG),bracket:rG,angleBracket:HZ(rG),squareBracket:HZ(rG),paren:HZ(rG),brace:HZ(rG),content:JZ,heading:tG,heading1:HZ(tG),heading2:HZ(tG),heading3:HZ(tG),heading4:HZ(tG),heading5:HZ(tG),heading6:HZ(tG),contentSeparator:HZ(JZ),list:HZ(JZ),quote:HZ(JZ),emphasis:HZ(JZ),strong:HZ(JZ),link:HZ(JZ),monospace:HZ(JZ),strikethrough:HZ(JZ),inserted:HZ(),deleted:HZ(),changed:HZ(),invalid:HZ(),meta:sG,documentMeta:HZ(sG),annotation:HZ(sG),processingInstruction:HZ(sG),definition:IZ.defineModifier(),constant:IZ.defineModifier(),function:IZ.defineModifier(),standard:IZ.defineModifier(),local:IZ.defineModifier(),special:IZ.defineModifier()};var lG;!function(t,e){let i=Object.create(null);for(let e of t)if(Array.isArray(e.tag))for(let t of e.tag)i[t.id]=e.class;else i[e.tag.id]=e.class;let{scope:n,all:r=null}=e||{}}([{tag:oG.link,class:"tok-link"},{tag:oG.heading,class:"tok-heading"},{tag:oG.emphasis,class:"tok-emphasis"},{tag:oG.strong,class:"tok-strong"},{tag:oG.keyword,class:"tok-keyword"},{tag:oG.atom,class:"tok-atom"},{tag:oG.bool,class:"tok-bool"},{tag:oG.url,class:"tok-url"},{tag:oG.labelName,class:"tok-labelName"},{tag:oG.inserted,class:"tok-inserted"},{tag:oG.deleted,class:"tok-deleted"},{tag:oG.literal,class:"tok-literal"},{tag:oG.string,class:"tok-string"},{tag:oG.number,class:"tok-number"},{tag:[oG.regexp,oG.escape,oG.special(oG.string)],class:"tok-string2"},{tag:oG.variableName,class:"tok-variableName"},{tag:oG.local(oG.variableName),class:"tok-variableName tok-local"},{tag:oG.definition(oG.variableName),class:"tok-variableName tok-definition"},{tag:oG.special(oG.variableName),class:"tok-variableName2"},{tag:oG.definition(oG.propertyName),class:"tok-propertyName tok-definition"},{tag:oG.typeName,class:"tok-typeName"},{tag:oG.namespace,class:"tok-namespace"},{tag:oG.className,class:"tok-className"},{tag:oG.macroName,class:"tok-macroName"},{tag:oG.propertyName,class:"tok-propertyName"},{tag:oG.operator,class:"tok-operator"},{tag:oG.comment,class:"tok-comment"},{tag:oG.meta,class:"tok-meta"},{tag:oG.invalid,class:"tok-invalid"},{tag:oG.punctuation,class:"tok-punctuation"}]);const aG=new fZ;class hG{constructor(t,e,i=[]){this.data=t,Qe.prototype.hasOwnProperty("tree")||Object.defineProperty(Qe.prototype,"tree",{get(){return fG(this)}}),this.parser=e,this.extension=[yG.of(this),Qe.languageData.of(((t,e,i)=>t.facet(cG(t,e,i))))].concat(i)}isActiveAt(t,e,i=-1){return cG(t,e,i)==this.data}findRegions(t){let e=t.facet(yG);if((null==e?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let i=[],n=(t,e)=>{if(t.prop(aG)==this.data)return void i.push({from:e,to:e+t.length});let r=t.prop(fZ.mounted);if(r){if(r.tree.prop(aG)==this.data){if(r.overlay)for(let t of r.overlay)i.push({from:t.from+e,to:t.to+e});else i.push({from:e,to:e+t.length});return}if(r.overlay){let t=i.length;if(n(r.tree,r.overlay[0].from+e),i.length>t)return}}for(let i=0;i<t.children.length;i++){let r=t.children[i];r instanceof OZ&&n(r,t.positions[i]+e)}};return n(fG(t),0),i}get allowsNesting(){return!0}}function cG(t,e,i){let n=t.facet(yG);if(!n)return null;let r=n.data;if(n.allowsNesting)for(let n=fG(t).topNode;n;n=n.enter(e,i,bZ.ExcludeBuffers))r=n.type.prop(aG)||r;return r}hG.setState=Oe.define();class uG extends hG{constructor(t,e){super(t,e),this.parser=e}static define(t){let e=(i=t.languageData,Vt.define({combine:i?t=>t.concat(i):void 0}));var i;return new uG(e,t.parser.configure({props:[aG.add((t=>t.isTop?e:void 0))]}))}configure(t){return new uG(this.data,this.parser.configure(t))}get allowsNesting(){return this.parser.hasWrappers()}}function fG(t){let e=t.field(hG.state,!1);return e?e.tree:OZ.empty}class dG{constructor(t,e=t.length){this.doc=t,this.length=e,this.cursorPos=0,this.string="",this.cursor=t.iter()}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-i,e-i)}}let pG=null;class gG{constructor(t,e,i=[],n,r,s,o,l){this.parser=t,this.state=e,this.fragments=i,this.tree=n,this.treeLen=r,this.viewport=s,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(t,e,i){return new gG(t,e,[],OZ.empty,0,i,[],null)}startParse(){return this.parser.startParse(new dG(this.state.doc),this.fragments)}work(t,e){return null!=e&&e>=this.state.doc.length&&(e=void 0),this.tree!=OZ.empty&&this.isDone(null!=e?e:this.state.doc.length)?(this.takeTree(),!0):this.withContext((()=>{var i;if("number"==typeof t){let e=Date.now()+t;t=()=>Date.now()>e}for(this.parse||(this.parse=this.startParse()),null!=e&&(null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n){if(this.fragments=this.withoutTempSkipped(EZ.addTree(n,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(i=this.parse.stoppedAt)&&void 0!==i?i:this.state.doc.length,this.tree=n,this.parse=null,!(this.treeLen<(null!=e?e:this.state.doc.length)))return!0;this.parse=this.startParse()}if(t())return!1}}))}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext((()=>{for(;!(e=this.parse.advance()););})),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(EZ.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=pG;pG=this;try{return t()}finally{pG=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=mG(t,e.from,e.to);return t}changes(t,e){let{fragments:i,tree:n,treeLen:r,viewport:s,skipped:o}=this;if(this.takeTree(),!t.empty){let e=[];if(t.iterChangedRanges(((t,i,n,r)=>e.push({fromA:t,toA:i,fromB:n,toB:r}))),i=EZ.applyChanges(i,e),n=OZ.empty,r=0,s={from:t.mapPos(s.from,-1),to:t.mapPos(s.to,1)},this.skipped.length){o=[];for(let e of this.skipped){let i=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);i<n&&o.push({from:i,to:n})}}}return new gG(this.parser,e,i,n,r,s,o,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let e=0;e<this.skipped.length;e++){let{from:i,to:n}=this.skipped[e];i<t.to&&n>t.from&&(this.fragments=mG(this.fragments,i,n),this.skipped.splice(e--,1))}return!(this.skipped.length>=e)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends class{startParse(t,e,i){return"string"==typeof t&&(t=new NZ(t)),i=i?i.length?i.map((t=>new uZ(t.from,t.to))):[new uZ(0,0)]:[new uZ(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let t=n.advance();if(t)return t}}}{createParse(e,i,n){let r=n[0].from,s=n[n.length-1].to;return{parsedPos:r,advance(){let e=pG;if(e){for(let t of n)e.tempSkipped.push(t);t&&(e.scheduleOn=e.scheduleOn?Promise.all([e.scheduleOn,t]):t)}return this.parsedPos=s,new OZ(pZ.none,[],[],s-r)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&0==e[0].from&&e[0].to>=t}static get(){return pG}}function mG(t,e,i){return EZ.applyChanges(t,[{fromA:e,toA:i,fromB:e,toB:i}])}class bG{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,i)||e.takeTree(),new bG(e)}static init(t){let e=Math.min(3e3,t.doc.length),i=gG.create(t.facet(yG).parser,t,{from:0,to:e});return i.work(20,e)||i.takeTree(),new bG(i)}}hG.state=Gt.define({create:bG.init,update(t,e){for(let t of e.effects)if(t.is(hG.setState))return t.value;return e.startState.facet(yG)!=e.state.facet(yG)?bG.init(e.state):t.apply(e)}});let OG=t=>{let e=setTimeout((()=>t()),500);return()=>clearTimeout(e)};"undefined"!=typeof requestIdleCallback&&(OG=t=>{let e=-1,i=setTimeout((()=>{e=requestIdleCallback(t,{timeout:400})}),100);return()=>e<0?clearTimeout(i):cancelIdleCallback(e)});const vG="undefined"!=typeof navigator&&(null===(lG=navigator.scheduling)||void 0===lG?void 0:lG.isInputPending)?()=>navigator.scheduling.isInputPending():null,wG=Bn.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(hG.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),t.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(hG.state);e.tree==e.context.tree&&e.context.isDone(t.doc.length)||(this.working=OG(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,r=i.field(hG.state);if(r.tree==r.context.tree&&r.context.isDone(n+1e5))return;let s=Date.now()+Math.min(this.chunkBudget,100,t&&!vG?Math.max(25,t.timeRemaining()-5):1e9),o=r.context.treeLen<n&&i.doc.length>n+1e3,l=r.context.work((()=>vG&&vG()||Date.now()>s),n+(o?0:1e5));this.chunkBudget-=Date.now()-e,(l||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:hG.setState.of(new bG(r.context))})),this.chunkBudget>0&&(!l||o)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then((()=>this.scheduleWork())).catch((t=>_n(this.view.state,t))).then((()=>this.workScheduled--)),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),yG=Vt.define({combine:t=>t.length?t[0]:null,enables:[hG.state,wG]});class xG{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}}const kG=Vt.define({combine:t=>{if(!t.length)return"  ";if(!/^(?: +|\t+)$/.test(t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return t[0]}}),SG=new fZ;function CG({closing:t,align:e=!0,units:i=1}){return n=>function(t,e,i,n,r){let s=t.textAfter,o=s.match(/^\s*/)[0].length,l=n&&s.slice(o,o+n.length)==n||r==t.pos+o,a=e?function(t){let e=t.node,i=e.childAfter(e.from),n=e.lastChild;if(!i)return null;let r=t.options.simulateBreak,s=t.state.doc.lineAt(i.from),o=null==r||r<=s.from?s.to:Math.min(s.to,r);for(let t=i.to;;){let r=e.childAfter(t);if(!r||r==n)return null;if(!r.type.isSkipped)return r.from<o?i:null;t=r.to}}(t):null;return a?l?t.column(a.from):t.column(a.to):t.baseIndent+(l?0:t.unit*i)}(n,e,i,t)}function AG({except:t,units:e=1}={}){return i=>{let n=t&&t.test(i.textAfter);return i.baseIndent+(n?0:e*i.unit)}}const TG=new fZ;const PG=Object.create(null),MG=[pZ.none],QG=[],RG=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])RG[t]=_G(PG,e);function $G(t,e){QG.indexOf(t)>-1||(QG.push(t),console.warn(e))}function _G(t,e){let i=null;for(let n of e.split(".")){let e=t[n]||oG[n];e?"function"==typeof e?i?i=e(i):$G(n,`Modifier ${n} used at start of tag`):i?$G(n,`Tag ${n} used as modifier`):i=e:$G(n,`Unknown highlighting tag ${n}`)}if(!i)return 0;let n=e.replace(/ /g,"_"),r=pZ.define({id:MG.length,name:n,props:[VZ({[n]:i})]});return MG.push(r),r.id}function DG(t){let e=Object.keys(t).join(""),i=/\w/.test(e);return i&&(e=e.replace(/\w/g,"")),`[${i?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function EG(t){let e=t.map((t=>"string"==typeof t?{label:t}:t)),[i,n]=e.every((t=>/^\w+$/.test(t.label)))?[/\w*$/,/\w+$/]:function(t){let e=Object.create(null),i=Object.create(null);for(let{label:n}of t){e[n[0]]=!0;for(let t=1;t<n.length;t++)i[n[t]]=!0}let n=DG(e)+DG(i)+"*$";return[new RegExp("^"+n),new RegExp(n)]}(e);return t=>{let r=t.matchBefore(n);return r||t.explicit?{from:r?r.from:t.pos,options:e,validFor:i}:null}}const NG=Is.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"300px"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class BG{constructor(t,e,i,n){this.field=t,this.line=e,this.from=i,this.to=n}}class IG{constructor(t,e,i){this.field=t,this.from=e,this.to=i}map(t){let e=t.mapPos(this.from,-1,Mt.TrackDel),i=t.mapPos(this.to,1,Mt.TrackDel);return null==e||null==i?null:new IG(this.field,e,i)}}class zG{constructor(t,e){this.lines=t,this.fieldPositions=e}instantiate(t,e){let i=[],n=[e],r=t.doc.lineAt(e),s=/^\s*/.exec(r.text)[0];for(let r of this.lines){if(i.length){let i=s,o=/^\t*/.exec(r)[0].length;for(let e=0;e<o;e++)i+=t.facet(kG);n.push(e+i.length-o),r=i+r.slice(o)}i.push(r),e+=r.length+1}let o=this.fieldPositions.map((t=>new IG(t.field,n[t.line]+t.from,n[t.line]+t.to)));return{text:i,ranges:o}}static parse(t){let e,i=[],n=[],r=[];for(let s of t.split(/\r\n?|\n/)){for(;e=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(s);){let t=e[1]?+e[1]:null,o=e[2]||e[3]||"",l=-1;for(let e=0;e<i.length;e++)(null!=t?i[e].seq==t:o&&i[e].name==o)&&(l=e);if(l<0){let e=0;for(;e<i.length&&(null==t||null!=i[e].seq&&i[e].seq<t);)e++;i.splice(e,0,{seq:t,name:o}),l=e;for(let t of r)t.field>=l&&t.field++}r.push(new BG(l,n.length,e.index,e.index+o.length)),s=s.slice(0,e.index)+o+s.slice(e.index+e[0].length)}for(let t;t=/([$#])\\{/.exec(s);){s=s.slice(0,t.index)+t[1]+"{"+s.slice(t.index+t[0].length);for(let e of r)e.line==n.length&&e.from>t.index&&(e.from--,e.to--)}n.push(s)}return new zG(n,r)}}let LG=dn.widget({widget:new class extends un{toDOM(){let t=document.createElement("span");return t.className="cm-snippetFieldPosition",t}ignoreEvent(){return!1}}}),WG=dn.mark({class:"cm-snippetField"});class VG{constructor(t,e){this.ranges=t,this.active=e,this.deco=dn.set(t.map((t=>(t.from==t.to?LG:WG).range(t.from,t.to))))}map(t){let e=[];for(let i of this.ranges){let n=i.map(t);if(!n)return null;e.push(n)}return new VG(e,this.active)}selectionInsideField(t){return t.ranges.every((t=>this.ranges.some((e=>e.field==this.active&&e.from<=t.from&&e.to>=t.to))))}}const jG=Oe.define({map:(t,e)=>t&&t.map(e)}),qG=Oe.define(),HG=Gt.define({create:()=>null,update(t,e){for(let i of e.effects){if(i.is(jG))return i.value;if(i.is(qG)&&t)return new VG(t.ranges,i.value)}return t&&e.docChanged&&(t=t.map(e.changes)),t&&e.selection&&!t.selectionInsideField(e.selection)&&(t=null),t},provide:t=>Is.decorations.from(t,(t=>t?t.deco:dn.none))});function XG(t,e){return zt.create(t.filter((t=>t.field==e)).map((t=>zt.range(t.from,t.to))))}function FG(t){let e=zG.parse(t);return(t,i,n,r)=>{let{text:s,ranges:o}=e.instantiate(t.state,n),l={changes:{from:n,to:r,insert:at.of(s)},scrollIntoView:!0};if(o.length&&(l.selection=XG(o,0)),o.length>1){let e=new VG(o,0),i=l.effects=[jG.of(e)];void 0===t.state.field(HG,!1)&&i.push(Oe.appendConfig.of([HG,YG,JG,NG]))}t.dispatch(t.state.update(l))}}function ZG(t){return({state:e,dispatch:i})=>{let n=e.field(HG,!1);if(!n||t<0&&0==n.active)return!1;let r=n.active+t,s=t>0&&!n.ranges.some((e=>e.field==r+t));return i(e.update({selection:XG(n.ranges,r),effects:jG.of(s?null:new VG(n.ranges,r))})),!0}}const GG=[{key:"Tab",run:ZG(1),shift:ZG(-1)},{key:"Escape",run:({state:t,dispatch:e})=>!!t.field(HG,!1)&&(e(t.update({effects:jG.of(null)})),!0)}],UG=Vt.define({combine:t=>t.length?t[0]:GG}),YG=ee.highest(Xs.compute([UG],(t=>t.facet(UG))));function KG(t,e){return Object.assign(Object.assign({},e),{apply:FG(t)})}const JG=Is.domEventHandlers({mousedown(t,e){let i,n=e.state.field(HG,!1);if(!n||null==(i=e.posAtCoords({x:t.clientX,y:t.clientY})))return!1;let r=n.ranges.find((t=>t.from<=i&&t.to>=i));return!(!r||r.field==n.active)&&(e.dispatch({selection:XG(n.ranges,r.field),effects:jG.of(n.ranges.some((t=>t.field>r.field))?new VG(n.ranges,r.field):null)}),!0)}}),tU=new class extends $e{};tU.startSide=1,tU.endSide=-1;const eU=[KG("function ${name}(${params}) {\n\t${}\n}",{label:"function",detail:"definition",type:"keyword"}),KG("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n\t${}\n}",{label:"for",detail:"loop",type:"keyword"}),KG("for (let ${name} of ${collection}) {\n\t${}\n}",{label:"for",detail:"of loop",type:"keyword"}),KG("do {\n\t${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),KG("while (${}) {\n\t${}\n}",{label:"while",detail:"loop",type:"keyword"}),KG("try {\n\t${}\n} catch (${error}) {\n\t${}\n}",{label:"try",detail:"/ catch block",type:"keyword"}),KG("if (${}) {\n\t${}\n}",{label:"if",detail:"block",type:"keyword"}),KG("if (${}) {\n\t${}\n} else {\n\t${}\n}",{label:"if",detail:"/ else block",type:"keyword"}),KG("class ${name} {\n\tconstructor(${params}) {\n\t\t${}\n\t}\n}",{label:"class",detail:"definition",type:"keyword"}),KG('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),KG('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],iU=new DZ,nU=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function rU(t){return(e,i)=>{let n=e.node.getChild("VariableDefinition");return n&&i(n,t),!0}}const sU=["FunctionDeclaration"],oU={FunctionDeclaration:rU("function"),ClassDeclaration:rU("class"),ClassExpression:()=>!0,EnumDeclaration:rU("constant"),TypeAliasDeclaration:rU("type"),NamespaceDeclaration:rU("namespace"),VariableDefinition(t,e){t.matchContext(sU)||e(t,"variable")},TypeDefinition(t,e){e(t,"type")},__proto__:null};function lU(t,e){let i=iU.get(e);if(i)return i;let n=[],r=!0;function s(e,i){let r=t.sliceString(e.from,e.to);n.push({label:r,type:i})}return e.cursor(bZ.IncludeAnonymous).iterate((e=>{if(r)r=!1;else if(e.name){let t=oU[e.name];if(t&&t(e,s)||nU.has(e.name))return!1}else if(e.to-e.from>8192){for(let i of lU(t,e.node))n.push(i);return!1}})),iU.set(e,n),n}const aU=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,hU=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName"];function cU(t){let e=fG(t.state).resolveInner(t.pos,-1);if(hU.indexOf(e.name)>-1)return null;let i=e.to-e.from<20&&aU.test(t.state.sliceDoc(e.from,e.to));if(!i&&!t.explicit)return null;let n=[];for(let i=e;i;i=i.parent)nU.has(i.name)&&(n=n.concat(lU(t.state.doc,i)));return{options:n,from:i?e.from:t.pos,validFor:aU}}const uU=uG.define({parser:aZ.configure({props:[SG.add({IfStatement:AG({except:/^\s*({|else\b)/}),TryStatement:AG({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:t=>t.baseIndent,SwitchBody:t=>{let e=t.textAfter,i=/^\s*\}/.test(e),n=/^\s*(case|default)\b/.test(e);return t.baseIndent+(i?0:n?1:2)*t.unit},Block:CG({closing:"}"}),ArrowFunction:t=>t.baseIndent+t.unit,"TemplateString BlockComment":()=>-1,"Statement Property":AG({except:/^{/}),JSXElement(t){let e=/^\s*<\//.test(t.textAfter);return t.lineIndent(t.node.from)+(e?0:t.unit)},JSXEscape(t){let e=/\s*\}/.test(t.textAfter);return t.lineIndent(t.node.from)+(e?0:t.unit)},"JSXOpenTag JSXSelfClosingTag":t=>t.column(t.node.from)+t.unit}),TG.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression":function(t){let e=t.firstChild,i=t.lastChild;return e&&e.to<i.from?{from:e.to,to:i.type.isError?t.to:i.from}:null},BlockComment:t=>({from:t.from+2,to:t.to-2})})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),fU=uU.configure({dialect:"ts"}),dU=uU.configure({dialect:"jsx"}),pU=uU.configure({dialect:"jsx ts"}),gU="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map((t=>({label:t,type:"keyword"})));function mU(t={}){let e=t.jsx?t.typescript?pU:dU:t.typescript?fU:uU;return new xG(e,[uU.data.of({autocomplete:(i=hU,n=EG(eU.concat(gU)),t=>{for(let e=fG(t.state).resolveInner(t.pos,-1);e;e=e.parent)if(i.indexOf(e.name)>-1)return null;return n(t)})}),uU.data.of({autocomplete:cU}),t.jsx?vU:[]]);var i,n}function bU(t,e,i=t.length){if(!e)return"";let n=e.getChild("JSXIdentifier");return n?t.sliceString(n.from,Math.min(n.to,i)):""}const OU="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),vU=Is.inputHandler.of(((t,e,i,n)=>{if((OU?t.composing:t.compositionStarted)||t.state.readOnly||e!=i||">"!=n&&"/"!=n||!uU.isActiveAt(t.state,e,-1))return!1;let{state:r}=t,s=r.changeByRange((t=>{var e,i,s;let o,{head:l}=t,a=fG(r).resolveInner(l,-1);if("JSXStartTag"==a.name&&(a=a.parent),">"==n&&"JSXFragmentTag"==a.name)return{range:zt.cursor(l+1),changes:{from:l,insert:"><>"}};if(">"==n&&"JSXIdentifier"==a.name){if("JSXEndTag"!=(null===(i=null===(e=a.parent)||void 0===e?void 0:e.lastChild)||void 0===i?void 0:i.name)&&(o=bU(r.doc,a.parent,l)))return{range:zt.cursor(l+1),changes:{from:l,insert:`></${o}>`}}}else if("/"==n&&"JSXFragmentTag"==a.name){let t=a.parent,e=null==t?void 0:t.parent;if(t.from==l-1&&"JSXEndTag"!=(null===(s=e.lastChild)||void 0===s?void 0:s.name)&&(o=bU(r.doc,null==e?void 0:e.firstChild,l))){let t=`/${o}>`;return{range:zt.cursor(l+t.length),changes:{from:l,insert:t}}}}return{range:t}}));return!s.changes.empty&&(t.dispatch(s,{userEvent:"input.type",scrollIntoView:!0}),!0)})),wU=1024;let yU=0;class xU{constructor(t,e){this.from=t,this.to=e}}class kU{constructor(t={}){this.id=yU++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=CU.match(t)),e=>{let i=t(e);return void 0===i?null:[this,i]}}}kU.closedBy=new kU({deserialize:t=>t.split(" ")}),kU.openedBy=new kU({deserialize:t=>t.split(" ")}),kU.group=new kU({deserialize:t=>t.split(" ")}),kU.contextHash=new kU({perNode:!0}),kU.lookAhead=new kU({perNode:!0}),kU.mounted=new kU({perNode:!0});const SU=Object.create(null);class CU{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):SU,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),n=new CU(t.name||"",e,t.id,i);if(t.props)for(let i of t.props)if(Array.isArray(i)||(i=i(n)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[i[0].id]=i[1]}return n}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop(kU.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return t=>{for(let i=t.prop(kU.group),n=-1;n<(i?i.length:0);n++){let r=e[n<0?t.name:i[n]];if(r)return r}}}}CU.none=new CU("",Object.create(null),0,8);const AU=new WeakMap,TU=new WeakMap;var PU;!function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"}(PU||(PU={}));class MU{constructor(t,e,i,n,r){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,r&&r.length){this.props=Object.create(null);for(let[t,e]of r)this.props["number"==typeof t?t:t.id]=e}}toString(){let t=this.prop(kU.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let i=t.toString();i&&(e&&(e+=","),e+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new LU(this.topNode,t)}cursorAt(t,e=0,i=0){let n=AU.get(this)||this.topNode,r=new LU(n);return r.moveTo(t,e),AU.set(this,r._tree),r}get topNode(){return new EU(this,0,0,null)}resolve(t,e=0){let i=DU(AU.get(this)||this.topNode,t,e,!1);return AU.set(this,i),i}resolveInner(t,e=0){let i=DU(TU.get(this)||this.topNode,t,e,!0);return TU.set(this,i),i}iterate(t){let{enter:e,leave:i,from:n=0,to:r=this.length}=t;for(let s=this.cursor((t.mode||0)|PU.IncludeAnonymous);;){let t=!1;if(s.from<=r&&s.to>=n&&(s.type.isAnonymous||!1!==e(s))){if(s.firstChild())continue;t=!0}for(;t&&i&&!s.type.isAnonymous&&i(s),!s.nextSibling();){if(!s.parent())return;t=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:qU(CU.none,this.children,this.positions,0,this.children.length,0,this.length,((t,e,i)=>new MU(this.type,t,e,i,this.propValues)),t.makeTree||((t,e,i)=>new MU(CU.none,t,e,i)))}static build(t){return function(t){var e;let{buffer:i,nodeSet:n,maxBufferLength:r=wU,reused:s=[],minRepeatType:o=n.types.length}=t,l=Array.isArray(i)?new QU(i,i.length):i,a=n.types,h=0,c=0;function u(t,e,i,b,O){let{id:v,start:w,end:y,size:x}=l,k=c;for(;x<0;){if(l.next(),-1==x){let e=s[v];return i.push(e),void b.push(w-t)}if(-3==x)return void(h=v);if(-4==x)return void(c=v);throw new RangeError(`Unrecognized record size: ${x}`)}let S,C,A=a[v],T=w-t;if(y-w<=r&&(C=g(l.pos-e,O))){let e=new Uint16Array(C.size-C.skip),i=l.pos-C.size,r=e.length;for(;l.pos>i;)r=m(C.start,e,r);S=new RU(e,y-C.start,n),T=C.start-t}else{let t=l.pos-x;l.next();let e=[],i=[],n=v>=o?v:-1,s=0,a=y;for(;l.pos>t;)n>=0&&l.id==n&&l.size>=0?(l.end<=a-r&&(d(e,i,w,s,l.end,a,n,k),s=e.length,a=l.end),l.next()):u(w,t,e,i,n);if(n>=0&&s>0&&s<e.length&&d(e,i,w,s,w,a,n,k),e.reverse(),i.reverse(),n>-1&&s>0){let t=f(A);S=qU(A,e,i,0,e.length,0,y-w,t,t)}else S=p(A,e,i,y-w,k-y)}i.push(S),b.push(T)}function f(t){return(e,i,n)=>{let r,s,o=0,l=e.length-1;if(l>=0&&(r=e[l])instanceof MU){if(!l&&r.type==t&&r.length==n)return r;(s=r.prop(kU.lookAhead))&&(o=i[l]+r.length+s)}return p(t,e,i,n,o)}}function d(t,e,i,r,s,o,l,a){let h=[],c=[];for(;t.length>r;)h.push(t.pop()),c.push(e.pop()+i-s);t.push(p(n.types[l],h,c,o-s,a-o)),e.push(s-i)}function p(t,e,i,n,r=0,s){if(h){let t=[kU.contextHash,h];s=s?[t].concat(s):[t]}if(r>25){let t=[kU.lookAhead,r];s=s?[t].concat(s):[t]}return new MU(t,e,i,n,s)}function g(t,e){let i=l.fork(),n=0,s=0,a=0,h=i.end-r,c={size:0,start:0,skip:0};t:for(let r=i.pos-t;i.pos>r;){let t=i.size;if(i.id==e&&t>=0){c.size=n,c.start=s,c.skip=a,a+=4,n+=4,i.next();continue}let l=i.pos-t;if(t<0||l<r||i.start<h)break;let u=i.id>=o?4:0,f=i.start;for(i.next();i.pos>l;){if(i.size<0){if(-3!=i.size)break t;u+=4}else i.id>=o&&(u+=4);i.next()}s=f,n+=t,a+=u}return(e<0||n==t)&&(c.size=n,c.start=s,c.skip=a),c.size>4?c:void 0}function m(t,e,i){let{id:n,start:r,end:s,size:a}=l;if(l.next(),a>=0&&n<o){let o=i;if(a>4){let n=l.pos-(a-4);for(;l.pos>n;)i=m(t,e,i)}e[--i]=o,e[--i]=s-t,e[--i]=r-t,e[--i]=n}else-3==a?h=n:-4==a&&(c=n);return i}let b=[],O=[];for(;l.pos>0;)u(t.start||0,t.bufferStart||0,b,O,-1);let v=null!==(e=t.length)&&void 0!==e?e:b.length?O[0]+b[0].length:0;return new MU(a[t.topID],b.reverse(),O.reverse(),v)}(t)}}MU.empty=new MU(CU.none,[],[],0);class QU{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new QU(this.buffer,this.index)}}class RU{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return CU.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],r=n.name;if(/\W/.test(r)&&!n.isError&&(r=JSON.stringify(r)),i==(t+=4))return r;let s=[];for(;t<i;)s.push(this.childString(t)),t=this.buffer[t+3];return r+"("+s.join(",")+")"}findChild(t,e,i,n,r){let{buffer:s}=this,o=-1;for(let l=t;l!=e&&!($U(r,n,s[l+1],s[l+2])&&(o=l,i>0));l=s[l+3]);return o}slice(t,e,i,n){let r=this.buffer,s=new Uint16Array(e-t);for(let n=t,o=0;n<e;)s[o++]=r[n++],s[o++]=r[n++]-i,s[o++]=r[n++]-i,s[o++]=r[n++]-t;return new RU(s,n-i,this.set)}}function $U(t,e,i,n){switch(t){case-2:return i<e;case-1:return n>=e&&i<e;case 0:return i<e&&n>e;case 1:return i<=e&&n>e;case 2:return n>e;case 4:return!0}}function _U(t,e){let i=t.childBefore(e);for(;i;){let e=i.lastChild;if(!e||e.to!=i.to)break;e.type.isError&&e.from==e.to?(t=i,i=e.prevSibling):i=e}return t}function DU(t,e,i,n){for(var r;t.from==t.to||(i<1?t.from>=e:t.from>e)||(i>-1?t.to<=e:t.to<e);){let e=!n&&t instanceof EU&&t.index<0?null:t.parent;if(!e)return t;t=e}let s=n?0:PU.IgnoreOverlays;if(n)for(let n=t,o=n.parent;o;n=o,o=n.parent)n instanceof EU&&n.index<0&&(null===(r=o.enter(e,i,s))||void 0===r?void 0:r.from)!=n.from&&(t=o);for(;;){let n=t.enter(e,i,s);if(!n)return t;t=n}}class EU{constructor(t,e,i,n){this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,r=0){for(let s=this;;){for(let{children:o,positions:l}=s._tree,a=e>0?o.length:-1;t!=a;t+=e){let a=o[t],h=l[t]+s.from;if($U(n,i,h,h+a.length))if(a instanceof RU){if(r&PU.ExcludeBuffers)continue;let o=a.findChild(0,a.buffer.length,e,i-h,n);if(o>-1)return new zU(new IU(s,a,t,h),null,o)}else if(r&PU.IncludeAnonymous||!a.type.isAnonymous||WU(a)){let o;if(!(r&PU.IgnoreMounts)&&a.props&&(o=a.prop(kU.mounted))&&!o.overlay)return new EU(o.tree,h,t,s);let l=new EU(a,h,t,s);return r&PU.IncludeAnonymous||!l.type.isAnonymous?l:l.nextChild(e<0?a.children.length-1:0,e,i,n)}}if(r&PU.IncludeAnonymous||!s.type.isAnonymous)return null;if(t=s.index>=0?s.index+e:e<0?-1:s._parent._tree.children.length,s=s._parent,!s)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&PU.IgnoreOverlays)&&(n=this._tree.prop(kU.mounted))&&n.overlay){let i=t-this.from;for(let{from:t,to:r}of n.overlay)if((e>0?t<=i:t<i)&&(e<0?r>=i:r>i))return new EU(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new LU(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return DU(this,t,e,!1)}resolveInner(t,e=0){return DU(this,t,e,!0)}enterUnfinishedNodesBefore(t){return _U(this,t)}getChild(t,e=null,i=null){let n=NU(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return NU(this,t,e,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return BU(this,t)}}function NU(t,e,i,n){let r=t.cursor(),s=[];if(!r.firstChild())return s;if(null!=i)for(;!r.type.is(i);)if(!r.nextSibling())return s;for(;;){if(null!=n&&r.type.is(n))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return null==n?s:[]}}function BU(t,e,i=e.length-1){for(let n=t.parent;i>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[i]&&e[i]!=n.name)return!1;i--}}return!0}class IU{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class zU{constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(t,e,i){let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return r<0?null:new zU(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&PU.ExcludeBuffers)return null;let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new zU(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new zU(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new zU(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new LU(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,r=i.buffer[this.index+3];if(r>n){let s=i.buffer[this.index+1],o=i.buffer[this.index+2];t.push(i.slice(n,r,s,o)),e.push(0)}return new MU(this.type,t,e,this.to-this.from)}resolve(t,e=0){return DU(this,t,e,!1)}resolveInner(t,e=0){return DU(this,t,e,!0)}enterUnfinishedNodesBefore(t){return _U(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let n=NU(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return NU(this,t,e,i)}get node(){return this}matchContext(t){return BU(this,t)}}class LU{constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof EU)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}get name(){return this.type.name}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return!!t&&(t instanceof EU?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?!(i&PU.ExcludeBuffers)&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&PU.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&PU.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let t=i<0?0:this.stack[i]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(t)}return i<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(n.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;({index:e,_parent:i}=i))if(e>-1)for(let n=e+t,r=t<0?-1:i._tree.children.length;n!=r;n+=t){let t=i._tree.children[n];if(this.mode&PU.IncludeAnonymous||t instanceof RU||!t.type.isAnonymous||WU(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,r=this.stack.length;r>=0;){for(let s=t;s;s=s._parent)if(s.index==n){if(n==this.index)return s;e=s,i=r+1;break t}n=this.stack[--r]}for(let t=i;t<this.stack.length;t++)e=new zU(this.buffer,e,this.stack[t]);return this.bufferNode=new zU(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||!1!==t(this)){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;n&&e&&e(this),n=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return BU(this.node,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,r=this.stack.length-1;n>=0;r--){if(r<0)return BU(this.node,t,n);let s=i[e.buffer[this.stack[r]]];if(!s.isAnonymous){if(t[n]&&t[n]!=s.name)return!1;n--}}return!0}}function WU(t){return t.children.some((t=>t instanceof RU||!t.type.isAnonymous||WU(t)))}const VU=new WeakMap;function jU(t,e){if(!t.isAnonymous||e instanceof RU||e.type!=t)return 1;let i=VU.get(e);if(null==i){i=1;for(let n of e.children){if(n.type!=t||!(n instanceof MU)){i=1;break}i+=jU(t,n)}VU.set(e,i)}return i}function qU(t,e,i,n,r,s,o,l,a){let h=0;for(let i=n;i<r;i++)h+=jU(t,e[i]);let c=Math.ceil(1.5*h/8),u=[],f=[];return function e(i,n,r,o,l){for(let h=r;h<o;){let r=h,d=n[h],p=jU(t,i[h]);for(h++;h<o;h++){let e=jU(t,i[h]);if(p+e>=c)break;p+=e}if(h==r+1){if(p>c){let t=i[r];e(t.children,t.positions,0,t.children.length,n[r]+l);continue}u.push(i[r])}else{let e=n[h-1]+i[h-1].length-d;u.push(qU(t,i,n,r,h,d,e,null,a))}f.push(d+l-s)}}(e,i,n,r,0),(l||a)(u,f,o)}class HU{constructor(t,e,i,n,r=!1,s=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(r?1:0)|(s?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(t,e=[],i=!1){let n=[new HU(0,t.length,t,0,!1,i)];for(let i of e)i.to>t.length&&n.push(i);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],r=1,s=t.length?t[0]:null;for(let o=0,l=0,a=0;;o++){let h=o<e.length?e[o]:null,c=h?h.fromA:1e9;if(c-l>=i)for(;s&&s.from<c;){let e=s;if(l>=e.from||c<=e.to||a){let t=Math.max(e.from,l)-a,i=Math.min(e.to,c)-a;e=t>=i?null:new HU(t,i,e.tree,e.offset+a,o>0,!!h)}if(e&&n.push(e),s.to>c)break;s=r<t.length?t[r++]:null}if(!h)break;l=h.toA,a=h.toA-h.toB}return n}}class XU{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new kU({perNode:!0});let FU=0;class ZU{constructor(t,e,i){this.set=t,this.base=e,this.modified=i,this.id=FU++}static define(t){if(null==t?void 0:t.base)throw new Error("Can not derive from a modified tag");let e=new ZU([],null,[]);if(e.set.push(e),t)for(let i of t.set)e.set.push(i);return e}static defineModifier(){let t=new UU;return e=>e.modified.indexOf(t)>-1?e:UU.get(e.base||e,e.modified.concat(t).sort(((t,e)=>t.id-e.id)))}}let GU=0;class UU{constructor(){this.instances=[],this.id=GU++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find((i=>{return i.base==t&&(n=e,r=i.modified,n.length==r.length&&n.every(((t,e)=>t==r[e])));var n,r}));if(i)return i;let n=[],r=new ZU(n,t,e);for(let t of e)t.instances.push(r);let s=YU(e);for(let e of t.set)for(let t of s)n.push(UU.get(e,t));return r}}function YU(t){let e=[t];for(let i=0;i<t.length;i++)for(let n of YU(t.slice(0,i).concat(t.slice(i+1))))e.push(n);return e}function KU(t){let e=Object.create(null);for(let i in t){let n=t[i];Array.isArray(n)||(n=[n]);for(let t of i.split(" "))if(t){let i=[],r=2,s=t;for(let e=0;;){if("..."==s&&e>0&&e+3==t.length){r=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!n)throw new RangeError("Invalid path: "+t);if(i.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),e+=n[0].length,e==t.length)break;let o=t[e++];if(e==t.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+t);s=t.slice(e)}let o=i.length-1,l=i[o];if(!l)throw new RangeError("Invalid path: "+t);let a=new tY(n,r,o>0?i.slice(0,o):null);e[l]=a.sort(e[l])}}return JU.add(e)}const JU=new kU;class tY{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}const eY=ZU.define,iY=eY(),nY=eY(),rY=eY(nY),sY=eY(nY),oY=eY(),lY=eY(oY),aY=eY(oY),hY=eY(),cY=eY(hY),uY=eY(),fY=eY(),dY=eY(),pY=eY(dY),gY=eY(),mY={comment:iY,lineComment:eY(iY),blockComment:eY(iY),docComment:eY(iY),name:nY,variableName:eY(nY),typeName:rY,tagName:eY(rY),propertyName:sY,attributeName:eY(sY),className:eY(nY),labelName:eY(nY),namespace:eY(nY),macroName:eY(nY),literal:oY,string:lY,docString:eY(lY),character:eY(lY),attributeValue:eY(lY),number:aY,integer:eY(aY),float:eY(aY),bool:eY(oY),regexp:eY(oY),escape:eY(oY),color:eY(oY),url:eY(oY),keyword:uY,self:eY(uY),null:eY(uY),atom:eY(uY),unit:eY(uY),modifier:eY(uY),operatorKeyword:eY(uY),controlKeyword:eY(uY),definitionKeyword:eY(uY),moduleKeyword:eY(uY),operator:fY,derefOperator:eY(fY),arithmeticOperator:eY(fY),logicOperator:eY(fY),bitwiseOperator:eY(fY),compareOperator:eY(fY),updateOperator:eY(fY),definitionOperator:eY(fY),typeOperator:eY(fY),controlOperator:eY(fY),punctuation:dY,separator:eY(dY),bracket:pY,angleBracket:eY(pY),squareBracket:eY(pY),paren:eY(pY),brace:eY(pY),content:hY,heading:cY,heading1:eY(cY),heading2:eY(cY),heading3:eY(cY),heading4:eY(cY),heading5:eY(cY),heading6:eY(cY),contentSeparator:eY(hY),list:eY(hY),quote:eY(hY),emphasis:eY(hY),strong:eY(hY),link:eY(hY),monospace:eY(hY),strikethrough:eY(hY),inserted:eY(),deleted:eY(),changed:eY(),invalid:eY(),meta:gY,documentMeta:eY(gY),annotation:eY(gY),processingInstruction:eY(gY),definition:ZU.defineModifier(),constant:ZU.defineModifier(),function:ZU.defineModifier(),standard:ZU.defineModifier(),local:ZU.defineModifier(),special:ZU.defineModifier()};var bY;!function(t,e){let i=Object.create(null);for(let e of t)if(Array.isArray(e.tag))for(let t of e.tag)i[t.id]=e.class;else i[e.tag.id]=e.class;let{scope:n,all:r=null}=e||{}}([{tag:mY.link,class:"tok-link"},{tag:mY.heading,class:"tok-heading"},{tag:mY.emphasis,class:"tok-emphasis"},{tag:mY.strong,class:"tok-strong"},{tag:mY.keyword,class:"tok-keyword"},{tag:mY.atom,class:"tok-atom"},{tag:mY.bool,class:"tok-bool"},{tag:mY.url,class:"tok-url"},{tag:mY.labelName,class:"tok-labelName"},{tag:mY.inserted,class:"tok-inserted"},{tag:mY.deleted,class:"tok-deleted"},{tag:mY.literal,class:"tok-literal"},{tag:mY.string,class:"tok-string"},{tag:mY.number,class:"tok-number"},{tag:[mY.regexp,mY.escape,mY.special(mY.string)],class:"tok-string2"},{tag:mY.variableName,class:"tok-variableName"},{tag:mY.local(mY.variableName),class:"tok-variableName tok-local"},{tag:mY.definition(mY.variableName),class:"tok-variableName tok-definition"},{tag:mY.special(mY.variableName),class:"tok-variableName2"},{tag:mY.definition(mY.propertyName),class:"tok-propertyName tok-definition"},{tag:mY.typeName,class:"tok-typeName"},{tag:mY.namespace,class:"tok-namespace"},{tag:mY.className,class:"tok-className"},{tag:mY.macroName,class:"tok-macroName"},{tag:mY.propertyName,class:"tok-propertyName"},{tag:mY.operator,class:"tok-operator"},{tag:mY.comment,class:"tok-comment"},{tag:mY.meta,class:"tok-meta"},{tag:mY.invalid,class:"tok-invalid"},{tag:mY.punctuation,class:"tok-punctuation"}]);const OY=new kU;class vY{constructor(t,e,i=[]){this.data=t,Qe.prototype.hasOwnProperty("tree")||Object.defineProperty(Qe.prototype,"tree",{get(){return xY(this)}}),this.parser=e,this.extension=[RY.of(this),Qe.languageData.of(((t,e,i)=>t.facet(wY(t,e,i))))].concat(i)}isActiveAt(t,e,i=-1){return wY(t,e,i)==this.data}findRegions(t){let e=t.facet(RY);if((null==e?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let i=[],n=(t,e)=>{if(t.prop(OY)==this.data)return void i.push({from:e,to:e+t.length});let r=t.prop(kU.mounted);if(r){if(r.tree.prop(OY)==this.data){if(r.overlay)for(let t of r.overlay)i.push({from:t.from+e,to:t.to+e});else i.push({from:e,to:e+t.length});return}if(r.overlay){let t=i.length;if(n(r.tree,r.overlay[0].from+e),i.length>t)return}}for(let i=0;i<t.children.length;i++){let r=t.children[i];r instanceof MU&&n(r,t.positions[i]+e)}};return n(xY(t),0),i}get allowsNesting(){return!0}}function wY(t,e,i){let n=t.facet(RY);if(!n)return null;let r=n.data;if(n.allowsNesting)for(let n=xY(t).topNode;n;n=n.enter(e,i,PU.ExcludeBuffers))r=n.type.prop(OY)||r;return r}vY.setState=Oe.define();class yY extends vY{constructor(t,e){super(t,e),this.parser=e}static define(t){let e=(i=t.languageData,Vt.define({combine:i?t=>t.concat(i):void 0}));var i;return new yY(e,t.parser.configure({props:[OY.add((t=>t.isTop?e:void 0))]}))}configure(t){return new yY(this.data,this.parser.configure(t))}get allowsNesting(){return this.parser.hasWrappers()}}function xY(t){let e=t.field(vY.state,!1);return e?e.tree:MU.empty}class kY{constructor(t,e=t.length){this.doc=t,this.length=e,this.cursorPos=0,this.string="",this.cursor=t.iter()}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-i,e-i)}}let SY=null;class CY{constructor(t,e,i=[],n,r,s,o,l){this.parser=t,this.state=e,this.fragments=i,this.tree=n,this.treeLen=r,this.viewport=s,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(t,e,i){return new CY(t,e,[],MU.empty,0,i,[],null)}startParse(){return this.parser.startParse(new kY(this.state.doc),this.fragments)}work(t,e){return null!=e&&e>=this.state.doc.length&&(e=void 0),this.tree!=MU.empty&&this.isDone(null!=e?e:this.state.doc.length)?(this.takeTree(),!0):this.withContext((()=>{var i;if("number"==typeof t){let e=Date.now()+t;t=()=>Date.now()>e}for(this.parse||(this.parse=this.startParse()),null!=e&&(null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n){if(this.fragments=this.withoutTempSkipped(HU.addTree(n,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(i=this.parse.stoppedAt)&&void 0!==i?i:this.state.doc.length,this.tree=n,this.parse=null,!(this.treeLen<(null!=e?e:this.state.doc.length)))return!0;this.parse=this.startParse()}if(t())return!1}}))}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext((()=>{for(;!(e=this.parse.advance()););})),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(HU.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=SY;SY=this;try{return t()}finally{SY=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=AY(t,e.from,e.to);return t}changes(t,e){let{fragments:i,tree:n,treeLen:r,viewport:s,skipped:o}=this;if(this.takeTree(),!t.empty){let e=[];if(t.iterChangedRanges(((t,i,n,r)=>e.push({fromA:t,toA:i,fromB:n,toB:r}))),i=HU.applyChanges(i,e),n=MU.empty,r=0,s={from:t.mapPos(s.from,-1),to:t.mapPos(s.to,1)},this.skipped.length){o=[];for(let e of this.skipped){let i=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);i<n&&o.push({from:i,to:n})}}}return new CY(this.parser,e,i,n,r,s,o,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let e=0;e<this.skipped.length;e++){let{from:i,to:n}=this.skipped[e];i<t.to&&n>t.from&&(this.fragments=AY(this.fragments,i,n),this.skipped.splice(e--,1))}return!(this.skipped.length>=e)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends class{startParse(t,e,i){return"string"==typeof t&&(t=new XU(t)),i=i?i.length?i.map((t=>new xU(t.from,t.to))):[new xU(0,0)]:[new xU(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let t=n.advance();if(t)return t}}}{createParse(e,i,n){let r=n[0].from,s=n[n.length-1].to;return{parsedPos:r,advance(){let e=SY;if(e){for(let t of n)e.tempSkipped.push(t);t&&(e.scheduleOn=e.scheduleOn?Promise.all([e.scheduleOn,t]):t)}return this.parsedPos=s,new MU(CU.none,[],[],s-r)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&0==e[0].from&&e[0].to>=t}static get(){return SY}}function AY(t,e,i){return HU.applyChanges(t,[{fromA:e,toA:i,fromB:e,toB:i}])}class TY{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,i)||e.takeTree(),new TY(e)}static init(t){let e=Math.min(3e3,t.doc.length),i=CY.create(t.facet(RY).parser,t,{from:0,to:e});return i.work(20,e)||i.takeTree(),new TY(i)}}vY.state=Gt.define({create:TY.init,update(t,e){for(let t of e.effects)if(t.is(vY.setState))return t.value;return e.startState.facet(RY)!=e.state.facet(RY)?TY.init(e.state):t.apply(e)}});let PY=t=>{let e=setTimeout((()=>t()),500);return()=>clearTimeout(e)};"undefined"!=typeof requestIdleCallback&&(PY=t=>{let e=-1,i=setTimeout((()=>{e=requestIdleCallback(t,{timeout:400})}),100);return()=>e<0?clearTimeout(i):cancelIdleCallback(e)});const MY="undefined"!=typeof navigator&&(null===(bY=navigator.scheduling)||void 0===bY?void 0:bY.isInputPending)?()=>navigator.scheduling.isInputPending():null,QY=Bn.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(vY.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),t.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(vY.state);e.tree==e.context.tree&&e.context.isDone(t.doc.length)||(this.working=PY(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,r=i.field(vY.state);if(r.tree==r.context.tree&&r.context.isDone(n+1e5))return;let s=Date.now()+Math.min(this.chunkBudget,100,t&&!MY?Math.max(25,t.timeRemaining()-5):1e9),o=r.context.treeLen<n&&i.doc.length>n+1e3,l=r.context.work((()=>MY&&MY()||Date.now()>s),n+(o?0:1e5));this.chunkBudget-=Date.now()-e,(l||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:vY.setState.of(new TY(r.context))})),this.chunkBudget>0&&(!l||o)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then((()=>this.scheduleWork())).catch((t=>_n(this.view.state,t))).then((()=>this.workScheduled--)),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),RY=Vt.define({combine:t=>t.length?t[0]:null,enables:[vY.state,QY]});class $Y{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}}const _Y=new kU,DY=new kU,EY=Object.create(null),NY=[CU.none],BY=[],IY=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])IY[t]=LY(EY,e);function zY(t,e){BY.indexOf(t)>-1||(BY.push(t),console.warn(e))}function LY(t,e){let i=null;for(let n of e.split(".")){let e=t[n]||mY[n];e?"function"==typeof e?i?i=e(i):zY(n,`Modifier ${n} used at start of tag`):i?zY(n,`Tag ${n} used as modifier`):i=e:zY(n,`Unknown highlighting tag ${n}`)}if(!i)return 0;let n=e.replace(/ /g,"_"),r=CU.define({id:NY.length,name:n,props:[KU({[n]:i})]});return NY.push(r),r.id}const WY=["_blank","_self","_top","_parent"],VY=["ascii","utf-8","utf-16","latin1","latin1"],jY=["get","post","put","delete"],qY=["application/x-www-form-urlencoded","multipart/form-data","text/plain"],HY=["true","false"],XY={},FY={a:{attrs:{href:null,ping:null,type:null,media:null,target:WY,hreflang:null}},abbr:XY,acronym:XY,address:XY,applet:XY,area:{attrs:{alt:null,coords:null,href:null,target:null,ping:null,media:null,hreflang:null,type:null,shape:["default","rect","circle","poly"]}},article:XY,aside:XY,audio:{attrs:{src:null,mediagroup:null,crossorigin:["anonymous","use-credentials"],preload:["none","metadata","auto"],autoplay:["autoplay"],loop:["loop"],controls:["controls"]}},b:XY,base:{attrs:{href:null,target:WY}},basefont:XY,bdi:XY,bdo:XY,big:XY,blockquote:{attrs:{cite:null}},body:XY,br:XY,button:{attrs:{form:null,formaction:null,name:null,value:null,autofocus:["autofocus"],disabled:["autofocus"],formenctype:qY,formmethod:jY,formnovalidate:["novalidate"],formtarget:WY,type:["submit","reset","button"]}},canvas:{attrs:{width:null,height:null}},caption:XY,center:XY,cite:XY,code:XY,col:{attrs:{span:null}},colgroup:{attrs:{span:null}},command:{attrs:{type:["command","checkbox","radio"],label:null,icon:null,radiogroup:null,command:null,title:null,disabled:["disabled"],checked:["checked"]}},data:{attrs:{value:null}},datagrid:{attrs:{disabled:["disabled"],multiple:["multiple"]}},datalist:{attrs:{data:null}},dd:XY,del:{attrs:{cite:null,datetime:null}},details:{attrs:{open:["open"]}},dfn:XY,dir:XY,div:XY,dl:XY,dt:XY,em:XY,embed:{attrs:{src:null,type:null,width:null,height:null}},eventsource:{attrs:{src:null}},fieldset:{attrs:{disabled:["disabled"],form:null,name:null}},figcaption:XY,figure:XY,font:XY,footer:XY,form:{attrs:{action:null,name:null,"accept-charset":VY,autocomplete:["on","off"],enctype:qY,method:jY,novalidate:["novalidate"],target:WY}},frame:XY,frameset:XY,h1:XY,h2:XY,h3:XY,h4:XY,h5:XY,h6:XY,head:{children:["title","base","link","style","meta","script","noscript","command"]},header:XY,hgroup:XY,hr:XY,html:{attrs:{manifest:null}},i:XY,iframe:{attrs:{src:null,srcdoc:null,name:null,width:null,height:null,sandbox:["allow-top-navigation","allow-same-origin","allow-forms","allow-scripts"],seamless:["seamless"]}},img:{attrs:{alt:null,src:null,ismap:null,usemap:null,width:null,height:null,crossorigin:["anonymous","use-credentials"]}},input:{attrs:{alt:null,dirname:null,form:null,formaction:null,height:null,list:null,max:null,maxlength:null,min:null,name:null,pattern:null,placeholder:null,size:null,src:null,step:null,value:null,width:null,accept:["audio/*","video/*","image/*"],autocomplete:["on","off"],autofocus:["autofocus"],checked:["checked"],disabled:["disabled"],formenctype:qY,formmethod:jY,formnovalidate:["novalidate"],formtarget:WY,multiple:["multiple"],readonly:["readonly"],required:["required"],type:["hidden","text","search","tel","url","email","password","datetime","date","month","week","time","datetime-local","number","range","color","checkbox","radio","file","submit","image","reset","button"]}},ins:{attrs:{cite:null,datetime:null}},kbd:XY,keygen:{attrs:{challenge:null,form:null,name:null,autofocus:["autofocus"],disabled:["disabled"],keytype:["RSA"]}},label:{attrs:{for:null,form:null}},legend:XY,li:{attrs:{value:null}},link:{attrs:{href:null,type:null,hreflang:null,media:null,sizes:["all","16x16","16x16 32x32","16x16 32x32 64x64"]}},map:{attrs:{name:null}},mark:XY,menu:{attrs:{label:null,type:["list","context","toolbar"]}},meta:{attrs:{content:null,charset:VY,name:["viewport","application-name","author","description","generator","keywords"],"http-equiv":["content-language","content-type","default-style","refresh"]}},meter:{attrs:{value:null,min:null,low:null,high:null,max:null,optimum:null}},nav:XY,noframes:XY,noscript:XY,object:{attrs:{data:null,type:null,name:null,usemap:null,form:null,width:null,height:null,typemustmatch:["typemustmatch"]}},ol:{attrs:{reversed:["reversed"],start:null,type:["1","a","A","i","I"]},children:["li","script","template","ul","ol"]},optgroup:{attrs:{disabled:["disabled"],label:null}},option:{attrs:{disabled:["disabled"],label:null,selected:["selected"],value:null}},output:{attrs:{for:null,form:null,name:null}},p:XY,param:{attrs:{name:null,value:null}},pre:XY,progress:{attrs:{value:null,max:null}},q:{attrs:{cite:null}},rp:XY,rt:XY,ruby:XY,s:XY,samp:XY,script:{attrs:{type:["text/javascript"],src:null,async:["async"],defer:["defer"],charset:VY}},section:XY,select:{attrs:{form:null,name:null,size:null,autofocus:["autofocus"],disabled:["disabled"],multiple:["multiple"]}},slot:{attrs:{name:null}},small:XY,source:{attrs:{src:null,type:null,media:null}},span:XY,strike:XY,strong:XY,style:{attrs:{type:["text/css"],media:null,scoped:null}},sub:XY,summary:XY,sup:XY,table:XY,tbody:XY,td:{attrs:{colspan:null,rowspan:null,headers:null}},template:XY,textarea:{attrs:{dirname:null,form:null,maxlength:null,name:null,placeholder:null,rows:null,cols:null,autofocus:["autofocus"],disabled:["disabled"],readonly:["readonly"],required:["required"],wrap:["soft","hard"]}},tfoot:XY,th:{attrs:{colspan:null,rowspan:null,headers:null,scope:["row","col","rowgroup","colgroup"]}},thead:XY,time:{attrs:{datetime:null}},title:XY,tr:XY,track:{attrs:{src:null,label:null,default:null,kind:["subtitles","captions","descriptions","chapters","metadata"],srclang:null}},tt:XY,u:XY,ul:{children:["li","script","template","ul","ol"]},var:XY,video:{attrs:{src:null,poster:null,width:null,height:null,crossorigin:["anonymous","use-credentials"],preload:["auto","metadata","none"],autoplay:["autoplay"],mediagroup:["movie"],muted:["muted"],controls:["controls"]}},wbr:XY},ZY={accesskey:null,class:null,contenteditable:HY,contextmenu:null,dir:["ltr","rtl","auto"],draggable:["true","false","auto"],dropzone:["copy","move","link","string:","file:"],hidden:["hidden"],id:null,inert:["inert"],itemid:null,itemprop:null,itemref:null,itemscope:["itemscope"],itemtype:null,lang:["ar","bn","de","en-GB","en-US","es","fr","hi","id","ja","pa","pt","ru","tr","zh"],spellcheck:HY,autocorrect:HY,autocapitalize:HY,style:null,tabindex:null,title:null,translate:["yes","no"],onclick:null,rel:["stylesheet","alternate","author","bookmark","help","license","next","nofollow","noreferrer","prefetch","prev","search","tag"],role:"alert application article banner button cell checkbox complementary contentinfo dialog document feed figure form grid gridcell heading img list listbox listitem main navigation region row rowgroup search switch tab table tabpanel textbox timer".split(" "),"aria-activedescendant":null,"aria-atomic":HY,"aria-autocomplete":["inline","list","both","none"],"aria-busy":HY,"aria-checked":["true","false","mixed","undefined"],"aria-controls":null,"aria-describedby":null,"aria-disabled":HY,"aria-dropeffect":null,"aria-expanded":["true","false","undefined"],"aria-flowto":null,"aria-grabbed":["true","false","undefined"],"aria-haspopup":HY,"aria-hidden":HY,"aria-invalid":["true","false","grammar","spelling"],"aria-label":null,"aria-labelledby":null,"aria-level":null,"aria-live":["off","polite","assertive"],"aria-multiline":HY,"aria-multiselectable":HY,"aria-owns":null,"aria-posinset":null,"aria-pressed":["true","false","mixed","undefined"],"aria-readonly":HY,"aria-relevant":null,"aria-required":HY,"aria-selected":["true","false","undefined"],"aria-setsize":null,"aria-sort":["ascending","descending","none","other"],"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null,"aria-valuetext":null};class GY{constructor(t,e){this.tags=Object.assign(Object.assign({},FY),t),this.globalAttrs=Object.assign(Object.assign({},ZY),e),this.allTags=Object.keys(this.tags),this.globalAttrNames=Object.keys(this.globalAttrs)}}function UY(t,e,i=t.length){if(!e)return"";let n=e.firstChild,r=n&&n.getChild("TagName");return r?t.sliceString(r.from,Math.min(r.to,i)):""}function YY(t,e=!1){for(let i=t.parent;i;i=i.parent)if("Element"==i.name){if(!e)return i;e=!1}return null}function KY(t,e,i){let n=i.tags[UY(t,YY(e,!0))];return(null==n?void 0:n.children)||i.allTags}function JY(t,e){let i=[];for(let n=e;n=YY(n);){let r=UY(t,n);if(r&&"CloseTag"==n.lastChild.name)break;r&&i.indexOf(r)<0&&("EndTag"==e.name||e.from>=n.firstChild.to)&&i.push(r)}return i}GY.default=new GY;const tK=/^[:\-\.\w\u00b7-\uffff]*$/;function eK(t,e,i,n,r){let s=/\s*>/.test(t.sliceDoc(r,r+5))?"":">";return{from:n,to:r,options:KY(t.doc,i,e).map((t=>({label:t,type:"type"}))).concat(JY(t.doc,i).map(((t,e)=>({label:"/"+t,apply:"/"+t+s,type:"type",boost:99-e})))),validFor:/^\/?[:\-\.\w\u00b7-\uffff]*$/}}function iK(t,e,i,n){let r=/\s*>/.test(t.sliceDoc(n,n+5))?"":">";return{from:i,to:n,options:JY(t.doc,e).map(((t,e)=>({label:t,apply:t+r,type:"type",boost:99-e}))),validFor:tK}}function nK(t,e){let{state:i,pos:n}=e,r=xY(i).resolveInner(n),s=r.resolve(n,-1);for(let t,e=n;r==s&&(t=s.childBefore(e));){let i=t.lastChild;if(!i||!i.type.isError||i.from<i.to)break;r=s=t,e=i.from}return"TagName"==s.name?s.parent&&/CloseTag$/.test(s.parent.name)?iK(i,s,s.from,n):eK(i,t,s,s.from,n):"StartTag"==s.name?eK(i,t,s,n,n):"StartCloseTag"==s.name||"IncompleteCloseTag"==s.name?iK(i,s,n,n):e.explicit&&("OpenTag"==s.name||"SelfClosingTag"==s.name)||"AttributeName"==s.name?function(t,e,i,n,r){let s=YY(i),o=s?e.tags[UY(t.doc,s)]:null;return{from:n,to:r,options:(o&&o.attrs?Object.keys(o.attrs).concat(e.globalAttrNames):e.globalAttrNames).map((t=>({label:t,type:"property"}))),validFor:tK}}(i,t,s,"AttributeName"==s.name?s.from:n,n):"Is"==s.name||"AttributeValue"==s.name||"UnquotedAttributeValue"==s.name?function(t,e,i,n,r){var s;let o,l=null===(s=i.parent)||void 0===s?void 0:s.getChild("AttributeName"),a=[];if(l){let s=t.sliceDoc(l.from,l.to),h=e.globalAttrs[s];if(!h){let n=YY(i),r=n?e.tags[UY(t.doc,n)]:null;h=(null==r?void 0:r.attrs)&&r.attrs[s]}if(h){let e=t.sliceDoc(n,r).toLowerCase(),i='"',s='"';/^['"]/.test(e)?(o='"'==e[0]?/^[^"]*$/:/^[^']*$/,i="",s=t.sliceDoc(r,r+1)==e[0]?"":e[0],e=e.slice(1),n++):o=/^[^\s<>='"]*$/;for(let t of h)a.push({label:t,apply:i+t+s,type:"constant"})}}return{from:n,to:r,options:a,validFor:o}}(i,t,s,"Is"==s.name?n:s.from,n):!e.explicit||"Element"!=r.name&&"Text"!=r.name&&"Document"!=r.name?null:function(t,e,i,n){let r=[],s=0;for(let n of KY(t.doc,i,e))r.push({label:"<"+n,type:"type"});for(let e of JY(t.doc,i))r.push({label:"</"+e+">",type:"type",boost:99-s++});return{from:n,to:n,options:r,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}(i,t,s,n)}function rK(t){let{extraTags:e,extraGlobalAttributes:i}=t,n=i||e?new GY(e,i):GY.default;return t=>nK(n,t)}const sK=yY.define({parser:vj.configure({props:[_Y.add({Element(t){let e=/^(\s*)(<\/)?/.exec(t.textAfter);return t.node.to<=t.pos+e[0].length?t.continue():t.lineIndent(t.node.from)+(e[2]?0:t.unit)},"OpenTag CloseTag SelfClosingTag":t=>t.column(t.node.from)+t.unit,Document(t){if(t.pos+/\s*/.exec(t.textAfter)[0].length<t.node.to)return t.continue();let e,i=null;for(let e=t.node;;){let t=e.lastChild;if(!t||"Element"!=t.name||t.to!=e.to)break;i=e=t}return i&&(!(e=i.lastChild)||"CloseTag"!=e.name&&"SelfClosingTag"!=e.name)?t.lineIndent(i.from)+t.unit:null}}),DY.add({Element(t){let e=t.firstChild,i=t.lastChild;return e&&"OpenTag"==e.name?{from:e.to,to:"CloseTag"==i.name?i.from:t.to}:null}})],wrap:xj([{tag:"script",attrs:t=>!t.type||/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i.test(t.type),parser:uU.parser},{tag:"style",attrs:t=>(!t.lang||"css"==t.lang)&&(!t.type||/^(text\/)?(x-)?(stylesheet|css)$/i.test(t.type)),parser:PX.parser}])}),languageData:{commentTokens:{block:{open:"\x3c!--",close:"--\x3e"}},indentOnInput:/^\s*<\/\w+\W$/,wordChars:"-._"}});function oK(t={}){let e=sK;return!1===t.matchClosingTags&&(e=e.configure({dialect:"noMatch"})),new $Y(e,[sK.data.of({autocomplete:rK(t)}),!1!==t.autoCloseTags?lK:[],mU().support,new uX(PX,PX.data.of({autocomplete:TX})).support])}const lK=Is.inputHandler.of(((t,e,i,n)=>{if(t.composing||t.state.readOnly||e!=i||">"!=n&&"/"!=n||!sK.isActiveAt(t.state,e,-1))return!1;let{state:r}=t,s=r.changeByRange((t=>{var e,i,s;let o,{head:l}=t,a=xY(r).resolveInner(l,-1);if("TagName"!=a.name&&"StartTag"!=a.name||(a=a.parent),">"==n&&"OpenTag"==a.name){if("CloseTag"!=(null===(i=null===(e=a.parent)||void 0===e?void 0:e.lastChild)||void 0===i?void 0:i.name)&&(o=UY(r.doc,a.parent,l)))return{range:zt.cursor(l+1),changes:{from:l,insert:`></${o}>`}}}else if("/"==n&&"OpenTag"==a.name){let t=a.parent,e=null==t?void 0:t.parent;if(t.from==l-1&&"CloseTag"!=(null===(s=e.lastChild)||void 0===s?void 0:s.name)&&(o=UY(r.doc,e,l))){let t=`/${o}>`;return{range:zt.cursor(l+t.length),changes:{from:l,insert:t}}}}return{range:t}}));return!s.changes.empty&&(t.dispatch(s,{userEvent:"input.type",scrollIntoView:!0}),!0)})),aK=mI({block:{open:"\x3c!--",close:"--\x3e"}}),hK=iW.configure({props:[$I.add((t=>{if(t.is("Block")&&!t.is("Document"))return(t,e)=>({from:e.doc.lineAt(t.from).to,to:t.to})})),RI.add({Document:()=>null}),gI.add({Document:aK})]});function cK(t){return new bI(aK,t)}const uK=cK(hK),fK=cK(hK.configure([dW,mW,gW,bW]));function dK(t,e){return e.sliceString(t.from,t.from+50)}class pK{constructor(t,e,i,n,r,s,o){this.node=t,this.from=e,this.to=i,this.spaceBefore=n,this.spaceAfter=r,this.type=s,this.item=o}blank(t=!0){let e=this.spaceBefore;if("Blockquote"==this.node.name)e+=">";else for(let t=this.to-this.from-e.length-this.spaceAfter.length;t>0;t--)e+=" ";return e+(t?this.spaceAfter:"")}marker(t,e){let i="OrderedList"==this.node.name?String(+mK(this.item,t)[2]+e):"";return this.spaceBefore+i+this.type+this.spaceAfter}}function gK(t,e,i){let n=[];for(let e=t;e&&"Document"!=e.name;e=e.parent)"ListItem"!=e.name&&"Blockquote"!=e.name||n.push(e);let r=[],s=0;for(let t=n.length-1;t>=0;t--){let o,l=n[t],a=s;if("Blockquote"==l.name&&(o=/^[ \t]*>( ?)/.exec(e.slice(s))))s+=o[0].length,r.push(new pK(l,a,s,"",o[1],">",null));else if("ListItem"==l.name&&"OrderedList"==l.parent.name&&(o=/^([ \t]*)\d+([.)])([ \t]*)/.exec(dK(l,i)))){let t=o[3],e=o[0].length;t.length>=4&&(t=t.slice(0,t.length-4),e-=4),s+=e,r.push(new pK(l.parent,a,s,o[1],t,o[2],l))}else if("ListItem"==l.name&&"BulletList"==l.parent.name&&(o=/^([ \t]*)([-+*])([ \t]{1,4}\[[ xX]\])?([ \t]+)/.exec(dK(l,i)))){let t=o[4],e=o[0].length;t.length>4&&(t=t.slice(0,t.length-4),e-=4);let i=o[2];o[3]&&(i+=o[3].replace(/[xX]/," ")),s+=e,r.push(new pK(l.parent,a,s,o[1],t,i,l))}}return r}function mK(t,e){return/^(\s*)(\d+)(?=[.)])/.exec(e.sliceString(t.from,t.from+10))}function bK(t,e,i,n=0){for(let r=-1,s=t;;){if("ListItem"==s.name){let t=mK(s,e),o=+t[2];if(r>=0){if(o!=r+1)return;i.push({from:s.from+t[1].length,to:s.from+t[0].length,insert:String(r+2+n)})}r=o}let t=s.nextSibling;if(!t)break;s=t}}function OK(t){return"QuoteMark"==t.name||"ListMark"==t.name}const vK=[{key:"Enter",run:({state:t,dispatch:e})=>{let i=vI(t),{doc:n}=t,r=null,s=t.changeByRange((e=>{if(!e.empty||!fK.isActiveAt(t,e.from))return r={range:e};let s=e.from,o=n.lineAt(s),l=gK(i.resolveInner(s,-1),o.text,n);for(;l.length&&l[l.length-1].from>s-o.from;)l.pop();if(!l.length)return r={range:e};let a=l[l.length-1];if(a.to-a.spaceAfter.length>s-o.from)return r={range:e};let h=s>=a.to-a.spaceAfter.length&&!/\S/.test(o.text.slice(a.to));if(a.item&&h){if(a.node.firstChild.to>=s||o.from>0&&!/[^\s>]/.test(n.lineAt(o.from-1).text)){let t,e=l.length>1?l[l.length-2]:null,i="";e&&e.item?(t=o.from+e.from,i=e.marker(n,1)):t=o.from+(e?e.to:0);let r=[{from:t,to:s,insert:i}];return"OrderedList"==a.node.name&&bK(a.item,n,r,-2),e&&"OrderedList"==e.node.name&&bK(e.item,n,r),{range:zt.cursor(t+i.length),changes:r}}{let e="";for(let t=0,i=l.length-2;t<=i;t++)e+=l[t].blank(t<i);return e+=t.lineBreak,{range:zt.cursor(s+e.length),changes:{from:o.from,insert:e}}}}if("Blockquote"==a.node.name&&h&&o.from){let i=n.lineAt(o.from-1),r=/>\s*$/.exec(i.text);if(r&&r.index==a.from){let n=t.changes([{from:i.from+r.index,to:i.to},{from:o.from+a.from,to:o.to}]);return{range:e.map(n),changes:n}}}let c=[];"OrderedList"==a.node.name&&bK(a.item,n,c);let u=t.lineBreak,f=a.item&&a.item.from<o.from;if(!f||/^[\s\d.)\-+*>]*/.exec(o.text)[0].length>=a.to)for(let t=0,e=l.length-1;t<=e;t++)u+=t!=e||f?l[t].blank():l[t].marker(n,1);let d=s;for(;d>o.from&&/\s/.test(o.text.charAt(d-o.from-1));)d--;return c.push({from:d,to:s,insert:u}),{range:zt.cursor(d+u.length),changes:c}}));return!r&&(e(t.update(s,{scrollIntoView:!0,userEvent:"input"})),!0)}},{key:"Backspace",run:({state:t,dispatch:e})=>{let i=vI(t),n=null,r=t.changeByRange((e=>{let r=e.from,{doc:s}=t;if(e.empty&&fK.isActiveAt(t,e.from)){let t=s.lineAt(r),n=gK(function(t,e){let i,n=t.resolveInner(e,-1),r=e;for(OK(n)&&(r=n.from,n=n.parent);i=n.childBefore(r);)if(OK(i))r=i.from;else{if("OrderedList"!=i.name&&"BulletList"!=i.name)break;n=i.lastChild,r=n.to}return n}(i,r),t.text,s);if(n.length){let i=n[n.length-1],s=i.to-i.spaceAfter.length+(i.spaceAfter?1:0);if(r-t.from>s&&!/\S/.test(t.text.slice(s,r-t.from)))return{range:zt.cursor(t.from+s),changes:{from:t.from+s,to:r}};if(r-t.from==s){let n=t.from+i.from;if(i.item&&i.node.from<i.item.from&&/\S/.test(t.text.slice(i.from,i.to)))return{range:e,changes:{from:n,to:t.from+i.to,insert:i.blank()}};if(n<r)return{range:zt.cursor(n),changes:{from:n,to:r}}}}}return n={range:e}}));return!n&&(e(t.update(r,{scrollIntoView:!0,userEvent:"delete"})),!0)}}],wK=oK({matchClosingTags:!1});function yK(t={}){let{codeLanguages:e,defaultCodeLanguage:i,addKeymap:n=!0,base:{parser:r}=uK}=t;if(!(r instanceof ML))throw new RangeError("Base parser provided to `markdown` should be a Markdown parser");let s,o=t.extensions?[t.extensions]:[],l=[wK.support];i instanceof MI?(l.push(i.support),s=i.language):i&&(s=i);let a=e||s?(h=e,c=s,t=>{if(t&&h){let e=null;if(e="function"==typeof h?h(t):QI.matchLanguageName(h,t,!0),e instanceof QI)return e.support?e.support.language.parser:xI.getSkippingParser(e.load());if(e)return e.parser}return c?c.parser:null}):void 0;var h,c;return o.push(rW({codeParser:a,htmlParser:wK.language.parser})),n&&l.push(ee.high(Xs.of(vK))),new MI(cK(r.configure(o)),l)}const xK=[];function kK(e,i=t){let n;const r=new Set;function o(t){if(s(e,t)&&(e=t,n)){const t=!xK.length;for(const t of r)t[1](),xK.push(t,e);if(t){for(let t=0;t<xK.length;t+=2)xK[t][0](xK[t+1]);xK.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,l=t){const a=[s,l];return r.add(a),1===r.size&&(n=i(o)||t),s(e),()=>{r.delete(a),0===r.size&&(n(),n=null)}}}}const SK=kK({name:"Default",font:"Fira Code, Menlo",fontSize:"16pt",textAreaColor:"#454158",backgroundColor:"#22212C",textColor:"#80ffea",borderColor:"#1B1A23",Cyan:"#80FFEA",Green:"#8AFF80",Orange:"#FFCA80",Pink:"#FF80BF",Purple:"#9580FF",Red:"#FF9580",Yellow:"#FFFF80",functionColor:"#9580FF",stringColor:"#8AFF80",constantColor:"#FFCA80",keywordColor:"#FFFF80",highlightBackgroundColor:"#4f4f5f",selectionColor:"#22212C",buttons:[{color:"#80FFEA",id:0},{color:"#8AFF80",id:1},{color:"#FFCA80",id:2},{color:"#FF80BF",id:3},{color:"#9580FF",id:4},{color:"#FF9580",id:5},{color:"blue",id:6},{color:"green",id:7},{color:"red",id:8},{color:"purple",id:9}]});function CK(e){let i,n;return{c(){i=b("div"),x(i,"name","editor"),x(i,"id","CMeditor"),x(i,"style",n="height: "+e[0]+"; width: "+e[1]+"; "+e[2]),x(i,"class","svelte-1p9zuvj")},m(t,n){p(t,i,n),e[6](i)},p(t,[e]){7&e&&n!==(n="height: "+t[0]+"; width: "+t[1]+"; "+t[2])&&x(i,"style",n)},i:t,o:t,d(t){t&&g(i),e[6](null)}}}function AK(t,e,i){let n;o(t,SK,(t=>i(11,n=t)));const r=E();let{height:s=0}=e,{width:l=0}=e,{styling:a=""}=e,{config:h={}}=e,{initFinished:c=!1}=e,u=null,f=null,d=null,p=null,g=null;const m=ff.theme({"&":{color:n.textColor,backgroundColor:n.textAreaColor,height:s,minHeight:s},".cm-content":{caretColor:n.Cyan,minHeight:s},"&.cm-focused .cm-cursor":{borderLeftColor:n.Cyan},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, ::selection":{backgroundColor:n.selectionColor},".cm-panels":{backgroundColor:n.backgroundColor,color:n.textColor},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:n.highlightBackgroundColor},".cm-selectionMatch":{backgroundColor:"#aafe661a"},".cm-matchingBracket, .cm-nonmatchingBracket":{backgroundColor:"#bad0f847",outline:"1px solid #515a6b"},".cm-gutter":{minHeight:s},".cm-gutters":{backgroundColor:n.backgroundColor,color:n.green,border:"none"},".cm-activeLineGutter":{backgroundColor:n.highlightBackgroundColor},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid #181a1f",backgroundColor:n.backgroundColor},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:n.highlightBackgroundColor,color:n.textColor}}},{dark:!0});function b(t,e){r(t,{data:e})}function O(t){c&&v(t)}function v(t){null!==d&&(d.destroy(),f.destroy(),console.log("Cleared out old editor state..."));const e=[vo(),eE(),Js(),[ho,co],Qe.allowMultipleSelections.of(!0),wv(),Fv(Uv,{fallback:!0}),sw(),ZA(),lT(),Po(),Ro(),DN(),Xs.of([...tT,...vN,...cB,...bE,...Dv,...aT,...e_]),m,ff.updateListener.of((t=>{t.docChanged&&b("textChange",{value:P(),cursor:T()})}))];switch(h.lineNumbers&&(e.push(Wv()),e.push(function(t={}){return[Uo.of(t),Vo(),Jo]}())),h.language){case"markdown":default:e.push(yK());break;case"javascript":e.push(mU())}h.lineWrapping&&e.push(ff.lineWrapping),h.lineHighlight&&e.push(So),f=Qe.create({doc:t,extensions:e}),d=new ff({state:f,parent:u})}function w(t){if(void 0!==d){let e=T(),i=d.state.update({changes:[{from:e,insert:t}]});d.dispatch(i)}}function y(){return void 0!==d&&d.hasFocus}function x(t){return void 0!==d?d.docView.domAtPos(t).node.textContent:""}function k(){if(void 0!==d)return d.state.sliceDoc(d.state.selection.main.from,d.state.selection.main.to)}function S(t){if(void 0!==d){let e=d.state.selection.main.from,i=d.state.update({changes:[{from:d.state.selection.main.from,to:d.state.selection.main.to},{from:e,insert:t}]});d.dispatch(i)}}function C(){if(void 0!==d)return d.state.selection.ranges.some((t=>!t.empty))}function A(t){void 0!==d&&(g=t,d.dispatch({selection:{anchor:g}}))}function T(){return void 0!==d?(g=d.state.selection.main.head,g):0}function P(){if(void 0!==d)return d.state.doc.toString()}function M(){void 0!==d&&d.focus()}function Q(){return d}function R(){return f}return _((()=>(v(""),p={getSelection:k,getValue:P,replaceSelection:S,somethingSelected:C,setCursor:A,getCursor:T,setValue:O,getLine:x,focus:M,getEdView:Q,getEdState:R,isFocused:y,insertAtCursor:w},b("editorChange",p),M(),()=>{f=null,d=null,p=null}))),t.$$set=t=>{"height"in t&&i(0,s=t.height),"width"in t&&i(1,l=t.width),"styling"in t&&i(2,a=t.styling),"config"in t&&i(4,h=t.config),"initFinished"in t&&i(5,c=t.initFinished)},[s,l,a,u,h,c,function(t){B[t?"unshift":"push"]((()=>{u=t,i(3,u)}))}]}class TK extends lt{constructor(t){super(),ot(this,t,AK,CK,s,{height:0,width:1,styling:2,config:4,initFinished:5})}}function PK(t,e,i){const n=t.slice();return n[17]=e[i],n}function MK(t){let e,i,r,s,o,l,a,h,c,u,f,m,w,S=t[17].name+"",C=t[17].email+"";function A(){return t[11](t[17])}function T(){return t[12](t[17])}return{c(){e=b("tr"),i=b("td"),r=O(S),s=v(),o=b("td"),l=O(C),a=v(),h=b("td"),h.textContent="🖋",c=v(),u=b("td"),u.textContent="❌",f=v(),x(h,"class","iconClick svelte-1c11hkb"),x(u,"class","iconClick svelte-1c11hkb")},m(t,n){p(t,e,n),d(e,i),d(i,r),d(e,s),d(e,o),d(o,l),d(e,a),d(e,h),d(e,c),d(e,u),d(e,f),m||(w=[y(h,"click",A),y(u,"click",T)],m=!0)},p(e,i){t=e,1&i&&S!==(S=t[17].name+"")&&k(r,S),1&i&&C!==(C=t[17].email+"")&&k(l,C)},d(t){t&&g(e),m=!1,n(w)}}}function QK(t){let e,i,r,s,o,l,a,h,c,u,f,m,w,k,A,T,P,M,Q;return{c(){e=b("div"),i=b("div"),r=b("label"),r.textContent="Name:",s=v(),o=b("input"),l=v(),a=b("div"),h=b("label"),h.textContent="Email:",c=v(),u=b("input"),f=v(),m=b("div"),w=b("button"),k=O("Save"),A=v(),T=b("button"),P=O("Close"),x(r,"for","aename"),x(o,"type","text"),x(o,"id","aename"),C(o,"background-color",t[4].textAreaColor),C(o,"color",t[4].textColor),C(o,"border-color",t[4].borderColor),x(o,"class","svelte-1c11hkb"),x(i,"id","addeditrow"),x(i,"class","svelte-1c11hkb"),x(h,"for","aeemail"),x(u,"type","text"),x(u,"id","aeemail"),C(u,"background-color",t[4].textAreaColor),C(u,"color",t[4].textColor),C(u,"border-color",t[4].borderColor),x(u,"class","svelte-1c11hkb"),x(a,"id","addeditrow"),x(a,"class","svelte-1c11hkb"),C(w,"background-color",t[4].textAreaColor),C(w,"color",t[4].textColor),C(w,"border-color",t[4].borderColor),x(w,"class","svelte-1c11hkb"),C(T,"background-color",t[4].textAreaColor),C(T,"color",t[4].textColor),C(T,"border-color",t[4].borderColor),x(T,"class","svelte-1c11hkb"),x(m,"id","buttonrow"),x(m,"class","svelte-1c11hkb"),x(e,"id","addeditdiv"),C(e,"background-color",t[4].backgroundColor),C(e,"font-family",t[4].font),C(e,"color",t[4].textColor),C(e,"font-size",t[4].fontSize),C(e,"border-color",t[4].textAreaColor),x(e,"class","svelte-1c11hkb")},m(n,g){p(n,e,g),d(e,i),d(i,r),d(i,s),d(i,o),S(o,t[2]),d(e,l),d(e,a),d(a,h),d(a,c),d(a,u),S(u,t[3]),d(e,f),d(e,m),d(m,w),d(w,k),d(m,A),d(m,T),d(T,P),M||(Q=[y(o,"input",t[13]),y(u,"input",t[14]),y(w,"click",t[7]),y(T,"click",t[15])],M=!0)},p(t,i){16&i&&C(o,"background-color",t[4].textAreaColor),16&i&&C(o,"color",t[4].textColor),16&i&&C(o,"border-color",t[4].borderColor),4&i&&o.value!==t[2]&&S(o,t[2]),16&i&&C(u,"background-color",t[4].textAreaColor),16&i&&C(u,"color",t[4].textColor),16&i&&C(u,"border-color",t[4].borderColor),8&i&&u.value!==t[3]&&S(u,t[3]),16&i&&C(w,"background-color",t[4].textAreaColor),16&i&&C(w,"color",t[4].textColor),16&i&&C(w,"border-color",t[4].borderColor),16&i&&C(T,"background-color",t[4].textAreaColor),16&i&&C(T,"color",t[4].textColor),16&i&&C(T,"border-color",t[4].borderColor),16&i&&C(e,"background-color",t[4].backgroundColor),16&i&&C(e,"font-family",t[4].font),16&i&&C(e,"color",t[4].textColor),16&i&&C(e,"font-size",t[4].fontSize),16&i&&C(e,"border-color",t[4].textAreaColor)},d(t){t&&g(e),M=!1,n(Q)}}}function RK(e){let i,r,s,o,l,a,h,c,u,f,k,S,A,T,P,M,Q,R=e[0],$=[];for(let t=0;t<R.length;t+=1)$[t]=MK(PK(e,R,t));let _=e[1]&&QK(e);return{c(){i=b("div"),r=b("div"),s=b("table"),o=b("thead"),o.innerHTML="<th>Name</th>  <th>Address</th>  <th></th>  <th></th>",l=v(),a=b("tbody");for(let t=0;t<$.length;t+=1)$[t].c();h=v(),c=b("div"),u=b("button"),f=O("New"),k=v(),S=b("button"),A=O("Close"),T=v(),_&&_.c(),P=w(),x(r,"id","tablediv"),x(r,"class","svelte-1c11hkb"),C(u,"background-color",e[4].textAreaColor),C(u,"color",e[4].textColor),C(u,"border-color",e[4].borderColor),x(u,"class","svelte-1c11hkb"),C(S,"background-color",e[4].textAreaColor),C(S,"color",e[4].textColor),C(S,"border-color",e[4].borderColor),x(S,"class","svelte-1c11hkb"),x(c,"id","buttonrow"),x(c,"class","svelte-1c11hkb"),x(i,"id","addressBook"),C(i,"background-color",e[4].backgroundColor),C(i,"font-family",e[4].font),C(i,"color",e[4].textColor),C(i,"font-size",e[4].fontSize),C(i,"border-color",e[4].borderColor),x(i,"class","svelte-1c11hkb")},m(t,n){p(t,i,n),d(i,r),d(r,s),d(s,o),d(s,l),d(s,a);for(let t=0;t<$.length;t+=1)$[t].m(a,null);d(i,h),d(i,c),d(c,u),d(u,f),d(c,k),d(c,S),d(S,A),p(t,T,n),_&&_.m(t,n),p(t,P,n),M||(Q=[y(u,"click",e[5]),y(S,"click",e[6])],M=!0)},p(t,[e]){if(769&e){let i;for(R=t[0],i=0;i<R.length;i+=1){const n=PK(t,R,i);$[i]?$[i].p(n,e):($[i]=MK(n),$[i].c(),$[i].m(a,null))}for(;i<$.length;i+=1)$[i].d(1);$.length=R.length}16&e&&C(u,"background-color",t[4].textAreaColor),16&e&&C(u,"color",t[4].textColor),16&e&&C(u,"border-color",t[4].borderColor),16&e&&C(S,"background-color",t[4].textAreaColor),16&e&&C(S,"color",t[4].textColor),16&e&&C(S,"border-color",t[4].borderColor),16&e&&C(i,"background-color",t[4].backgroundColor),16&e&&C(i,"font-family",t[4].font),16&e&&C(i,"color",t[4].textColor),16&e&&C(i,"font-size",t[4].fontSize),16&e&&C(i,"border-color",t[4].borderColor),t[1]?_?_.p(t,e):(_=QK(t),_.c(),_.m(P.parentNode,P)):_&&(_.d(1),_=null)},i:t,o:t,d(t){t&&g(i),m($,t),t&&g(T),_&&_.d(t),t&&g(P),M=!1,n(Q)}}}function $K(t,e,i){let n;o(t,SK,(t=>i(4,n=t)));let{show:r}=e,s=[],l=!1,a="",h="";function c(t){console.log(t),i(2,a=t.name),i(3,h=t.email)}function u(t){t.email=t.email.trim(),i(0,s=s.filter((e=>e.email!==t.email))),fetch("http://localhost:9978/api/emailit/addEmail",{method:"DELETE",headers:{"Content-type":"application/json"},body:{name:"",email:t.email}})}_((()=>{!function(t){fetch("http://localhost:9978/api/emailit/emails",{method:"GET",headers:{"Content-type":"application/json"}}).then((t=>t.json())).then((e=>{i(0,s=e.emails),void 0!==t&&t()}))}()}));return t.$$set=t=>{"show"in t&&i(10,r=t.show)},[s,l,a,h,n,function(){i(1,l=!0),i(2,a=""),i(3,h="")},function(){i(10,r=!1)},function(){i(3,h=h.trim()),i(2,a=a.trim()),i(0,s=s.filter((t=>t.email!==h))),s.push({name:a,email:h}),i(0,s),fetch("http://localhost:9978/api/emailit/addEmail",{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify({name:a,email:h})}),i(1,l=!1)},c,u,r,t=>{c(t)},t=>{u(t)},function(){a=this.value,i(2,a)},function(){h=this.value,i(3,h)},()=>{i(1,l=!1)}]}class _K extends lt{constructor(t){super(),ot(this,t,$K,RK,s,{show:10})}}var DK,EK="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},NK={exports:{}};DK=NK,function(){function t(t){var e={omitExtraWLInCodeBlocks:{defaultValue:!1,describe:"Omit the default extra whiteline added to code blocks",type:"boolean"},noHeaderId:{defaultValue:!1,describe:"Turn on/off generated header id",type:"boolean"},prefixHeaderId:{defaultValue:!1,describe:"Add a prefix to the generated header ids. Passing a string will prefix that string to the header id. Setting to true will add a generic 'section-' prefix",type:"string"},rawPrefixHeaderId:{defaultValue:!1,describe:'Setting this option to true will prevent showdown from modifying the prefix. This might result in malformed IDs (if, for instance, the " char is used in the prefix)',type:"boolean"},ghCompatibleHeaderId:{defaultValue:!1,describe:"Generate header ids compatible with github style (spaces are replaced with dashes, a bunch of non alphanumeric chars are removed)",type:"boolean"},rawHeaderId:{defaultValue:!1,describe:"Remove only spaces, ' and \" from generated header ids (including prefixes), replacing them with dashes (-). WARNING: This might result in malformed ids",type:"boolean"},headerLevelStart:{defaultValue:!1,describe:"The header blocks level start",type:"integer"},parseImgDimensions:{defaultValue:!1,describe:"Turn on/off image dimension parsing",type:"boolean"},simplifiedAutoLink:{defaultValue:!1,describe:"Turn on/off GFM autolink style",type:"boolean"},excludeTrailingPunctuationFromURLs:{defaultValue:!1,describe:"Excludes trailing punctuation from links generated with autoLinking",type:"boolean"},literalMidWordUnderscores:{defaultValue:!1,describe:"Parse midword underscores as literal underscores",type:"boolean"},literalMidWordAsterisks:{defaultValue:!1,describe:"Parse midword asterisks as literal asterisks",type:"boolean"},strikethrough:{defaultValue:!1,describe:"Turn on/off strikethrough support",type:"boolean"},tables:{defaultValue:!1,describe:"Turn on/off tables support",type:"boolean"},tablesHeaderId:{defaultValue:!1,describe:"Add an id to table headers",type:"boolean"},ghCodeBlocks:{defaultValue:!0,describe:"Turn on/off GFM fenced code blocks support",type:"boolean"},tasklists:{defaultValue:!1,describe:"Turn on/off GFM tasklist support",type:"boolean"},smoothLivePreview:{defaultValue:!1,describe:"Prevents weird effects in live previews due to incomplete input",type:"boolean"},smartIndentationFix:{defaultValue:!1,describe:"Tries to smartly fix indentation in es6 strings",type:"boolean"},disableForced4SpacesIndentedSublists:{defaultValue:!1,describe:"Disables the requirement of indenting nested sublists by 4 spaces",type:"boolean"},simpleLineBreaks:{defaultValue:!1,describe:"Parses simple line breaks as <br> (GFM Style)",type:"boolean"},requireSpaceBeforeHeadingText:{defaultValue:!1,describe:"Makes adding a space between `#` and the header text mandatory (GFM Style)",type:"boolean"},ghMentions:{defaultValue:!1,describe:"Enables github @mentions",type:"boolean"},ghMentionsLink:{defaultValue:"https://github.com/{u}",describe:"Changes the link generated by @mentions. Only applies if ghMentions option is enabled.",type:"string"},encodeEmails:{defaultValue:!0,describe:"Encode e-mail addresses through the use of Character Entities, transforming ASCII e-mail addresses into its equivalent decimal entities",type:"boolean"},openLinksInNewWindow:{defaultValue:!1,describe:"Open all links in new windows",type:"boolean"},backslashEscapesHTMLTags:{defaultValue:!1,describe:"Support for HTML Tag escaping. ex: <div>foo</div>",type:"boolean"},emoji:{defaultValue:!1,describe:"Enable emoji support. Ex: `this is a :smile: emoji`",type:"boolean"},underline:{defaultValue:!1,describe:"Enable support for underline. Syntax is double or triple underscores: `__underline word__`. With this option enabled, underscores no longer parses into `<em>` and `<strong>`",type:"boolean"},ellipsis:{defaultValue:!0,describe:"Replaces three dots with the ellipsis unicode character",type:"boolean"},completeHTMLDocument:{defaultValue:!1,describe:"Outputs a complete html document, including `<html>`, `<head>` and `<body>` tags",type:"boolean"},metadata:{defaultValue:!1,describe:"Enable support for document metadata (defined at the top of the document between `«««` and `»»»` or between `---` and `---`).",type:"boolean"},splitAdjacentBlockquotes:{defaultValue:!1,describe:"Split adjacent blockquote blocks",type:"boolean"}};if(!1===t)return JSON.parse(JSON.stringify(e));var i={};for(var n in e)e.hasOwnProperty(n)&&(i[n]=e[n].defaultValue);return i}var e={},i={},n={},r=t(!0),s="vanilla",o={github:{omitExtraWLInCodeBlocks:!0,simplifiedAutoLink:!0,excludeTrailingPunctuationFromURLs:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,disableForced4SpacesIndentedSublists:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghCompatibleHeaderId:!0,ghMentions:!0,backslashEscapesHTMLTags:!0,emoji:!0,splitAdjacentBlockquotes:!0},original:{noHeaderId:!0,ghCodeBlocks:!1},ghost:{omitExtraWLInCodeBlocks:!0,parseImgDimensions:!0,simplifiedAutoLink:!0,excludeTrailingPunctuationFromURLs:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,smoothLivePreview:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghMentions:!1,encodeEmails:!0},vanilla:t(!0),allOn:function(){var e=t(!0),i={};for(var n in e)e.hasOwnProperty(n)&&(i[n]=!0);return i}()};function l(t,i){var n=i?"Error in "+i+" extension->":"Error in unnamed extension",r={valid:!0,error:""};e.helper.isArray(t)||(t=[t]);for(var s=0;s<t.length;++s){var o=n+" sub-extension "+s+": ",l=t[s];if("object"!=typeof l)return r.valid=!1,r.error=o+"must be an object, but "+typeof l+" given",r;if(!e.helper.isString(l.type))return r.valid=!1,r.error=o+'property "type" must be a string, but '+typeof l.type+" given",r;var a=l.type=l.type.toLowerCase();if("language"===a&&(a=l.type="lang"),"html"===a&&(a=l.type="output"),"lang"!==a&&"output"!==a&&"listener"!==a)return r.valid=!1,r.error=o+"type "+a+' is not recognized. Valid values: "lang/language", "output/html" or "listener"',r;if("listener"===a){if(e.helper.isUndefined(l.listeners))return r.valid=!1,r.error=o+'. Extensions of type "listener" must have a property called "listeners"',r}else if(e.helper.isUndefined(l.filter)&&e.helper.isUndefined(l.regex))return r.valid=!1,r.error=o+a+' extensions must define either a "regex" property or a "filter" method',r;if(l.listeners){if("object"!=typeof l.listeners)return r.valid=!1,r.error=o+'"listeners" property must be an object but '+typeof l.listeners+" given",r;for(var h in l.listeners)if(l.listeners.hasOwnProperty(h)&&"function"!=typeof l.listeners[h])return r.valid=!1,r.error=o+'"listeners" property must be an hash of [event name]: [callback]. listeners.'+h+" must be a function but "+typeof l.listeners[h]+" given",r}if(l.filter){if("function"!=typeof l.filter)return r.valid=!1,r.error=o+'"filter" must be a function, but '+typeof l.filter+" given",r}else if(l.regex){if(e.helper.isString(l.regex)&&(l.regex=new RegExp(l.regex,"g")),!(l.regex instanceof RegExp))return r.valid=!1,r.error=o+'"regex" property must either be a string or a RegExp object, but '+typeof l.regex+" given",r;if(e.helper.isUndefined(l.replace))return r.valid=!1,r.error=o+'"regex" extensions must implement a replace string or function',r}}return r}function a(t,e){return"¨E"+e.charCodeAt(0)+"E"}e.helper={},e.extensions={},e.setOption=function(t,e){return r[t]=e,this},e.getOption=function(t){return r[t]},e.getOptions=function(){return r},e.resetOptions=function(){r=t(!0)},e.setFlavor=function(t){if(!o.hasOwnProperty(t))throw Error(t+" flavor was not found");e.resetOptions();var i=o[t];for(var n in s=t,i)i.hasOwnProperty(n)&&(r[n]=i[n])},e.getFlavor=function(){return s},e.getFlavorOptions=function(t){if(o.hasOwnProperty(t))return o[t]},e.getDefaultOptions=function(e){return t(e)},e.subParser=function(t,n){if(e.helper.isString(t)){if(void 0===n){if(i.hasOwnProperty(t))return i[t];throw Error("SubParser named "+t+" not registered!")}i[t]=n}},e.extension=function(t,i){if(!e.helper.isString(t))throw Error("Extension 'name' must be a string");if(t=e.helper.stdExtName(t),e.helper.isUndefined(i)){if(!n.hasOwnProperty(t))throw Error("Extension named "+t+" is not registered!");return n[t]}"function"==typeof i&&(i=i()),e.helper.isArray(i)||(i=[i]);var r=l(i,t);if(!r.valid)throw Error(r.error);n[t]=i},e.getAllExtensions=function(){return n},e.removeExtension=function(t){delete n[t]},e.resetExtensions=function(){n={}},e.validateExtension=function(t){var e=l(t,null);return!!e.valid||(console.warn(e.error),!1)},e.hasOwnProperty("helper")||(e.helper={}),e.helper.isString=function(t){return"string"==typeof t||t instanceof String},e.helper.isFunction=function(t){return t&&"[object Function]"==={}.toString.call(t)},e.helper.isArray=function(t){return Array.isArray(t)},e.helper.isUndefined=function(t){return void 0===t},e.helper.forEach=function(t,i){if(e.helper.isUndefined(t))throw new Error("obj param is required");if(e.helper.isUndefined(i))throw new Error("callback param is required");if(!e.helper.isFunction(i))throw new Error("callback param must be a function/closure");if("function"==typeof t.forEach)t.forEach(i);else if(e.helper.isArray(t))for(var n=0;n<t.length;n++)i(t[n],n,t);else{if("object"!=typeof t)throw new Error("obj does not seem to be an array or an iterable object");for(var r in t)t.hasOwnProperty(r)&&i(t[r],r,t)}},e.helper.stdExtName=function(t){return t.replace(/[_?*+\/\\.^-]/g,"").replace(/\s/g,"").toLowerCase()},e.helper.escapeCharactersCallback=a,e.helper.escapeCharacters=function(t,e,i){var n="(["+e.replace(/([\[\]\\])/g,"\\$1")+"])";i&&(n="\\\\"+n);var r=new RegExp(n,"g");return t=t.replace(r,a)},e.helper.unescapeHTMLEntities=function(t){return t.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")};var h=function(t,e,i,n){var r,s,o,l,a,h=n||"",c=h.indexOf("g")>-1,u=new RegExp(e+"|"+i,"g"+h.replace(/g/g,"")),f=new RegExp(e,h.replace(/g/g,"")),d=[];do{for(r=0;o=u.exec(t);)if(f.test(o[0]))r++||(l=(s=u.lastIndex)-o[0].length);else if(r&&!--r){a=o.index+o[0].length;var p={left:{start:l,end:s},match:{start:s,end:o.index},right:{start:o.index,end:a},wholeMatch:{start:l,end:a}};if(d.push(p),!c)return d}}while(r&&(u.lastIndex=s));return d};e.helper.matchRecursiveRegExp=function(t,e,i,n){for(var r=h(t,e,i,n),s=[],o=0;o<r.length;++o)s.push([t.slice(r[o].wholeMatch.start,r[o].wholeMatch.end),t.slice(r[o].match.start,r[o].match.end),t.slice(r[o].left.start,r[o].left.end),t.slice(r[o].right.start,r[o].right.end)]);return s},e.helper.replaceRecursiveRegExp=function(t,i,n,r,s){if(!e.helper.isFunction(i)){var o=i;i=function(){return o}}var l=h(t,n,r,s),a=t,c=l.length;if(c>0){var u=[];0!==l[0].wholeMatch.start&&u.push(t.slice(0,l[0].wholeMatch.start));for(var f=0;f<c;++f)u.push(i(t.slice(l[f].wholeMatch.start,l[f].wholeMatch.end),t.slice(l[f].match.start,l[f].match.end),t.slice(l[f].left.start,l[f].left.end),t.slice(l[f].right.start,l[f].right.end))),f<c-1&&u.push(t.slice(l[f].wholeMatch.end,l[f+1].wholeMatch.start));l[c-1].wholeMatch.end<t.length&&u.push(t.slice(l[c-1].wholeMatch.end)),a=u.join("")}return a},e.helper.regexIndexOf=function(t,i,n){if(!e.helper.isString(t))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";if(i instanceof RegExp==0)throw"InvalidArgumentError: second parameter of showdown.helper.regexIndexOf function must be an instance of RegExp";var r=t.substring(n||0).search(i);return r>=0?r+(n||0):r},e.helper.splitAtIndex=function(t,i){if(!e.helper.isString(t))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";return[t.substring(0,i),t.substring(i)]},e.helper.encodeEmailAddress=function(t){var e=[function(t){return"&#"+t.charCodeAt(0)+";"},function(t){return"&#x"+t.charCodeAt(0).toString(16)+";"},function(t){return t}];return t=t.replace(/./g,(function(t){if("@"===t)t=e[Math.floor(2*Math.random())](t);else{var i=Math.random();t=i>.9?e[2](t):i>.45?e[1](t):e[0](t)}return t}))},e.helper.padEnd=function(t,e,i){return e>>=0,i=String(i||" "),t.length>e?String(t):((e-=t.length)>i.length&&(i+=i.repeat(e/i.length)),String(t)+i.slice(0,e))},"undefined"==typeof console&&(console={warn:function(t){alert(t)},log:function(t){alert(t)},error:function(t){throw t}}),e.helper.regexes={asteriskDashAndColon:/([*_:~])/g},e.helper.emojis={"+1":"👍","-1":"👎",100:"💯",1234:"🔢","1st_place_medal":"🥇","2nd_place_medal":"🥈","3rd_place_medal":"🥉","8ball":"🎱",a:"🅰️",ab:"🆎",abc:"🔤",abcd:"🔡",accept:"🉑",aerial_tramway:"🚡",airplane:"✈️",alarm_clock:"⏰",alembic:"⚗️",alien:"👽",ambulance:"🚑",amphora:"🏺",anchor:"⚓️",angel:"👼",anger:"💢",angry:"😠",anguished:"😧",ant:"🐜",apple:"🍎",aquarius:"♒️",aries:"♈️",arrow_backward:"◀️",arrow_double_down:"⏬",arrow_double_up:"⏫",arrow_down:"⬇️",arrow_down_small:"🔽",arrow_forward:"▶️",arrow_heading_down:"⤵️",arrow_heading_up:"⤴️",arrow_left:"⬅️",arrow_lower_left:"↙️",arrow_lower_right:"↘️",arrow_right:"➡️",arrow_right_hook:"↪️",arrow_up:"⬆️",arrow_up_down:"↕️",arrow_up_small:"🔼",arrow_upper_left:"↖️",arrow_upper_right:"↗️",arrows_clockwise:"🔃",arrows_counterclockwise:"🔄",art:"🎨",articulated_lorry:"🚛",artificial_satellite:"🛰",astonished:"😲",athletic_shoe:"👟",atm:"🏧",atom_symbol:"⚛️",avocado:"🥑",b:"🅱️",baby:"👶",baby_bottle:"🍼",baby_chick:"🐤",baby_symbol:"🚼",back:"🔙",bacon:"🥓",badminton:"🏸",baggage_claim:"🛄",baguette_bread:"🥖",balance_scale:"⚖️",balloon:"🎈",ballot_box:"🗳",ballot_box_with_check:"☑️",bamboo:"🎍",banana:"🍌",bangbang:"‼️",bank:"🏦",bar_chart:"📊",barber:"💈",baseball:"⚾️",basketball:"🏀",basketball_man:"⛹️",basketball_woman:"⛹️&zwj;♀️",bat:"🦇",bath:"🛀",bathtub:"🛁",battery:"🔋",beach_umbrella:"🏖",bear:"🐻",bed:"🛏",bee:"🐝",beer:"🍺",beers:"🍻",beetle:"🐞",beginner:"🔰",bell:"🔔",bellhop_bell:"🛎",bento:"🍱",biking_man:"🚴",bike:"🚲",biking_woman:"🚴&zwj;♀️",bikini:"👙",biohazard:"☣️",bird:"🐦",birthday:"🎂",black_circle:"⚫️",black_flag:"🏴",black_heart:"🖤",black_joker:"🃏",black_large_square:"⬛️",black_medium_small_square:"◾️",black_medium_square:"◼️",black_nib:"✒️",black_small_square:"▪️",black_square_button:"🔲",blonde_man:"👱",blonde_woman:"👱&zwj;♀️",blossom:"🌼",blowfish:"🐡",blue_book:"📘",blue_car:"🚙",blue_heart:"💙",blush:"😊",boar:"🐗",boat:"⛵️",bomb:"💣",book:"📖",bookmark:"🔖",bookmark_tabs:"📑",books:"📚",boom:"💥",boot:"👢",bouquet:"💐",bowing_man:"🙇",bow_and_arrow:"🏹",bowing_woman:"🙇&zwj;♀️",bowling:"🎳",boxing_glove:"🥊",boy:"👦",bread:"🍞",bride_with_veil:"👰",bridge_at_night:"🌉",briefcase:"💼",broken_heart:"💔",bug:"🐛",building_construction:"🏗",bulb:"💡",bullettrain_front:"🚅",bullettrain_side:"🚄",burrito:"🌯",bus:"🚌",business_suit_levitating:"🕴",busstop:"🚏",bust_in_silhouette:"👤",busts_in_silhouette:"👥",butterfly:"🦋",cactus:"🌵",cake:"🍰",calendar:"📆",call_me_hand:"🤙",calling:"📲",camel:"🐫",camera:"📷",camera_flash:"📸",camping:"🏕",cancer:"♋️",candle:"🕯",candy:"🍬",canoe:"🛶",capital_abcd:"🔠",capricorn:"♑️",car:"🚗",card_file_box:"🗃",card_index:"📇",card_index_dividers:"🗂",carousel_horse:"🎠",carrot:"🥕",cat:"🐱",cat2:"🐈",cd:"💿",chains:"⛓",champagne:"🍾",chart:"💹",chart_with_downwards_trend:"📉",chart_with_upwards_trend:"📈",checkered_flag:"🏁",cheese:"🧀",cherries:"🍒",cherry_blossom:"🌸",chestnut:"🌰",chicken:"🐔",children_crossing:"🚸",chipmunk:"🐿",chocolate_bar:"🍫",christmas_tree:"🎄",church:"⛪️",cinema:"🎦",circus_tent:"🎪",city_sunrise:"🌇",city_sunset:"🌆",cityscape:"🏙",cl:"🆑",clamp:"🗜",clap:"👏",clapper:"🎬",classical_building:"🏛",clinking_glasses:"🥂",clipboard:"📋",clock1:"🕐",clock10:"🕙",clock1030:"🕥",clock11:"🕚",clock1130:"🕦",clock12:"🕛",clock1230:"🕧",clock130:"🕜",clock2:"🕑",clock230:"🕝",clock3:"🕒",clock330:"🕞",clock4:"🕓",clock430:"🕟",clock5:"🕔",clock530:"🕠",clock6:"🕕",clock630:"🕡",clock7:"🕖",clock730:"🕢",clock8:"🕗",clock830:"🕣",clock9:"🕘",clock930:"🕤",closed_book:"📕",closed_lock_with_key:"🔐",closed_umbrella:"🌂",cloud:"☁️",cloud_with_lightning:"🌩",cloud_with_lightning_and_rain:"⛈",cloud_with_rain:"🌧",cloud_with_snow:"🌨",clown_face:"🤡",clubs:"♣️",cocktail:"🍸",coffee:"☕️",coffin:"⚰️",cold_sweat:"😰",comet:"☄️",computer:"💻",computer_mouse:"🖱",confetti_ball:"🎊",confounded:"😖",confused:"😕",congratulations:"㊗️",construction:"🚧",construction_worker_man:"👷",construction_worker_woman:"👷&zwj;♀️",control_knobs:"🎛",convenience_store:"🏪",cookie:"🍪",cool:"🆒",policeman:"👮",copyright:"©️",corn:"🌽",couch_and_lamp:"🛋",couple:"👫",couple_with_heart_woman_man:"💑",couple_with_heart_man_man:"👨&zwj;❤️&zwj;👨",couple_with_heart_woman_woman:"👩&zwj;❤️&zwj;👩",couplekiss_man_man:"👨&zwj;❤️&zwj;💋&zwj;👨",couplekiss_man_woman:"💏",couplekiss_woman_woman:"👩&zwj;❤️&zwj;💋&zwj;👩",cow:"🐮",cow2:"🐄",cowboy_hat_face:"🤠",crab:"🦀",crayon:"🖍",credit_card:"💳",crescent_moon:"🌙",cricket:"🏏",crocodile:"🐊",croissant:"🥐",crossed_fingers:"🤞",crossed_flags:"🎌",crossed_swords:"⚔️",crown:"👑",cry:"😢",crying_cat_face:"😿",crystal_ball:"🔮",cucumber:"🥒",cupid:"💘",curly_loop:"➰",currency_exchange:"💱",curry:"🍛",custard:"🍮",customs:"🛃",cyclone:"🌀",dagger:"🗡",dancer:"💃",dancing_women:"👯",dancing_men:"👯&zwj;♂️",dango:"🍡",dark_sunglasses:"🕶",dart:"🎯",dash:"💨",date:"📅",deciduous_tree:"🌳",deer:"🦌",department_store:"🏬",derelict_house:"🏚",desert:"🏜",desert_island:"🏝",desktop_computer:"🖥",male_detective:"🕵️",diamond_shape_with_a_dot_inside:"💠",diamonds:"♦️",disappointed:"😞",disappointed_relieved:"😥",dizzy:"💫",dizzy_face:"😵",do_not_litter:"🚯",dog:"🐶",dog2:"🐕",dollar:"💵",dolls:"🎎",dolphin:"🐬",door:"🚪",doughnut:"🍩",dove:"🕊",dragon:"🐉",dragon_face:"🐲",dress:"👗",dromedary_camel:"🐪",drooling_face:"🤤",droplet:"💧",drum:"🥁",duck:"🦆",dvd:"📀","e-mail":"📧",eagle:"🦅",ear:"👂",ear_of_rice:"🌾",earth_africa:"🌍",earth_americas:"🌎",earth_asia:"🌏",egg:"🥚",eggplant:"🍆",eight_pointed_black_star:"✴️",eight_spoked_asterisk:"✳️",electric_plug:"🔌",elephant:"🐘",email:"✉️",end:"🔚",envelope_with_arrow:"📩",euro:"💶",european_castle:"🏰",european_post_office:"🏤",evergreen_tree:"🌲",exclamation:"❗️",expressionless:"😑",eye:"👁",eye_speech_bubble:"👁&zwj;🗨",eyeglasses:"👓",eyes:"👀",face_with_head_bandage:"🤕",face_with_thermometer:"🤒",fist_oncoming:"👊",factory:"🏭",fallen_leaf:"🍂",family_man_woman_boy:"👪",family_man_boy:"👨&zwj;👦",family_man_boy_boy:"👨&zwj;👦&zwj;👦",family_man_girl:"👨&zwj;👧",family_man_girl_boy:"👨&zwj;👧&zwj;👦",family_man_girl_girl:"👨&zwj;👧&zwj;👧",family_man_man_boy:"👨&zwj;👨&zwj;👦",family_man_man_boy_boy:"👨&zwj;👨&zwj;👦&zwj;👦",family_man_man_girl:"👨&zwj;👨&zwj;👧",family_man_man_girl_boy:"👨&zwj;👨&zwj;👧&zwj;👦",family_man_man_girl_girl:"👨&zwj;👨&zwj;👧&zwj;👧",family_man_woman_boy_boy:"👨&zwj;👩&zwj;👦&zwj;👦",family_man_woman_girl:"👨&zwj;👩&zwj;👧",family_man_woman_girl_boy:"👨&zwj;👩&zwj;👧&zwj;👦",family_man_woman_girl_girl:"👨&zwj;👩&zwj;👧&zwj;👧",family_woman_boy:"👩&zwj;👦",family_woman_boy_boy:"👩&zwj;👦&zwj;👦",family_woman_girl:"👩&zwj;👧",family_woman_girl_boy:"👩&zwj;👧&zwj;👦",family_woman_girl_girl:"👩&zwj;👧&zwj;👧",family_woman_woman_boy:"👩&zwj;👩&zwj;👦",family_woman_woman_boy_boy:"👩&zwj;👩&zwj;👦&zwj;👦",family_woman_woman_girl:"👩&zwj;👩&zwj;👧",family_woman_woman_girl_boy:"👩&zwj;👩&zwj;👧&zwj;👦",family_woman_woman_girl_girl:"👩&zwj;👩&zwj;👧&zwj;👧",fast_forward:"⏩",fax:"📠",fearful:"😨",feet:"🐾",female_detective:"🕵️&zwj;♀️",ferris_wheel:"🎡",ferry:"⛴",field_hockey:"🏑",file_cabinet:"🗄",file_folder:"📁",film_projector:"📽",film_strip:"🎞",fire:"🔥",fire_engine:"🚒",fireworks:"🎆",first_quarter_moon:"🌓",first_quarter_moon_with_face:"🌛",fish:"🐟",fish_cake:"🍥",fishing_pole_and_fish:"🎣",fist_raised:"✊",fist_left:"🤛",fist_right:"🤜",flags:"🎏",flashlight:"🔦",fleur_de_lis:"⚜️",flight_arrival:"🛬",flight_departure:"🛫",floppy_disk:"💾",flower_playing_cards:"🎴",flushed:"😳",fog:"🌫",foggy:"🌁",football:"🏈",footprints:"👣",fork_and_knife:"🍴",fountain:"⛲️",fountain_pen:"🖋",four_leaf_clover:"🍀",fox_face:"🦊",framed_picture:"🖼",free:"🆓",fried_egg:"🍳",fried_shrimp:"🍤",fries:"🍟",frog:"🐸",frowning:"😦",frowning_face:"☹️",frowning_man:"🙍&zwj;♂️",frowning_woman:"🙍",middle_finger:"🖕",fuelpump:"⛽️",full_moon:"🌕",full_moon_with_face:"🌝",funeral_urn:"⚱️",game_die:"🎲",gear:"⚙️",gem:"💎",gemini:"♊️",ghost:"👻",gift:"🎁",gift_heart:"💝",girl:"👧",globe_with_meridians:"🌐",goal_net:"🥅",goat:"🐐",golf:"⛳️",golfing_man:"🏌️",golfing_woman:"🏌️&zwj;♀️",gorilla:"🦍",grapes:"🍇",green_apple:"🍏",green_book:"📗",green_heart:"💚",green_salad:"🥗",grey_exclamation:"❕",grey_question:"❔",grimacing:"😬",grin:"😁",grinning:"😀",guardsman:"💂",guardswoman:"💂&zwj;♀️",guitar:"🎸",gun:"🔫",haircut_woman:"💇",haircut_man:"💇&zwj;♂️",hamburger:"🍔",hammer:"🔨",hammer_and_pick:"⚒",hammer_and_wrench:"🛠",hamster:"🐹",hand:"✋",handbag:"👜",handshake:"🤝",hankey:"💩",hatched_chick:"🐥",hatching_chick:"🐣",headphones:"🎧",hear_no_evil:"🙉",heart:"❤️",heart_decoration:"💟",heart_eyes:"😍",heart_eyes_cat:"😻",heartbeat:"💓",heartpulse:"💗",hearts:"♥️",heavy_check_mark:"✔️",heavy_division_sign:"➗",heavy_dollar_sign:"💲",heavy_heart_exclamation:"❣️",heavy_minus_sign:"➖",heavy_multiplication_x:"✖️",heavy_plus_sign:"➕",helicopter:"🚁",herb:"🌿",hibiscus:"🌺",high_brightness:"🔆",high_heel:"👠",hocho:"🔪",hole:"🕳",honey_pot:"🍯",horse:"🐴",horse_racing:"🏇",hospital:"🏥",hot_pepper:"🌶",hotdog:"🌭",hotel:"🏨",hotsprings:"♨️",hourglass:"⌛️",hourglass_flowing_sand:"⏳",house:"🏠",house_with_garden:"🏡",houses:"🏘",hugs:"🤗",hushed:"😯",ice_cream:"🍨",ice_hockey:"🏒",ice_skate:"⛸",icecream:"🍦",id:"🆔",ideograph_advantage:"🉐",imp:"👿",inbox_tray:"📥",incoming_envelope:"📨",tipping_hand_woman:"💁",information_source:"ℹ️",innocent:"😇",interrobang:"⁉️",iphone:"📱",izakaya_lantern:"🏮",jack_o_lantern:"🎃",japan:"🗾",japanese_castle:"🏯",japanese_goblin:"👺",japanese_ogre:"👹",jeans:"👖",joy:"😂",joy_cat:"😹",joystick:"🕹",kaaba:"🕋",key:"🔑",keyboard:"⌨️",keycap_ten:"🔟",kick_scooter:"🛴",kimono:"👘",kiss:"💋",kissing:"😗",kissing_cat:"😽",kissing_closed_eyes:"😚",kissing_heart:"😘",kissing_smiling_eyes:"😙",kiwi_fruit:"🥝",koala:"🐨",koko:"🈁",label:"🏷",large_blue_circle:"🔵",large_blue_diamond:"🔷",large_orange_diamond:"🔶",last_quarter_moon:"🌗",last_quarter_moon_with_face:"🌜",latin_cross:"✝️",laughing:"😆",leaves:"🍃",ledger:"📒",left_luggage:"🛅",left_right_arrow:"↔️",leftwards_arrow_with_hook:"↩️",lemon:"🍋",leo:"♌️",leopard:"🐆",level_slider:"🎚",libra:"♎️",light_rail:"🚈",link:"🔗",lion:"🦁",lips:"👄",lipstick:"💄",lizard:"🦎",lock:"🔒",lock_with_ink_pen:"🔏",lollipop:"🍭",loop:"➿",loud_sound:"🔊",loudspeaker:"📢",love_hotel:"🏩",love_letter:"💌",low_brightness:"🔅",lying_face:"🤥",m:"Ⓜ️",mag:"🔍",mag_right:"🔎",mahjong:"🀄️",mailbox:"📫",mailbox_closed:"📪",mailbox_with_mail:"📬",mailbox_with_no_mail:"📭",man:"👨",man_artist:"👨&zwj;🎨",man_astronaut:"👨&zwj;🚀",man_cartwheeling:"🤸&zwj;♂️",man_cook:"👨&zwj;🍳",man_dancing:"🕺",man_facepalming:"🤦&zwj;♂️",man_factory_worker:"👨&zwj;🏭",man_farmer:"👨&zwj;🌾",man_firefighter:"👨&zwj;🚒",man_health_worker:"👨&zwj;⚕️",man_in_tuxedo:"🤵",man_judge:"👨&zwj;⚖️",man_juggling:"🤹&zwj;♂️",man_mechanic:"👨&zwj;🔧",man_office_worker:"👨&zwj;💼",man_pilot:"👨&zwj;✈️",man_playing_handball:"🤾&zwj;♂️",man_playing_water_polo:"🤽&zwj;♂️",man_scientist:"👨&zwj;🔬",man_shrugging:"🤷&zwj;♂️",man_singer:"👨&zwj;🎤",man_student:"👨&zwj;🎓",man_teacher:"👨&zwj;🏫",man_technologist:"👨&zwj;💻",man_with_gua_pi_mao:"👲",man_with_turban:"👳",tangerine:"🍊",mans_shoe:"👞",mantelpiece_clock:"🕰",maple_leaf:"🍁",martial_arts_uniform:"🥋",mask:"😷",massage_woman:"💆",massage_man:"💆&zwj;♂️",meat_on_bone:"🍖",medal_military:"🎖",medal_sports:"🏅",mega:"📣",melon:"🍈",memo:"📝",men_wrestling:"🤼&zwj;♂️",menorah:"🕎",mens:"🚹",metal:"🤘",metro:"🚇",microphone:"🎤",microscope:"🔬",milk_glass:"🥛",milky_way:"🌌",minibus:"🚐",minidisc:"💽",mobile_phone_off:"📴",money_mouth_face:"🤑",money_with_wings:"💸",moneybag:"💰",monkey:"🐒",monkey_face:"🐵",monorail:"🚝",moon:"🌔",mortar_board:"🎓",mosque:"🕌",motor_boat:"🛥",motor_scooter:"🛵",motorcycle:"🏍",motorway:"🛣",mount_fuji:"🗻",mountain:"⛰",mountain_biking_man:"🚵",mountain_biking_woman:"🚵&zwj;♀️",mountain_cableway:"🚠",mountain_railway:"🚞",mountain_snow:"🏔",mouse:"🐭",mouse2:"🐁",movie_camera:"🎥",moyai:"🗿",mrs_claus:"🤶",muscle:"💪",mushroom:"🍄",musical_keyboard:"🎹",musical_note:"🎵",musical_score:"🎼",mute:"🔇",nail_care:"💅",name_badge:"📛",national_park:"🏞",nauseated_face:"🤢",necktie:"👔",negative_squared_cross_mark:"❎",nerd_face:"🤓",neutral_face:"😐",new:"🆕",new_moon:"🌑",new_moon_with_face:"🌚",newspaper:"📰",newspaper_roll:"🗞",next_track_button:"⏭",ng:"🆖",no_good_man:"🙅&zwj;♂️",no_good_woman:"🙅",night_with_stars:"🌃",no_bell:"🔕",no_bicycles:"🚳",no_entry:"⛔️",no_entry_sign:"🚫",no_mobile_phones:"📵",no_mouth:"😶",no_pedestrians:"🚷",no_smoking:"🚭","non-potable_water":"🚱",nose:"👃",notebook:"📓",notebook_with_decorative_cover:"📔",notes:"🎶",nut_and_bolt:"🔩",o:"⭕️",o2:"🅾️",ocean:"🌊",octopus:"🐙",oden:"🍢",office:"🏢",oil_drum:"🛢",ok:"🆗",ok_hand:"👌",ok_man:"🙆&zwj;♂️",ok_woman:"🙆",old_key:"🗝",older_man:"👴",older_woman:"👵",om:"🕉",on:"🔛",oncoming_automobile:"🚘",oncoming_bus:"🚍",oncoming_police_car:"🚔",oncoming_taxi:"🚖",open_file_folder:"📂",open_hands:"👐",open_mouth:"😮",open_umbrella:"☂️",ophiuchus:"⛎",orange_book:"📙",orthodox_cross:"☦️",outbox_tray:"📤",owl:"🦉",ox:"🐂",package:"📦",page_facing_up:"📄",page_with_curl:"📃",pager:"📟",paintbrush:"🖌",palm_tree:"🌴",pancakes:"🥞",panda_face:"🐼",paperclip:"📎",paperclips:"🖇",parasol_on_ground:"⛱",parking:"🅿️",part_alternation_mark:"〽️",partly_sunny:"⛅️",passenger_ship:"🛳",passport_control:"🛂",pause_button:"⏸",peace_symbol:"☮️",peach:"🍑",peanuts:"🥜",pear:"🍐",pen:"🖊",pencil2:"✏️",penguin:"🐧",pensive:"😔",performing_arts:"🎭",persevere:"😣",person_fencing:"🤺",pouting_woman:"🙎",phone:"☎️",pick:"⛏",pig:"🐷",pig2:"🐖",pig_nose:"🐽",pill:"💊",pineapple:"🍍",ping_pong:"🏓",pisces:"♓️",pizza:"🍕",place_of_worship:"🛐",plate_with_cutlery:"🍽",play_or_pause_button:"⏯",point_down:"👇",point_left:"👈",point_right:"👉",point_up:"☝️",point_up_2:"👆",police_car:"🚓",policewoman:"👮&zwj;♀️",poodle:"🐩",popcorn:"🍿",post_office:"🏣",postal_horn:"📯",postbox:"📮",potable_water:"🚰",potato:"🥔",pouch:"👝",poultry_leg:"🍗",pound:"💷",rage:"😡",pouting_cat:"😾",pouting_man:"🙎&zwj;♂️",pray:"🙏",prayer_beads:"📿",pregnant_woman:"🤰",previous_track_button:"⏮",prince:"🤴",princess:"👸",printer:"🖨",purple_heart:"💜",purse:"👛",pushpin:"📌",put_litter_in_its_place:"🚮",question:"❓",rabbit:"🐰",rabbit2:"🐇",racehorse:"🐎",racing_car:"🏎",radio:"📻",radio_button:"🔘",radioactive:"☢️",railway_car:"🚃",railway_track:"🛤",rainbow:"🌈",rainbow_flag:"🏳️&zwj;🌈",raised_back_of_hand:"🤚",raised_hand_with_fingers_splayed:"🖐",raised_hands:"🙌",raising_hand_woman:"🙋",raising_hand_man:"🙋&zwj;♂️",ram:"🐏",ramen:"🍜",rat:"🐀",record_button:"⏺",recycle:"♻️",red_circle:"🔴",registered:"®️",relaxed:"☺️",relieved:"😌",reminder_ribbon:"🎗",repeat:"🔁",repeat_one:"🔂",rescue_worker_helmet:"⛑",restroom:"🚻",revolving_hearts:"💞",rewind:"⏪",rhinoceros:"🦏",ribbon:"🎀",rice:"🍚",rice_ball:"🍙",rice_cracker:"🍘",rice_scene:"🎑",right_anger_bubble:"🗯",ring:"💍",robot:"🤖",rocket:"🚀",rofl:"🤣",roll_eyes:"🙄",roller_coaster:"🎢",rooster:"🐓",rose:"🌹",rosette:"🏵",rotating_light:"🚨",round_pushpin:"📍",rowing_man:"🚣",rowing_woman:"🚣&zwj;♀️",rugby_football:"🏉",running_man:"🏃",running_shirt_with_sash:"🎽",running_woman:"🏃&zwj;♀️",sa:"🈂️",sagittarius:"♐️",sake:"🍶",sandal:"👡",santa:"🎅",satellite:"📡",saxophone:"🎷",school:"🏫",school_satchel:"🎒",scissors:"✂️",scorpion:"🦂",scorpius:"♏️",scream:"😱",scream_cat:"🙀",scroll:"📜",seat:"💺",secret:"㊙️",see_no_evil:"🙈",seedling:"🌱",selfie:"🤳",shallow_pan_of_food:"🥘",shamrock:"☘️",shark:"🦈",shaved_ice:"🍧",sheep:"🐑",shell:"🐚",shield:"🛡",shinto_shrine:"⛩",ship:"🚢",shirt:"👕",shopping:"🛍",shopping_cart:"🛒",shower:"🚿",shrimp:"🦐",signal_strength:"📶",six_pointed_star:"🔯",ski:"🎿",skier:"⛷",skull:"💀",skull_and_crossbones:"☠️",sleeping:"😴",sleeping_bed:"🛌",sleepy:"😪",slightly_frowning_face:"🙁",slightly_smiling_face:"🙂",slot_machine:"🎰",small_airplane:"🛩",small_blue_diamond:"🔹",small_orange_diamond:"🔸",small_red_triangle:"🔺",small_red_triangle_down:"🔻",smile:"😄",smile_cat:"😸",smiley:"😃",smiley_cat:"😺",smiling_imp:"😈",smirk:"😏",smirk_cat:"😼",smoking:"🚬",snail:"🐌",snake:"🐍",sneezing_face:"🤧",snowboarder:"🏂",snowflake:"❄️",snowman:"⛄️",snowman_with_snow:"☃️",sob:"😭",soccer:"⚽️",soon:"🔜",sos:"🆘",sound:"🔉",space_invader:"👾",spades:"♠️",spaghetti:"🍝",sparkle:"❇️",sparkler:"🎇",sparkles:"✨",sparkling_heart:"💖",speak_no_evil:"🙊",speaker:"🔈",speaking_head:"🗣",speech_balloon:"💬",speedboat:"🚤",spider:"🕷",spider_web:"🕸",spiral_calendar:"🗓",spiral_notepad:"🗒",spoon:"🥄",squid:"🦑",stadium:"🏟",star:"⭐️",star2:"🌟",star_and_crescent:"☪️",star_of_david:"✡️",stars:"🌠",station:"🚉",statue_of_liberty:"🗽",steam_locomotive:"🚂",stew:"🍲",stop_button:"⏹",stop_sign:"🛑",stopwatch:"⏱",straight_ruler:"📏",strawberry:"🍓",stuck_out_tongue:"😛",stuck_out_tongue_closed_eyes:"😝",stuck_out_tongue_winking_eye:"😜",studio_microphone:"🎙",stuffed_flatbread:"🥙",sun_behind_large_cloud:"🌥",sun_behind_rain_cloud:"🌦",sun_behind_small_cloud:"🌤",sun_with_face:"🌞",sunflower:"🌻",sunglasses:"😎",sunny:"☀️",sunrise:"🌅",sunrise_over_mountains:"🌄",surfing_man:"🏄",surfing_woman:"🏄&zwj;♀️",sushi:"🍣",suspension_railway:"🚟",sweat:"😓",sweat_drops:"💦",sweat_smile:"😅",sweet_potato:"🍠",swimming_man:"🏊",swimming_woman:"🏊&zwj;♀️",symbols:"🔣",synagogue:"🕍",syringe:"💉",taco:"🌮",tada:"🎉",tanabata_tree:"🎋",taurus:"♉️",taxi:"🚕",tea:"🍵",telephone_receiver:"📞",telescope:"🔭",tennis:"🎾",tent:"⛺️",thermometer:"🌡",thinking:"🤔",thought_balloon:"💭",ticket:"🎫",tickets:"🎟",tiger:"🐯",tiger2:"🐅",timer_clock:"⏲",tipping_hand_man:"💁&zwj;♂️",tired_face:"😫",tm:"™️",toilet:"🚽",tokyo_tower:"🗼",tomato:"🍅",tongue:"👅",top:"🔝",tophat:"🎩",tornado:"🌪",trackball:"🖲",tractor:"🚜",traffic_light:"🚥",train:"🚋",train2:"🚆",tram:"🚊",triangular_flag_on_post:"🚩",triangular_ruler:"📐",trident:"🔱",triumph:"😤",trolleybus:"🚎",trophy:"🏆",tropical_drink:"🍹",tropical_fish:"🐠",truck:"🚚",trumpet:"🎺",tulip:"🌷",tumbler_glass:"🥃",turkey:"🦃",turtle:"🐢",tv:"📺",twisted_rightwards_arrows:"🔀",two_hearts:"💕",two_men_holding_hands:"👬",two_women_holding_hands:"👭",u5272:"🈹",u5408:"🈴",u55b6:"🈺",u6307:"🈯️",u6708:"🈷️",u6709:"🈶",u6e80:"🈵",u7121:"🈚️",u7533:"🈸",u7981:"🈲",u7a7a:"🈳",umbrella:"☔️",unamused:"😒",underage:"🔞",unicorn:"🦄",unlock:"🔓",up:"🆙",upside_down_face:"🙃",v:"✌️",vertical_traffic_light:"🚦",vhs:"📼",vibration_mode:"📳",video_camera:"📹",video_game:"🎮",violin:"🎻",virgo:"♍️",volcano:"🌋",volleyball:"🏐",vs:"🆚",vulcan_salute:"🖖",walking_man:"🚶",walking_woman:"🚶&zwj;♀️",waning_crescent_moon:"🌘",waning_gibbous_moon:"🌖",warning:"⚠️",wastebasket:"🗑",watch:"⌚️",water_buffalo:"🐃",watermelon:"🍉",wave:"👋",wavy_dash:"〰️",waxing_crescent_moon:"🌒",wc:"🚾",weary:"😩",wedding:"💒",weight_lifting_man:"🏋️",weight_lifting_woman:"🏋️&zwj;♀️",whale:"🐳",whale2:"🐋",wheel_of_dharma:"☸️",wheelchair:"♿️",white_check_mark:"✅",white_circle:"⚪️",white_flag:"🏳️",white_flower:"💮",white_large_square:"⬜️",white_medium_small_square:"◽️",white_medium_square:"◻️",white_small_square:"▫️",white_square_button:"🔳",wilted_flower:"🥀",wind_chime:"🎐",wind_face:"🌬",wine_glass:"🍷",wink:"😉",wolf:"🐺",woman:"👩",woman_artist:"👩&zwj;🎨",woman_astronaut:"👩&zwj;🚀",woman_cartwheeling:"🤸&zwj;♀️",woman_cook:"👩&zwj;🍳",woman_facepalming:"🤦&zwj;♀️",woman_factory_worker:"👩&zwj;🏭",woman_farmer:"👩&zwj;🌾",woman_firefighter:"👩&zwj;🚒",woman_health_worker:"👩&zwj;⚕️",woman_judge:"👩&zwj;⚖️",woman_juggling:"🤹&zwj;♀️",woman_mechanic:"👩&zwj;🔧",woman_office_worker:"👩&zwj;💼",woman_pilot:"👩&zwj;✈️",woman_playing_handball:"🤾&zwj;♀️",woman_playing_water_polo:"🤽&zwj;♀️",woman_scientist:"👩&zwj;🔬",woman_shrugging:"🤷&zwj;♀️",woman_singer:"👩&zwj;🎤",woman_student:"👩&zwj;🎓",woman_teacher:"👩&zwj;🏫",woman_technologist:"👩&zwj;💻",woman_with_turban:"👳&zwj;♀️",womans_clothes:"👚",womans_hat:"👒",women_wrestling:"🤼&zwj;♀️",womens:"🚺",world_map:"🗺",worried:"😟",wrench:"🔧",writing_hand:"✍️",x:"❌",yellow_heart:"💛",yen:"💴",yin_yang:"☯️",yum:"😋",zap:"⚡️",zipper_mouth_face:"🤐",zzz:"💤",octocat:'<img alt=":octocat:" height="20" width="20" align="absmiddle" src="https://assets-cdn.github.com/images/icons/emoji/octocat.png">',showdown:"<span style=\"font-family: 'Anonymous Pro', monospace; text-decoration: underline; text-decoration-style: dashed; text-decoration-color: #3e8b8a;text-underline-position: under;\">S</span>"},e.Converter=function(t){var i={},a=[],h=[],c={},u=s,f={parsed:{},raw:"",format:""};function d(t,i){if(i=i||null,e.helper.isString(t)){if(i=t=e.helper.stdExtName(t),e.extensions[t])return console.warn("DEPRECATION WARNING: "+t+" is an old extension that uses a deprecated loading method.Please inform the developer that the extension should be updated!"),void function(t,i){"function"==typeof t&&(t=t(new e.Converter)),e.helper.isArray(t)||(t=[t]);var n=l(t,i);if(!n.valid)throw Error(n.error);for(var r=0;r<t.length;++r)switch(t[r].type){case"lang":a.push(t[r]);break;case"output":h.push(t[r]);break;default:throw Error("Extension loader error: Type unrecognized!!!")}}(e.extensions[t],t);if(e.helper.isUndefined(n[t]))throw Error('Extension "'+t+'" could not be loaded. It was either not found or is not a valid extension.');t=n[t]}"function"==typeof t&&(t=t()),e.helper.isArray(t)||(t=[t]);var r=l(t,i);if(!r.valid)throw Error(r.error);for(var s=0;s<t.length;++s){switch(t[s].type){case"lang":a.push(t[s]);break;case"output":h.push(t[s])}if(t[s].hasOwnProperty("listeners"))for(var o in t[s].listeners)t[s].listeners.hasOwnProperty(o)&&p(o,t[s].listeners[o])}}function p(t,i){if(!e.helper.isString(t))throw Error("Invalid argument in converter.listen() method: name must be a string, but "+typeof t+" given");if("function"!=typeof i)throw Error("Invalid argument in converter.listen() method: callback must be a function, but "+typeof i+" given");c.hasOwnProperty(t)||(c[t]=[]),c[t].push(i)}!function(){for(var n in t=t||{},r)r.hasOwnProperty(n)&&(i[n]=r[n]);if("object"!=typeof t)throw Error("Converter expects the passed parameter to be an object, but "+typeof t+" was passed instead.");for(var s in t)t.hasOwnProperty(s)&&(i[s]=t[s]);i.extensions&&e.helper.forEach(i.extensions,d)}(),this._dispatch=function(t,e,i,n){if(c.hasOwnProperty(t))for(var r=0;r<c[t].length;++r){var s=c[t][r](t,e,this,i,n);s&&void 0!==s&&(e=s)}return e},this.listen=function(t,e){return p(t,e),this},this.makeHtml=function(t){if(!t)return t;var n={gHtmlBlocks:[],gHtmlMdBlocks:[],gHtmlSpans:[],gUrls:{},gTitles:{},gDimensions:{},gListLevel:0,hashLinkCounts:{},langExtensions:a,outputModifiers:h,converter:this,ghCodeBlocks:[],metadata:{parsed:{},raw:"",format:""}};return t=(t=(t=(t=(t=t.replace(/¨/g,"¨T")).replace(/\$/g,"¨D")).replace(/\r\n/g,"\n")).replace(/\r/g,"\n")).replace(/\u00A0/g,"&nbsp;"),i.smartIndentationFix&&(t=function(t){var e=t.match(/^\s*/)[0].length,i=new RegExp("^\\s{0,"+e+"}","gm");return t.replace(i,"")}(t)),t="\n\n"+t+"\n\n",t=(t=e.subParser("detab")(t,i,n)).replace(/^[ \t]+$/gm,""),e.helper.forEach(a,(function(r){t=e.subParser("runExtension")(r,t,i,n)})),t=e.subParser("metadata")(t,i,n),t=e.subParser("hashPreCodeTags")(t,i,n),t=e.subParser("githubCodeBlocks")(t,i,n),t=e.subParser("hashHTMLBlocks")(t,i,n),t=e.subParser("hashCodeTags")(t,i,n),t=e.subParser("stripLinkDefinitions")(t,i,n),t=e.subParser("blockGamut")(t,i,n),t=e.subParser("unhashHTMLSpans")(t,i,n),t=(t=(t=e.subParser("unescapeSpecialChars")(t,i,n)).replace(/¨D/g,"$$")).replace(/¨T/g,"¨"),t=e.subParser("completeHTMLDocument")(t,i,n),e.helper.forEach(h,(function(r){t=e.subParser("runExtension")(r,t,i,n)})),f=n.metadata,t},this.makeMarkdown=this.makeMd=function(t,i){if(t=(t=(t=t.replace(/\r\n/g,"\n")).replace(/\r/g,"\n")).replace(/>[ \t]+</,">¨NBSP;<"),!i){if(!window||!window.document)throw new Error("HTMLParser is undefined. If in a webworker or nodejs environment, you need to provide a WHATWG DOM and HTML such as JSDOM");i=window.document}var n=i.createElement("div");n.innerHTML=t;var r={preList:function(t){for(var i=t.querySelectorAll("pre"),n=[],r=0;r<i.length;++r)if(1===i[r].childElementCount&&"code"===i[r].firstChild.tagName.toLowerCase()){var s=i[r].firstChild.innerHTML.trim(),o=i[r].firstChild.getAttribute("data-language")||"";if(""===o)for(var l=i[r].firstChild.className.split(" "),a=0;a<l.length;++a){var h=l[a].match(/^language-(.+)$/);if(null!==h){o=h[1];break}}s=e.helper.unescapeHTMLEntities(s),n.push(s),i[r].outerHTML='<precode language="'+o+'" precodenum="'+r.toString()+'"></precode>'}else n.push(i[r].innerHTML),i[r].innerHTML="",i[r].setAttribute("prenum",r.toString());return n}(n)};!function t(e){for(var i=0;i<e.childNodes.length;++i){var n=e.childNodes[i];3===n.nodeType?/\S/.test(n.nodeValue)||/^[ ]+$/.test(n.nodeValue)?(n.nodeValue=n.nodeValue.split("\n").join(" "),n.nodeValue=n.nodeValue.replace(/(\s)+/g,"$1")):(e.removeChild(n),--i):1===n.nodeType&&t(n)}}(n);for(var s=n.childNodes,o="",l=0;l<s.length;l++)o+=e.subParser("makeMarkdown.node")(s[l],r);return o},this.setOption=function(t,e){i[t]=e},this.getOption=function(t){return i[t]},this.getOptions=function(){return i},this.addExtension=function(t,e){d(t,e=e||null)},this.useExtension=function(t){d(t)},this.setFlavor=function(t){if(!o.hasOwnProperty(t))throw Error(t+" flavor was not found");var e=o[t];for(var n in u=t,e)e.hasOwnProperty(n)&&(i[n]=e[n])},this.getFlavor=function(){return u},this.removeExtension=function(t){e.helper.isArray(t)||(t=[t]);for(var i=0;i<t.length;++i){for(var n=t[i],r=0;r<a.length;++r)a[r]===n&&a.splice(r,1);for(var s=0;s<h.length;++s)h[s]===n&&h.splice(s,1)}},this.getAllExtensions=function(){return{language:a,output:h}},this.getMetadata=function(t){return t?f.raw:f.parsed},this.getMetadataFormat=function(){return f.format},this._setMetadataPair=function(t,e){f.parsed[t]=e},this._setMetadataFormat=function(t){f.format=t},this._setMetadataRaw=function(t){f.raw=t}},e.subParser("anchors",(function(t,i,n){var r=function(t,r,s,o,l,a,h){if(e.helper.isUndefined(h)&&(h=""),s=s.toLowerCase(),t.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)o="";else if(!o){if(s||(s=r.toLowerCase().replace(/ ?\n/g," ")),o="#"+s,e.helper.isUndefined(n.gUrls[s]))return t;o=n.gUrls[s],e.helper.isUndefined(n.gTitles[s])||(h=n.gTitles[s])}var c='<a href="'+(o=o.replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback))+'"';return""!==h&&null!==h&&(c+=' title="'+(h=(h=h.replace(/"/g,"&quot;")).replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback))+'"'),i.openLinksInNewWindow&&!/^#/.test(o)&&(c+=' rel="noopener noreferrer" target="¨E95Eblank"'),c+=">"+r+"</a>"};return t=(t=(t=(t=(t=n.converter._dispatch("anchors.before",t,i,n)).replace(/\[((?:\[[^\]]*]|[^\[\]])*)] ?(?:\n *)?\[(.*?)]()()()()/g,r)).replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<([^>]*)>(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,r)).replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,r)).replace(/\[([^\[\]]+)]()()()()()/g,r),i.ghMentions&&(t=t.replace(/(^|\s)(\\)?(@([a-z\d]+(?:[a-z\d.-]+?[a-z\d]+)*))/gim,(function(t,n,r,s,o){if("\\"===r)return n+s;if(!e.helper.isString(i.ghMentionsLink))throw new Error("ghMentionsLink option must be a string");var l=i.ghMentionsLink.replace(/\{u}/g,o),a="";return i.openLinksInNewWindow&&(a=' rel="noopener noreferrer" target="¨E95Eblank"'),n+'<a href="'+l+'"'+a+">"+s+"</a>"}))),t=n.converter._dispatch("anchors.after",t,i,n)}));var c=/([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+?\.[^'">\s]+?)()(\1)?(?=\s|$)(?!["<>])/gi,u=/([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+\.[^'">\s]+?)([.!?,()\[\]])?(\1)?(?=\s|$)(?!["<>])/gi,f=/()<(((https?|ftp|dict):\/\/|www\.)[^'">\s]+)()>()/gi,d=/(^|\s)(?:mailto:)?([A-Za-z0-9!#$%&'*+-/=?^_`{|}~.]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)(?=$|\s)/gim,p=/<()(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,g=function(t){return function(i,n,r,s,o,l,a){var h=r=r.replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback),c="",u="",f=n||"",d=a||"";return/^www\./i.test(r)&&(r=r.replace(/^www\./i,"http://www.")),t.excludeTrailingPunctuationFromURLs&&l&&(c=l),t.openLinksInNewWindow&&(u=' rel="noopener noreferrer" target="¨E95Eblank"'),f+'<a href="'+r+'"'+u+">"+h+"</a>"+c+d}},m=function(t,i){return function(n,r,s){var o="mailto:";return r=r||"",s=e.subParser("unescapeSpecialChars")(s,t,i),t.encodeEmails?(o=e.helper.encodeEmailAddress(o+s),s=e.helper.encodeEmailAddress(s)):o+=s,r+'<a href="'+o+'">'+s+"</a>"}};e.subParser("autoLinks",(function(t,e,i){return t=(t=(t=i.converter._dispatch("autoLinks.before",t,e,i)).replace(f,g(e))).replace(p,m(e,i)),t=i.converter._dispatch("autoLinks.after",t,e,i)})),e.subParser("simplifiedAutoLinks",(function(t,e,i){return e.simplifiedAutoLink?(t=i.converter._dispatch("simplifiedAutoLinks.before",t,e,i),t=(t=e.excludeTrailingPunctuationFromURLs?t.replace(u,g(e)):t.replace(c,g(e))).replace(d,m(e,i)),t=i.converter._dispatch("simplifiedAutoLinks.after",t,e,i)):t})),e.subParser("blockGamut",(function(t,i,n){return t=n.converter._dispatch("blockGamut.before",t,i,n),t=e.subParser("blockQuotes")(t,i,n),t=e.subParser("headers")(t,i,n),t=e.subParser("horizontalRule")(t,i,n),t=e.subParser("lists")(t,i,n),t=e.subParser("codeBlocks")(t,i,n),t=e.subParser("tables")(t,i,n),t=e.subParser("hashHTMLBlocks")(t,i,n),t=e.subParser("paragraphs")(t,i,n),t=n.converter._dispatch("blockGamut.after",t,i,n)})),e.subParser("blockQuotes",(function(t,i,n){t=n.converter._dispatch("blockQuotes.before",t,i,n),t+="\n\n";var r=/(^ {0,3}>[ \t]?.+\n(.+\n)*\n*)+/gm;return i.splitAdjacentBlockquotes&&(r=/^ {0,3}>[\s\S]*?(?:\n\n)/gm),t=t.replace(r,(function(t){return t=(t=(t=t.replace(/^[ \t]*>[ \t]?/gm,"")).replace(/¨0/g,"")).replace(/^[ \t]+$/gm,""),t=e.subParser("githubCodeBlocks")(t,i,n),t=(t=(t=e.subParser("blockGamut")(t,i,n)).replace(/(^|\n)/g,"$1  ")).replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,(function(t,e){var i=e;return i=(i=i.replace(/^  /gm,"¨0")).replace(/¨0/g,"")})),e.subParser("hashBlock")("<blockquote>\n"+t+"\n</blockquote>",i,n)})),t=n.converter._dispatch("blockQuotes.after",t,i,n)})),e.subParser("codeBlocks",(function(t,i,n){return t=n.converter._dispatch("codeBlocks.before",t,i,n),t=(t+="¨0").replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=¨0))/g,(function(t,r,s){var o=r,l=s,a="\n";return o=e.subParser("outdent")(o,i,n),o=e.subParser("encodeCode")(o,i,n),o=(o=(o=e.subParser("detab")(o,i,n)).replace(/^\n+/g,"")).replace(/\n+$/g,""),i.omitExtraWLInCodeBlocks&&(a=""),o="<pre><code>"+o+a+"</code></pre>",e.subParser("hashBlock")(o,i,n)+l})),t=t.replace(/¨0/,""),t=n.converter._dispatch("codeBlocks.after",t,i,n)})),e.subParser("codeSpans",(function(t,i,n){return void 0===(t=n.converter._dispatch("codeSpans.before",t,i,n))&&(t=""),t=t.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,(function(t,r,s,o){var l=o;return l=(l=l.replace(/^([ \t]*)/g,"")).replace(/[ \t]*$/g,""),l=r+"<code>"+(l=e.subParser("encodeCode")(l,i,n))+"</code>",l=e.subParser("hashHTMLSpans")(l,i,n)})),t=n.converter._dispatch("codeSpans.after",t,i,n)})),e.subParser("completeHTMLDocument",(function(t,e,i){if(!e.completeHTMLDocument)return t;t=i.converter._dispatch("completeHTMLDocument.before",t,e,i);var n="html",r="<!DOCTYPE HTML>\n",s="",o='<meta charset="utf-8">\n',l="",a="";for(var h in void 0!==i.metadata.parsed.doctype&&(r="<!DOCTYPE "+i.metadata.parsed.doctype+">\n","html"!==(n=i.metadata.parsed.doctype.toString().toLowerCase())&&"html5"!==n||(o='<meta charset="utf-8">')),i.metadata.parsed)if(i.metadata.parsed.hasOwnProperty(h))switch(h.toLowerCase()){case"doctype":break;case"title":s="<title>"+i.metadata.parsed.title+"</title>\n";break;case"charset":o="html"===n||"html5"===n?'<meta charset="'+i.metadata.parsed.charset+'">\n':'<meta name="charset" content="'+i.metadata.parsed.charset+'">\n';break;case"language":case"lang":l=' lang="'+i.metadata.parsed[h]+'"',a+='<meta name="'+h+'" content="'+i.metadata.parsed[h]+'">\n';break;default:a+='<meta name="'+h+'" content="'+i.metadata.parsed[h]+'">\n'}return t=r+"<html"+l+">\n<head>\n"+s+o+a+"</head>\n<body>\n"+t.trim()+"\n</body>\n</html>",t=i.converter._dispatch("completeHTMLDocument.after",t,e,i)})),e.subParser("detab",(function(t,e,i){return t=(t=(t=(t=i.converter._dispatch("detab.before",t,e,i)).replace(/\t(?=\t)/g,"    ")).replace(/\t/g,"¨A¨B")).replace(/¨B(.+?)¨A/g,(function(t,e){for(var i=e,n=4-i.length%4,r=0;r<n;r++)i+=" ";return i})),t=(t=t.replace(/¨A/g,"    ")).replace(/¨B/g,""),t=i.converter._dispatch("detab.after",t,e,i)})),e.subParser("ellipsis",(function(t,e,i){return e.ellipsis?(t=(t=i.converter._dispatch("ellipsis.before",t,e,i)).replace(/\.\.\./g,"…"),t=i.converter._dispatch("ellipsis.after",t,e,i)):t})),e.subParser("emoji",(function(t,i,n){return i.emoji?(t=(t=n.converter._dispatch("emoji.before",t,i,n)).replace(/:([\S]+?):/g,(function(t,i){return e.helper.emojis.hasOwnProperty(i)?e.helper.emojis[i]:t})),t=n.converter._dispatch("emoji.after",t,i,n)):t})),e.subParser("encodeAmpsAndAngles",(function(t,e,i){return t=(t=(t=(t=(t=i.converter._dispatch("encodeAmpsAndAngles.before",t,e,i)).replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;")).replace(/<(?![a-z\/?$!])/gi,"&lt;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;"),t=i.converter._dispatch("encodeAmpsAndAngles.after",t,e,i)})),e.subParser("encodeBackslashEscapes",(function(t,i,n){return t=(t=(t=n.converter._dispatch("encodeBackslashEscapes.before",t,i,n)).replace(/\\(\\)/g,e.helper.escapeCharactersCallback)).replace(/\\([`*_{}\[\]()>#+.!~=|:-])/g,e.helper.escapeCharactersCallback),t=n.converter._dispatch("encodeBackslashEscapes.after",t,i,n)})),e.subParser("encodeCode",(function(t,i,n){return t=(t=n.converter._dispatch("encodeCode.before",t,i,n)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/([*_{}\[\]\\=~-])/g,e.helper.escapeCharactersCallback),t=n.converter._dispatch("encodeCode.after",t,i,n)})),e.subParser("escapeSpecialCharsWithinTagAttributes",(function(t,i,n){return t=(t=(t=n.converter._dispatch("escapeSpecialCharsWithinTagAttributes.before",t,i,n)).replace(/<\/?[a-z\d_:-]+(?:[\s]+[\s\S]+?)?>/gi,(function(t){return t.replace(/(.)<\/?code>(?=.)/g,"$1`").replace(/([\\`*_~=|])/g,e.helper.escapeCharactersCallback)}))).replace(/<!(--(?:(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>/gi,(function(t){return t.replace(/([\\`*_~=|])/g,e.helper.escapeCharactersCallback)})),t=n.converter._dispatch("escapeSpecialCharsWithinTagAttributes.after",t,i,n)})),e.subParser("githubCodeBlocks",(function(t,i,n){return i.ghCodeBlocks?(t=n.converter._dispatch("githubCodeBlocks.before",t,i,n),t=(t+="¨0").replace(/(?:^|\n)(?: {0,3})(```+|~~~+)(?: *)([^\s`~]*)\n([\s\S]*?)\n(?: {0,3})\1/g,(function(t,r,s,o){var l=i.omitExtraWLInCodeBlocks?"":"\n";return o=e.subParser("encodeCode")(o,i,n),o="<pre><code"+(s?' class="'+s+" language-"+s+'"':"")+">"+(o=(o=(o=e.subParser("detab")(o,i,n)).replace(/^\n+/g,"")).replace(/\n+$/g,""))+l+"</code></pre>",o=e.subParser("hashBlock")(o,i,n),"\n\n¨G"+(n.ghCodeBlocks.push({text:t,codeblock:o})-1)+"G\n\n"})),t=t.replace(/¨0/,""),n.converter._dispatch("githubCodeBlocks.after",t,i,n)):t})),e.subParser("hashBlock",(function(t,e,i){return t=(t=i.converter._dispatch("hashBlock.before",t,e,i)).replace(/(^\n+|\n+$)/g,""),t="\n\n¨K"+(i.gHtmlBlocks.push(t)-1)+"K\n\n",t=i.converter._dispatch("hashBlock.after",t,e,i)})),e.subParser("hashCodeTags",(function(t,i,n){return t=n.converter._dispatch("hashCodeTags.before",t,i,n),t=e.helper.replaceRecursiveRegExp(t,(function(t,r,s,o){var l=s+e.subParser("encodeCode")(r,i,n)+o;return"¨C"+(n.gHtmlSpans.push(l)-1)+"C"}),"<code\\b[^>]*>","</code>","gim"),t=n.converter._dispatch("hashCodeTags.after",t,i,n)})),e.subParser("hashElement",(function(t,e,i){return function(t,e){var n=e;return n=(n=(n=n.replace(/\n\n/g,"\n")).replace(/^\n/,"")).replace(/\n+$/g,""),n="\n\n¨K"+(i.gHtmlBlocks.push(n)-1)+"K\n\n"}})),e.subParser("hashHTMLBlocks",(function(t,i,n){t=n.converter._dispatch("hashHTMLBlocks.before",t,i,n);var r=["pre","div","h1","h2","h3","h4","h5","h6","blockquote","table","dl","ol","ul","script","noscript","form","fieldset","iframe","math","style","section","header","footer","nav","article","aside","address","audio","canvas","figure","hgroup","output","video","p"],s=function(t,e,i,r){var s=t;return-1!==i.search(/\bmarkdown\b/)&&(s=i+n.converter.makeHtml(e)+r),"\n\n¨K"+(n.gHtmlBlocks.push(s)-1)+"K\n\n"};i.backslashEscapesHTMLTags&&(t=t.replace(/\\<(\/?[^>]+?)>/g,(function(t,e){return"&lt;"+e+"&gt;"})));for(var o=0;o<r.length;++o)for(var l,a=new RegExp("^ {0,3}(<"+r[o]+"\\b[^>]*>)","im"),h="<"+r[o]+"\\b[^>]*>",c="</"+r[o]+">";-1!==(l=e.helper.regexIndexOf(t,a));){var u=e.helper.splitAtIndex(t,l),f=e.helper.replaceRecursiveRegExp(u[1],s,h,c,"im");if(f===u[1])break;t=u[0].concat(f)}return t=t.replace(/(\n {0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,e.subParser("hashElement")(t,i,n)),t=(t=e.helper.replaceRecursiveRegExp(t,(function(t){return"\n\n¨K"+(n.gHtmlBlocks.push(t)-1)+"K\n\n"}),"^ {0,3}\x3c!--","--\x3e","gm")).replace(/(?:\n\n)( {0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,e.subParser("hashElement")(t,i,n)),t=n.converter._dispatch("hashHTMLBlocks.after",t,i,n)})),e.subParser("hashHTMLSpans",(function(t,e,i){function n(t){return"¨C"+(i.gHtmlSpans.push(t)-1)+"C"}return t=(t=(t=(t=(t=i.converter._dispatch("hashHTMLSpans.before",t,e,i)).replace(/<[^>]+?\/>/gi,(function(t){return n(t)}))).replace(/<([^>]+?)>[\s\S]*?<\/\1>/g,(function(t){return n(t)}))).replace(/<([^>]+?)\s[^>]+?>[\s\S]*?<\/\1>/g,(function(t){return n(t)}))).replace(/<[^>]+?>/gi,(function(t){return n(t)})),t=i.converter._dispatch("hashHTMLSpans.after",t,e,i)})),e.subParser("unhashHTMLSpans",(function(t,e,i){t=i.converter._dispatch("unhashHTMLSpans.before",t,e,i);for(var n=0;n<i.gHtmlSpans.length;++n){for(var r=i.gHtmlSpans[n],s=0;/¨C(\d+)C/.test(r);){var o=RegExp.$1;if(r=r.replace("¨C"+o+"C",i.gHtmlSpans[o]),10===s){console.error("maximum nesting of 10 spans reached!!!");break}++s}t=t.replace("¨C"+n+"C",r)}return t=i.converter._dispatch("unhashHTMLSpans.after",t,e,i)})),e.subParser("hashPreCodeTags",(function(t,i,n){return t=n.converter._dispatch("hashPreCodeTags.before",t,i,n),t=e.helper.replaceRecursiveRegExp(t,(function(t,r,s,o){var l=s+e.subParser("encodeCode")(r,i,n)+o;return"\n\n¨G"+(n.ghCodeBlocks.push({text:t,codeblock:l})-1)+"G\n\n"}),"^ {0,3}<pre\\b[^>]*>\\s*<code\\b[^>]*>","^ {0,3}</code>\\s*</pre>","gim"),t=n.converter._dispatch("hashPreCodeTags.after",t,i,n)})),e.subParser("headers",(function(t,i,n){t=n.converter._dispatch("headers.before",t,i,n);var r=isNaN(parseInt(i.headerLevelStart))?1:parseInt(i.headerLevelStart),s=i.smoothLivePreview?/^(.+)[ \t]*\n={2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n=+[ \t]*\n+/gm,o=i.smoothLivePreview?/^(.+)[ \t]*\n-{2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n-+[ \t]*\n+/gm;t=(t=t.replace(s,(function(t,s){var o=e.subParser("spanGamut")(s,i,n),l=i.noHeaderId?"":' id="'+a(s)+'"',h="<h"+r+l+">"+o+"</h"+r+">";return e.subParser("hashBlock")(h,i,n)}))).replace(o,(function(t,s){var o=e.subParser("spanGamut")(s,i,n),l=i.noHeaderId?"":' id="'+a(s)+'"',h=r+1,c="<h"+h+l+">"+o+"</h"+h+">";return e.subParser("hashBlock")(c,i,n)}));var l=i.requireSpaceBeforeHeadingText?/^(#{1,6})[ \t]+(.+?)[ \t]*#*\n+/gm:/^(#{1,6})[ \t]*(.+?)[ \t]*#*\n+/gm;function a(t){var r,s;if(i.customizedHeaderId){var o=t.match(/\{([^{]+?)}\s*$/);o&&o[1]&&(t=o[1])}return r=t,s=e.helper.isString(i.prefixHeaderId)?i.prefixHeaderId:!0===i.prefixHeaderId?"section-":"",i.rawPrefixHeaderId||(r=s+r),r=i.ghCompatibleHeaderId?r.replace(/ /g,"-").replace(/&amp;/g,"").replace(/¨T/g,"").replace(/¨D/g,"").replace(/[&+$,\/:;=?@"#{}|^¨~\[\]`\\*)(%.!'<>]/g,"").toLowerCase():i.rawHeaderId?r.replace(/ /g,"-").replace(/&amp;/g,"&").replace(/¨T/g,"¨").replace(/¨D/g,"$").replace(/["']/g,"-").toLowerCase():r.replace(/[^\w]/g,"").toLowerCase(),i.rawPrefixHeaderId&&(r=s+r),n.hashLinkCounts[r]?r=r+"-"+n.hashLinkCounts[r]++:n.hashLinkCounts[r]=1,r}return t=t.replace(l,(function(t,s,o){var l=o;i.customizedHeaderId&&(l=o.replace(/\s?\{([^{]+?)}\s*$/,""));var h=e.subParser("spanGamut")(l,i,n),c=i.noHeaderId?"":' id="'+a(o)+'"',u=r-1+s.length,f="<h"+u+c+">"+h+"</h"+u+">";return e.subParser("hashBlock")(f,i,n)})),t=n.converter._dispatch("headers.after",t,i,n)})),e.subParser("horizontalRule",(function(t,i,n){t=n.converter._dispatch("horizontalRule.before",t,i,n);var r=e.subParser("hashBlock")("<hr />",i,n);return t=(t=(t=t.replace(/^ {0,2}( ?-){3,}[ \t]*$/gm,r)).replace(/^ {0,2}( ?\*){3,}[ \t]*$/gm,r)).replace(/^ {0,2}( ?_){3,}[ \t]*$/gm,r),t=n.converter._dispatch("horizontalRule.after",t,i,n)})),e.subParser("images",(function(t,i,n){function r(t,i,r,s,o,l,a,h){var c=n.gUrls,u=n.gTitles,f=n.gDimensions;if(r=r.toLowerCase(),h||(h=""),t.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)s="";else if(""===s||null===s){if(""!==r&&null!==r||(r=i.toLowerCase().replace(/ ?\n/g," ")),s="#"+r,e.helper.isUndefined(c[r]))return t;s=c[r],e.helper.isUndefined(u[r])||(h=u[r]),e.helper.isUndefined(f[r])||(o=f[r].width,l=f[r].height)}i=i.replace(/"/g,"&quot;").replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback);var d='<img src="'+(s=s.replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback))+'" alt="'+i+'"';return h&&e.helper.isString(h)&&(d+=' title="'+(h=h.replace(/"/g,"&quot;").replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback))+'"'),o&&l&&(d+=' width="'+(o="*"===o?"auto":o)+'"',d+=' height="'+(l="*"===l?"auto":l)+'"'),d+=" />"}return t=(t=(t=(t=(t=(t=n.converter._dispatch("images.before",t,i,n)).replace(/!\[([^\]]*?)] ?(?:\n *)?\[([\s\S]*?)]()()()()()/g,r)).replace(/!\[([^\]]*?)][ \t]*()\([ \t]?<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,(function(t,e,i,n,s,o,l,a){return r(t,e,i,n=n.replace(/\s/g,""),s,o,0,a)}))).replace(/!\[([^\]]*?)][ \t]*()\([ \t]?<([^>]*)>(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(?:(["'])([^"]*?)\6))?[ \t]?\)/g,r)).replace(/!\[([^\]]*?)][ \t]*()\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,r)).replace(/!\[([^\[\]]+)]()()()()()/g,r),t=n.converter._dispatch("images.after",t,i,n)})),e.subParser("italicsAndBold",(function(t,e,i){function n(t,e,i){return e+t+i}return t=i.converter._dispatch("italicsAndBold.before",t,e,i),t=e.literalMidWordUnderscores?(t=(t=t.replace(/\b___(\S[\s\S]*?)___\b/g,(function(t,e){return n(e,"<strong><em>","</em></strong>")}))).replace(/\b__(\S[\s\S]*?)__\b/g,(function(t,e){return n(e,"<strong>","</strong>")}))).replace(/\b_(\S[\s\S]*?)_\b/g,(function(t,e){return n(e,"<em>","</em>")})):(t=(t=t.replace(/___(\S[\s\S]*?)___/g,(function(t,e){return/\S$/.test(e)?n(e,"<strong><em>","</em></strong>"):t}))).replace(/__(\S[\s\S]*?)__/g,(function(t,e){return/\S$/.test(e)?n(e,"<strong>","</strong>"):t}))).replace(/_([^\s_][\s\S]*?)_/g,(function(t,e){return/\S$/.test(e)?n(e,"<em>","</em>"):t})),t=e.literalMidWordAsterisks?(t=(t=t.replace(/([^*]|^)\B\*\*\*(\S[\s\S]*?)\*\*\*\B(?!\*)/g,(function(t,e,i){return n(i,e+"<strong><em>","</em></strong>")}))).replace(/([^*]|^)\B\*\*(\S[\s\S]*?)\*\*\B(?!\*)/g,(function(t,e,i){return n(i,e+"<strong>","</strong>")}))).replace(/([^*]|^)\B\*(\S[\s\S]*?)\*\B(?!\*)/g,(function(t,e,i){return n(i,e+"<em>","</em>")})):(t=(t=t.replace(/\*\*\*(\S[\s\S]*?)\*\*\*/g,(function(t,e){return/\S$/.test(e)?n(e,"<strong><em>","</em></strong>"):t}))).replace(/\*\*(\S[\s\S]*?)\*\*/g,(function(t,e){return/\S$/.test(e)?n(e,"<strong>","</strong>"):t}))).replace(/\*([^\s*][\s\S]*?)\*/g,(function(t,e){return/\S$/.test(e)?n(e,"<em>","</em>"):t})),t=i.converter._dispatch("italicsAndBold.after",t,e,i)})),e.subParser("lists",(function(t,i,n){function r(t,r){n.gListLevel++,t=t.replace(/\n{2,}$/,"\n");var s=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(¨0| {0,3}([*+-]|\d+[.])[ \t]+))/gm,o=/\n[ \t]*\n(?!¨0)/.test(t+="¨0");return i.disableForced4SpacesIndentedSublists&&(s=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(¨0|\2([*+-]|\d+[.])[ \t]+))/gm),t=(t=t.replace(s,(function(t,r,s,l,a,h,c){c=c&&""!==c.trim();var u=e.subParser("outdent")(a,i,n),f="";return h&&i.tasklists&&(f=' class="task-list-item" style="list-style-type: none;"',u=u.replace(/^[ \t]*\[(x|X| )?]/m,(function(){var t='<input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;"';return c&&(t+=" checked"),t+=">"}))),u=u.replace(/^([-*+]|\d\.)[ \t]+[\S\n ]*/g,(function(t){return"¨A"+t})),r||u.search(/\n{2,}/)>-1?(u=e.subParser("githubCodeBlocks")(u,i,n),u=e.subParser("blockGamut")(u,i,n)):(u=(u=e.subParser("lists")(u,i,n)).replace(/\n$/,""),u=(u=e.subParser("hashHTMLBlocks")(u,i,n)).replace(/\n\n+/g,"\n\n"),u=o?e.subParser("paragraphs")(u,i,n):e.subParser("spanGamut")(u,i,n)),u="<li"+f+">"+(u=u.replace("¨A",""))+"</li>\n"}))).replace(/¨0/g,""),n.gListLevel--,r&&(t=t.replace(/\s+$/,"")),t}function s(t,e){if("ol"===e){var i=t.match(/^ *(\d+)\./);if(i&&"1"!==i[1])return' start="'+i[1]+'"'}return""}function o(t,e,n){var o=i.disableForced4SpacesIndentedSublists?/^ ?\d+\.[ \t]/gm:/^ {0,3}\d+\.[ \t]/gm,l=i.disableForced4SpacesIndentedSublists?/^ ?[*+-][ \t]/gm:/^ {0,3}[*+-][ \t]/gm,a="ul"===e?o:l,h="";if(-1!==t.search(a))!function i(c){var u=c.search(a),f=s(t,e);-1!==u?(h+="\n\n<"+e+f+">\n"+r(c.slice(0,u),!!n)+"</"+e+">\n",a="ul"==(e="ul"===e?"ol":"ul")?o:l,i(c.slice(u))):h+="\n\n<"+e+f+">\n"+r(c,!!n)+"</"+e+">\n"}(t);else{var c=s(t,e);h="\n\n<"+e+c+">\n"+r(t,!!n)+"</"+e+">\n"}return h}return t=n.converter._dispatch("lists.before",t,i,n),t+="¨0",t=(t=n.gListLevel?t.replace(/^(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(¨0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,(function(t,e,i){return o(e,i.search(/[*+-]/g)>-1?"ul":"ol",!0)})):t.replace(/(\n\n|^\n?)(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(¨0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,(function(t,e,i,n){return o(i,n.search(/[*+-]/g)>-1?"ul":"ol",!1)}))).replace(/¨0/,""),t=n.converter._dispatch("lists.after",t,i,n)})),e.subParser("metadata",(function(t,e,i){if(!e.metadata)return t;function n(t){i.metadata.raw=t,(t=(t=t.replace(/&/g,"&amp;").replace(/"/g,"&quot;")).replace(/\n {4}/g," ")).replace(/^([\S ]+): +([\s\S]+?)$/gm,(function(t,e,n){return i.metadata.parsed[e]=n,""}))}return t=(t=i.converter._dispatch("metadata.before",t,e,i)).replace(/^\s*«««+(\S*?)\n([\s\S]+?)\n»»»+\n/,(function(t,e,i){return n(i),"¨M"})),t=t.replace(/^\s*---+(\S*?)\n([\s\S]+?)\n---+\n/,(function(t,e,r){return e&&(i.metadata.format=e),n(r),"¨M"})),t=t.replace(/¨M/g,""),t=i.converter._dispatch("metadata.after",t,e,i)})),e.subParser("outdent",(function(t,e,i){return t=(t=(t=i.converter._dispatch("outdent.before",t,e,i)).replace(/^(\t|[ ]{1,4})/gm,"¨0")).replace(/¨0/g,""),t=i.converter._dispatch("outdent.after",t,e,i)})),e.subParser("paragraphs",(function(t,i,n){for(var r=(t=(t=(t=n.converter._dispatch("paragraphs.before",t,i,n)).replace(/^\n+/g,"")).replace(/\n+$/g,"")).split(/\n{2,}/g),s=[],o=r.length,l=0;l<o;l++){var a=r[l];a.search(/¨(K|G)(\d+)\1/g)>=0?s.push(a):a.search(/\S/)>=0&&(a=(a=e.subParser("spanGamut")(a,i,n)).replace(/^([ \t]*)/g,"<p>"),a+="</p>",s.push(a))}for(o=s.length,l=0;l<o;l++){for(var h="",c=s[l],u=!1;/¨(K|G)(\d+)\1/.test(c);){var f=RegExp.$1,d=RegExp.$2;h=(h="K"===f?n.gHtmlBlocks[d]:u?e.subParser("encodeCode")(n.ghCodeBlocks[d].text,i,n):n.ghCodeBlocks[d].codeblock).replace(/\$/g,"$$$$"),c=c.replace(/(\n\n)?¨(K|G)\d+\2(\n\n)?/,h),/^<pre\b[^>]*>\s*<code\b[^>]*>/.test(c)&&(u=!0)}s[l]=c}return t=(t=(t=s.join("\n")).replace(/^\n+/g,"")).replace(/\n+$/g,""),n.converter._dispatch("paragraphs.after",t,i,n)})),e.subParser("runExtension",(function(t,e,i,n){if(t.filter)e=t.filter(e,n.converter,i);else if(t.regex){var r=t.regex;r instanceof RegExp||(r=new RegExp(r,"g")),e=e.replace(r,t.replace)}return e})),e.subParser("spanGamut",(function(t,i,n){return t=n.converter._dispatch("spanGamut.before",t,i,n),t=e.subParser("codeSpans")(t,i,n),t=e.subParser("escapeSpecialCharsWithinTagAttributes")(t,i,n),t=e.subParser("encodeBackslashEscapes")(t,i,n),t=e.subParser("images")(t,i,n),t=e.subParser("anchors")(t,i,n),t=e.subParser("autoLinks")(t,i,n),t=e.subParser("simplifiedAutoLinks")(t,i,n),t=e.subParser("emoji")(t,i,n),t=e.subParser("underline")(t,i,n),t=e.subParser("italicsAndBold")(t,i,n),t=e.subParser("strikethrough")(t,i,n),t=e.subParser("ellipsis")(t,i,n),t=e.subParser("hashHTMLSpans")(t,i,n),t=e.subParser("encodeAmpsAndAngles")(t,i,n),i.simpleLineBreaks?/\n\n¨K/.test(t)||(t=t.replace(/\n+/g,"<br />\n")):t=t.replace(/  +\n/g,"<br />\n"),t=n.converter._dispatch("spanGamut.after",t,i,n)})),e.subParser("strikethrough",(function(t,i,n){return i.strikethrough&&(t=(t=n.converter._dispatch("strikethrough.before",t,i,n)).replace(/(?:~){2}([\s\S]+?)(?:~){2}/g,(function(t,r){return function(t){return i.simplifiedAutoLink&&(t=e.subParser("simplifiedAutoLinks")(t,i,n)),"<del>"+t+"</del>"}(r)})),t=n.converter._dispatch("strikethrough.after",t,i,n)),t})),e.subParser("stripLinkDefinitions",(function(t,i,n){var r=function(r,s,o,l,a,h,c){return s=s.toLowerCase(),t.toLowerCase().split(s).length-1<2?r:(o.match(/^data:.+?\/.+?;base64,/)?n.gUrls[s]=o.replace(/\s/g,""):n.gUrls[s]=e.subParser("encodeAmpsAndAngles")(o,i,n),h?h+c:(c&&(n.gTitles[s]=c.replace(/"|'/g,"&quot;")),i.parseImgDimensions&&l&&a&&(n.gDimensions[s]={width:l,height:a}),""))};return t=(t=(t=(t+="¨0").replace(/^ {0,3}\[([^\]]+)]:[ \t]*\n?[ \t]*<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n\n|(?=¨0)|(?=\n\[))/gm,r)).replace(/^ {0,3}\[([^\]]+)]:[ \t]*\n?[ \t]*<?([^>\s]+)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n+|(?=¨0))/gm,r)).replace(/¨0/,"")})),e.subParser("tables",(function(t,i,n){if(!i.tables)return t;function r(t,r){var s="";return t=t.trim(),(i.tablesHeaderId||i.tableHeaderId)&&(s=' id="'+t.replace(/ /g,"_").toLowerCase()+'"'),"<th"+s+r+">"+(t=e.subParser("spanGamut")(t,i,n))+"</th>\n"}function s(t){var s,o=t.split("\n");for(s=0;s<o.length;++s)/^ {0,3}\|/.test(o[s])&&(o[s]=o[s].replace(/^ {0,3}\|/,"")),/\|[ \t]*$/.test(o[s])&&(o[s]=o[s].replace(/\|[ \t]*$/,"")),o[s]=e.subParser("codeSpans")(o[s],i,n);var l,a,h=o[0].split("|").map((function(t){return t.trim()})),c=o[1].split("|").map((function(t){return t.trim()})),u=[],f=[],d=[],p=[];for(o.shift(),o.shift(),s=0;s<o.length;++s)""!==o[s].trim()&&u.push(o[s].split("|").map((function(t){return t.trim()})));if(h.length<c.length)return t;for(s=0;s<c.length;++s)d.push((l=c[s],/^:[ \t]*--*$/.test(l)?' style="text-align:left;"':/^--*[ \t]*:[ \t]*$/.test(l)?' style="text-align:right;"':/^:[ \t]*--*[ \t]*:$/.test(l)?' style="text-align:center;"':""));for(s=0;s<h.length;++s)e.helper.isUndefined(d[s])&&(d[s]=""),f.push(r(h[s],d[s]));for(s=0;s<u.length;++s){for(var g=[],m=0;m<f.length;++m)e.helper.isUndefined(u[s][m]),g.push((a=u[s][m],"<td"+d[m]+">"+e.subParser("spanGamut")(a,i,n)+"</td>\n"));p.push(g)}return function(t,e){for(var i="<table>\n<thead>\n<tr>\n",n=t.length,r=0;r<n;++r)i+=t[r];for(i+="</tr>\n</thead>\n<tbody>\n",r=0;r<e.length;++r){i+="<tr>\n";for(var s=0;s<n;++s)i+=e[r][s];i+="</tr>\n"}return i+"</tbody>\n</table>\n"}(f,p)}return t=(t=(t=(t=n.converter._dispatch("tables.before",t,i,n)).replace(/\\(\|)/g,e.helper.escapeCharactersCallback)).replace(/^ {0,3}\|?.+\|.+\n {0,3}\|?[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*:?[ \t]*(?:[-=]){2,}[\s\S]+?(?:\n\n|¨0)/gm,s)).replace(/^ {0,3}\|.+\|[ \t]*\n {0,3}\|[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*\n( {0,3}\|.+\|[ \t]*\n)*(?:\n|¨0)/gm,s),t=n.converter._dispatch("tables.after",t,i,n)})),e.subParser("underline",(function(t,i,n){return i.underline?(t=n.converter._dispatch("underline.before",t,i,n),t=(t=i.literalMidWordUnderscores?(t=t.replace(/\b___(\S[\s\S]*?)___\b/g,(function(t,e){return"<u>"+e+"</u>"}))).replace(/\b__(\S[\s\S]*?)__\b/g,(function(t,e){return"<u>"+e+"</u>"})):(t=t.replace(/___(\S[\s\S]*?)___/g,(function(t,e){return/\S$/.test(e)?"<u>"+e+"</u>":t}))).replace(/__(\S[\s\S]*?)__/g,(function(t,e){return/\S$/.test(e)?"<u>"+e+"</u>":t}))).replace(/(_)/g,e.helper.escapeCharactersCallback),t=n.converter._dispatch("underline.after",t,i,n)):t})),e.subParser("unescapeSpecialChars",(function(t,e,i){return t=(t=i.converter._dispatch("unescapeSpecialChars.before",t,e,i)).replace(/¨E(\d+)E/g,(function(t,e){var i=parseInt(e);return String.fromCharCode(i)})),t=i.converter._dispatch("unescapeSpecialChars.after",t,e,i)})),e.subParser("makeMarkdown.blockquote",(function(t,i){var n="";if(t.hasChildNodes())for(var r=t.childNodes,s=r.length,o=0;o<s;++o){var l=e.subParser("makeMarkdown.node")(r[o],i);""!==l&&(n+=l)}return n="> "+(n=n.trim()).split("\n").join("\n> ")})),e.subParser("makeMarkdown.codeBlock",(function(t,e){var i=t.getAttribute("language"),n=t.getAttribute("precodenum");return"```"+i+"\n"+e.preList[n]+"\n```"})),e.subParser("makeMarkdown.codeSpan",(function(t){return"`"+t.innerHTML+"`"})),e.subParser("makeMarkdown.emphasis",(function(t,i){var n="";if(t.hasChildNodes()){n+="*";for(var r=t.childNodes,s=r.length,o=0;o<s;++o)n+=e.subParser("makeMarkdown.node")(r[o],i);n+="*"}return n})),e.subParser("makeMarkdown.header",(function(t,i,n){var r=new Array(n+1).join("#"),s="";if(t.hasChildNodes()){s=r+" ";for(var o=t.childNodes,l=o.length,a=0;a<l;++a)s+=e.subParser("makeMarkdown.node")(o[a],i)}return s})),e.subParser("makeMarkdown.hr",(function(){return"---"})),e.subParser("makeMarkdown.image",(function(t){var e="";return t.hasAttribute("src")&&(e+="!["+t.getAttribute("alt")+"](",e+="<"+t.getAttribute("src")+">",t.hasAttribute("width")&&t.hasAttribute("height")&&(e+=" ="+t.getAttribute("width")+"x"+t.getAttribute("height")),t.hasAttribute("title")&&(e+=' "'+t.getAttribute("title")+'"'),e+=")"),e})),e.subParser("makeMarkdown.links",(function(t,i){var n="";if(t.hasChildNodes()&&t.hasAttribute("href")){var r=t.childNodes,s=r.length;n="[";for(var o=0;o<s;++o)n+=e.subParser("makeMarkdown.node")(r[o],i);n+="](",n+="<"+t.getAttribute("href")+">",t.hasAttribute("title")&&(n+=' "'+t.getAttribute("title")+'"'),n+=")"}return n})),e.subParser("makeMarkdown.list",(function(t,i,n){var r="";if(!t.hasChildNodes())return"";for(var s=t.childNodes,o=s.length,l=t.getAttribute("start")||1,a=0;a<o;++a)void 0!==s[a].tagName&&"li"===s[a].tagName.toLowerCase()&&(r+=("ol"===n?l.toString()+". ":"- ")+e.subParser("makeMarkdown.listItem")(s[a],i),++l);return(r+="\n\x3c!-- --\x3e\n").trim()})),e.subParser("makeMarkdown.listItem",(function(t,i){for(var n="",r=t.childNodes,s=r.length,o=0;o<s;++o)n+=e.subParser("makeMarkdown.node")(r[o],i);return/\n$/.test(n)?n=n.split("\n").join("\n    ").replace(/^ {4}$/gm,"").replace(/\n\n+/g,"\n\n"):n+="\n",n})),e.subParser("makeMarkdown.node",(function(t,i,n){n=n||!1;var r="";if(3===t.nodeType)return e.subParser("makeMarkdown.txt")(t,i);if(8===t.nodeType)return"\x3c!--"+t.data+"--\x3e\n\n";if(1!==t.nodeType)return"";switch(t.tagName.toLowerCase()){case"h1":n||(r=e.subParser("makeMarkdown.header")(t,i,1)+"\n\n");break;case"h2":n||(r=e.subParser("makeMarkdown.header")(t,i,2)+"\n\n");break;case"h3":n||(r=e.subParser("makeMarkdown.header")(t,i,3)+"\n\n");break;case"h4":n||(r=e.subParser("makeMarkdown.header")(t,i,4)+"\n\n");break;case"h5":n||(r=e.subParser("makeMarkdown.header")(t,i,5)+"\n\n");break;case"h6":n||(r=e.subParser("makeMarkdown.header")(t,i,6)+"\n\n");break;case"p":n||(r=e.subParser("makeMarkdown.paragraph")(t,i)+"\n\n");break;case"blockquote":n||(r=e.subParser("makeMarkdown.blockquote")(t,i)+"\n\n");break;case"hr":n||(r=e.subParser("makeMarkdown.hr")(t,i)+"\n\n");break;case"ol":n||(r=e.subParser("makeMarkdown.list")(t,i,"ol")+"\n\n");break;case"ul":n||(r=e.subParser("makeMarkdown.list")(t,i,"ul")+"\n\n");break;case"precode":n||(r=e.subParser("makeMarkdown.codeBlock")(t,i)+"\n\n");break;case"pre":n||(r=e.subParser("makeMarkdown.pre")(t,i)+"\n\n");break;case"table":n||(r=e.subParser("makeMarkdown.table")(t,i)+"\n\n");break;case"code":r=e.subParser("makeMarkdown.codeSpan")(t,i);break;case"em":case"i":r=e.subParser("makeMarkdown.emphasis")(t,i);break;case"strong":case"b":r=e.subParser("makeMarkdown.strong")(t,i);break;case"del":r=e.subParser("makeMarkdown.strikethrough")(t,i);break;case"a":r=e.subParser("makeMarkdown.links")(t,i);break;case"img":r=e.subParser("makeMarkdown.image")(t,i);break;default:r=t.outerHTML+"\n\n"}return r})),e.subParser("makeMarkdown.paragraph",(function(t,i){var n="";if(t.hasChildNodes())for(var r=t.childNodes,s=r.length,o=0;o<s;++o)n+=e.subParser("makeMarkdown.node")(r[o],i);return n=n.trim()})),e.subParser("makeMarkdown.pre",(function(t,e){var i=t.getAttribute("prenum");return"<pre>"+e.preList[i]+"</pre>"})),e.subParser("makeMarkdown.strikethrough",(function(t,i){var n="";if(t.hasChildNodes()){n+="~~";for(var r=t.childNodes,s=r.length,o=0;o<s;++o)n+=e.subParser("makeMarkdown.node")(r[o],i);n+="~~"}return n})),e.subParser("makeMarkdown.strong",(function(t,i){var n="";if(t.hasChildNodes()){n+="**";for(var r=t.childNodes,s=r.length,o=0;o<s;++o)n+=e.subParser("makeMarkdown.node")(r[o],i);n+="**"}return n})),e.subParser("makeMarkdown.table",(function(t,i){var n,r,s="",o=[[],[]],l=t.querySelectorAll("thead>tr>th"),a=t.querySelectorAll("tbody>tr");for(n=0;n<l.length;++n){var h=e.subParser("makeMarkdown.tableCell")(l[n],i),c="---";if(l[n].hasAttribute("style"))switch(l[n].getAttribute("style").toLowerCase().replace(/\s/g,"")){case"text-align:left;":c=":---";break;case"text-align:right;":c="---:";break;case"text-align:center;":c=":---:"}o[0][n]=h.trim(),o[1][n]=c}for(n=0;n<a.length;++n){var u=o.push([])-1,f=a[n].getElementsByTagName("td");for(r=0;r<l.length;++r){var d=" ";void 0!==f[r]&&(d=e.subParser("makeMarkdown.tableCell")(f[r],i)),o[u].push(d)}}var p=3;for(n=0;n<o.length;++n)for(r=0;r<o[n].length;++r){var g=o[n][r].length;g>p&&(p=g)}for(n=0;n<o.length;++n){for(r=0;r<o[n].length;++r)1===n?":"===o[n][r].slice(-1)?o[n][r]=e.helper.padEnd(o[n][r].slice(-1),p-1,"-")+":":o[n][r]=e.helper.padEnd(o[n][r],p,"-"):o[n][r]=e.helper.padEnd(o[n][r],p);s+="| "+o[n].join(" | ")+" |\n"}return s.trim()})),e.subParser("makeMarkdown.tableCell",(function(t,i){var n="";if(!t.hasChildNodes())return"";for(var r=t.childNodes,s=r.length,o=0;o<s;++o)n+=e.subParser("makeMarkdown.node")(r[o],i,!0);return n.trim()})),e.subParser("makeMarkdown.txt",(function(t){var i=t.nodeValue;return i=(i=i.replace(/ +/g," ")).replace(/¨NBSP;/g," "),i=(i=(i=(i=(i=(i=(i=(i=(i=e.helper.unescapeHTMLEntities(i)).replace(/([*_~|`])/g,"\\$1")).replace(/^(\s*)>/g,"\\$1>")).replace(/^#/gm,"\\#")).replace(/^(\s*)([-=]{3,})(\s*)$/,"$1\\$2$3")).replace(/^( {0,3}\d+)\./gm,"$1\\.")).replace(/^( {0,3})([+-])/gm,"$1\\$2")).replace(/]([\s]*)\(/g,"\\]$1\\(")).replace(/^ {0,3}\[([\S \t]*?)]:/gm,"\\[$1]:")})),DK.exports?DK.exports=e:this.showdown=e}.call(EK);var BK=NK.exports;const IK=kK("emailit"),zK=kK(void 0),LK=kK({to:"",subject:"",body:""}),WK=kK(void 0),VK=kK(void 0),jK=kK(!1),qK=kK(!1);function HK(t,e,i){const n=t.slice();return n[96]=e[i],n}function XK(t,e,i){const n=t.slice();return n[96]=e[i],n}function FK(t,e,i){const n=t.slice();return n[101]=e[i],n}function ZK(t){let e,i,r,s,o,l,a,h,c,u,f,m,w,k,A,T,P,M,Q,R,$,_,D,E,N,B,I,z,L,W,V,j,q,H,X,F,Z,G,U,Y,K,J,tt,et,it,nt,rt,st,ot;return{c(){e=b("div"),i=b("label"),i.textContent="Default:",r=v(),s=b("input"),o=v(),l=b("label"),l.textContent="Name of Account:",a=v(),h=b("input"),c=v(),u=b("label"),u.textContent="From Email:",f=v(),m=b("input"),w=v(),k=b("label"),k.textContent="Address of SMPT Server:",A=v(),T=b("input"),P=v(),M=b("label"),M.textContent="SMPT Server Port:",Q=v(),R=b("input"),$=v(),_=b("label"),_.textContent="User Name:",D=v(),E=b("input"),N=v(),B=b("label"),B.textContent="Password:",I=v(),z=b("input"),L=v(),W=b("label"),W.textContent="Signiture:",V=v(),j=b("textarea"),q=v(),H=b("label"),H.textContent="Header HTML:",X=v(),F=b("textarea"),Z=v(),G=b("label"),G.textContent="Footer HTML:",U=v(),Y=b("textarea"),K=v(),J=b("div"),tt=b("button"),et=O("Save"),it=v(),nt=b("button"),rt=O("Cancel"),x(i,"for","accountDefaultInput"),x(i,"class","newAccountLabel svelte-1fv5snm"),x(s,"id","accountDefaultInput"),x(s,"type","checkbox"),x(s,"class","svelte-1fv5snm"),x(l,"for","accountNameInput"),x(l,"class","newAccountLabel svelte-1fv5snm"),x(h,"id","accountNameInput"),C(h,"background-color",t[28].textAreaColor),C(h,"color",t[28].textColor),C(h,"border-color",t[28].borderColor),x(h,"class","svelte-1fv5snm"),x(u,"for","accountFromInput"),x(u,"class","newAccountLabel svelte-1fv5snm"),x(m,"id","accountFromInput"),C(m,"background-color",t[28].textAreaColor),C(m,"color",t[28].textColor),C(m,"border-color",t[28].borderColor),x(m,"class","svelte-1fv5snm"),x(k,"for","accountSmptServerInput"),x(k,"class","newAccountLabel svelte-1fv5snm"),x(T,"id","accountSmptServerInput"),C(T,"background-color",t[28].textAreaColor),C(T,"color",t[28].textColor),C(T,"border-color",t[28].borderColor),x(T,"class","svelte-1fv5snm"),x(M,"for","accountPortInput"),x(M,"class","newAccountLabel svelte-1fv5snm"),x(R,"id","accountPortInput"),C(R,"background-color",t[28].textAreaColor),C(R,"color",t[28].textColor),C(R,"border-color",t[28].borderColor),x(R,"class","svelte-1fv5snm"),x(_,"for","accountUsernameInput"),x(_,"class","newAccountLabel svelte-1fv5snm"),x(E,"id","accountUsernameInput"),C(E,"background-color",t[28].textAreaColor),C(E,"color",t[28].textColor),C(E,"border-color",t[28].borderColor),x(E,"class","svelte-1fv5snm"),x(B,"for","accountPasswordInput"),x(B,"class","newAccountLabel svelte-1fv5snm"),x(z,"id","accountPasswordInput"),C(z,"background-color",t[28].textAreaColor),C(z,"color",t[28].textColor),C(z,"border-color",t[28].borderColor),x(z,"class","svelte-1fv5snm"),x(W,"for","accountSigInput"),x(W,"class","newAccountLabel svelte-1fv5snm"),x(j,"id","accountSigInput"),C(j,"background-color",t[28].textAreaColor),C(j,"color",t[28].textColor),C(j,"border-color",t[28].borderColor),x(j,"class","svelte-1fv5snm"),x(H,"for","accountHeaderHTMLInput"),x(H,"class","newAccountLabel svelte-1fv5snm"),x(F,"id","accountHeaderHTMLInput"),C(F,"background-color",t[28].textAreaColor),C(F,"color",t[28].textColor),C(F,"border-color",t[28].borderColor),x(F,"class","svelte-1fv5snm"),x(G,"for","accountFooterHTMLInput"),x(G,"class","newAccountLabel svelte-1fv5snm"),x(Y,"id","accountFooterHTMLInput"),C(Y,"background-color",t[28].textAreaColor),C(Y,"color",t[28].textColor),C(Y,"border-color",t[28].borderColor),x(Y,"class","svelte-1fv5snm"),x(tt,"id","save"),C(tt,"background-color",t[28].textAreaColor),C(tt,"color",t[28].textColor),C(tt,"border-color",t[28].borderColor),x(tt,"class","svelte-1fv5snm"),x(nt,"id","cancel"),C(nt,"background-color",t[28].textAreaColor),C(nt,"color",t[28].textColor),C(nt,"border-color",t[28].borderColor),x(nt,"class","svelte-1fv5snm"),x(J,"id","buttonrow"),C(J,"grid-column","1 / span 2"),x(J,"class","svelte-1fv5snm"),x(e,"id","newAccountDialog"),C(e,"background-color",t[28].backgroundColor),C(e,"color",t[28].textColor),C(e,"border-color",t[28].borderColor),x(e,"class","svelte-1fv5snm")},m(n,g){p(n,e,g),d(e,i),d(e,r),d(e,s),s.checked=t[16],d(e,o),d(e,l),d(e,a),d(e,h),S(h,t[8]),d(e,c),d(e,u),d(e,f),d(e,m),S(m,t[7]),d(e,w),d(e,k),d(e,A),d(e,T),S(T,t[10]),d(e,P),d(e,M),d(e,Q),d(e,R),S(R,t[12]),d(e,$),d(e,_),d(e,D),d(e,E),S(E,t[9]),d(e,N),d(e,B),d(e,I),d(e,z),S(z,t[11]),d(e,L),d(e,W),d(e,V),d(e,j),S(j,t[13]),d(e,q),d(e,H),d(e,X),d(e,F),S(F,t[14]),d(e,Z),d(e,G),d(e,U),d(e,Y),S(Y,t[15]),d(e,K),d(e,J),d(J,tt),d(tt,et),d(J,it),d(J,nt),d(nt,rt),st||(ot=[y(s,"change",t[53]),y(h,"input",t[54]),y(m,"input",t[55]),y(T,"input",t[56]),y(R,"input",t[57]),y(E,"input",t[58]),y(z,"input",t[59]),y(j,"input",t[60]),y(F,"input",t[61]),y(Y,"input",t[62]),y(tt,"click",t[43]),y(nt,"click",t[45])],st=!0)},p(t,i){65536&i[0]&&(s.checked=t[16]),268435456&i[0]&&C(h,"background-color",t[28].textAreaColor),268435456&i[0]&&C(h,"color",t[28].textColor),268435456&i[0]&&C(h,"border-color",t[28].borderColor),256&i[0]&&h.value!==t[8]&&S(h,t[8]),268435456&i[0]&&C(m,"background-color",t[28].textAreaColor),268435456&i[0]&&C(m,"color",t[28].textColor),268435456&i[0]&&C(m,"border-color",t[28].borderColor),128&i[0]&&m.value!==t[7]&&S(m,t[7]),268435456&i[0]&&C(T,"background-color",t[28].textAreaColor),268435456&i[0]&&C(T,"color",t[28].textColor),268435456&i[0]&&C(T,"border-color",t[28].borderColor),1024&i[0]&&T.value!==t[10]&&S(T,t[10]),268435456&i[0]&&C(R,"background-color",t[28].textAreaColor),268435456&i[0]&&C(R,"color",t[28].textColor),268435456&i[0]&&C(R,"border-color",t[28].borderColor),4096&i[0]&&R.value!==t[12]&&S(R,t[12]),268435456&i[0]&&C(E,"background-color",t[28].textAreaColor),268435456&i[0]&&C(E,"color",t[28].textColor),268435456&i[0]&&C(E,"border-color",t[28].borderColor),512&i[0]&&E.value!==t[9]&&S(E,t[9]),268435456&i[0]&&C(z,"background-color",t[28].textAreaColor),268435456&i[0]&&C(z,"color",t[28].textColor),268435456&i[0]&&C(z,"border-color",t[28].borderColor),2048&i[0]&&z.value!==t[11]&&S(z,t[11]),268435456&i[0]&&C(j,"background-color",t[28].textAreaColor),268435456&i[0]&&C(j,"color",t[28].textColor),268435456&i[0]&&C(j,"border-color",t[28].borderColor),8192&i[0]&&S(j,t[13]),268435456&i[0]&&C(F,"background-color",t[28].textAreaColor),268435456&i[0]&&C(F,"color",t[28].textColor),268435456&i[0]&&C(F,"border-color",t[28].borderColor),16384&i[0]&&S(F,t[14]),268435456&i[0]&&C(Y,"background-color",t[28].textAreaColor),268435456&i[0]&&C(Y,"color",t[28].textColor),268435456&i[0]&&C(Y,"border-color",t[28].borderColor),32768&i[0]&&S(Y,t[15]),268435456&i[0]&&C(tt,"background-color",t[28].textAreaColor),268435456&i[0]&&C(tt,"color",t[28].textColor),268435456&i[0]&&C(tt,"border-color",t[28].borderColor),268435456&i[0]&&C(nt,"background-color",t[28].textAreaColor),268435456&i[0]&&C(nt,"color",t[28].textColor),268435456&i[0]&&C(nt,"border-color",t[28].borderColor),268435456&i[0]&&C(e,"background-color",t[28].backgroundColor),268435456&i[0]&&C(e,"color",t[28].textColor),268435456&i[0]&&C(e,"border-color",t[28].borderColor)},d(t){t&&g(e),st=!1,n(ot)}}}function GK(t){let e,i,r,s,o,l,a,h,c,u,f,w,k,S,A,T,P,M,Q,R,$,_,D;function E(t,e){return void 0!==t[27]?YK:UK}let N=E(t),B=N(t),I=t[3],z=[];for(let e=0;e<I.length;e+=1)z[e]=KK(FK(t,I,e));return{c(){e=b("div"),i=b("h1"),i.textContent="Email It - Change Account",r=v(),B.c(),s=v(),o=b("div");for(let t=0;t<z.length;t+=1)z[t].c();l=v(),a=b("div"),h=b("button"),c=O("Save"),u=v(),f=b("button"),w=O("New"),k=v(),S=b("button"),A=O("Edit"),T=v(),P=b("button"),M=O("Cancel"),Q=v(),R=b("button"),$=O("Delete"),x(i,"class","svelte-1fv5snm"),x(o,"id","AccountsList"),x(o,"class","svelte-1fv5snm"),x(h,"id","save"),C(h,"background-color",t[28].textAreaColor),C(h,"color",t[28].textColor),C(h,"border-color",t[28].borderColor),x(h,"class","svelte-1fv5snm"),x(f,"id","new"),C(f,"background-color",t[28].textAreaColor),C(f,"color",t[28].textColor),C(f,"border-color",t[28].borderColor),x(f,"class","svelte-1fv5snm"),x(S,"id","edit"),C(S,"background-color",t[28].textAreaColor),C(S,"color",t[28].textColor),C(S,"border-color",t[28].borderColor),x(S,"class","svelte-1fv5snm"),x(P,"id","cancel"),C(P,"background-color",t[28].textAreaColor),C(P,"color",t[28].textColor),C(P,"border-color",t[28].borderColor),x(P,"class","svelte-1fv5snm"),x(R,"id","delete"),C(R,"background-color",t[28].textAreaColor),C(R,"color",t[28].textColor),C(R,"border-color",t[28].borderColor),x(R,"class","svelte-1fv5snm"),x(a,"id","buttonrow"),x(a,"class","svelte-1fv5snm"),x(e,"id","accountsDiv"),C(e,"background-color",t[28].backgroundColor),C(e,"color",t[28].textColor),C(e,"border-color",t[28].borderColor),x(e,"class","svelte-1fv5snm")},m(n,g){p(n,e,g),d(e,i),d(e,r),B.m(e,null),d(e,s),d(e,o);for(let t=0;t<z.length;t+=1)z[t].m(o,null);d(e,l),d(e,a),d(a,h),d(h,c),d(a,u),d(a,f),d(f,w),d(a,k),d(a,S),d(S,A),d(a,T),d(a,P),d(P,M),d(a,Q),d(a,R),d(R,$),_||(D=[y(h,"click",t[35]),y(f,"click",t[36]),y(S,"click",t[46]),y(P,"click",t[37]),y(R,"click",t[44])],_=!0)},p(t,i){if(N===(N=E(t))&&B?B.p(t,i):(B.d(1),B=N(t),B&&(B.c(),B.m(e,s))),268435464&i[0]|128&i[1]){let e;for(I=t[3],e=0;e<I.length;e+=1){const n=FK(t,I,e);z[e]?z[e].p(n,i):(z[e]=KK(n),z[e].c(),z[e].m(o,null))}for(;e<z.length;e+=1)z[e].d(1);z.length=I.length}268435456&i[0]&&C(h,"background-color",t[28].textAreaColor),268435456&i[0]&&C(h,"color",t[28].textColor),268435456&i[0]&&C(h,"border-color",t[28].borderColor),268435456&i[0]&&C(f,"background-color",t[28].textAreaColor),268435456&i[0]&&C(f,"color",t[28].textColor),268435456&i[0]&&C(f,"border-color",t[28].borderColor),268435456&i[0]&&C(S,"background-color",t[28].textAreaColor),268435456&i[0]&&C(S,"color",t[28].textColor),268435456&i[0]&&C(S,"border-color",t[28].borderColor),268435456&i[0]&&C(P,"background-color",t[28].textAreaColor),268435456&i[0]&&C(P,"color",t[28].textColor),268435456&i[0]&&C(P,"border-color",t[28].borderColor),268435456&i[0]&&C(R,"background-color",t[28].textAreaColor),268435456&i[0]&&C(R,"color",t[28].textColor),268435456&i[0]&&C(R,"border-color",t[28].borderColor),268435456&i[0]&&C(e,"background-color",t[28].backgroundColor),268435456&i[0]&&C(e,"color",t[28].textColor),268435456&i[0]&&C(e,"border-color",t[28].borderColor)},d(t){t&&g(e),B.d(),m(z,t),_=!1,n(D)}}}function UK(e){let i;return{c(){i=b("h2"),i.textContent="Current Account: Please Create an Account",x(i,"class","svelte-1fv5snm")},m(t,e){p(t,i,e)},p:t,d(t){t&&g(i)}}}function YK(t){let e,i,n,r=t[27].name+"";return{c(){e=b("h2"),i=O("Current Account: "),n=O(r),x(e,"class","svelte-1fv5snm")},m(t,r){p(t,e,r),d(e,i),d(e,n)},p(t,e){134217728&e[0]&&r!==(r=t[27].name+"")&&k(n,r)},d(t){t&&g(e)}}}function KK(t){let e,i,n,r,s,o=t[101].name+"";function l(){return t[63](t[101])}return{c(){e=b("button"),i=O(o),n=v(),C(e,"background-color",t[28].textAreaColor),C(e,"color",t[28].textColor),C(e,"border-color",t[28].borderColor),x(e,"class","svelte-1fv5snm")},m(t,o){p(t,e,o),d(e,i),d(e,n),r||(s=y(e,"click",l),r=!0)},p(n,r){t=n,8&r[0]&&o!==(o=t[101].name+"")&&k(i,o),268435456&r[0]&&C(e,"background-color",t[28].textAreaColor),268435456&r[0]&&C(e,"color",t[28].textColor),268435456&r[0]&&C(e,"border-color",t[28].borderColor)},d(t){t&&g(e),r=!1,s()}}}function JK(t){let e,i,n=t[20],r=[];for(let e=0;e<n.length;e+=1)r[e]=tJ(XK(t,n,e));return{c(){e=b("div"),i=b("ul");for(let t=0;t<r.length;t+=1)r[t].c();x(i,"class","svelte-1fv5snm"),x(e,"id","elist"),C(e,"width",t[26].offsetWidth+"px"),C(e,"left",fJ(t[26]).left+"px"),C(e,"top",fJ(t[26]).top+40+"px"),C(e,"background-color",t[28].textAreaColor),C(e,"color",t[28].textColor),C(e,"border-color",t[28].borderColor),x(e,"class","svelte-1fv5snm")},m(t,n){p(t,e,n),d(e,i);for(let t=0;t<r.length;t+=1)r[t].m(i,null)},p(t,s){if(68157440&s[0]|1&s[1]){let e;for(n=t[20],e=0;e<n.length;e+=1){const o=XK(t,n,e);r[e]?r[e].p(o,s):(r[e]=tJ(o),r[e].c(),r[e].m(i,null))}for(;e<r.length;e+=1)r[e].d(1);r.length=n.length}67108864&s[0]&&C(e,"width",t[26].offsetWidth+"px"),67108864&s[0]&&C(e,"left",fJ(t[26]).left+"px"),67108864&s[0]&&C(e,"top",fJ(t[26]).top+40+"px"),268435456&s[0]&&C(e,"background-color",t[28].textAreaColor),268435456&s[0]&&C(e,"color",t[28].textColor),268435456&s[0]&&C(e,"border-color",t[28].borderColor)},d(t){t&&g(e),m(r,t)}}}function tJ(t){let e,i,n,r,s,o=t[96]+"";function l(){return t[71](t[96])}return{c(){e=b("li"),i=O(o),n=v(),x(e,"class","svelte-1fv5snm")},m(t,o){p(t,e,o),d(e,i),d(e,n),r||(s=y(e,"click",l),r=!0)},p(e,n){t=e,1048576&n[0]&&o!==(o=t[96]+"")&&k(i,o)},d(t){t&&g(e),r=!1,s()}}}function eJ(t){let e,i;return e=new TK({props:{height:"330px",width:"983px",config:t[29],initFinished:t[18],styling:"position: relative; margin-bottom: 20px; border: solid 1px transparent; border-radius: 20px; overflow: hidden;"}}),e.$on("textChange",t[73]),e.$on("editorChange",t[74]),{c(){nt(e.$$.fragment)},m(t,n){rt(e,t,n),i=!0},p(t,i){const n={};262144&i[0]&&(n.initFinished=t[18]),e.$set(n)},i(t){i||(tt(e.$$.fragment,t),i=!0)},o(t){et(e.$$.fragment,t),i=!1},d(t){st(e,t)}}}function iJ(e){let i;return{c(){i=b("div"),x(i,"id","preview"),C(i,"border-color",e[28].textColor),x(i,"class","svelte-1fv5snm")},m(t,n){p(t,i,n),i.innerHTML=e[17]},p(t,e){131072&e[0]&&(i.innerHTML=t[17]),268435456&e[0]&&C(i,"border-color",t[28].textColor)},i:t,o:t,d(t){t&&g(i)}}}function nJ(t){let e,i,r,s,o,l,a;return{c(){e=b("button"),i=O("Edit"),r=v(),s=b("button"),o=O("Send"),x(e,"id","edit"),C(e,"background-color",t[28].textAreaColor),C(e,"color",t[28].textColor),C(e,"border-color",t[28].borderColor),x(e,"class","svelte-1fv5snm"),x(s,"id","send"),C(s,"background-color",t[28].textAreaColor),C(s,"color",t[28].textColor),C(s,"border-color",t[28].borderColor),x(s,"class","svelte-1fv5snm")},m(n,h){p(n,e,h),d(e,i),p(n,r,h),p(n,s,h),d(s,o),l||(a=[y(e,"click",t[40]),y(s,"click",t[41])],l=!0)},p(t,i){268435456&i[0]&&C(e,"background-color",t[28].textAreaColor),268435456&i[0]&&C(e,"color",t[28].textColor),268435456&i[0]&&C(e,"border-color",t[28].borderColor),268435456&i[0]&&C(s,"background-color",t[28].textAreaColor),268435456&i[0]&&C(s,"color",t[28].textColor),268435456&i[0]&&C(s,"border-color",t[28].borderColor)},d(t){t&&g(e),t&&g(r),t&&g(s),l=!1,n(a)}}}function rJ(t){let e,i,n,r;return{c(){e=b("button"),i=O("Preview"),x(e,"id","showPreview"),C(e,"background-color",t[28].textAreaColor),C(e,"color",t[28].textColor),C(e,"border-color",t[28].borderColor),x(e,"class","svelte-1fv5snm")},m(s,o){p(s,e,o),d(e,i),n||(r=y(e,"click",t[39]),n=!0)},p(t,i){268435456&i[0]&&C(e,"background-color",t[28].textAreaColor),268435456&i[0]&&C(e,"color",t[28].textColor),268435456&i[0]&&C(e,"border-color",t[28].borderColor)},d(t){t&&g(e),n=!1,r()}}}function sJ(t){let e,i,n,r,s=t[27].name+"";return{c(){e=b("button"),i=O(s),x(e,"id","account"),C(e,"background-color",t[28].textAreaColor),C(e,"color",t[28].textColor),C(e,"border-color",t[28].borderColor),x(e,"class","svelte-1fv5snm")},m(s,o){p(s,e,o),d(e,i),n||(r=y(e,"click",t[34]),n=!0)},p(t,n){134217728&n[0]&&s!==(s=t[27].name+"")&&k(i,s),268435456&n[0]&&C(e,"background-color",t[28].textAreaColor),268435456&n[0]&&C(e,"color",t[28].textColor),268435456&n[0]&&C(e,"border-color",t[28].borderColor)},d(t){t&&g(e),n=!1,r()}}}function oJ(t){let e,i,n,r;return{c(){e=b("button"),i=O("Create a New Account"),x(e,"id","account"),C(e,"background-color",t[28].textAreaColor),C(e,"color",t[28].textColor),C(e,"border-color",t[28].borderColor),x(e,"class","svelte-1fv5snm")},m(s,o){p(s,e,o),d(e,i),n||(r=y(e,"click",t[36]),n=!0)},p(t,i){268435456&i[0]&&C(e,"background-color",t[28].textAreaColor),268435456&i[0]&&C(e,"color",t[28].textColor),268435456&i[0]&&C(e,"border-color",t[28].borderColor)},d(t){t&&g(e),n=!1,r()}}}function lJ(t){let e,i,n,r,s,o,l,a,h,c,u,f,m=t[19].length>0&&aJ(t);return{c(){e=b("div"),i=b("h1"),n=O(t[21]),r=v(),s=b("p"),o=O(t[22]),l=v(),m&&m.c(),a=v(),h=b("button"),c=O("Close"),x(i,"class","svelte-1fv5snm"),x(h,"class","alertbutton svelte-1fv5snm"),C(h,"background-color",t[28].textAreaColor),C(h,"color",t[28].textColor),C(h,"border-color",t[28].borderColor),C(h,"border-color",t[28].backgroundColor),x(e,"id","alert"),C(e,"background-color",t[28].textAreaColor),C(e,"color",t[28].textColor),C(e,"border-color",t[28].borderColor),x(e,"class","svelte-1fv5snm")},m(g,b){p(g,e,b),d(e,i),d(i,n),d(e,r),d(e,s),d(s,o),d(e,l),m&&m.m(e,null),d(e,a),d(e,h),d(h,c),u||(f=y(h,"click",t[75]),u=!0)},p(t,i){2097152&i[0]&&k(n,t[21]),4194304&i[0]&&k(o,t[22]),t[19].length>0?m?m.p(t,i):(m=aJ(t),m.c(),m.m(e,a)):m&&(m.d(1),m=null),268435456&i[0]&&C(h,"background-color",t[28].textAreaColor),268435456&i[0]&&C(h,"color",t[28].textColor),268435456&i[0]&&C(h,"border-color",t[28].borderColor),268435456&i[0]&&C(h,"border-color",t[28].backgroundColor),268435456&i[0]&&C(e,"background-color",t[28].textAreaColor),268435456&i[0]&&C(e,"color",t[28].textColor),268435456&i[0]&&C(e,"border-color",t[28].borderColor)},d(t){t&&g(e),m&&m.d(),u=!1,f()}}}function aJ(t){let e,i=t[19],n=[];for(let e=0;e<i.length;e+=1)n[e]=hJ(HK(t,i,e));return{c(){e=b("ul");for(let t=0;t<n.length;t+=1)n[t].c();x(e,"class","svelte-1fv5snm")},m(t,i){p(t,e,i);for(let t=0;t<n.length;t+=1)n[t].m(e,null)},p(t,r){if(524288&r[0]){let s;for(i=t[19],s=0;s<i.length;s+=1){const o=HK(t,i,s);n[s]?n[s].p(o,r):(n[s]=hJ(o),n[s].c(),n[s].m(e,null))}for(;s<n.length;s+=1)n[s].d(1);n.length=i.length}},d(t){t&&g(e),m(n,t)}}}function hJ(t){let e,i,n=t[96]+"";return{c(){e=b("li"),i=O(n),x(e,"class","svelte-1fv5snm")},m(t,n){p(t,e,n),d(e,i)},p(t,e){524288&e[0]&&n!==(n=t[96]+"")&&k(i,n)},d(t){t&&g(e)}}}function cJ(t){let e,i,n;function r(e){t[76](e)}let s={};return void 0!==t[25]&&(s.show=t[25]),e=new _K({props:s}),B.push((()=>it(e,"show",r))),{c(){nt(e.$$.fragment)},m(t,i){rt(e,t,i),n=!0},p(t,n){const r={};!i&&33554432&n[0]&&(i=!0,r.show=t[25],H((()=>i=!1))),e.$set(r)},i(t){n||(tt(e.$$.fragment,t),n=!0)},o(t){et(e.$$.fragment,t),n=!1},d(t){st(e,t)}}}function uJ(t){let e,i,r,s,o,l,a,h,c,u,f,m,k,A,T,P,M,Q,R,$,_,D,E,N,B,I,z,L,W,V,j,q,H,X,F,Z,G,U,Y,it,nt,rt,st,ot=t[5]&&ZK(t),lt=t[4]&&GK(t),at=t[24]&&t[20].length>0&&JK(t);const ht=[iJ,eJ],ct=[];function ut(t,e){return t[6]?0:1}function ft(t,e){return"edit"===t[2]?rJ:nJ}Q=ut(t),R=ct[Q]=ht[Q](t);let dt=ft(t),pt=dt(t);function gt(t,e){return void 0===t[27]?oJ:sJ}let mt=gt(t),bt=mt(t),Ot=t[23]&&lJ(t),vt=t[25]&&cJ(t);return{c(){e=b("div"),ot&&ot.c(),i=v(),lt&&lt.c(),r=v(),s=b("h1"),s.textContent="Email It",o=v(),l=b("div"),a=b("div"),h=b("label"),h.textContent="To:",c=v(),u=b("input"),f=v(),at&&at.c(),m=v(),k=b("div"),A=b("label"),A.textContent="Subject:",T=v(),P=b("input"),M=v(),R.c(),$=v(),_=b("div"),D=b("button"),E=O("Notes"),N=v(),pt.c(),B=v(),bt.c(),I=v(),z=b("button"),L=O("Clear"),W=v(),V=b("button"),j=O("Templates"),q=v(),H=b("button"),X=O("Scripts"),F=v(),Z=b("button"),G=O("Address Book"),U=v(),Ot&&Ot.c(),Y=v(),vt&&vt.c(),it=w(),x(s,"class","svelte-1fv5snm"),x(h,"for","receiverInput"),x(h,"class","svelte-1fv5snm"),x(u,"id","receiverInput"),x(u,"class","receiverInput svelte-1fv5snm"),C(u,"background-color",t[28].textAreaColor),C(u,"color",t[28].textColor),C(u,"border-color",t[28].borderColor),x(a,"class","headerRow svelte-1fv5snm"),x(A,"for","subject"),x(A,"class","svelte-1fv5snm"),x(P,"id","subject"),C(P,"background-color",t[28].textAreaColor),C(P,"color",t[28].textColor),C(P,"border-color",t[28].borderColor),x(P,"class","svelte-1fv5snm"),x(k,"class","headerRow svelte-1fv5snm"),x(l,"id","header"),x(l,"class","svelte-1fv5snm"),C(D,"background-color",t[28].textAreaColor),C(D,"color",t[28].textColor),C(D,"border-color",t[28].borderColor),x(D,"class","svelte-1fv5snm"),x(z,"id","clear"),C(z,"background-color",t[28].textAreaColor),C(z,"color",t[28].textColor),C(z,"border-color",t[28].borderColor),x(z,"class","svelte-1fv5snm"),C(V,"background-color",t[28].textAreaColor),C(V,"color",t[28].textColor),C(V,"border-color",t[28].borderColor),x(V,"class","svelte-1fv5snm"),C(H,"background-color",t[28].textAreaColor),C(H,"color",t[28].textColor),C(H,"border-color",t[28].borderColor),x(H,"class","svelte-1fv5snm"),x(Z,"id","addressBook"),C(Z,"background-color",t[28].textAreaColor),C(Z,"color",t[28].textColor),C(Z,"border-color",t[28].borderColor),x(Z,"class","svelte-1fv5snm"),x(_,"id","buttonrow"),x(_,"class","svelte-1fv5snm"),x(e,"id","main"),C(e,"background-color",t[28].backgroundColor),C(e,"font-family",t[28].font),C(e,"color",t[28].textColor),C(e,"font-size",t[28].fontSize),x(e,"class","svelte-1fv5snm")},m(n,g){p(n,e,g),ot&&ot.m(e,null),d(e,i),lt&&lt.m(e,null),d(e,r),d(e,s),d(e,o),d(e,l),d(l,a),d(a,h),d(a,c),d(a,u),S(u,t[0]),t[65](u),d(a,f),at&&at.m(a,null),d(l,m),d(l,k),d(k,A),d(k,T),d(k,P),t[72](P),d(e,M),ct[Q].m(e,null),d(e,$),d(e,_),d(_,D),d(D,E),d(_,N),pt.m(_,null),d(_,B),bt.m(_,null),d(_,I),d(_,z),d(z,L),d(_,W),d(_,V),d(V,j),d(_,q),d(_,H),d(H,X),d(_,F),d(_,Z),d(Z,G),p(n,U,g),Ot&&Ot.m(n,g),p(n,Y,g),vt&&vt.m(n,g),p(n,it,g),nt=!0,rt||(st=[y(u,"input",t[64]),y(u,"blur",t[66]),y(u,"focus",t[67]),y(u,"keydown",t[68]),y(u,"keyup",t[69]),y(u,"change",t[70]),y(P,"blur",t[48]),y(D,"click",t[47]),y(z,"click",t[42]),y(V,"click",t[50]),y(H,"click",t[49]),y(Z,"click",t[52])],rt=!0)},p(t,n){t[5]?ot?ot.p(t,n):(ot=ZK(t),ot.c(),ot.m(e,i)):ot&&(ot.d(1),ot=null),t[4]?lt?lt.p(t,n):(lt=GK(t),lt.c(),lt.m(e,r)):lt&&(lt.d(1),lt=null),(!nt||268435456&n[0])&&C(u,"background-color",t[28].textAreaColor),(!nt||268435456&n[0])&&C(u,"color",t[28].textColor),(!nt||268435456&n[0])&&C(u,"border-color",t[28].borderColor),1&n[0]&&u.value!==t[0]&&S(u,t[0]),t[24]&&t[20].length>0?at?at.p(t,n):(at=JK(t),at.c(),at.m(a,null)):at&&(at.d(1),at=null),(!nt||268435456&n[0])&&C(P,"background-color",t[28].textAreaColor),(!nt||268435456&n[0])&&C(P,"color",t[28].textColor),(!nt||268435456&n[0])&&C(P,"border-color",t[28].borderColor);let s=Q;Q=ut(t),Q===s?ct[Q].p(t,n):(K(),et(ct[s],1,1,(()=>{ct[s]=null})),J(),R=ct[Q],R?R.p(t,n):(R=ct[Q]=ht[Q](t),R.c()),tt(R,1),R.m(e,$)),(!nt||268435456&n[0])&&C(D,"background-color",t[28].textAreaColor),(!nt||268435456&n[0])&&C(D,"color",t[28].textColor),(!nt||268435456&n[0])&&C(D,"border-color",t[28].borderColor),dt===(dt=ft(t))&&pt?pt.p(t,n):(pt.d(1),pt=dt(t),pt&&(pt.c(),pt.m(_,B))),mt===(mt=gt(t))&&bt?bt.p(t,n):(bt.d(1),bt=mt(t),bt&&(bt.c(),bt.m(_,I))),(!nt||268435456&n[0])&&C(z,"background-color",t[28].textAreaColor),(!nt||268435456&n[0])&&C(z,"color",t[28].textColor),(!nt||268435456&n[0])&&C(z,"border-color",t[28].borderColor),(!nt||268435456&n[0])&&C(V,"background-color",t[28].textAreaColor),(!nt||268435456&n[0])&&C(V,"color",t[28].textColor),(!nt||268435456&n[0])&&C(V,"border-color",t[28].borderColor),(!nt||268435456&n[0])&&C(H,"background-color",t[28].textAreaColor),(!nt||268435456&n[0])&&C(H,"color",t[28].textColor),(!nt||268435456&n[0])&&C(H,"border-color",t[28].borderColor),(!nt||268435456&n[0])&&C(Z,"background-color",t[28].textAreaColor),(!nt||268435456&n[0])&&C(Z,"color",t[28].textColor),(!nt||268435456&n[0])&&C(Z,"border-color",t[28].borderColor),(!nt||268435456&n[0])&&C(e,"background-color",t[28].backgroundColor),(!nt||268435456&n[0])&&C(e,"font-family",t[28].font),(!nt||268435456&n[0])&&C(e,"color",t[28].textColor),(!nt||268435456&n[0])&&C(e,"font-size",t[28].fontSize),t[23]?Ot?Ot.p(t,n):(Ot=lJ(t),Ot.c(),Ot.m(Y.parentNode,Y)):Ot&&(Ot.d(1),Ot=null),t[25]?vt?(vt.p(t,n),33554432&n[0]&&tt(vt,1)):(vt=cJ(t),vt.c(),tt(vt,1),vt.m(it.parentNode,it)):vt&&(K(),et(vt,1,1,(()=>{vt=null})),J())},i(t){nt||(tt(R),tt(vt),nt=!0)},o(t){et(R),et(vt),nt=!1},d(i){i&&g(e),ot&&ot.d(),lt&&lt.d(),t[65](null),at&&at.d(),t[72](null),ct[Q].d(),pt.d(),bt.d(),i&&g(U),Ot&&Ot.d(i),i&&g(Y),vt&&vt.d(i),i&&g(it),rt=!1,n(st)}}}function fJ(t){var e=0,i=0;do{e+=t.offsetTop||0,i+=t.offsetLeft||0,t=t.offsetParent}while(t);return{top:e,left:i}}function dJ(t,e,i){let n,r,s,l,a,h,c;o(t,LK,(t=>i(82,n=t))),o(t,qK,(t=>i(83,r=t))),o(t,jK,(t=>i(84,s=t))),o(t,WK,(t=>i(85,l=t))),o(t,zK,(t=>i(27,a=t))),o(t,VK,(t=>i(86,h=t))),o(t,SK,(t=>i(28,c=t)));let u,d,p,g="",m="",b="edit",O=!1,v=!1,w=!1,y="",x="",k="",S="",C="",A="",T="",P="",M="",Q=!1,R="",$="",E="",N=[],I=!0,z=[],L=[],W="",V="",j=!1,q=!1,H=!1;function X(t){if(void 0===t||"Escape"!==t.key&&"Tab"!==t.key){var e=g.toString().toLowerCase(),n="",r=e.split(",");r.length>1?(n=r[r.length-1],i(20,L=N.filter((t=>t.toString().toLowerCase().includes(n.trim()))))):i(20,L=N.filter((t=>t.toString().toLowerCase().includes(e))))}else i(24,q=!1),"Tab"!==t.key&&t.preventDefault()}function F(t){var e=g.split(",");e.length>1?(i(0,g=e.slice(0,e.length-1).map((t=>t.trim())).join(",")+", "+t),i(26,p.selectionStart=g.length,p)):i(0,g=t)}function Z(t){f(WK,l=t,l)}function G(t){f(LK,n.body=t.value,n),$=t.value}function U(){i(8,x=""),i(16,Q=!1),i(7,y=""),i(9,k=""),i(10,S=""),i(11,C=""),i(12,A=""),i(13,T=""),i(14,P=""),i(15,M="")}function Y(t){f(zK,a=t,a),"edit"===b?$=l.getValue():K()}function K(){var t=new BK.Converter({extensions:[]});t.setOption("tables",!0),i(17,R=t.makeHtml($+a.signiture)),void 0!==a.headerHTML&&i(17,R=a.headerHTML+R+a.footerHTML)}function J(){i(21,W="Invalid Emails"),i(22,V="Please fix these emails!"),i(23,j=!0)}function tt(t){var e=!0;return i(19,z=[]),t.toString().split(",").forEach((t=>{const i=function(t){if(t.includes("<")){const e=new RegExp(/^[^<]*\<([^\>]*)\>/),i=t.match(e);t=i[1]}return new RegExp(/^[a-zA-Z0-9][\-_\.\+\!\#\$\%\&\'\*\/\=\?\^\`\{\|]{0,1}([a-zA-Z0-9][\-_\.\+\!\#\$\%\&\'\*\/\=\?\^\`\{\|]{0,1})*[a-zA-Z0-9]@[a-zA-Z0-9][-\.]{0,1}([a-zA-Z][-\.]{0,1})*[a-zA-Z0-9]\.[a-zA-Z0-9]{1,}([\.\-]{0,1}[a-zA-Z]){0,}[a-zA-Z0-9]{0,}$/i).test(t)}(t.trim());i||(e=!1,z.push(t))})),e}function et(){if(null!==l){var t=document.getElementById("receiverInput");f(LK,n.to=t.value,n),f(LK,n.body=l.getValue(),n),f(LK,n.subject=m.value,n)}}function it(){f(LK,n.to=g,n)}_((()=>{!function(t){fetch("http://localhost:9978/api/emailit/emails",{method:"GET",headers:{"Content-type":"application/json"}}).then((t=>t.json())).then((e=>{N=e.emails.map((t=>""===t.name?t.email:`${t.name.trim()} <${t.email.trim()}>`)),void 0!==t&&t()}))}(),function(t){fetch("http://localhost:9978/api/emailit/accounts",{method:"GET",headers:{"Content-type":"application/json"}}).then((t=>t.json())).then((e=>{i(3,u=e),u.length>0&&void 0===a&&f(zK,a=u.find((t=>t.default)),a),void 0!==t&&t()}))}(),i(2,b="edit"),E="edit",i(18,I=!0)})),D((()=>{void 0!==h&&""!==h&&(i(0,g=h),f(LK,n.to=h,n),f(VK,h=void 0,h)),null!==l&&"edit"===b&&"preview"===E&&(l.setValue($),E="edit")}));return[g,m,b,u,O,v,w,y,x,k,S,C,A,T,P,M,Q,R,I,z,L,W,V,j,q,H,p,a,c,{language:"markdown",lineNumbers:!1,lineWrapping:!0,lineHighlight:!0},X,F,Z,G,function(){d=a,i(4,O=!O)},function(){"preview"===b&&K(),i(4,O=!1)},function(){U(),i(5,v=!0)},function(){f(zK,a=d,a),"edit"===b?$=l.getValue():K(),i(4,O=!1)},Y,function(){var t;t=void 0!==n.to?n.to:document.getElementById("receiverInput").value,tt(t)?($=l.getValue(),i(2,b="preview"),E=b,K(),i(6,w=!0)):J()},async function(){i(2,b="edit"),i(6,w=!1)},async function(){var t;if(tt(t=void 0!==n.to?n.to:document.getElementById("receiverInput").value)){t.toString().split(",").forEach((t=>{var e=t,i="";if(t.includes("<")){const n=new RegExp(/^([^<]*)\<([^\>]*)\>/),r=t.match(n);i=r[1],e=r[2]}!function(t,e){e=e.trim(),t=t.trim(),N=N.filter((t=>t.email!==e)),N.push({name:t,email:e}),fetch("http://localhost:9978/api/emailit/addEmail",{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify({name:t,email:e})})}(i,e)}));var e=$+a.signiture.replace(/<hr>/gimu,"\n").replace(/<[/]*[^>]+>/gimu,"");i(6,w=!1),i(2,b="edit"),fetch("http://localhost:9978/api/emailit/send",{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify({acc:a,to:t,from:a.from,subject:m.value,text:e,html:R})})}else J()},function(){document.getElementById("receiverInput").value="",i(0,g=""),i(1,m.value="",m),l.setValue(""),$="",f(LK,n.to="",n),f(LK,n.subject="",n),f(LK,n.body="",n),i(6,w=!1),i(2,b="edit"),E="edit"},function(){var t={name:x,default:Q,from:y,username:k,smtpserver:S,port:A,password:C,signiture:T,headerHTML:P,footerHTML:M};!function(t){fetch("http://localhost:9978/api/emailit/accounts",{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(t)})}(t),Q&&i(3,u=u.map((t=>(t.default=!1,t)))),u.filter((e=>e.name===t.name)).length>0&&(i(3,u=u.filter((e=>e.name!==t.name))),u.push(t)),f(zK,a=t,a),i(3,u),"preview"===b&&K(),U(),i(5,v=!1)},function(){var t=a;i(3,u=u.filter((e=>e.name!==t.name))),u.length>0?(f(zK,a=u[0],a),d=u[0],"preview"===b&&K()):(i(5,v=!1),f(zK,a=void 0,a),d=void 0),function(t){fetch("http://localhost:9978/api/emailit/accounts",{method:"DELETE",headers:{"Content-type":"application/json"},body:t})}(t)},function(){U(),i(5,v=!1)},function(){i(8,x=a.name),i(16,Q=a.default),i(7,y=a.from),i(9,k=a.username),i(10,S=a.smtpserver),i(11,C=a.password),i(12,A=a.port),i(13,T=a.signiture),i(14,P=a.headerHTML),i(15,M=a.footerHTML),i(5,v=!0)},function(){et(),IK.set("notes")},et,function(){f(jK,s=!s,s)},function(){f(qK,r=!r,r)},it,function(){i(25,H=!H)},function(){Q=this.checked,i(16,Q)},function(){x=this.value,i(8,x)},function(){y=this.value,i(7,y)},function(){S=this.value,i(10,S)},function(){A=this.value,i(12,A)},function(){k=this.value,i(9,k)},function(){C=this.value,i(11,C)},function(){T=this.value,i(13,T)},function(){P=this.value,i(14,P)},function(){M=this.value,i(15,M)},t=>{Y(t)},function(){g=this.value,i(0,g)},function(t){B[t?"unshift":"push"]((()=>{p=t,i(26,p)}))},()=>{it()},()=>{i(24,q=!0),X(),i(26,p.selectionStart=g.length,p)},t=>{X(t)},t=>{X(t)},()=>{X()},t=>{F(t),p.focus()},function(t){B[t?"unshift":"push"]((()=>{m=t,i(1,m)}))},t=>{G(t.detail.data)},t=>{Z(t.detail.data)},()=>{i(23,j=!1)},function(t){H=t,i(25,H)}]}class pJ extends lt{constructor(t){super(),ot(this,t,dJ,uJ,s,{},null,[-1,-1,-1,-1])}}function gJ(t){window.runtime.BrowserOpenURL(t)}function mJ(t){let e;return{c(){e=b("div"),x(e,"id","logItems"),x(e,"class","svelte-1p4g52i")},m(i,n){p(i,e,n),e.innerHTML=t[0],t[7](e)},p(t,i){1&i&&(e.innerHTML=t[0])},d(i){i&&g(e),t[7](null)}}}function bJ(e){let i;return{c(){i=b("p"),i.textContent="No Logs"},m(t,e){p(t,i,e)},p:t,d(t){t&&g(i)}}}function OJ(e){let i,r,s,o,l,a,h,c,u,f,m,w,k,S,A,T;function P(t,e){return void 0===t[0]?bJ:mJ}let M=P(e),Q=M(e);return{c(){i=b("div"),Q.c(),r=v(),s=b("div"),o=b("button"),l=O("EmailIt"),a=v(),h=b("button"),c=O("Notes"),u=v(),f=b("button"),m=O("Node-Red"),w=v(),k=b("button"),S=O("Node-Red Dashboard"),C(o,"background-color",e[2].textAreaColor),C(o,"color",e[2].textColor),C(o,"border-color",e[2].borderColor),x(o,"class","svelte-1p4g52i"),C(h,"background-color",e[2].textAreaColor),C(h,"color",e[2].textColor),C(h,"border-color",e[2].borderColor),x(h,"class","svelte-1p4g52i"),C(f,"background-color",e[2].textAreaColor),C(f,"color",e[2].textColor),C(f,"border-color",e[2].borderColor),x(f,"class","svelte-1p4g52i"),C(k,"background-color",e[2].textAreaColor),C(k,"color",e[2].textColor),C(k,"border-color",e[2].borderColor),x(k,"class","svelte-1p4g52i"),x(s,"id","buttonRow"),x(s,"class","svelte-1p4g52i"),x(i,"id","log"),C(i,"background-color",e[2].backgroundColor),C(i,"font-family",e[2].font),C(i,"color",e[2].textColor),C(i,"font-size",e[2].fontSize),x(i,"class","svelte-1p4g52i")},m(t,n){p(t,i,n),Q.m(i,null),d(i,r),d(i,s),d(s,o),d(o,l),d(s,a),d(s,h),d(h,c),d(s,u),d(s,f),d(f,m),d(s,w),d(s,k),d(k,S),A||(T=[y(o,"click",e[3]),y(h,"click",e[4]),y(f,"click",e[5]),y(k,"click",e[6])],A=!0)},p(t,[e]){M===(M=P(t))&&Q?Q.p(t,e):(Q.d(1),Q=M(t),Q&&(Q.c(),Q.m(i,r))),4&e&&C(o,"background-color",t[2].textAreaColor),4&e&&C(o,"color",t[2].textColor),4&e&&C(o,"border-color",t[2].borderColor),4&e&&C(h,"background-color",t[2].textAreaColor),4&e&&C(h,"color",t[2].textColor),4&e&&C(h,"border-color",t[2].borderColor),4&e&&C(f,"background-color",t[2].textAreaColor),4&e&&C(f,"color",t[2].textColor),4&e&&C(f,"border-color",t[2].borderColor),4&e&&C(k,"background-color",t[2].textAreaColor),4&e&&C(k,"color",t[2].textColor),4&e&&C(k,"border-color",t[2].borderColor),4&e&&C(i,"background-color",t[2].backgroundColor),4&e&&C(i,"font-family",t[2].font),4&e&&C(i,"color",t[2].textColor),4&e&&C(i,"font-size",t[2].fontSize)},i:t,o:t,d(t){t&&g(i),Q.d(),A=!1,n(T)}}}function vJ(t,e,i){let n,r,s;return o(t,SK,(t=>i(2,n=t))),_((()=>{!function(t){fetch("http://localhost:9978/api/messages",{method:"GET",headers:{"Content-type":"application/json"}}).then((t=>t.json())).then((e=>{i(0,r=function(t){var e="";return t.map((t=>e+="<p>"+t.replaceAll(" ","&nbsp;").replaceAll("\n","<br />").replaceAll("\t","&nbsp;&nbsp;")+"</p>")),e}(e.data)),void 0!==t&&t()}))}()})),D((()=>{void 0!==s&&i(1,s.scrollTop=s.scrollHeight,s)})),[r,s,n,function(){IK.set("emailit")},function(){IK.set("notes")},async function(){gJ("http://localhost:9978/red/admin")},async function(){gJ("http://localhost:9978/red/api/ui")},function(t){B[t?"unshift":"push"]((()=>{s=t,i(1,s)}))}]}class wJ extends lt{constructor(t){super(),ot(this,t,vJ,OJ,s,{})}}const yJ=kK(0),xJ=kK(["","","","","","","","","",""]),kJ=kK(["","","","","","","","","",""]),SJ=kK(void 0);function CJ(t,e,i){const n=t.slice();return n[27]=e[i],n[29]=i,n}function AJ(t){let e,i,n,r;function s(){return t[15](t[29])}return{c(){e=b("div"),x(e,"class",i="noteButton "+(t[1]===t[2].buttons[t[29]].id?"selectedButton":"")+" svelte-yyde1d"),C(e,"background-color",t[2].buttons[t[29]].color)},m(t,i){p(t,e,i),n||(r=y(e,"click",s),n=!0)},p(n,r){t=n,6&r&&i!==(i="noteButton "+(t[1]===t[2].buttons[t[29]].id?"selectedButton":"")+" svelte-yyde1d")&&x(e,"class",i),4&r&&C(e,"background-color",t[2].buttons[t[29]].color)},d(t){t&&g(e),n=!1,r()}}}function TJ(t){let e,i,r,s,o,l,a,h,c,u,f,w,k,S,A,T,P,M,Q,R,$,_,D,E,N,B,I;r=new TK({props:{height:"500px",width:"900px",config:t[3],initFinished:t[0]}}),r.$on("textChange",t[13]),r.$on("editorChange",t[14]);let z=t[2].buttons,L=[];for(let e=0;e<z.length;e+=1)L[e]=AJ(CJ(t,z,e));return{c(){e=b("div"),i=b("div"),nt(r.$$.fragment),s=v(),o=b("div");for(let t=0;t<L.length;t+=1)L[t].c();l=v(),a=b("div"),h=b("button"),c=O("EmailIt"),u=v(),f=b("button"),w=O("Logs"),k=v(),S=b("button"),A=O("Scripts"),T=v(),P=b("button"),M=O("Templates"),Q=v(),R=b("button"),$=O("Edit Scripts"),_=v(),D=b("button"),E=O("Edit Templates"),x(o,"id","noteButtons"),x(o,"class","svelte-yyde1d"),x(i,"id","editorRow"),x(i,"class","svelte-yyde1d"),C(h,"background-color",t[2].textAreaColor),C(h,"color",t[2].textColor),C(h,"border-color",t[2].borderColor),x(h,"class","svelte-yyde1d"),C(f,"background-color",t[2].textAreaColor),C(f,"color",t[2].textColor),C(f,"border-color",t[2].borderColor),x(f,"class","svelte-yyde1d"),C(S,"background-color",t[2].textAreaColor),C(S,"color",t[2].textColor),C(S,"border-color",t[2].borderColor),x(S,"class","svelte-yyde1d"),C(P,"background-color",t[2].textAreaColor),C(P,"color",t[2].textColor),C(P,"border-color",t[2].borderColor),x(P,"class","svelte-yyde1d"),C(R,"background-color",t[2].textAreaColor),C(R,"color",t[2].textColor),C(R,"border-color",t[2].borderColor),x(R,"class","svelte-yyde1d"),C(D,"background-color",t[2].textAreaColor),C(D,"color",t[2].textColor),C(D,"border-color",t[2].borderColor),x(D,"class","svelte-yyde1d"),x(a,"id","buttonRow"),x(a,"class","svelte-yyde1d"),x(e,"id","notes"),C(e,"background-color",t[2].backgroundColor),C(e,"font-family",t[2].font),C(e,"color",t[2].textColor),C(e,"font-size",t[2].fontSize),x(e,"class","svelte-yyde1d")},m(n,g){p(n,e,g),d(e,i),rt(r,i,null),d(i,s),d(i,o);for(let t=0;t<L.length;t+=1)L[t].m(o,null);d(e,l),d(e,a),d(a,h),d(h,c),d(a,u),d(a,f),d(f,w),d(a,k),d(a,S),d(S,A),d(a,T),d(a,P),d(P,M),d(a,Q),d(a,R),d(R,$),d(a,_),d(a,D),d(D,E),N=!0,B||(I=[y(h,"click",t[7]),y(f,"click",t[6]),y(S,"click",t[9]),y(P,"click",t[10]),y(R,"click",t[12]),y(D,"click",t[11])],B=!0)},p(t,[i]){const n={};if(1&i&&(n.initFinished=t[0]),r.$set(n),262&i){let e;for(z=t[2].buttons,e=0;e<z.length;e+=1){const n=CJ(t,z,e);L[e]?L[e].p(n,i):(L[e]=AJ(n),L[e].c(),L[e].m(o,null))}for(;e<L.length;e+=1)L[e].d(1);L.length=z.length}(!N||4&i)&&C(h,"background-color",t[2].textAreaColor),(!N||4&i)&&C(h,"color",t[2].textColor),(!N||4&i)&&C(h,"border-color",t[2].borderColor),(!N||4&i)&&C(f,"background-color",t[2].textAreaColor),(!N||4&i)&&C(f,"color",t[2].textColor),(!N||4&i)&&C(f,"border-color",t[2].borderColor),(!N||4&i)&&C(S,"background-color",t[2].textAreaColor),(!N||4&i)&&C(S,"color",t[2].textColor),(!N||4&i)&&C(S,"border-color",t[2].borderColor),(!N||4&i)&&C(P,"background-color",t[2].textAreaColor),(!N||4&i)&&C(P,"color",t[2].textColor),(!N||4&i)&&C(P,"border-color",t[2].borderColor),(!N||4&i)&&C(R,"background-color",t[2].textAreaColor),(!N||4&i)&&C(R,"color",t[2].textColor),(!N||4&i)&&C(R,"border-color",t[2].borderColor),(!N||4&i)&&C(D,"background-color",t[2].textAreaColor),(!N||4&i)&&C(D,"color",t[2].textColor),(!N||4&i)&&C(D,"border-color",t[2].borderColor),(!N||4&i)&&C(e,"background-color",t[2].backgroundColor),(!N||4&i)&&C(e,"font-family",t[2].font),(!N||4&i)&&C(e,"color",t[2].textColor),(!N||4&i)&&C(e,"font-size",t[2].fontSize)},i(t){N||(tt(r.$$.fragment,t),N=!0)},o(t){et(r.$$.fragment,t),N=!1},d(t){t&&g(e),st(r),m(L,t),B=!1,n(I)}}}function PJ(t,e,i){let n,r,s,l,a,h,c,u;o(t,IK,(t=>i(16,n=t))),o(t,qK,(t=>i(17,r=t))),o(t,jK,(t=>i(18,s=t))),o(t,SJ,(t=>i(19,l=t))),o(t,yJ,(t=>i(1,a=t))),o(t,kJ,(t=>i(20,h=t))),o(t,xJ,(t=>i(21,c=t))),o(t,SK,(t=>i(2,u=t)));let d=!1;function p(t,e){fetch(`http://localhost:9978/api/note/${t}/w`,{method:"GET",headers:{"Content-type":"application/json"}}).then((t=>t.json())).then((i=>{f(xJ,c[t]=i.note,c),void 0!==e&&e()}))}function g(t){f(SJ,l=t,l)}function m(t){f(xJ,c[a]=t.value,c),f(kJ,h[a]=t.cursor,h),function(t){var e=c[t];fetch(`http://localhost:9978/api/note/${t}/w`,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify({note:e})})}(a)}function b(){null!==l&&l.focus()}function O(){f(kJ,h[a]=l.getCursor(),h)}function v(t){f(yJ,a=t,a),l.setValue(c[a]);var e=parseInt(h[a]);Number.isInteger(e)||(e=0),l.setCursor(e),b()}_((()=>{p(0),p(1),p(2),p(3),p(4),p(5),p(6),p(7),p(8),p(9,(async()=>{i(0,d=!0),await j(),v(a),b()}))}));return[d,a,u,{language:"markdown",lineNumbers:!0,lineWrapping:!0,lineHighlight:!0},g,m,function(){O(),f(IK,n="viewlog",n)},function(){O(),f(IK,n="emailit",n)},v,function(){f(jK,s=!s,s)},function(){f(qK,r=!r,r)},function(){f(IK,n="templates",n)},function(){f(IK,n="scripts",n)},t=>{m(t.detail.data)},t=>{g(t.detail.data)},t=>{v(t)}]}class MJ extends lt{constructor(t){super(),ot(this,t,PJ,TJ,s,{})}}const QJ=kK([]),RJ=kK(void 0),$J=kK(void 0);function _J(t,e,i){const n=t.slice();return n[20]=e[i],n[22]=i,n}function DJ(t){let e,i=t[2],n=[];for(let e=0;e<i.length;e+=1)n[e]=EJ(_J(t,i,e));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=w()},m(t,i){for(let e=0;e<n.length;e+=1)n[e].m(t,i);p(t,e,i)},p(t,r){if(212&r){let s;for(i=t[2],s=0;s<i.length;s+=1){const o=_J(t,i,s);n[s]?n[s].p(o,r):(n[s]=EJ(o),n[s].c(),n[s].m(e.parentNode,e))}for(;s<n.length;s+=1)n[s].d(1);n.length=i.length}},d(t){m(n,t),t&&g(e)}}}function EJ(t){let e,i,n,r,s,o=t[20].name+"";function l(){return t[11](t[20])}return{c(){e=b("li"),i=O(o),n=v(),C(e,"background-color",t[4]===t[22]?t[6].Purple:"transparent"),x(e,"data-key",t[22]),x(e,"class","svelte-n0htir")},m(t,o){p(t,e,o),d(e,i),d(e,n),r||(s=y(e,"click",l),r=!0)},p(n,r){t=n,4&r&&o!==(o=t[20].name+"")&&k(i,o),80&r&&C(e,"background-color",t[4]===t[22]?t[6].Purple:"transparent")},d(t){t&&g(e),r=!1,s()}}}function NJ(e){let i,r,s,o,l,a,h,c="object"==typeof e[5]&&DJ(e);return{c(){i=b("div"),r=b("input"),s=v(),o=b("div"),l=b("ul"),c&&c.c(),x(r,"type","text"),C(r,"background-color",e[6].textAreaColor),C(r,"font-family",e[6].font),C(r,"color",e[6].textColor),C(r,"font-size",e[6].fontSize),C(r,"border","solid 3px "+e[6].borderColor),x(r,"class","svelte-n0htir"),x(l,"class","svelte-n0htir"),x(o,"id","list"),x(o,"class","svelte-n0htir"),x(i,"id","scriptmenu"),C(i,"left",e[1]?"10px":"-900px"),C(i,"background-color",e[6].backgroundColor),C(i,"font-family",e[6].font),C(i,"color",e[6].textColor),C(i,"font-size",e[6].fontSize),C(i,"border","solid 3px "+e[6].borderColor),x(i,"class","svelte-n0htir")},m(t,n){p(t,i,n),d(i,r),S(r,e[0]),e[10](r),d(i,s),d(i,o),d(o,l),c&&c.m(l,null),a||(h=[y(r,"input",e[9]),y(r,"keydown",e[8])],a=!0)},p(t,[e]){64&e&&C(r,"background-color",t[6].textAreaColor),64&e&&C(r,"font-family",t[6].font),64&e&&C(r,"color",t[6].textColor),64&e&&C(r,"font-size",t[6].fontSize),64&e&&C(r,"border","solid 3px "+t[6].borderColor),1&e&&r.value!==t[0]&&S(r,t[0]),"object"==typeof t[5]?c?c.p(t,e):(c=DJ(t),c.c(),c.m(l,null)):c&&(c.d(1),c=null),2&e&&C(i,"left",t[1]?"10px":"-900px"),64&e&&C(i,"background-color",t[6].backgroundColor),64&e&&C(i,"font-family",t[6].font),64&e&&C(i,"color",t[6].textColor),64&e&&C(i,"font-size",t[6].fontSize),64&e&&C(i,"border","solid 3px "+t[6].borderColor)},i:t,o:t,d(t){t&&g(i),e[10](null),c&&c.d(),a=!1,n(h)}}}function BJ(t,e,i){let n,r,s,l,a,h,c,u;o(t,jK,(t=>i(1,n=t))),o(t,RJ,(t=>i(13,r=t))),o(t,IK,(t=>i(14,s=t))),o(t,$J,(t=>i(15,l=t))),o(t,SJ,(t=>i(16,a=t))),o(t,WK,(t=>i(17,h=t))),o(t,QJ,(t=>i(5,c=t))),o(t,SK,(t=>i(6,u=t)));let d,p="",g=[],m=!0,b=0;function O(t){var e=[];return""===t||void 0===t?e=c:(t=t.toLowerCase(),e=c.filter((e=>null!=e&&e.name.toLowerCase().includes(t)))),e=e.sort(((t,e)=>t.name.toLowerCase()>e.name.toLowerCase()))}function v(t){var e="",o=!1;"emailit"===s?h.somethingSelected()?(o=!0,e=h.getSelection()):e=h.getValue():"notes"===s?a.somethingSelected()?(o=!0,e=a.getSelection()):e=a.getValue():"scripts"===s?l.somethingSelected()?(o=!0,e=l.getSelection()):e=l.getValue():"templates"===s&&(r.somethingSelected()?(o=!0,e=r.getSelection()):e=r.getValue()),fetch("http://localhost:9978/api/script/run",{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify({script:t.name,text:e})}).then((t=>t.json())).then((e=>{"emailit"===s?(o?h.replaceSelection(e.text):t.insert?h.insertAtCursor(e.text):h.setValue(e.text),h.focus()):"notes"===s?(o?a.replaceSelection(e.text):t.insert?a.insertAtCursor(e.text):a.setValue(e.text),a.focus()):"scripts"===s?(o?l.replaceSelection(e.text):t.insert?l.insertAtCursor(e.text):l.setValue(e.text),l.focus()):"templates"===s&&(o?r.replaceSelection(e.text):t.insert?r.insertAtCursor(e.text):r.setValue(e.text),r.focus()),f(jK,n=!1,n),i(0,p="")}))}_((()=>{})),D((()=>{n&&m&&(i(2,g=O(p)),m=!1,d.focus())}));return t.$$.update=()=>{1&t.$$.dirty&&i(2,g=O(p)),2&t.$$.dirty&&n&&(i(4,b=0),i(0,p=""),d.focus())},[p,n,g,d,b,c,u,v,function(t){switch(t.key){case"ArrowDown":t.preventDefault(),i(4,b+=1),b>=g.length&&i(4,b=g.length-1);break;case"ArrowUp":t.preventDefault(),i(4,b-=1),b<0&&i(4,b=0);break;case"Enter":t.preventDefault(),v(g[b]);break;case"Escape":f(jK,n=!1,n)}},function(){p=this.value,i(0,p)},function(t){B[t?"unshift":"push"]((()=>{d=t,i(3,d)}))},t=>{v(t)}]}class IJ extends lt{constructor(t){super(),ot(this,t,BJ,NJ,s,{})}}const zJ=kK([]);function LJ(t,e,i){const n=t.slice();return n[20]=e[i],n[22]=i,n}function WJ(t){let e,i=t[2],n=[];for(let e=0;e<i.length;e+=1)n[e]=VJ(LJ(t,i,e));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=w()},m(t,i){for(let e=0;e<n.length;e+=1)n[e].m(t,i);p(t,e,i)},p(t,r){if(212&r){let s;for(i=t[2],s=0;s<i.length;s+=1){const o=LJ(t,i,s);n[s]?n[s].p(o,r):(n[s]=VJ(o),n[s].c(),n[s].m(e.parentNode,e))}for(;s<n.length;s+=1)n[s].d(1);n.length=i.length}},d(t){m(n,t),t&&g(e)}}}function VJ(t){let e,i,n,r,s,o=t[20]+"";function l(){return t[11](t[20])}return{c(){e=b("li"),i=O(o),n=v(),C(e,"background-color",t[4]===t[22]?t[6].Purple:"transparent"),x(e,"data-key",t[22]),x(e,"class","svelte-wbzyyy")},m(t,o){p(t,e,o),d(e,i),d(e,n),r||(s=y(e,"click",l),r=!0)},p(n,r){t=n,4&r&&o!==(o=t[20]+"")&&k(i,o),80&r&&C(e,"background-color",t[4]===t[22]?t[6].Purple:"transparent")},d(t){t&&g(e),r=!1,s()}}}function jJ(e){let i,r,s,o,l,a,h,c="object"==typeof e[5]&&WJ(e);return{c(){i=b("div"),r=b("input"),s=v(),o=b("div"),l=b("ul"),c&&c.c(),x(r,"type","text"),C(r,"background-color",e[6].textAreaColor),C(r,"font-family",e[6].font),C(r,"color",e[6].textColor),C(r,"font-size",e[6].fontSize),C(r,"border","solid 3px "+e[6].borderColor),x(r,"class","svelte-wbzyyy"),x(l,"class","svelte-wbzyyy"),x(o,"id","list"),x(o,"class","svelte-wbzyyy"),x(i,"id","templatemenu"),C(i,"left",e[1]?"10px":"-900px"),C(i,"background-color",e[6].backgroundColor),C(i,"font-family",e[6].font),C(i,"color",e[6].textColor),C(i,"font-size",e[6].fontSize),C(i,"border","solid 3px "+e[6].borderColor),x(i,"class","svelte-wbzyyy")},m(t,n){p(t,i,n),d(i,r),S(r,e[0]),e[10](r),d(i,s),d(i,o),d(o,l),c&&c.m(l,null),a||(h=[y(r,"input",e[9]),y(r,"keydown",e[8])],a=!0)},p(t,[e]){64&e&&C(r,"background-color",t[6].textAreaColor),64&e&&C(r,"font-family",t[6].font),64&e&&C(r,"color",t[6].textColor),64&e&&C(r,"font-size",t[6].fontSize),64&e&&C(r,"border","solid 3px "+t[6].borderColor),1&e&&r.value!==t[0]&&S(r,t[0]),"object"==typeof t[5]?c?c.p(t,e):(c=WJ(t),c.c(),c.m(l,null)):c&&(c.d(1),c=null),2&e&&C(i,"left",t[1]?"10px":"-900px"),64&e&&C(i,"background-color",t[6].backgroundColor),64&e&&C(i,"font-family",t[6].font),64&e&&C(i,"color",t[6].textColor),64&e&&C(i,"font-size",t[6].fontSize),64&e&&C(i,"border","solid 3px "+t[6].borderColor)},i:t,o:t,d(t){t&&g(i),e[10](null),c&&c.d(),a=!1,n(h)}}}function qJ(t,e,i){let n,r,s,l,a,h,c,u;o(t,qK,(t=>i(1,n=t))),o(t,RJ,(t=>i(13,r=t))),o(t,IK,(t=>i(14,s=t))),o(t,$J,(t=>i(15,l=t))),o(t,SJ,(t=>i(16,a=t))),o(t,WK,(t=>i(17,h=t))),o(t,zJ,(t=>i(5,c=t))),o(t,SK,(t=>i(6,u=t)));let d,p="",g=[],m=!0,b=0;function O(t){var e=[];return""===t||void 0===t?e=c:(t=t.toLowerCase(),e=c.filter((e=>null!=e&&e.toLowerCase().includes(t)))),e=e.sort(((t,e)=>t.toLowerCase()>e.toLowerCase()))}function v(t){var e="",o=!1;"emailit"===s?h.somethingSelected()?(o=!0,e=h.getSelection()):e=h.getValue():"notes"===s?a.somethingSelected()?(o=!0,e=a.getSelection()):e=a.getValue():"scripts"===s?l.somethingSelected()?(o=!0,e=l.getSelection()):e=l.getValue():"templates"===s&&(r.somethingSelected()?(o=!0,e=r.getSelection()):e=r.getValue()),fetch("http://localhost:9978/api/template/run",{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify({template:t,text:e})}).then((t=>t.json())).then((t=>{"emailit"===s?(o?h.replaceSelection(t.text):h.setValue(t.text),h.focus()):"notes"===s?(o?a.replaceSelection(t.text):a.setValue(t.text),a.focus()):"scripts"===s?(o?l.replaceSelection(t.text):l.setValue(t.text),l.focus()):"templates"===s&&(o?r.replaceSelection(t.text):r.setValue(t.text),r.focus()),f(qK,n=!1,n),i(0,p="")}))}_((()=>{})),D((()=>{n&&m&&(i(2,g=O(p)),m=!1,d.focus())}));return t.$$.update=()=>{1&t.$$.dirty&&i(2,g=O(p)),2&t.$$.dirty&&n&&(i(4,b=0),i(0,p=""),d.focus())},[p,n,g,d,b,c,u,v,function(t){switch(t.key){case"ArrowDown":t.preventDefault(),i(4,b+=1),b>=g.length&&i(4,b=g.length-1);break;case"ArrowUp":t.preventDefault(),i(4,b-=1),b<0&&i(4,b=0);break;case"Enter":t.preventDefault(),v(g[b]);break;case"Escape":f(qK,n=!1,n)}},function(){p=this.value,i(0,p)},function(t){B[t?"unshift":"push"]((()=>{d=t,i(3,d)}))},t=>{v(t)}]}class HJ extends lt{constructor(t){super(),ot(this,t,qJ,jJ,s,{})}}const XJ=t=>({noResultsText:2048&t[0]}),FJ=t=>({noResultsText:t[11]}),ZJ=t=>({createText:8192&t[0]}),GJ=t=>({createText:t[13]}),UJ=t=>({loadingText:4096&t[0]}),YJ=t=>({loadingText:t[12]});function KJ(t,e,i){const n=t.slice();return n[107]=e[i],n[109]=i,n}const JJ=t=>({item:1&t[1],label:1&t[1]}),t0=t=>({item:t[107].item,label:t[107].highlighted?t[107].highlighted.label:t[107].label});function e0(t,e,i){const n=t.slice();return n[110]=e[i],n}const i0=t=>({label:2&t[0],item:2&t[0]}),n0=t=>({label:t[35](t[110]),item:t[110],unselectItem:t[42]});function r0(t,e,i){const n=t.slice();return n[109]=e[i],n}function s0(t){let e,i=t[1],n=[];for(let e=0;e<i.length;e+=1)n[e]=l0(r0(t,i,e));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=w()},m(t,i){for(let e=0;e<n.length;e+=1)n[e].m(t,i);p(t,e,i)},p(t,r){if(18&r[0]|16&r[1]){let s;for(i=t[1],s=0;s<i.length;s+=1){const o=r0(t,i,s);n[s]?n[s].p(o,r):(n[s]=l0(o),n[s].c(),n[s].m(e.parentNode,e))}for(;s<n.length;s+=1)n[s].d(1);n.length=i.length}},d(t){m(n,t),t&&g(e)}}}function o0(t){let e,i;return{c(){e=b("option"),i=O(t[3]),e.__value=t[2],e.value=e.__value,e.selected=!0,x(e,"class","svelte-xmtx21")},m(t,n){p(t,e,n),d(e,i)},p(t,n){8&n[0]&&k(i,t[3]),22&n[0]&&(e.__value=t[2],e.value=e.__value)},d(t){t&&g(e)}}}function l0(t){let e,i,n,r,s=t[35](t[109])+"";return{c(){e=b("option"),i=O(s),n=v(),e.__value=r=t[4](t[109],!0),e.value=e.__value,e.selected=!0,x(e,"class","svelte-xmtx21")},m(t,r){p(t,e,r),d(e,i),d(e,n)},p(t,n){2&n[0]&&s!==(s=t[35](t[109])+"")&&k(i,s),18&n[0]&&r!==(r=t[4](t[109],!0))&&(e.__value=r,e.value=e.__value)},d(t){t&&g(e)}}}function a0(t){let e,i,n=t[1],r=[];for(let e=0;e<n.length;e+=1)r[e]=h0(e0(t,n,e));const s=t=>et(r[t],1,1,(()=>{r[t]=null}));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=w()},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);p(t,e,n),i=!0},p(t,i){if(2&i[0]|2064&i[1]|2048&i[2]){let o;for(n=t[1],o=0;o<n.length;o+=1){const s=e0(t,n,o);r[o]?(r[o].p(s,i),tt(r[o],1)):(r[o]=h0(s),r[o].c(),tt(r[o],1),r[o].m(e.parentNode,e))}for(K(),o=n.length;o<r.length;o+=1)s(o);J()}},i(t){if(!i){for(let t=0;t<n.length;t+=1)tt(r[t]);i=!0}},o(t){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)et(r[t]);i=!1},d(t){m(r,t),t&&g(e)}}}function h0(t){let e;const i=t[74].tag,n=l(i,t,t[73],n0),r=n||function(t){let e,i,n,r,s,o,l,a,h=t[35](t[110])+"";function c(){return t[76](t[110])}return{c(){e=b("div"),i=b("span"),n=O(h),r=v(),s=b("span"),o=v(),x(i,"class","tag svelte-xmtx21"),x(s,"class","tag is-delete svelte-xmtx21"),x(e,"class","tags has-addons svelte-xmtx21")},m(t,h){var u;p(t,e,h),d(e,i),d(i,n),d(e,r),d(e,s),p(t,o,h),l||(a=y(s,"click",(u=c,function(t){return t.preventDefault(),u.call(this,t)})),l=!0)},p(e,i){t=e,2&i[0]&&h!==(h=t[35](t[110])+"")&&k(n,h)},d(t){t&&g(e),t&&g(o),l=!1,a()}}}(t);return{c(){r&&r.c()},m(t,i){r&&r.m(t,i),e=!0},p(t,s){n?n.p&&(!e||2&s[0]|2048&s[2])&&c(n,i,t,t[73],e?h(i,t[73],s,i0):u(t[73]),n0):r&&r.p&&(!e||2&s[0])&&r.p(t,e?s:[-1,-1,-1,-1])},i(t){e||(tt(r,t),e=!0)},o(t){et(r,t),e=!1},d(t){r&&r.d(t)}}}function c0(e){let i,n,r;return{c(){i=b("span"),i.textContent="✖",x(i,"class","autocomplete-clear-button svelte-xmtx21")},m(t,s){p(t,i,s),n||(r=y(i,"click",e[46]),n=!0)},p:t,d(t){t&&g(i),n=!1,r()}}}function u0(t){let e,i;const n=t[74]["no-results"],r=l(n,t,t[73],FJ),s=r||function(t){let e;return{c(){e=O(t[11])},m(t,i){p(t,e,i)},p(t,i){2048&i[0]&&k(e,t[11])},d(t){t&&g(e)}}}(t);return{c(){e=b("div"),s&&s.c(),x(e,"class","autocomplete-list-item-no-results svelte-xmtx21")},m(t,n){p(t,e,n),s&&s.m(e,null),i=!0},p(t,e){r?r.p&&(!i||2048&e[0]|2048&e[2])&&c(r,n,t,t[73],i?h(n,t[73],e,XJ):u(t[73]),FJ):s&&s.p&&(!i||2048&e[0])&&s.p(t,i?e:[-1,-1,-1,-1])},i(t){i||(tt(s,t),i=!0)},o(t){et(s,t),i=!1},d(t){t&&g(e),s&&s.d(t)}}}function f0(t){let e,i,n,r;const s=t[74].create,o=l(s,t,t[73],GJ),a=o||function(t){let e;return{c(){e=O(t[13])},m(t,i){p(t,e,i)},p(t,i){8192&i[0]&&k(e,t[13])},d(t){t&&g(e)}}}(t);return{c(){e=b("div"),a&&a.c(),x(e,"class","autocomplete-list-item-create svelte-xmtx21")},m(s,o){p(s,e,o),a&&a.m(e,null),i=!0,n||(r=y(e,"click",t[36]),n=!0)},p(t,e){o?o.p&&(!i||8192&e[0]|2048&e[2])&&c(o,s,t,t[73],i?h(s,t[73],e,ZJ):u(t[73]),GJ):a&&a.p&&(!i||8192&e[0])&&a.p(t,i?e:[-1,-1,-1,-1])},i(t){i||(tt(a,t),i=!0)},o(t){et(a,t),i=!1},d(t){t&&g(e),a&&a.d(t),n=!1,r()}}}function d0(t){let e,i;const n=t[74].loading,r=l(n,t,t[73],YJ),s=r||function(t){let e;return{c(){e=O(t[12])},m(t,i){p(t,e,i)},p(t,i){4096&i[0]&&k(e,t[12])},d(t){t&&g(e)}}}(t);return{c(){e=b("div"),s&&s.c(),x(e,"class","autocomplete-list-item-loading svelte-xmtx21")},m(t,n){p(t,e,n),s&&s.m(e,null),i=!0},p(t,e){r?r.p&&(!i||4096&e[0]|2048&e[2])&&c(r,n,t,t[73],i?h(n,t[73],e,UJ):u(t[73]),YJ):s&&s.p&&(!i||4096&e[0])&&s.p(t,i?e:[-1,-1,-1,-1])},i(t){i||(tt(s,t),i=!0)},o(t){et(s,t),i=!1},d(t){t&&g(e),s&&s.d(t)}}}function p0(t){let e,i,n,r=t[31],s=[];for(let e=0;e<r.length;e+=1)s[e]=v0(KJ(t,r,e));const o=t=>et(s[t],1,1,(()=>{s[t]=null}));let l=t[5]>0&&t[31].length>t[5]&&w0(t);return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=v(),l&&l.c(),i=w()},m(t,r){for(let e=0;e<s.length;e+=1)s[e].m(t,r);p(t,e,r),l&&l.m(t,r),p(t,i,r),n=!0},p(t,n){if(1073741856&n[0]|131137&n[1]|2048&n[2]){let i;for(r=t[31],i=0;i<r.length;i+=1){const o=KJ(t,r,i);s[i]?(s[i].p(o,n),tt(s[i],1)):(s[i]=v0(o),s[i].c(),tt(s[i],1),s[i].m(e.parentNode,e))}for(K(),i=r.length;i<s.length;i+=1)o(i);J()}t[5]>0&&t[31].length>t[5]?l?l.p(t,n):(l=w0(t),l.c(),l.m(i.parentNode,i)):l&&(l.d(1),l=null)},i(t){if(!n){for(let t=0;t<r.length;t+=1)tt(s[t]);n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)et(s[t]);n=!1},d(t){m(s,t),t&&g(e),l&&l.d(t),t&&g(i)}}}function g0(t){let e,i,n=t[107]&&m0(t);return{c(){n&&n.c(),e=w()},m(t,r){n&&n.m(t,r),p(t,e,r),i=!0},p(t,i){t[107]?n?(n.p(t,i),1&i[1]&&tt(n,1)):(n=m0(t),n.c(),tt(n,1),n.m(e.parentNode,e)):n&&(K(),et(n,1,1,(()=>{n=null})),J())},i(t){i||(tt(n),i=!0)},o(t){et(n),i=!1},d(t){n&&n.d(t),t&&g(e)}}}function m0(t){let e,i,r,s,o;const a=t[74].item,f=l(a,t,t[73],t0),d=f||function(t){let e;function i(t,e){return t[107].highlighted?O0:b0}let n=i(t),r=n(t);return{c(){r.c(),e=w()},m(t,i){r.m(t,i),p(t,e,i)},p(t,s){n===(n=i(t))&&r?r.p(t,s):(r.d(1),r=n(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&g(e)}}}(t);function m(){return t[79](t[107])}function O(){return t[80](t[109])}return{c(){e=b("div"),d&&d.c(),x(e,"class",i="autocomplete-list-item "+(t[109]===t[30]?"selected":"")+" svelte-xmtx21"),P(e,"confirmed",t[48](t[107].item))},m(t,i){p(t,e,i),d&&d.m(e,null),r=!0,s||(o=[y(e,"click",m),y(e,"pointerenter",O)],s=!0)},p(n,s){t=n,f?f.p&&(!r||1&s[1]|2048&s[2])&&c(f,a,t,t[73],r?h(a,t[73],s,JJ):u(t[73]),t0):d&&d.p&&(!r||1&s[1])&&d.p(t,r?s:[-1,-1,-1,-1]),(!r||1073741824&s[0]&&i!==(i="autocomplete-list-item "+(t[109]===t[30]?"selected":"")+" svelte-xmtx21"))&&x(e,"class",i),1073741824&s[0]|131073&s[1]&&P(e,"confirmed",t[48](t[107].item))},i(t){r||(tt(d,t),r=!0)},o(t){et(d,t),r=!1},d(t){t&&g(e),d&&d.d(t),s=!1,n(o)}}}function b0(t){let e,i,n=t[107].label+"";return{c(){e=new M(!1),i=w(),e.a=i},m(t,r){e.m(n,t,r),p(t,i,r)},p(t,i){1&i[1]&&n!==(n=t[107].label+"")&&e.p(n)},d(t){t&&g(i),t&&e.d()}}}function O0(t){let e,i,n=t[107].highlighted.label+"";return{c(){e=new M(!1),i=w(),e.a=i},m(t,r){e.m(n,t,r),p(t,i,r)},p(t,i){1&i[1]&&n!==(n=t[107].highlighted.label+"")&&e.p(n)},d(t){t&&g(i),t&&e.d()}}}function v0(t){let e,i,n=t[107]&&(t[5]<=0||t[109]<t[5])&&g0(t);return{c(){n&&n.c(),e=w()},m(t,r){n&&n.m(t,r),p(t,e,r),i=!0},p(t,i){t[107]&&(t[5]<=0||t[109]<t[5])?n?(n.p(t,i),32&i[0]|1&i[1]&&tt(n,1)):(n=g0(t),n.c(),tt(n,1),n.m(e.parentNode,e)):n&&(K(),et(n,1,1,(()=>{n=null})),J())},i(t){i||(tt(n),i=!0)},o(t){et(n),i=!1},d(t){n&&n.d(t),t&&g(e)}}}function w0(t){let e,i,n,r,s=t[31].length-t[5]+"";return{c(){e=b("div"),i=O("..."),n=O(s),r=O(" results not shown"),x(e,"class","autocomplete-list-item-no-results svelte-xmtx21")},m(t,s){p(t,e,s),d(e,i),d(e,n),d(e,r)},p(t,e){32&e[0]|1&e[1]&&s!==(s=t[31].length-t[5]+"")&&k(n,s)},d(t){t&&g(e)}}}function y0(e){let i,s,o,l,a,h,c,u,f,m,O,w,k,T,M,Q,R,$,_,D;function E(t,e){return!t[6]&&t[2]?o0:t[6]&&t[1]?s0:void 0}let N=E(e),B=N&&N(e),I=e[6]&&e[1]&&a0(e),z=e[32]&&c0(e);const L=[p0,d0,f0,u0],W=[];function V(t,e){return t[31]&&t[31].length>0?0:t[29]&&t[12]?1:t[7]?2:t[11]?3:-1}return~(T=V(e))&&(M=W[T]=L[T](e)),{c(){i=b("div"),s=b("select"),B&&B.c(),o=v(),l=b("div"),I&&I.c(),a=v(),h=b("input"),O=v(),z&&z.c(),w=v(),k=b("div"),M&&M.c(),x(s,"name",e[19]),x(s,"id",e[20]),x(s,"class","svelte-xmtx21"),void 0===e[2]&&q((()=>e[75].call(s))),x(h,"type","text"),x(h,"class",c=(e[16]?e[16]:"")+" input autocomplete-input svelte-xmtx21"),x(h,"id",u=e[17]?e[17]:""),x(h,"autocomplete",f=e[22]?"on":"off"),x(h,"placeholder",e[14]),x(h,"name",e[18]),h.disabled=e[25],x(h,"title",e[21]),h.readOnly=m=e[23]||e[8]&&e[1],C(h,"background-color",e[26].textAreaColor),C(h,"color",e[26].textColor),C(h,"border-color",e[26].borderColor),x(l,"class","input-container svelte-xmtx21"),x(k,"class",Q=(e[24]?e[24]:"")+" autocomplete-list "+(e[33]?"":"hidden")+" is-fullwidth svelte-xmtx21"),C(k,"background-color",e[26].textAreaColor),C(k,"color",e[26].textColor),C(k,"border-color",e[26].borderColor),x(i,"class",R=(e[15]?e[15]:"")+" "+(e[9]||!e[0].length?"hide-arrow":"")+" "+(e[6]?"is-multiple":"")+" autocomplete select is-fullwidth "+e[34]+" svelte-xmtx21"),P(i,"show-clear",e[32]),P(i,"is-loading",e[10]&&e[29])},m(n,c){var u;p(n,i,c),d(i,s),B&&B.m(s,null),A(s,e[2]),d(i,o),d(i,l),I&&I.m(l,null),d(l,a),d(l,h),e[77](h),S(h,e[3]),d(l,O),z&&z.m(l,null),d(i,w),d(i,k),~T&&W[T].m(k,null),e[81](k),$=!0,_||(D=[y(window,"click",e[38]),y(s,"change",e[75]),(u=e[47].call(null,s),u&&r(u.destroy)?u.destroy:t),y(h,"input",e[78]),y(h,"input",e[41]),y(h,"focus",e[44]),y(h,"blur",e[45]),y(h,"keydown",e[39]),y(h,"click",e[43]),y(h,"keypress",e[40])],_=!0)},p(t,e){N===(N=E(t))&&B?B.p(t,e):(B&&B.d(1),B=N&&N(t),B&&(B.c(),B.m(s,null))),(!$||524288&e[0])&&x(s,"name",t[19]),(!$||1048576&e[0])&&x(s,"id",t[20]),22&e[0]&&A(s,t[2]),t[6]&&t[1]?I?(I.p(t,e),66&e[0]&&tt(I,1)):(I=a0(t),I.c(),tt(I,1),I.m(l,a)):I&&(K(),et(I,1,1,(()=>{I=null})),J()),(!$||65536&e[0]&&c!==(c=(t[16]?t[16]:"")+" input autocomplete-input svelte-xmtx21"))&&x(h,"class",c),(!$||131072&e[0]&&u!==(u=t[17]?t[17]:""))&&x(h,"id",u),(!$||4194304&e[0]&&f!==(f=t[22]?"on":"off"))&&x(h,"autocomplete",f),(!$||16384&e[0])&&x(h,"placeholder",t[14]),(!$||262144&e[0])&&x(h,"name",t[18]),(!$||33554432&e[0])&&(h.disabled=t[25]),(!$||2097152&e[0])&&x(h,"title",t[21]),(!$||8388866&e[0]&&m!==(m=t[23]||t[8]&&t[1]))&&(h.readOnly=m),(!$||67108864&e[0])&&C(h,"background-color",t[26].textAreaColor),(!$||67108864&e[0])&&C(h,"color",t[26].textColor),(!$||67108864&e[0])&&C(h,"border-color",t[26].borderColor),8&e[0]&&h.value!==t[3]&&S(h,t[3]),t[32]?z?z.p(t,e):(z=c0(t),z.c(),z.m(l,null)):z&&(z.d(1),z=null);let n=T;T=V(t),T===n?~T&&W[T].p(t,e):(M&&(K(),et(W[n],1,1,(()=>{W[n]=null})),J()),~T?(M=W[T],M?M.p(t,e):(M=W[T]=L[T](t),M.c()),tt(M,1),M.m(k,null)):M=null),(!$||16777216&e[0]|4&e[1]&&Q!==(Q=(t[24]?t[24]:"")+" autocomplete-list "+(t[33]?"":"hidden")+" is-fullwidth svelte-xmtx21"))&&x(k,"class",Q),(!$||67108864&e[0])&&C(k,"background-color",t[26].textAreaColor),(!$||67108864&e[0])&&C(k,"color",t[26].textColor),(!$||67108864&e[0])&&C(k,"border-color",t[26].borderColor),(!$||33345&e[0]&&R!==(R=(t[15]?t[15]:"")+" "+(t[9]||!t[0].length?"hide-arrow":"")+" "+(t[6]?"is-multiple":"")+" autocomplete select is-fullwidth "+t[34]+" svelte-xmtx21"))&&x(i,"class",R),33345&e[0]|2&e[1]&&P(i,"show-clear",t[32]),536905281&e[0]&&P(i,"is-loading",t[10]&&t[29])},i(t){$||(tt(I),tt(M),$=!0)},o(t){et(I),et(M),$=!1},d(t){t&&g(i),B&&B.d(),I&&I.d(),e[77](null),z&&z.d(),~T&&W[T].d(),e[81](null),_=!1,n(D)}}}function x0(t,e){let i;"function"!=typeof t&&console.error("Not a function: "+t+", argument: "+e);try{i=t(e)}catch(i){console.warn("Error executing Autocomplete function on value: "+e+" function: "+t)}let n=i;return null==n&&(n=""),"string"!=typeof n&&(n=n.toString()),n}function k0(t,e){if(!t)return 0;const i=t.keywords;let n=0;return e.forEach((t=>{i.includes(t)&&n++})),n}function S0(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function C0(t,e,i){let n,r,{$$slots:s={},$$scope:o}=e,{items:l=[]}=e,{searchFunction:a=!1}=e,{labelFieldName:h}=e,{keywordsFieldName:c=h}=e,{valueFieldName:u}=e,{labelFunction:f=function(t){return null==t?"":h?t[h]:t}}=e,{keywordsFunction:d=function(t){return null==t?"":c?t[c]:f(t)}}=e,{valueFunction:p=function(t,e=!1){return null==t?t:!C||e?u?t[u]:t:t.map((t=>u?t[u]:t))}}=e,{keywordsCleanFunction:g=function(t){return t}}=e,{textCleanFunction:m=function(t){return t}}=e,{beforeChange:b=function(t,e){return!0}}=e,{onChange:O=function(t){}}=e,{onFocus:v=function(){}}=e,{onBlur:w=function(){}}=e,{onCreate:y=function(t){J&&console.log("onCreate: "+t)}}=e,{selectFirstIfEmpty:x=!1}=e,{minCharactersToSearch:k=1}=e,{maxItemsToShowInList:S=0}=e,{multiple:C=!1}=e,{create:A=!1}=e,{ignoreAccents:P=!0}=e,{matchAllKeywords:M=!0}=e,{sortByMatchedKeywords:Q=!1}=e,{lock:R=!1}=e,{delay:$=0}=e,{localFiltering:_=!0}=e,{hideArrow:D=!1}=e,{showClear:E=!1}=e,{showLoadingIndicator:N=!1}=e,{noResultsText:I="No results found"}=e,{loadingText:z="Loading results..."}=e,{createText:L="Not found, add anyway?"}=e,{placeholder:W}=e,{className:V}=e,{inputClassName:j}=e,{inputId:q}=e,{name:H}=e,{selectName:X}=e,{selectId:F}=e,{title:Z}=e,{html5autocomplete:G}=e,{readonly:U}=e,{dropdownClassName:Y}=e,{disabled:K=!1}=e,{debug:J=!1}=e,{selectedItem:tt}=e,{value:et}=e,{theme:it}=e;const nt="sautocomplete-"+Math.floor(1e3*Math.random());let rt,st,ot,lt,at=!1,ht=!1,ct=-1,{text:ut}=e,ft=0,dt=[],pt=0,gt=0;function mt(t){return x0(f,t)}function bt(t){const e=x0(d,t);let i=x0(g,e);return i=i.toLowerCase().trim(),P&&(i=S0(i)),J&&console.log("Extracted keywords: '"+i+"' from item: "+JSON.stringify(t)),i}function Ot(){let t;J&&(t=`Autocomplete prepare list ${q?`(id: ${q})`:""})`,console.time(t),console.log("Prepare items to search"),console.log("items: "+JSON.stringify(l))),Array.isArray(l)||(console.warn("Autocomplete items / search function did not return array but",l),i(0,l=[]));const e=l?l.length:0;dt=new Array(e),e>0&&l.forEach(((t,e)=>{const i=function(t){return{keywords:bt(t),label:mt(t),item:t}}(t);null==i&&console.log("Undefined item for: ",t),dt[e]=i})),J&&(console.log(dt.length+" items to search"),console.timeEnd(t))}async function vt(){let t;J&&(t=`Autocomplete search ${q?`(id: ${q})`:""})`,console.time(t),console.log("Searching user entered text: '"+ut+"'"));const e=function(t){if(null==t)return"";const e=t.replace(/[&/\\#,+()$~%.'":*?<>{}]/g," ").trim();if(i(72,ft=e.length),k>1&&ft<k)return"";const n=m(e).toLowerCase().trim();return J&&console.log("Change user entered text '"+t+"' into '"+n+"'"),n}(ut);if(""===e)return a?(i(0,l=[]),J&&console.log("User entered text is empty clear list of items")):(i(31,ot=dt),J&&console.log("User entered text is empty set the list of items to all items")),Et(),void(J&&console.timeEnd(t));if(a){pt+=1;const t=pt;i(29,ht=!0);if(a instanceof async function*(){}.constructor)for await(const n of a(e)){if(t<gt)return!1;t>gt&&i(0,l=[]),gt=t,i(0,l=[...l,...n]),wt(e)}else{let n=await a(e);if(t<gt)return!1;gt=t,i(0,l=n),wt(e)}i(29,ht=!1)}else wt(e);J&&(console.timeEnd(t),console.log("Search found "+ot.length+" items"))}function wt(t){let e;if(Ot(),_){var n=t.split(" ");P&&(n=n.map((t=>S0(t)))),e=dt.filter((t=>{var e=k0(t,n);return M?e>=n.length:e>0})),Q&&(e=e.sort(((t,e)=>k0(e,n)-k0(t,n))))}else e=dt;const r=Nt(t,["label"]),s=e.map(r);return i(31,ot=s),Et(),!0}function yt(t){if(J&&console.log("selectListItem"),void 0===t)return A?(y(ut),!0):(J&&console.log("listItem is undefined. Can not select."),!1);const e=t.item;return b(tt,e)&&(C?tt?tt.includes(e)?i(1,tt=tt.filter((t=>t!==e))):i(1,tt=[...tt,e]):i(1,tt=[e]):i(1,tt=e)),!0}function xt(){J&&console.log("selectItem");yt(ot[ct])&&(_t(),C&&rt.focus())}function kt(){J&&console.log("up"),$t(),ct>0&&i(30,ct--,ct),Ct()}function St(){J&&console.log("down"),$t(),ct<ot.length-1&&i(30,ct++,ct),Ct()}function Ct(){J&&console.log("highlight");const t=".selected";J&&console.log("Seaching DOM element: .selected in "+st);const e=st&&st.querySelector(t);e?"function"==typeof e.scrollIntoViewIfNeeded?(J&&console.log("Scrolling selected item into view"),e.scrollIntoViewIfNeeded()):J&&console.warn("Could not scroll selected item into view, scrollIntoViewIfNeeded not supported"):J&&console.warn("Selected item not found to scroll into view")}function At(t){J&&console.log("onListItemClick"),yt(t)&&(_t(),C&&rt.focus())}function Tt(t){J&&console.log("unselectItem",t),i(1,tt=tt.filter((e=>e!==t))),rt.focus()}function Pt(){vt()&&(i(30,ct=0),$t())}function Mt(t){J&&console.log("onEsc"),t.stopPropagation(),at&&(rt.focus(),_t())}function Qt(t){J&&console.log("onBackspace"),Tt(tt[tt.length-1])}function Rt(){if(J&&console.log("resetListToAllItemsAndOpen"),ut?!dt.length&&tt&&a&&vt():i(31,ot=dt),$t(),tt){J&&console.log("Searching currently selected item: "+JSON.stringify(tt));for(let t=0;t<dt.length;t++){const e=dt[t];if(void 0!==e){if(J&&console.log("Item "+t+": "+JSON.stringify(e)),tt==e.item){i(30,ct=t),J&&console.log("Found selected item: "+t+": "+JSON.stringify(e)),Ct();break}}else J&&console.log(`listItem ${t} is undefined. Skipping.`)}}}function $t(){J&&console.log("open"),Dt()||i(71,at=!0)}function _t(){J&&console.log("close"),i(71,at=!1),i(29,ht=!1),!ut&&x&&(Nt=0,xt())}function Dt(){return k>1&&ft<k}function Et(){Dt()&&_t()}function Nt(t,e){return t=t.split(/\s+/g),i=>{const n=Object.assign({highlighted:{}},i);return e&&e.forEach((e=>{n[e]&&!n.highlighted[e]&&(n.highlighted[e]=n[e]),n.highlighted[e]&&t.forEach((t=>{const i=new RegExp("("+t+")","ig");n.highlighted[e]=n.highlighted[e].replace(i,"<b>$1</b>")}))})),n}}return t.$$set=t=>{"items"in t&&i(0,l=t.items),"searchFunction"in t&&i(49,a=t.searchFunction),"labelFieldName"in t&&i(50,h=t.labelFieldName),"keywordsFieldName"in t&&i(51,c=t.keywordsFieldName),"valueFieldName"in t&&i(52,u=t.valueFieldName),"labelFunction"in t&&i(53,f=t.labelFunction),"keywordsFunction"in t&&i(54,d=t.keywordsFunction),"valueFunction"in t&&i(4,p=t.valueFunction),"keywordsCleanFunction"in t&&i(55,g=t.keywordsCleanFunction),"textCleanFunction"in t&&i(56,m=t.textCleanFunction),"beforeChange"in t&&i(57,b=t.beforeChange),"onChange"in t&&i(58,O=t.onChange),"onFocus"in t&&i(59,v=t.onFocus),"onBlur"in t&&i(60,w=t.onBlur),"onCreate"in t&&i(61,y=t.onCreate),"selectFirstIfEmpty"in t&&i(62,x=t.selectFirstIfEmpty),"minCharactersToSearch"in t&&i(63,k=t.minCharactersToSearch),"maxItemsToShowInList"in t&&i(5,S=t.maxItemsToShowInList),"multiple"in t&&i(6,C=t.multiple),"create"in t&&i(7,A=t.create),"ignoreAccents"in t&&i(64,P=t.ignoreAccents),"matchAllKeywords"in t&&i(65,M=t.matchAllKeywords),"sortByMatchedKeywords"in t&&i(66,Q=t.sortByMatchedKeywords),"lock"in t&&i(8,R=t.lock),"delay"in t&&i(67,$=t.delay),"localFiltering"in t&&i(68,_=t.localFiltering),"hideArrow"in t&&i(9,D=t.hideArrow),"showClear"in t&&i(69,E=t.showClear),"showLoadingIndicator"in t&&i(10,N=t.showLoadingIndicator),"noResultsText"in t&&i(11,I=t.noResultsText),"loadingText"in t&&i(12,z=t.loadingText),"createText"in t&&i(13,L=t.createText),"placeholder"in t&&i(14,W=t.placeholder),"className"in t&&i(15,V=t.className),"inputClassName"in t&&i(16,j=t.inputClassName),"inputId"in t&&i(17,q=t.inputId),"name"in t&&i(18,H=t.name),"selectName"in t&&i(19,X=t.selectName),"selectId"in t&&i(20,F=t.selectId),"title"in t&&i(21,Z=t.title),"html5autocomplete"in t&&i(22,G=t.html5autocomplete),"readonly"in t&&i(23,U=t.readonly),"dropdownClassName"in t&&i(24,Y=t.dropdownClassName),"disabled"in t&&i(25,K=t.disabled),"debug"in t&&i(70,J=t.debug),"selectedItem"in t&&i(1,tt=t.selectedItem),"value"in t&&i(2,et=t.value),"theme"in t&&i(26,it=t.theme),"text"in t&&i(3,ut=t.text),"$$scope"in t&&i(73,o=t.$$scope)},t.$$.update=()=>{2&t.$$.dirty[0]&&(i(2,et=p(tt)),i(3,ut=C?"":mt(tt)),O(tt)),1&t.$$.dirty[0]|1536&t.$$.dirty[2]&&i(33,n=at&&(l&&l.length>0||ft>0)),322&t.$$.dirty[0]|128&t.$$.dirty[2]&&i(32,r=E||(R||C)&&tt),1&t.$$.dirty[0]&&Ot()},[l,tt,et,ut,p,S,C,A,R,D,N,I,z,L,W,V,j,q,H,X,F,Z,G,U,Y,K,it,rt,st,ht,ct,ot,r,n,nt,mt,xt,At,function(t){J&&console.log("onDocumentClick: "+JSON.stringify(t.target)),t.target.closest("."+nt)?(J&&console.log("onDocumentClick inside"),Ct()):(J&&console.log("onDocumentClick outside"),_t())},function(t){J&&console.log("onKeyDown");let e=t.key;"Tab"===e&&t.shiftKey&&(e="ShiftTab");const i={Tab:at?St.bind(this):null,ShiftTab:at?kt.bind(this):null,ArrowDown:St.bind(this),Escape:Mt.bind(this),Backspace:C&&tt&&tt.length&&!ut?Qt.bind(this):null}[e];"function"==typeof i&&(t.preventDefault(),i(t))},function(t){J&&console.log("onKeyPress"),"Enter"===t.key&&at&&(t.preventDefault(),xt())},function(t){J&&console.log("onInput"),i(3,ut=t.target.value),lt&&clearTimeout(lt),$?lt=setTimeout(Pt,$):Pt()},Tt,function(){J&&console.log("onInputClick"),Rt()},function(){J&&console.log("onFocus"),v(),Rt()},function(){J&&console.log("onBlur"),w()},function(){J&&console.log("clear"),i(3,ut=""),i(1,tt=void 0),setTimeout((()=>{rt.focus(),_t()}))},function(t){t.multiple=C},function(t){return!!tt&&(C?tt.includes(t):t==tt)},a,h,c,u,f,d,g,m,b,O,v,w,y,x,k,P,M,Q,$,_,E,J,at,ft,o,s,function(){et=T(this),i(2,et),i(4,p),i(1,tt)},t=>{Tt(t)},function(t){B[t?"unshift":"push"]((()=>{rt=t,i(27,rt)}))},function(){ut=this.value,i(3,ut)},t=>At(t),t=>{i(30,ct=t)},function(t){B[t?"unshift":"push"]((()=>{st=t,i(28,st)}))}]}class A0 extends lt{constructor(t){super(),ot(this,t,C0,y0,s,{items:0,searchFunction:49,labelFieldName:50,keywordsFieldName:51,valueFieldName:52,labelFunction:53,keywordsFunction:54,valueFunction:4,keywordsCleanFunction:55,textCleanFunction:56,beforeChange:57,onChange:58,onFocus:59,onBlur:60,onCreate:61,selectFirstIfEmpty:62,minCharactersToSearch:63,maxItemsToShowInList:5,multiple:6,create:7,ignoreAccents:64,matchAllKeywords:65,sortByMatchedKeywords:66,lock:8,delay:67,localFiltering:68,hideArrow:9,showClear:69,showLoadingIndicator:10,noResultsText:11,loadingText:12,createText:13,placeholder:14,className:15,inputClassName:16,inputId:17,name:18,selectName:19,selectId:20,title:21,html5autocomplete:22,readonly:23,dropdownClassName:24,disabled:25,debug:70,selectedItem:1,value:2,theme:26,text:3},null,[-1,-1,-1,-1])}}function T0(t){let e,i,r,s,o,l,a,h,c,u,f,m,w,k,A,T,P,M,Q,R,$,_,D,E,N,I,z,L,W,V,j,q,X,F,Z,G,U;function Y(e){t[19](e)}let K={inputId:"scriptName",items:t[6],inputClassName:"scriptInput",className:"scriptDiv",create:"true",theme:t[8],onChange:t[17],onCreate:t[18]};return void 0!==t[2]&&(K.selectedItem=t[2]),l=new A0({props:K}),B.push((()=>it(l,"selectedItem",Y))),M=new TK({props:{height:"380px",width:"980px",config:t[9],initFinished:t[0]}}),M.$on("textChange",t[22]),M.$on("editorChange",t[23]),{c(){e=b("div"),i=b("div"),r=b("div"),s=b("label"),s.textContent="Name:",o=v(),nt(l.$$.fragment),h=v(),c=b("label"),c.textContent="Insert?",u=v(),f=b("input"),m=v(),w=b("div"),k=b("label"),k.textContent="Description:",A=v(),T=b("input"),P=v(),nt(M.$$.fragment),Q=v(),R=b("div"),$=b("button"),_=O("Save Script"),D=v(),E=b("button"),N=O("Delete Script"),I=v(),z=b("button"),L=O("Notes"),W=v(),V=b("button"),j=O("Scripts Menu"),q=v(),X=b("button"),F=O("Templates Menu"),x(s,"for","scriptName"),x(s,"class","svelte-1nkhnrz"),x(c,"id","insertChkLab"),x(c,"for","insertChk"),x(c,"class","svelte-1nkhnrz"),x(f,"id","insertChk"),x(f,"name","insertChk"),x(f,"type","checkbox"),C(f,"background-color",t[8].textAreaColor),C(f,"color",t[8].textColor),C(f,"border-color",t[8].borderColor),x(f,"class","svelte-1nkhnrz"),x(r,"class","headerRow svelte-1nkhnrz"),x(k,"for","description"),x(k,"class","svelte-1nkhnrz"),x(T,"id","description"),C(T,"background-color",t[8].textAreaColor),C(T,"color",t[8].textColor),C(T,"border-color",t[8].borderColor),C(T,"font-size",t[8].fontSize),x(T,"class","svelte-1nkhnrz"),x(w,"class","headerRow svelte-1nkhnrz"),x(i,"id","header"),x(i,"class","svelte-1nkhnrz"),C($,"background-color",t[8].textAreaColor),C($,"color",t[8].textColor),C($,"border-color",t[8].borderColor),x($,"class","svelte-1nkhnrz"),C(E,"background-color",t[8].textAreaColor),C(E,"color",t[8].textColor),C(E,"border-color",t[8].borderColor),x(E,"class","svelte-1nkhnrz"),C(z,"background-color",t[8].textAreaColor),C(z,"color",t[8].textColor),C(z,"border-color",t[8].borderColor),x(z,"class","svelte-1nkhnrz"),C(V,"background-color",t[8].textAreaColor),C(V,"color",t[8].textColor),C(V,"border-color",t[8].borderColor),x(V,"class","svelte-1nkhnrz"),C(X,"background-color",t[8].textAreaColor),C(X,"color",t[8].textColor),C(X,"border-color",t[8].borderColor),x(X,"class","svelte-1nkhnrz"),x(R,"id","buttonRow"),x(R,"class","svelte-1nkhnrz"),x(e,"id","scripts"),C(e,"background-color",t[8].backgroundColor),C(e,"font-family",t[8].font),C(e,"color",t[8].textColor),C(e,"font-size",t[8].fontSize),x(e,"class","svelte-1nkhnrz")},m(n,a){p(n,e,a),d(e,i),d(i,r),d(r,s),d(r,o),rt(l,r,null),d(r,h),d(r,c),d(r,u),d(r,f),f.checked=t[5],d(i,m),d(i,w),d(w,k),d(w,A),d(w,T),S(T,t[4]),d(e,P),rt(M,e,null),d(e,Q),d(e,R),d(R,$),d($,_),d(R,D),d(R,E),d(E,N),d(R,I),d(R,z),d(z,L),d(R,W),d(R,V),d(V,j),d(R,q),d(R,X),d(X,F),Z=!0,G||(U=[y(f,"change",t[20]),y(T,"input",t[21]),y($,"click",t[10]),y(E,"click",t[11]),y(z,"click",t[14]),y(V,"click",t[15]),y(X,"click",t[16])],G=!0)},p(t,i){const n={};64&i[0]&&(n.items=t[6]),256&i[0]&&(n.theme=t[8]),154&i[0]&&(n.onCreate=t[18]),!a&&4&i[0]&&(a=!0,n.selectedItem=t[2],H((()=>a=!1))),l.$set(n),(!Z||256&i[0])&&C(f,"background-color",t[8].textAreaColor),(!Z||256&i[0])&&C(f,"color",t[8].textColor),(!Z||256&i[0])&&C(f,"border-color",t[8].borderColor),32&i[0]&&(f.checked=t[5]),(!Z||256&i[0])&&C(T,"background-color",t[8].textAreaColor),(!Z||256&i[0])&&C(T,"color",t[8].textColor),(!Z||256&i[0])&&C(T,"border-color",t[8].borderColor),(!Z||256&i[0])&&C(T,"font-size",t[8].fontSize),16&i[0]&&T.value!==t[4]&&S(T,t[4]);const r={};1&i[0]&&(r.initFinished=t[0]),M.$set(r),(!Z||256&i[0])&&C($,"background-color",t[8].textAreaColor),(!Z||256&i[0])&&C($,"color",t[8].textColor),(!Z||256&i[0])&&C($,"border-color",t[8].borderColor),(!Z||256&i[0])&&C(E,"background-color",t[8].textAreaColor),(!Z||256&i[0])&&C(E,"color",t[8].textColor),(!Z||256&i[0])&&C(E,"border-color",t[8].borderColor),(!Z||256&i[0])&&C(z,"background-color",t[8].textAreaColor),(!Z||256&i[0])&&C(z,"color",t[8].textColor),(!Z||256&i[0])&&C(z,"border-color",t[8].borderColor),(!Z||256&i[0])&&C(V,"background-color",t[8].textAreaColor),(!Z||256&i[0])&&C(V,"color",t[8].textColor),(!Z||256&i[0])&&C(V,"border-color",t[8].borderColor),(!Z||256&i[0])&&C(X,"background-color",t[8].textAreaColor),(!Z||256&i[0])&&C(X,"color",t[8].textColor),(!Z||256&i[0])&&C(X,"border-color",t[8].borderColor),(!Z||256&i[0])&&C(e,"background-color",t[8].backgroundColor),(!Z||256&i[0])&&C(e,"font-family",t[8].font),(!Z||256&i[0])&&C(e,"color",t[8].textColor),(!Z||256&i[0])&&C(e,"font-size",t[8].fontSize)},i(t){Z||(tt(l.$$.fragment,t),tt(M.$$.fragment,t),Z=!0)},o(t){et(l.$$.fragment,t),et(M.$$.fragment,t),Z=!1},d(t){t&&g(e),st(l),st(M),G=!1,n(U)}}}function P0(t,e,i){let n,r,s,l,a,h;o(t,qK,(t=>i(24,n=t))),o(t,jK,(t=>i(25,r=t))),o(t,IK,(t=>i(26,s=t))),o(t,$J,(t=>i(7,l=t))),o(t,QJ,(t=>i(27,a=t))),o(t,SK,(t=>i(8,h=t)));let c,u,d=!1,p="",g="",m="",b=!1;function O(t){fetch("http://localhost:9978/api/scripts/user",{method:"GET",headers:{"Content-type":"application/json"}}).then((t=>t.json())).then((e=>{i(6,u=e.scripts.sort()),void 0!==t&&t()}))}function v(t){fetch("http://localhost:9978/api/scripts/list",{method:"GET",headers:{"Content-type":"application/json"}}).then((t=>t.json())).then((e=>{f(QJ,a=e.data,a),void 0!==t&&t()}))}function w(t){f($J,l=t,l)}function y(t){i(1,c=t.value)}_((()=>{i(0,d=!0),O((()=>{}))}));return[d,c,p,g,m,b,u,l,h,{language:"javascript",lineNumbers:!0,lineWrapping:!0,lineHighlight:!0},function(){void 0!==g&&""!==g&&fetch(`http://localhost:9978/api/scripts/${g}`,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify({script:{name:g,insert:b,description:m,script:c}})}).then((()=>{i(2,p=""),i(3,g=""),i(5,b=!0),i(4,m=""),i(1,c=""),l.setValue(c),v(),O()}))},function(){void 0!==g&&""!==g&&fetch(`http://localhost:9978/api/scripts/${g}`,{method:"DELETE",headers:{"Content-type":"application/json"}}).then((()=>{i(3,g=""),i(5,b=!0),i(4,m=""),i(1,c=""),i(2,p=""),l.setValue(c),v(),O()}))},w,y,function(){f(IK,s="notes",s)},function(){f(jK,r=!r,r)},function(){f(qK,n=!n,n)},function(t){void 0!==t&&""!==t&&(i(3,g=t),function(t,e){void 0!==t&&""!==t&&fetch(`http://localhost:9978/api/scripts/${t}`,{method:"GET",headers:{"Content-type":"application/json"}}).then((t=>t.json())).then((t=>{i(3,g=t.script.name),i(1,c=t.script.script),i(4,m=t.script.description),i(5,b="true"==t.script.insert),l.setValue(c),void 0!==e&&e()}))}(g))},t=>{void 0!==t&&""!==t&&(i(3,g=t),i(4,m=""),i(1,c=""),l.setValue(c))},function(t){p=t,i(2,p)},function(){b=this.checked,i(5,b)},function(){m=this.value,i(4,m)},t=>{y(t.detail.data)},t=>{w(t.detail.data)}]}class M0 extends lt{constructor(t){super(),ot(this,t,P0,T0,s,{},null,[-1,-1])}}function Q0(t){let e,i,n,r;return{c(){e=b("button"),i=O("Delete Template"),C(e,"background-color",t[7].textAreaColor),C(e,"color",t[7].textColor),C(e,"border-color",t[7].borderColor),x(e,"class","svelte-2ihs3u")},m(s,o){p(s,e,o),d(e,i),n||(r=y(e,"click",t[10]),n=!0)},p(t,i){128&i&&C(e,"background-color",t[7].textAreaColor),128&i&&C(e,"color",t[7].textColor),128&i&&C(e,"border-color",t[7].borderColor)},d(t){t&&g(e),n=!1,r()}}}function R0(t){let e,i,r,s,o,l,a,h,c,u,f,m,w,k,A,T,P,M,Q,R,$,_,D,E,N,I,z,L,W,V,j;function q(e){t[18](e)}let X={inputId:"templateName",items:t[5],inputClassName:"templateInput",className:"templateDiv",create:"true",theme:t[7],onChange:t[16],onCreate:t[17]};void 0!==t[4]&&(X.selectedItem=t[4]),l=new A0({props:X}),B.push((()=>it(l,"selectedItem",q))),k=new TK({props:{height:"375px",width:"980px",config:t[8],initFinished:t[0]}}),k.$on("textChange",t[20]),k.$on("editorChange",t[21]);let F="Defaults"!==t[3]&&Q0(t);return{c(){e=b("div"),i=b("div"),r=b("div"),s=b("label"),s.textContent="Name:",o=v(),nt(l.$$.fragment),h=v(),c=b("div"),u=b("label"),u.textContent="Description:",f=v(),m=b("input"),w=v(),nt(k.$$.fragment),A=v(),T=b("div"),P=b("button"),M=O("Save Template"),Q=v(),F&&F.c(),R=v(),$=b("button"),_=O("Notes"),D=v(),E=b("button"),N=O("Scripts Menu"),I=v(),z=b("button"),L=O("Templates Menu"),x(s,"for","templateName"),x(s,"class","svelte-2ihs3u"),x(r,"class","headerRow svelte-2ihs3u"),x(u,"for","description"),x(u,"class","svelte-2ihs3u"),x(m,"id","description"),C(m,"background-color",t[7].textAreaColor),C(m,"color",t[7].textColor),C(m,"border-color",t[7].borderColor),x(m,"class","svelte-2ihs3u"),x(c,"class","headerRow svelte-2ihs3u"),x(i,"id","header"),x(i,"class","svelte-2ihs3u"),C(P,"background-color",t[7].textAreaColor),C(P,"color",t[7].textColor),C(P,"border-color",t[7].borderColor),x(P,"class","svelte-2ihs3u"),C($,"background-color",t[7].textAreaColor),C($,"color",t[7].textColor),C($,"border-color",t[7].borderColor),x($,"class","svelte-2ihs3u"),C(E,"background-color",t[7].textAreaColor),C(E,"color",t[7].textColor),C(E,"border-color",t[7].borderColor),x(E,"class","svelte-2ihs3u"),C(z,"background-color",t[7].textAreaColor),C(z,"color",t[7].textColor),C(z,"border-color",t[7].borderColor),x(z,"class","svelte-2ihs3u"),x(T,"id","buttonRow"),x(T,"class","svelte-2ihs3u"),x(e,"id","templates"),C(e,"background-color",t[7].backgroundColor),C(e,"font-family",t[7].font),C(e,"color",t[7].textColor),C(e,"font-size",t[7].fontSize),x(e,"class","svelte-2ihs3u")},m(n,a){p(n,e,a),d(e,i),d(i,r),d(r,s),d(r,o),rt(l,r,null),d(i,h),d(i,c),d(c,u),d(c,f),d(c,m),S(m,t[2]),d(e,w),rt(k,e,null),d(e,A),d(e,T),d(T,P),d(P,M),d(T,Q),F&&F.m(T,null),d(T,R),d(T,$),d($,_),d(T,D),d(T,E),d(E,N),d(T,I),d(T,z),d(z,L),W=!0,V||(j=[y(m,"input",t[19]),y(P,"click",t[9]),y($,"click",t[13]),y(E,"click",t[14]),y(z,"click",t[15])],V=!0)},p(t,[i]){const n={};32&i&&(n.items=t[5]),128&i&&(n.theme=t[7]),78&i&&(n.onCreate=t[17]),!a&&16&i&&(a=!0,n.selectedItem=t[4],H((()=>a=!1))),l.$set(n),(!W||128&i)&&C(m,"background-color",t[7].textAreaColor),(!W||128&i)&&C(m,"color",t[7].textColor),(!W||128&i)&&C(m,"border-color",t[7].borderColor),4&i&&m.value!==t[2]&&S(m,t[2]);const r={};1&i&&(r.initFinished=t[0]),k.$set(r),(!W||128&i)&&C(P,"background-color",t[7].textAreaColor),(!W||128&i)&&C(P,"color",t[7].textColor),(!W||128&i)&&C(P,"border-color",t[7].borderColor),"Defaults"!==t[3]?F?F.p(t,i):(F=Q0(t),F.c(),F.m(T,R)):F&&(F.d(1),F=null),(!W||128&i)&&C($,"background-color",t[7].textAreaColor),(!W||128&i)&&C($,"color",t[7].textColor),(!W||128&i)&&C($,"border-color",t[7].borderColor),(!W||128&i)&&C(E,"background-color",t[7].textAreaColor),(!W||128&i)&&C(E,"color",t[7].textColor),(!W||128&i)&&C(E,"border-color",t[7].borderColor),(!W||128&i)&&C(z,"background-color",t[7].textAreaColor),(!W||128&i)&&C(z,"color",t[7].textColor),(!W||128&i)&&C(z,"border-color",t[7].borderColor),(!W||128&i)&&C(e,"background-color",t[7].backgroundColor),(!W||128&i)&&C(e,"font-family",t[7].font),(!W||128&i)&&C(e,"color",t[7].textColor),(!W||128&i)&&C(e,"font-size",t[7].fontSize)},i(t){W||(tt(l.$$.fragment,t),tt(k.$$.fragment,t),W=!0)},o(t){et(l.$$.fragment,t),et(k.$$.fragment,t),W=!1},d(t){t&&g(e),st(l),st(k),F&&F.d(),V=!1,n(j)}}}function $0(t,e,i){let n,r,s,l,a,h;o(t,qK,(t=>i(22,n=t))),o(t,jK,(t=>i(23,r=t))),o(t,IK,(t=>i(24,s=t))),o(t,RJ,(t=>i(6,l=t))),o(t,zJ,(t=>i(25,a=t))),o(t,SK,(t=>i(7,h=t)));let c,u,d=!1,p="",g="",m="";function b(t){fetch("http://localhost:9978/api/template/user",{method:"GET",headers:{"Content-type":"application/json"}}).then((t=>t.json())).then((e=>{i(5,u=e.templates.sort()),void 0!==t&&t()}))}function O(t){fetch("http://localhost:9978/api/template/list",{method:"GET",headers:{"Content-type":"application/json"}}).then((t=>t.json())).then((e=>{f(zJ,a=e.templates,a),void 0!==t&&t()}))}function v(t){f(RJ,l=t,l)}function w(t){i(1,p=t.value)}_((()=>{b((()=>{i(0,d=!0)}))}));return[d,p,g,m,c,u,l,h,{language:"javascript",lineNumbers:!0,lineWrapping:!0,lineHighlight:!0},function(){void 0!==m&&""!==m&&fetch(`http://localhost:9978/api/template/${m}`,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify({template:{name:m,description:g,template:p}})}).then((()=>{i(1,p=""),i(3,m=""),i(2,g=""),i(4,c=""),l.setValue(p),O(),b()}))},function(){void 0!==m&&""!==m&&fetch(`http://localhost:9978/api/template/${m}`,{method:"DELETE",headers:{"Content-type":"application/json"}}).then((()=>{i(1,p=""),i(3,m=""),i(2,g=""),i(4,c=""),l.setValue(p),O(),b()}))},v,w,function(){f(IK,s="notes",s)},function(){f(jK,r=!r,r)},function(){f(qK,n=!n,n)},function(t){void 0!==t&&(i(3,m=t),function(t,e){void 0!==t&&""!==t&&fetch(`http://localhost:9978/api/template/${t}`,{method:"GET",headers:{"Content-type":"application/json"}}).then((t=>t.json())).then((t=>{i(1,p=t.text.template),l.setValue(p),i(2,g=t.text.description),void 0!==e&&e()}))}(m))},t=>{void 0!==t&&(i(3,m=t),i(2,g=""),i(1,p=""),l.setValue(p))},function(t){c=t,i(4,c)},function(){g=this.value,i(2,g)},t=>{w(t.detail.data)},t=>{v(t.detail.data)}]}class _0 extends lt{constructor(t){super(),ot(this,t,$0,R0,s,{})}}function D0(e){let i,r,s,o,l,a,h,c,u,f,m,O;return{c(){i=b("div"),r=b("div"),s=b("label"),s.textContent="Auto Launch Node-Red?",o=v(),l=b("input"),a=v(),h=b("div"),c=b("label"),c.textContent="Dashboard configured?",u=v(),f=b("input"),x(s,"class","styleLabel svelte-n1ihpd"),x(l,"class","PrefCheck svelte-n1ihpd"),x(l,"type","checkbox"),x(r,"class","labelRadialHolder svelte-n1ihpd"),x(c,"class","styleLabel svelte-n1ihpd"),x(f,"class","PrefCheck svelte-n1ihpd"),x(f,"type","checkbox"),x(h,"class","labelRadialHolder svelte-n1ihpd")},m(t,n){p(t,i,n),d(i,r),d(r,s),d(r,o),d(r,l),l.checked=e[0].REDAuto,d(i,a),d(i,h),d(h,c),d(h,u),d(h,f),f.checked=e[0].REDDashboard,m||(O=[y(l,"change",e[2]),y(l,"change",e[3]),y(f,"change",e[4]),y(f,"change",e[5])],m=!0)},p(t,[e]){1&e&&(l.checked=t[0].REDAuto),1&e&&(f.checked=t[0].REDDashboard)},i:t,o:t,d(t){t&&g(i),m=!1,n(O)}}}function E0(t,e,i){const n=E();var r={REDAuto:!0,REDDashboard:!0};function s(){!function(t,e){n(t,{data:e})}("changeTodos",{auto:r.REDAuto,dashboard:r.REDDashboard})}return[r,s,function(){r.REDAuto=this.checked,i(0,r)},()=>{s()},function(){r.REDDashboard=this.checked,i(0,r)},()=>{s()}]}class N0 extends lt{constructor(t){super(),ot(this,t,E0,D0,s,{})}}function B0(e){let i;return{c(){i=b("div"),C(i,"background-color",e[0].backgroundColor)},m(t,e){p(t,i,e)},p(t,[e]){1&e&&C(i,"background-color",t[0].backgroundColor)},i:t,o:t,d(t){t&&g(i)}}}function I0(t,e,i){let n;return o(t,SK,(t=>i(0,n=t))),[n]}class z0 extends lt{constructor(t){super(),ot(this,t,I0,B0,s,{})}}
/**
     * @category  html5 widgets
     * @package   Kelly
     * @author    Rubchuk Vladimir <torrenttvi@gmail.com>
     * @copyright 2015-2017 Rubchuk Vladimir
     * @license   GPLv3
     * @version   1.19
     *
     * Usage example :
     *
     *   new KellyColorPicker({place : 'color-picker'});
     *
     * ToDo :
     * 
     * Add switch color in colorsavers button (analog of X button in Photoshop)
     *
     **/function L0(t){var e,i=Math.PI,n=!0,r=new Object;r.radius=4;var s=!1,o=!1,l="quad",a=!1,h=!1,c=!0,u=new Array,f=new Array,d=document.createElement("canvas"),p=!1,g=!1,m=null,b=!1,O=!0,v="mixed",w=new Object;w.tag=!1,w.margin=6;var y,x,k,S,C=!1,A=this,T=200,P="#000000",M=1,Q=!1,R=!1,$=new Array,_=!1,D=new Array;function E(t,e,i){e=!!e;var n=new Object;n.width,n.widthPercentage=22,n.imageData=null,n.align=t,n.selected=e,n.color="#ffffff",n.position,n.paddingY=-4,n.paddingX=4,n.lineWidth=1,n.selectSize=4,"right"==t&&(n.paddingX=-1*n.paddingX),n.selected&&(n.color=P),i&&(n.color=i),n.updateSize=function(){this.width=parseInt(T-T/100*(100-this.widthPercentage)),"left"==this.align?this.position={x:0,y:T-this.width}:"right"==this.align&&(this.position={x:T-this.width,y:T-this.width})},n.calcS=function(t){return Math.abs((t[1].x-t[0].x)*(t[2].y-t[0].y)-(t[2].x-t[0].x)*(t[1].y-t[0].y))/2},n.isDotIn=function(t){var e=new Array;"left"==this.align?(e[0]={x:this.position.x,y:this.position.y},e[1]={x:this.position.x,y:this.position.y+this.width},e[2]={x:this.position.x+this.width,y:this.position.y+this.width}):(e[0]={x:this.position.x+this.width,y:this.position.y},e[1]={x:e[0].x,y:e[0].y+this.width},e[2]={x:e[0].x-this.width,y:this.position.y+this.width});for(var i=0;i<=e.length-1;++i)e[i].x+=this.paddingX,e[i].y+=this.paddingY;var n=this.calcS(e),r=[{x:e[0].x,y:e[0].y},{x:e[1].x,y:e[1].y},{x:t.x,y:t.y}],s=this.calcS(r);return r[1]={x:e[2].x,y:e[2].y},s+=this.calcS(r),r[0]={x:e[1].x,y:e[1].y},s+=this.calcS(r),Math.ceil(s)==Math.ceil(n)},n.draw=function(){d.width=this.width,d.height=this.width,p.clearRect(0,0,this.width,this.width),p.beginPath(),"left"==this.align&&(p.moveTo(this.lineWidth/2,this.width-this.lineWidth),p.lineTo(this.width,this.width-this.lineWidth),p.lineTo(this.lineWidth,this.lineWidth),p.lineTo(this.lineWidth,this.width-this.lineWidth)),"right"==this.align&&(p.moveTo(this.lineWidth/2,this.width-this.lineWidth),p.lineTo(this.width-this.lineWidth,this.width-this.lineWidth),p.lineTo(this.width-this.lineWidth,this.lineWidth),p.lineTo(this.lineWidth,this.width-this.lineWidth)),this.selected&&(p.fillStyle="rgba(255,255,255, 1)",p.fill(),p.strokeStyle="rgba(0, 0, 0, 1)",p.stroke(),p.closePath(),p.beginPath(),p.lineWidth=this.lineWidth,"left"==this.align&&(p.moveTo(this.selectSize,this.width-this.selectSize),p.lineTo(this.width-2*this.selectSize,this.width-this.selectSize),p.lineTo(this.selectSize,2*this.selectSize),p.lineTo(this.selectSize,this.width-this.selectSize)),"right"==this.align&&(p.moveTo(2*this.selectSize,this.width-this.selectSize),p.lineTo(this.width-this.selectSize,this.width-this.selectSize),p.lineTo(this.width-this.selectSize,2*this.selectSize),p.lineTo(2*this.selectSize,this.width-this.selectSize)));var t=Z(this.color);p.fillStyle="rgba("+t.r+","+t.g+","+t.b+", 1)",p.fill(),p.strokeStyle="rgba(0, 0, 0, 1)",p.stroke(),this.imageData=p.getImageData(0,0,this.width,this.width),o.drawImage(d,this.position.x+this.paddingX,this.position.y+this.paddingY)};var r=$.length;$[r]=n}var N=new Object;N.width=18,N.imageData=null,N.innerRadius,N.startAngle=0,N.outerRadius,N.outerStrokeStyle="rgba(0,0,0,0.2)",N.innerStrokeStyle="rgba(0,0,0,0.2)",N.pos,N.draw=function(){if(this.imageData)o.putImageData(this.imageData,0,0);else{for(var t=this.startAngle,e=0;e<=360;e++){var n=U(e-2),r=U(e);o.beginPath(),o.moveTo(x,x),o.arc(x,x,this.outerRadius,n,r,!1),o.closePath();var s=X(t/360,1,1);o.fillStyle="rgb("+s.r+", "+s.g+", "+s.b+")",o.fill(),++t>=360&&(t=0)}o.globalCompositeOperation="destination-out",o.beginPath(),o.arc(x,x,this.innerRadius,0,2*i),o.fill(),o.globalCompositeOperation="source-over",o.strokeStyle=this.innerStrokeStyle,o.lineWidth=2,o.stroke(),o.closePath(),o.beginPath(),o.arc(x,x,this.outerRadius,0,2*i),o.strokeStyle=this.outerStrokeStyle,o.lineWidth=2,o.stroke(),o.closePath(),this.imageData=o.getImageData(0,0,T,T)}},N.isDotIn=function(t){return Math.pow(this.pos.x-t.x,2)+Math.pow(this.pos.y-t.y,2)<Math.pow(this.outerRadius,2)&&Math.pow(this.pos.x-t.x,2)+Math.pow(this.pos.y-t.y,2)>Math.pow(this.innerRadius,2)};var B=new Object;B.lineWeight=2,B.height=4,B.paddingX=2,B.path;var I=new Object;I.width=18,I.padding=4,I.outerStrokeStyle="rgba(0,0,0,0.2)",I.innerStrokeStyle="rgba(0,0,0,0.2)",I.height,I.pos,I.updateSize=function(){this.pos={x:T+I.padding,y:I.padding},this.height=T-2*I.padding},I.draw=function(){var t=o.createLinearGradient(0,0,0,this.height),e=X(k.h,1,1);t.addColorStop(0,"rgba("+e.r+","+e.g+","+e.b+",1)"),t.addColorStop(1,"rgba("+e.r+","+e.g+","+e.b+",0)"),o.beginPath(),o.rect(this.pos.x,this.pos.y,this.width,this.height),o.fillStyle="white",o.fill(),o.fillStyle=t,o.fill(),o.strokeStyle="rgba(0,0,0, 0.2)",o.lineWidth=2,o.stroke(),o.closePath()},I.dotToAlpha=function(t){return 1-Math.abs(this.pos.y-t.y)/this.height},I.alphaToDot=function(t){return{x:0,y:this.height-this.height*t}},I.limitDotPosition=function(t){var e=t.y;return e<this.pos.y&&(e=this.pos.y),e>this.pos.y+this.height&&(e=this.pos.y+this.height),{x:this.pos.x,y:e}},I.isDotIn=function(t){return!(t.x<this.pos.x||t.x>this.pos.x+I.width||t.y<this.pos.y||t.y>this.pos.y+this.height)};var z=new Object;function L(t){var e=t.getBoundingClientRect(),i=0,n=0;return a&&(n=I.width+2*I.padding),t===s?e.width<=e.height?i=e.height:e.height<e.width&&(i=e.width):R?"height"==R?i=e.height:"width"==R&&(i=e.width):e.width>e.height?i=e.height:e.height>=e.width&&(i=e.width),i=parseInt(i),a&&(i-=n),!(i<=0)&&i}function W(t,e){var i=1,n=!1;if((t=t.trim(t)).length<=7)"#"==t.charAt(0)&&(t=t.slice(1)),3==t.length?n=t+t:6==t.length&&(n=t);else if("rgb"==t.substring(0,3)){var r=t.split(",");if(r.length>=3&&r.length<=4){r[0]=r[0].replace("rgba(",""),r[0]=r[0].replace("rgb(","");var s={r:parseInt(r[0]),g:parseInt(r[1]),b:parseInt(r[2])};s.r<=255&&s.g<=255&&s.b<=255&&(n=G(s),4==r.length&&((!(i=parseFloat(r[3]))||i<0)&&(i=0),i>1&&(i=1)))}}return(!1!==n||!e)&&(!1===n&&(n="000000"),"#"!=n.charAt(0)&&(n="#"+n),{h:n,a:i})}function V(){if(D.quad)return D.quad;var t=new Object;return t.size,t.padding=2,t.path,t.imageData=null,t.dotToSv=function(t){return{s:Math.abs(this.path[3].x-t.x)/this.size,v:Math.abs(this.path[3].y-t.y)/this.size}},t.svToDot=function(t){var e=this.path[0].x,i=this.path[0].y,n=.02;T<150?n=.07:T<100&&(n=.16);for(var r=0;r<this.size;r++)for(var s=0;s<this.size;s++){var o={x:s+e,y:r+i},l=this.dotToSv(o),a=Math.abs(l.s-t.s),h=Math.abs(l.v-t.v);if(a<n&&h<n)return o}return{x:0,y:0}},t.limitDotPosition=function(t){var e=t.x,i=t.y;return e<this.path[0].x&&(e=this.path[0].x),e>this.path[0].x+this.size&&(e=this.path[0].x+this.size),i<this.path[0].y&&(i=this.path[0].y),i>this.path[0].y+this.size&&(i=this.path[0].y+this.size),{x:e,y:i}},t.draw=function(){this.imageData||(this.imageData=o.createImageData(this.size,this.size));for(var t=0,e=this.path[0].x,i=this.path[0].y,n=0;n<this.size;n++)for(var r=0;r<this.size;r++){var s={x:r+e,y:n+i},l=this.dotToSv(s),a=X(k.h,l.s,l.v);this.imageData.data[t+0]=a.r,this.imageData.data[t+1]=a.g,this.imageData.data[t+2]=a.b,this.imageData.data[t+3]=255,t+=4}o.putImageData(this.imageData,e,i),o.beginPath(),o.strokeStyle="rgba(0,0,0, 0.2)",o.lineWidth=2;for(t=0;t<=this.path.length-1;++t)0==t?o.moveTo(this.path[t].x,this.path[t].y):o.lineTo(this.path[t].x,this.path[t].y);o.stroke(),o.closePath()},t.updateSize=function(){var t=2*N.innerRadius-2*B.paddingX-2*this.padding;this.size=Math.floor(t/Math.sqrt(2)),this.path=new Array,this.path[0]={x:this.size/2*-1,y:this.size/2*-1},this.path[1]={x:this.path[0].x+this.size,y:this.path[0].y},this.path[2]={x:this.path[1].x,y:this.path[1].y+this.size},this.path[3]={x:this.path[2].x-this.size,y:this.path[2].y},this.path[4]={x:this.path[0].x,y:this.path[0].y};for(var e=0;e<=this.path.length-1;++e)this.path[e].x+=N.pos.x,this.path[e].y+=N.pos.y},t.isDotIn=function(t){return!(t.x<this.path[0].x||t.x>this.path[0].x+this.size||t.y<this.path[0].y||t.y>this.path[0].y+this.size)},D.quad=t,t}function j(){if(D.triangle)return D.triangle;var t=new Object;return t.size,t.padding=2,t.path,t.imageData=null,t.followWheel=!0,t.s,t.sOnTop=!1,t.outerRadius,t.limitDotPosition=function(t){var e=t.x,i=t.y,n=this.path[0].x,r=this.path[2].x,s=e,o=i;s=Math.min(Math.max(r,s),n);var l=(this.path[0].y-this.path[1].y)/(this.path[0].x-this.path[1].x),a=Math.ceil(this.path[1].y+l*(s-this.path[1].x));l=(this.path[0].y-this.path[2].y)/(this.path[0].x-this.path[2].x);var h=Math.floor(this.path[2].y+l*(s-this.path[2].x));return e<r&&(N.pos.y,N.pos.x,o=i),{x:s,y:o=Math.min(Math.max(a,o),h)}},t.svToDot=function(t){var i=.02;T<150?i=.07:T<100&&(i=.16);for(var n=0;n<this.size;n++)for(var r=0;r<this.size;r++){var s={x:this.path[1].x+r,y:this.path[1].y+n};if(e.isDotIn(s)){var o=this.dotToSv(s),l=Math.abs(o.s-t.s),a=Math.abs(o.v-t.v);if(l<i&&a<i)return s}}return{x:0,y:0}},t.draw=function(){this.imageData||(this.imageData=p.createImageData(this.size,this.size)),d.width=this.size,d.height=this.size;for(var t=this.path[1].x,i=this.path[1].y,n=0,r=0;r<this.size;r++)for(var s=0;s<this.size;s++){var l={x:this.path[1].x+s,y:this.path[1].y+r};if(e.isDotIn(l)){var a=this.dotToSv(l),h=X(k.h,a.s,a.v);this.imageData.data[n+0]=h.r,this.imageData.data[n+1]=h.g,this.imageData.data[n+2]=h.b,this.imageData.data[n+3]=255}else this.imageData.data[n+0]=0,this.imageData.data[n+1]=0,this.imageData.data[n+2]=0,this.imageData.data[n+3]=0;n+=4}p.putImageData(this.imageData,0,0),o.drawImage(d,t,i),o.beginPath(),o.strokeStyle="rgba(0, 0, 0, 0.3)",o.lineWidth=2;var c=this.path;for(n=0;n<=c.length-1;++n)0==n?o.moveTo(c[n].x,c[n].y):o.lineTo(c[n].x,c[n].y);o.stroke(),o.closePath()},t.calcS=function(t){return Math.abs((t[1].x-t[0].x)*(t[2].y-t[0].y)-(t[2].x-t[0].x)*(t[1].y-t[0].y))/2},t.dotToSv=function(t){var e,i,n=function(t,e){var i=(e[0].x-e[1].x)*(e[0].x-e[1].x)+(e[0].y-e[1].y)*(e[0].y-e[1].y),n=(t.x-e[0].x)*(e[1].x-e[0].x)+(t.y-e[0].y)*(e[1].y-e[0].y),r=!0,s=n/i;s<0&&(s=0,r=!1);s>1&&(s=1,r=!1);return{x:e[0].x+s*(e[1].x-e[0].x),y:e[0].y+s*(e[1].y-e[0].y),pt:r}}({x:t.x,y:t.y},this.vol),r=(e=n,i=this.vol[0],Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2)));r<1&&(r=Math.floor(r)),r>this.h-1&&(r=this.h);var s=r/this.h,o=Math.abs(K(t,this.sSide));return o<30&&(o=30),o=60-(o-=30),{s:o/=60,v:s}},t.isDotIn=function(t){var e=[{x:this.path[0].x,y:this.path[0].y},{x:this.path[1].x,y:this.path[1].y},{x:t.x,y:t.y}],i=this.calcS(e);return e[1]={x:this.path[2].x,y:this.path[2].y},i+=this.calcS(e),e[0]={x:this.path[1].x,y:this.path[1].y},i+=this.calcS(e),Math.ceil(i)==Math.ceil(this.s)},t.updateSize=function(){this.outerRadius=N.innerRadius-B.paddingX-this.padding,this.size=Math.floor(2*this.outerRadius*Math.sin(U(60)));var t=Math.sqrt(3)/2*this.size;this.h=Math.sqrt(3)/2*this.size,this.path=new Array,this.path[0]={x:this.outerRadius,y:0},this.path[1]={x:this.path[0].x-t,y:this.size/2*-1},this.path[2]={x:this.path[1].x,y:this.size/2},this.path[3]={x:this.path[0].x,y:this.path[0].y};for(var e=0;e<=this.path.length-1;++e)this.path[e].x+=N.pos.x,this.path[e].y+=N.pos.y;if(this.vol=new Array,this.s=this.calcS(this.path),this.sOnTop){var i=Y(this.path[0],this.path[2]);this.vol[0]={x:this.path[1].x,y:this.path[1].y},this.vol[1]={x:i.x,y:i.y},this.sSide=this.path[1]}else{i=Y(this.path[0],this.path[1]);this.vol[0]={x:this.path[2].x,y:this.path[2].y},this.vol[1]={x:i.x,y:i.y},this.sSide=this.path[2]}},D.triangle=t,t}function q(t,e,i,n){return"object"!=typeof t&&(t=document.getElementById(t)),!!t&&(n||(n=""),u[n+e]=i,t.addEventListener?t.addEventListener(e,u[n+e]):t.attachEvent("on"+e,u[n+e]),!0)}function H(t,e,i){return"object"!=typeof t&&(t=document.getElementById(t)),!!t&&(i||(i=""),!!u[i+e]&&(t.removeEventListener?t.removeEventListener(e,u[i+e]):t.detachEvent("on"+e,u[i+e]),u[i+e]=null,!0))}function X(t,e,i){var n,r,s,o,l,a,h,c;switch(t&&void 0===e&&void 0===i&&(e=t.s,i=t.v,t=t.h),a=i*(1-e),h=i*(1-(l=6*t-(o=Math.floor(6*t)))*e),c=i*(1-(1-l)*e),o%6){case 0:n=i,r=c,s=a;break;case 1:n=h,r=i,s=a;break;case 2:n=a,r=i,s=c;break;case 3:n=a,r=h,s=i;break;case 4:n=c,r=a,s=i;break;case 5:n=i,r=a,s=h}return{r:Math.floor(255*n),g:Math.floor(255*r),b:Math.floor(255*s)}}function F(t,e,i){t&&void 0===e&&void 0===i&&(e=t.g,i=t.b,t=t.r),t/=255,e/=255,i/=255;var n,r,s=Math.max(t,e,i),o=Math.min(t,e,i),l=s,a=s-o;if(r=0==s?0:a/s,s==o)n=0;else{switch(s){case t:n=(e-i)/a+(e<i?6:0);break;case e:n=(i-t)/a+2;break;case i:n=(t-e)/a+4}n/=6}return{h:n,s:r,v:l}}function Z(t){var e=parseInt("#"==t.charAt(0)?t.slice(1):t,16);return{r:e>>16,g:e>>8&255,b:255&e}}function G(t){var e=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e};return"#"+e(t.r)+e(t.g)+e(t.b)}function U(t){return t*(i/180)}function Y(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}function K(t,e,n){e||(e={x:0,y:0});var r=t.x-e.x,s=t.y-e.y,o=180*Math.atan2(s,r)/i;return n&&o<0&&(o=360+o),o}function J(){y=2+B.paddingX,g=!1,N.imageData=null,x=T/2,N.pos={x:x,y:x},N.outerRadius=x-y,N.innerRadius=N.outerRadius-N.width,B.path=[{x:N.innerRadius-B.paddingX,y:-1*B.height},{x:N.outerRadius+B.paddingX,y:-1*B.height},{x:N.outerRadius+B.paddingX,y:B.height},{x:N.innerRadius-B.paddingX,y:B.height},{x:N.innerRadius-B.paddingX,y:-1*B.height}];var t=T;a&&(t+=I.width+2*I.padding),"CANVAS"!=C.tagName&&(C.style.width=t+"px",C.style.height=T+"px"),s.width=t,s.height=T,Q!=s&&(s.style.width=t+"px",s.style.height=T+"px");for(var i=0;i<=$.length-1;++i)$[i].updateSize();_&&(_.imageData.triangle=null,_.imageData.quad=null,_.updateSize()),e.updateSize(),a&&I.updateSize()}function tt(t){if(b){if(f.updateinput)if(!(0,f.updateinput)(A,b,t))return;var e="rgba("+S.r+", "+S.g+", "+S.b+", "+M.toFixed(2)+")";t||(b.value=M<1&&"mixed"===v?e:"hex"===v||"mixed"===v?P:e),O&&(k.v<.5?b.style.color="#FFF":b.style.color="#000",b.style.background=e)}}function et(){q(s,"mousedown",(function(t){A.mouseDownEvent(t)}),"wait_action_"),q(s,"touchstart",(function(t){A.mouseDownEvent(t)}),"wait_action_"),q(s,"mouseout",(function(t){A.mouseOutEvent(t)}),"wait_action_"),q(window,"touchmove",(function(t){A.touchMoveEvent(t)}),"wait_action_"),q(s,"mousemove",(function(t){A.mouseMoveRest(t)}),"wait_action_")}function it(){H(s,"mousedown","wait_action_"),H(s,"touchstart","wait_action_"),H(s,"mouseout","wait_action_"),H(window,"touchmove","wait_action_"),H(s,"mousemove","wait_action_")}function nt(t){var e,i;t=t||window.event;var n=document.body.scrollLeft+document.documentElement.scrollLeft,r=document.body.scrollTop+document.documentElement.scrollTop;"touchend"==t.type?(e=t.changedTouches[0].clientX+n,i=t.changedTouches[0].clientY+r):"touchmove"==t.type||t.touches?(e=t.touches[0].clientX+n,i=t.touches[0].clientY+r):(e=t.clientX+n,i=t.clientY+r);var o=s.getBoundingClientRect();return{x:e-=o.left+n,y:i-=o.top+r}}function rt(t){for(var e=!1,i=0;i<=$.length-1;++i)$[i].selected&&(e=i),$[i].selected=!1;var n=!1;for(i=0;i<=$.length-1;++i)if(i==t){$[i].selected=!0,A.setColorByHex($[i].color),n=!0;break}n&&f.selectcolorsaver&&(0,f.selectcolorsaver)(A,$[t]);return n||!1===e||($[e].selected=!0),n}function st(){for(var t=0;t<=$.length-1;++t)$[t].selected&&($[t].color=P)}function ot(){if($.length)for(var t=0;t<=$.length-1;++t)$[t].draw()}function lt(){if(!o||(o.clearRect(0,0,s.width,s.height),!(g?(o.putImageData(m,0,0),ot(),1):(N.draw(),e.draw(),a&&I.draw(),ot(),_&&_.draw(),h||(m=o.getImageData(0,0,s.width,s.height),g=!0),1))))return!1;var t=360*k.h-N.startAngle;if(a){o.beginPath();var n=I.height*(1-M);o.rect(I.pos.x-2,I.padding+n-1,I.width+4,2),o.strokeStyle="rgba(0,0,0, 0.8)",o.lineWidth=2,o.stroke(),o.closePath()}o.beginPath();for(var l=function(t,e){e=U(e);for(var i=new Array,n=0;n<=t.length-1;++n)i[n]={x:t[n].x*Math.cos(e)-t[n].y*Math.sin(e),y:t[n].x*Math.sin(e)+t[n].y*Math.cos(e)};return i}(B.path,t,(N.pos.x,N.pos.y)),c=0;c<=l.length-1;++c)l[c].x+=N.pos.x,l[c].y+=N.pos.y,0==c?o.moveTo(l[c].x,l[c].y):o.lineTo(l[c].x,l[c].y);return o.strokeStyle="rgba(0,0,0,0.8)",o.lineWidth=B.lineWeight,o.stroke(),o.closePath(),k.v>.5&&k.s<.5?o.strokeStyle="rgba(0, 0, 0, 1)":o.strokeStyle="rgba(255, 255, 255, 1)",o.beginPath(),o.lineWidth=2,o.arc(k.x,k.y,r.radius,0,2*i),o.stroke(),o.closePath(),!1}z.svCursorData=null,z.stCursor=null,z.curType=0,z.size=16,z.cEl=document.body,z.initSvCursor=function(){if(!s)return!1;if(this.curType=1,this.stCursor||(this.stCursor=window.getComputedStyle(this.cEl).cursor,this.stCursor||(this.stCursor="auto")),this.svCursorData)return this.cEl.style.cursor=this.svCursorData,!0;if(!d)return!1;var t=this.size+2;d.width=t,d.height=t,p.clearRect(0,0,this.size,this.size),p.strokeStyle="rgba(255, 255, 255, 1)",p.beginPath(),p.lineWidth=2,p.arc(t/2,t/2,this.size/2,0,2*i),p.stroke(),p.closePath();var e=t,n=d.toDataURL();return this.svCursorData="url("+n+") "+e/2+" "+e/2+", auto",!!this.svCursorData&&(this.cEl.style.cursor=this.svCursorData,-1===this.cEl.style.cursor.indexOf(n)&&(this.svCursorData="crosshair",this.cEl.style.cursor="crosshair"),!0)},z.initStandartCursor=function(){this.stCursor&&(z.curType=0,this.cEl.style.cursor=this.stCursor)},z.updateCursor=function(t){n&&(L0.cursorLock||(e.isDotIn(t)?z.initSvCursor():z.initStandartCursor()))},this.popUpClose=function(t){if(!1!==w.tag){if(t){if(t.target==b||t.target==s)return!1;if(t.target==w.tag)return!1}w.tag.style.display="none",L0.activePopUp==A&&(L0.activePopUp=!1)}},this.popUpShow=function(t){if(!1!==w.tag){if(f.popupshow)if(!(0,f.popupshow)(A,t))return;L0.popupEventsInclude||(q(document,"click",(function(t){return!!L0.activePopUp&&L0.activePopUp.popUpClose(t)}),"popup_close_"),q(window,"resize",(function(t){if(L0.activePopUp)return L0.activePopUp.popUpShow(t)}),"popup_resize_"),L0.popupEventsInclude=!0),L0.activePopUp&&L0.activePopUp.popUpClose(!1);var e=A.getCanvas().width,i=A.getAlphaFig();i&&(e-=i.width+i.padding);var n=window.getComputedStyle(w.tag),r=parseInt(n.paddingBottom)+parseInt(n.paddingTop);r<=0&&(r=0);var s=b.getBoundingClientRect(),o=s.top+(window.scrollY||window.pageYOffset||document.body.scrollTop)-r,l=s.left+(window.scrollX||window.pageXOffset||document.body.scrollLeft);return w.tag.style.top=o-e-w.margin+"px",w.tag.style.left=l+"px",w.tag.style.display="block",L0.activePopUp=A,!1}},this.setHueByDot=function(t){var e=K(t,N.pos)+N.startAngle;(e<0&&(e=360+e),k.h=e/360,S=X(k.h,k.s,k.v),P=G(S),st(),f.change)&&(0,f.change)(A);tt(),g=!1,lt()},this.setColorForColorSaver=function(t,e){var i=W(t,!0);if(i){var n=A.getColorSaver(e);return n.selected?this.setColorByHex(t,!1):(n.color=i.h,lt()),!0}},this.setColor=function(t,e){A.setColorByHex(t,e)},this.setColorByHex=function(t,i){i||(i=!1);var n=M;if(!1!==t){if(!t||!t.length)return;var r=W(t,!0);if(!r)return;t=r.h,a&&(n=r.a)}else t=P;if(a&&t==P&&g&&n!=M)return M=n,void lt();if(!P||t!=P||!g){M=n,S=Z(t),P=t,k=F(S);var s=e.svToDot(k);if(k.x=s.x,k.y=s.y,g=!1,st(),lt(),f.change)(0,f.change)(A);tt(i)}},this.setAlphaByDot=function(t){(M=I.dotToAlpha(t),f.change)&&(0,f.change)(A);tt(),lt()},this.setAlpha=function(t){M=t,tt(),lt()},this.setColorByDot=function(t){var i=e.dotToSv(t);(k.s=i.s,k.v=i.v,k.x=t.x,k.y=t.y,k.s>1&&(k.s=1),k.s<0&&(k.s=0),k.v>1&&(k.v=1),k.v<0&&(k.v=0),S=X(k.h,k.s,k.v),P=G(S),st(),f.change)&&(0,f.change)(A);tt(),lt()},this.mouseOutEvent=function(t){z.curType>0&&!L0.cursorLock&&z.initStandartCursor()},this.mouseMoveRest=function(t){if(!h&&c){c=!1;var e=nt(t);if(z.updateCursor(e),requestAnimationFrame((function(){c=!0})),f.mousemoverest)(0,f.mousemoverest)(t,A,e)}},this.touchMoveEvent=function(t){h&&event.preventDefault()},this.mouseDownEvent=function(t){t.preventDefault();var i,n=!1,r=nt(t);if(N.isDotIn(r))h="wheel",A.setHueByDot(r),i=function(t){A.wheelMouseMove(t,r)},n=function(t){L0.cursorLock=!1,A.wheelMouseUp(t,r)};else if(e.isDotIn(r))h="sv",A.setColorByDot(r),i=function(t){A.svMouseMove(t,r)},n=function(t){L0.cursorLock=!1,A.svMouseUp(t,r)};else if(a&&I.isDotIn(r))h="alpha",A.setAlphaByDot(r),i=function(t){A.alphaMouseMove(t,r)},n=function(t){L0.cursorLock=!1,A.alphaMouseUp(t,r)};else if(_&&_.isDotIn(r))A.setMethod();else if($.length)for(var s=0;s<=$.length-1;++s)if($[s].isDotIn(r)){rt(s);break}i&&n&&(it(),L0.cursorLock=A,q(document,"mouseup",n,"action_process_"),q(document,"mousemove",i,"action_process_"),q(document,"touchend",n,"action_process_"),q(document,"touchmove",i,"action_process_"))},this.wheelMouseMove=function(t,e){if(t.preventDefault(),h&&c){c=!1;var i=nt(t);if(requestAnimationFrame((function(){c=!0})),A.setHueByDot(i),f.mousemoveh)(0,f.mousemoveh)(t,A,i)}},this.wheelMouseUp=function(t,e){if(t.preventDefault(),h){H(document,"mouseup","action_process_"),H(document,"mousemove","action_process_"),H(document,"touchend","action_process_"),H(document,"touchmove","action_process_"),et(),h=!1,g=!1,lt();var i=nt(t);if(z.updateCursor(i),f.mouseuph)(0,f.mouseuph)(t,A,i)}},this.alphaMouseMove=function(t,e){if(t.preventDefault(),h&&c){c=!1;var i=nt(t);if(i=I.limitDotPosition(i),requestAnimationFrame((function(){c=!0})),A.setAlphaByDot(i),f.mousemovealpha)(0,f.mousemovealpha)(t,A,i)}},this.alphaMouseUp=function(t,e){if(t.preventDefault(),h){H(document,"mouseup","action_process_"),H(document,"mousemove","action_process_"),H(document,"touchend","action_process_"),H(document,"touchmove","action_process_"),et(),h=!1;var i=nt(t);if(z.updateCursor(i),f.mouseupalpha)(0,f.mouseupalpha)(t,A,i)}},this.svMouseMove=function(t,i){if(t.preventDefault(),h&&c){c=!1;var n=nt(t);if(n=e.limitDotPosition(n),requestAnimationFrame((function(){c=!0})),A.setColorByDot(n),f.mousemovesv)(0,f.mousemovesv)(t,A,n)}},this.svMouseUp=function(t,e){if(t.preventDefault(),h){H(document,"mouseup","action_process_"),H(document,"mousemove","action_process_"),H(document,"touchend","action_process_"),H(document,"touchmove","action_process_"),et(),h=!1;var i=nt(t);if(z.updateCursor(i),a&&(g=!1,lt()),f.mouseupsv)(0,f.mouseupsv)(t,A,i)}},this.addUserEvent=function(t,e){return f[t]=e,!0},this.removeUserEvent=function(t){return!!f[t]&&(f[t]=null,!0)},this.getCanvas=function(){return!!o&&s},this.getCtx=function(){return o||!1},this.getInput=function(){return b},this.getSvFig=function(){return e},this.getSvFigCursor=function(){return r},this.getWheel=function(){return N},this.getWheelCursor=function(){return B},this.getCurColorHsv=function(){return k},this.getCurColorRgb=function(){return S},this.getCurColorHex=function(){return P},this.getCurColorRgba=function(){return{r:S.r,g:S.g,b:S.b,a:M}},this.getCurAlpha=function(){return M},this.getAlphaFig=function(){return!!a&&I},this.getPopup=function(){return w},this.getSize=function(){return T},this.getColorSaver=function(t){for(var e=0;e<=$.length-1;++e)if(!t&&$[e].selected||$[e].align==t)return $[e].rgb=Z($[e].color),$[e].hsv=F($[e].rgb.r,$[e].rgb.g,$[e].rgb.b),$[e]},this.setColorSaver=function(t){if(!t)return!1;for(var e=0;e<=$.length-1;++e)if($[e].align==t)return rt(e),$[e]},this.updateView=function(t){return!!o&&(t&&(N.imageData=null,e.imageData=null,m=null),g=!1,J(),lt(),!0)},this.resize=function(t,i){return!!o&&(t==T&&!i||(g=!1,N.imageData=null,e.imageData=null,m=null,T=t,J(),A.setColorByHex(!1),!1))},this.syncSize=function(t){if(!Q)return!1;var e=L(Q);return e&&A.resize(e),!1},this.setMethod=function(t){if(t||(t="triangle","triangle"==l&&(t="quad")),t==l)return!1;if("quad"!=l&&"triangle"!=l)return!1;("quad"==(l=t)&&(e=V()),"triangle"==l&&(e=j()),A.resize(T,!0),f.setmethod)&&(0,f.setmethod)(A,l);return!0},this.destroy=function(){if(!A)return!1;z.curType>0&&(L0.cursorLock=!1,z.initStandartCursor()),h&&(H(document,"mouseup","action_process_"),H(document,"mousemove","action_process_"),H(document,"touchend","action_process_"),H(document,"touchmove","action_process_"),h=!1),w.tag&&H(b,"click","popup_"),b&&(H(b,"click","input_edit_"),H(b,"change","input_edit_"),H(b,"keyup","input_edit_"),H(b,"keypress","input_edit_")),L0.popupEventsInclude&&u.popup_close_click&&(L0.activePopUp&&L0.activePopUp.popUpClose(!1),H(document,"click","popup_close_"),H(window,"resize","popup_resize_"),L0.popupEventsInclude=!1),N.imageData=null,e.imageData=null,m=null,d=null,C&&C.parentNode&&C.parentNode.removeChild(C),Q&&H(window,"resize","canvas_"),it(),A=null},function(t){var r="",h="";if(void 0!==t.alpha_slider&&(t.alphaSlider=t.alpha_slider),void 0!==t.input_color&&(t.inputColor=t.input_color),void 0!==t.input_format&&(t.inputFormat=t.input_format),t.input&&"object"!=typeof t.input?(t.input=document.getElementById(t.input),b=t.input):"object"==typeof t.input&&(b=t.input),void 0!==t.changeCursor&&(n=t.changeCursor),void 0!==t.alpha&&(M=t.alpha),void 0!==t.alphaSlider&&(a=t.alphaSlider),void 0!==t.inputColor&&(O=t.inputColor),void 0!==t.inputFormat&&(v=t.inputFormat),t.userEvents&&(f=t.userEvents),t.place&&"object"!=typeof t.place&&(h=t.place,t.place=document.getElementById(t.place)),t.place)C=t.place;else if(b){w.tag=document.createElement("div"),w.tag.className="popup-kelly-color",t.popupClass?w.tag.className=t.popupClass:(w.tag.className="popup-kelly-color",w.tag.style.position="absolute",w.tag.style.bottom="0px",w.tag.style.left="0px",w.tag.style.display="none",w.tag.style.backgroundColor="#e1e1e1",w.tag.style.border="1px solid #bfbfbf",w.tag.style.boxShadow="7px 7px 14px -3px rgba(0,0,0,0.24)",w.tag.style.borderTopLeftRadius="4px",w.tag.style.borderTopRightRadius="4px",w.tag.style.borderBottomLeftRadius="4px",w.tag.style.borderBottomRightRadius="4px",w.tag.style.padding="12px",w.tag.style.boxSizing="content-box"),C=w.tag,document.getElementsByTagName("body")[0].appendChild(w.tag),q(b,"click",(function(t){return A.popUpShow(t)}),"popup_")}else r+='| "place" ('+h+") not not found";var c=!1;if(t.color?c=W(t.color):b&&b.value&&(c=W(b.value)),c&&(P=c.h,a&&(M=c.a)),!t.method||"triangle"!=t.method&&"quad"!=t.method||(l=t.method),function(){if(!C)return!1;"CANVAS"!=C.tagName?(s=document.createElement("CANVAS"),C.appendChild(s)):s=C;void 0!==window.G_vmlCanvasManager&&(s=window.G_vmlCanvasManager.initElement(s),d=window.G_vmlCanvasManager.initElement(d));return!(!s.getContext||!s.getContext("2d"))&&(o=s.getContext("2d"),p=d.getContext("2d"),!0)}()||(r+=" | cant init canvas context"),t.resizeWith&&("object"!=typeof t.resizeWith&&"boolean"!=typeof t.resizeWith&&(t.resizeWith=document.getElementById(t.resizeWith)),Q=!0===t.resizeWith?s:t.resizeWith,t.resizeSide&&(R=t.resizeSide),Q&&(L(Q)&&(t.size=L(Q)),q(window,"resize",(function(t){return A.syncSize(t)}),"canvas_"))),t.size&&t.size>0&&(T=t.size),r)"undefined"!=typeof console&&console.log("KellyColorPicker : "+r);else{if("quad"==l&&(e=V()),"triangle"==l&&(e=j()),b){var u=function(t){(t=t||window.event).target||(t.target=t.srcElement),A.setColorByHex(t.target.value,!0)};q(b,"click",u,"input_edit_"),q(b,"change",u,"input_edit_"),q(b,"keyup",u,"input_edit_"),q(b,"keypress",u,"input_edit_")}t.colorSaver&&(E("left",!0),E("right")),t.methodSwitch&&((_=new Object).size,_.sizePercentage=10,_.position,_.paddingY=4,_.paddingX=4,_.imageData=new Array,_.lineWidth=2,_.color="#c1ebf5",_.updateSize=function(){this.size=parseInt(T-T/100*(100-this.sizePercentage)),this.size<16&&(this.size=16),this.position={x:this.paddingX,y:this.paddingY}},_.draw=function(){if(this.imageData[l])o.putImageData(this.imageData[l],this.position.x,this.position.y);else{var t=Z(this.color);d.width=this.size,d.height=this.size,p.clearRect(0,0,this.size,this.size),p.beginPath();var e,n="triangle";if("triangle"==l&&(n="quad"),p.beginPath(),this.size<35)var r=s=d.width/2;else{var s=d.width/2-this.lineWidth;p.arc(this.size/2,this.size/2,s,0,2*i),p.strokeStyle="rgba(0, 0, 0, 0.4)",p.lineWidth=this.lineWidth,p.stroke(),r=s-6,p.closePath(),p.beginPath(),p.arc(this.size/2,this.size/2,r,0,2*i),p.strokeStyle="rgba(0, 0, 0, 0.4)",p.lineWidth=this.lineWidth,p.stroke(),p.closePath()}if(p.beginPath(),"quad"==n){var a=2*r-4;e=Math.floor(a/Math.sqrt(2));var h=(this.size-e)/2;(c={x:h+e,y:h+e/2}).y=c.y-e/2,p.moveTo(c.x,c.y),p.lineTo(c.x-e,c.y),p.lineTo(c.x-e,c.y+e),p.lineTo(c.x,c.y+e)}else{e=Math.floor((2*r-4)*Math.sin(U(60)));var c={x:2*r+(s-r),y:this.size/2},u=Math.sqrt(3)/2*e;p.moveTo(c.x,c.y),p.lineTo(c.x-u,c.y-e/2),p.lineTo(c.x-u,c.y+e/2),p.lineTo(c.x,c.y)}p.lineTo(c.x,c.y),p.fillStyle="rgba("+t.r+","+t.g+","+t.b+", 1)",p.fill(),p.lineWidth=this.lineWidth,p.strokeStyle="rgba(0, 0, 0, 0.6)",p.stroke(),p.closePath(),this.imageData[l]=p.getImageData(0,0,d.width,d.width),o.drawImage(d,this.position.x,this.position.y)}},_.isDotIn=function(t){return t.x>=this.position.x&&t.x<=this.position.x+this.size&&t.y>=this.position.y&&t.y<=this.position.y+this.size}),et(),J(),A.setColorByHex(!1)}}(t)}function W0(t){let e,i,r,s,o,l,a,h,c,u,f,m,w,S,A,T,P,M;return{c(){e=b("div"),i=b("p"),r=O("The color for "),s=O(t[2]),o=O(":"),l=v(),a=b("canvas"),h=b("br"),c=v(),u=b("input"),f=v(),m=b("button"),w=O("Select"),S=v(),A=b("button"),T=O("Quit"),x(a,"id","picker"),x(u,"id","color"),u.value=t[0],C(m,"background-color",t[5].textAreaColor),C(m,"font-family",t[5].font),C(m,"color",t[5].textColor),C(m,"font-size",t[5].fontSize),x(m,"class","svelte-6rjn91"),C(A,"background-color",t[5].textAreaColor),C(A,"font-family",t[5].font),C(A,"color",t[5].textColor),C(A,"font-size",t[5].fontSize),x(A,"class","svelte-6rjn91"),x(e,"id","colorPicker"),C(e,"background-color",t[5].backgroundColor),C(e,"font-family",t[5].font),C(e,"color",t[5].textColor),C(e,"font-size",t[5].fontSize),x(e,"class","svelte-6rjn91")},m(n,g){p(n,e,g),d(e,i),d(i,r),d(i,s),d(i,o),d(e,l),d(e,a),t[11](a),d(e,h),d(e,c),d(e,u),t[12](u),d(e,f),d(e,m),d(m,w),d(e,S),d(e,A),d(A,T),P||(M=[y(u,"keyup",t[13]),y(m,"click",t[14]),y(A,"click",t[15])],P=!0)},p(t,i){4&i&&k(s,t[2]),1&i&&u.value!==t[0]&&(u.value=t[0]),32&i&&C(m,"background-color",t[5].textAreaColor),32&i&&C(m,"font-family",t[5].font),32&i&&C(m,"color",t[5].textColor),32&i&&C(m,"font-size",t[5].fontSize),32&i&&C(A,"background-color",t[5].textAreaColor),32&i&&C(A,"font-family",t[5].font),32&i&&C(A,"color",t[5].textColor),32&i&&C(A,"font-size",t[5].fontSize),32&i&&C(e,"background-color",t[5].backgroundColor),32&i&&C(e,"font-family",t[5].font),32&i&&C(e,"color",t[5].textColor),32&i&&C(e,"font-size",t[5].fontSize)},d(i){i&&g(e),t[11](null),t[12](null),P=!1,n(M)}}}function V0(e){let i,n=e[1]&&W0(e);return{c(){n&&n.c(),i=w()},m(t,e){n&&n.m(t,e),p(t,i,e)},p(t,[e]){t[1]?n?n.p(t,e):(n=W0(t),n.c(),n.m(i.parentNode,i)):n&&(n.d(1),n=null)},i:t,o:t,d(t){n&&n.d(t),t&&g(i)}}}function j0(t,e,i){let n;o(t,SK,(t=>i(5,n=t)));let r,s,{color:l=""}=e,{id:a=0}=e,{show:h=!1}=e,{item:c="circle"}=e,{explainText:u=""}=e;const f=E();function d(t,e){f(t,{data:e})}function p(){d("quitColorPicker",{})}function g(){document.body.style.cursor="default",d("colorChanged",{color:s.value,id:a})}function m(t){"Enter"===t.key&&(t.preventDefault(),t.stopPropagation(),g())}D((()=>{h&&new L0({place:r,input:s,colorSaver:!0,methodSwitch:!0})}));return t.$$set=t=>{"color"in t&&i(0,l=t.color),"id"in t&&i(9,a=t.id),"show"in t&&i(1,h=t.show),"item"in t&&i(10,c=t.item),"explainText"in t&&i(2,u=t.explainText)},[l,h,u,r,s,n,p,g,m,a,c,function(t){B[t?"unshift":"push"]((()=>{r=t,i(3,r)}))},function(t){B[t?"unshift":"push"]((()=>{s=t,i(4,s)}))},t=>{m(t)},t=>{g()},t=>{p()}]}L0.cursorLock=!1,L0.activePopUp=!1,L0.popupEventsInclude=!1,L0.attachToInputByClass=function(t,e){for(var i=new Array,n=document.getElementsByClassName(t),r=0;r<n.length;r++)e?e.input=n[r]:e={input:n[r],size:150},i.push(new L0(e));return i};class q0 extends lt{constructor(t){super(),ot(this,t,j0,V0,s,{color:0,id:9,show:1,item:10,explainText:2})}}function H0(t,e,i){const n=t.slice();return n[40]=e[i],n[42]=i,n}function X0(t,e,i){const n=t.slice();return n[43]=e[i],n}function F0(t){let e,i,r,s,o,l,a,h,c,u,f=void 0!==t[7]&&G0(t);return{c(){e=b("select"),f&&f.c(),i=b("option"),i.textContent="New",r=v(),s=b("button"),o=O("Update Theme"),l=v(),a=b("button"),h=O("Delete Theme"),i.__value="New",i.value=i.__value,x(e,"class","prefSelector svelte-1igofh5"),C(e,"background-color",t[8].textAreaColor),C(e,"color",t[8].textColor),void 0===t[5]&&q((()=>t[17].call(e))),C(s,"background-color",t[8].textAreaColor),C(s,"font-family",t[8].font),C(s,"color",t[8].textColor),C(s,"font-size",t[8].fontSize),x(s,"class","svelte-1igofh5"),C(a,"background-color",t[8].textAreaColor),C(a,"font-family",t[8].font),C(a,"color",t[8].textColor),C(a,"font-size",t[8].fontSize),x(a,"class","svelte-1igofh5")},m(n,g){p(n,e,g),f&&f.m(e,null),d(e,i),A(e,t[5]),p(n,r,g),p(n,s,g),d(s,o),p(n,l,g),p(n,a,g),d(a,h),c||(u=[y(e,"change",t[17]),y(e,"change",t[18]),y(s,"click",t[13]),y(a,"click",t[14])],c=!0)},p(t,n){void 0!==t[7]?f?f.p(t,n):(f=G0(t),f.c(),f.m(e,i)):f&&(f.d(1),f=null),256&n[0]&&C(e,"background-color",t[8].textAreaColor),256&n[0]&&C(e,"color",t[8].textColor),160&n[0]&&A(e,t[5]),256&n[0]&&C(s,"background-color",t[8].textAreaColor),256&n[0]&&C(s,"font-family",t[8].font),256&n[0]&&C(s,"color",t[8].textColor),256&n[0]&&C(s,"font-size",t[8].fontSize),256&n[0]&&C(a,"background-color",t[8].textAreaColor),256&n[0]&&C(a,"font-family",t[8].font),256&n[0]&&C(a,"color",t[8].textColor),256&n[0]&&C(a,"font-size",t[8].fontSize)},d(t){t&&g(e),f&&f.d(),t&&g(r),t&&g(s),t&&g(l),t&&g(a),c=!1,n(u)}}}function Z0(t){let e,i,r,s,o,l;return{c(){e=b("input"),i=v(),r=b("button"),s=O("Save New"),x(e,"class","prefInput svelte-1igofh5"),C(e,"background-color",t[8].textAreaColor),C(e,"color",t[8].textColor),C(r,"background-color",t[8].textAreaColor),C(r,"font-family",t[8].font),C(r,"color",t[8].textColor),C(r,"font-size",t[8].fontSize),x(r,"class","svelte-1igofh5")},m(n,a){p(n,e,a),S(e,t[5]),p(n,i,a),p(n,r,a),d(r,s),o||(l=[y(e,"input",t[15]),y(e,"change",t[16]),y(r,"click",t[12])],o=!0)},p(t,i){256&i[0]&&C(e,"background-color",t[8].textAreaColor),256&i[0]&&C(e,"color",t[8].textColor),160&i[0]&&e.value!==t[5]&&S(e,t[5]),256&i[0]&&C(r,"background-color",t[8].textAreaColor),256&i[0]&&C(r,"font-family",t[8].font),256&i[0]&&C(r,"color",t[8].textColor),256&i[0]&&C(r,"font-size",t[8].fontSize)},d(t){t&&g(e),t&&g(i),t&&g(r),o=!1,n(l)}}}function G0(t){let e,i=t[7],n=[];for(let e=0;e<i.length;e+=1)n[e]=U0(X0(t,i,e));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=w()},m(t,i){for(let e=0;e<n.length;e+=1)n[e].m(t,i);p(t,e,i)},p(t,r){if(128&r[0]){let s;for(i=t[7],s=0;s<i.length;s+=1){const o=X0(t,i,s);n[s]?n[s].p(o,r):(n[s]=U0(o),n[s].c(),n[s].m(e.parentNode,e))}for(;s<n.length;s+=1)n[s].d(1);n.length=i.length}},d(t){m(n,t),t&&g(e)}}}function U0(t){let e,i,n,r=t[43]+"";return{c(){e=b("option"),i=O(r),e.__value=n=t[43],e.value=e.__value},m(t,n){p(t,e,n),d(e,i)},p(t,s){128&s[0]&&r!==(r=t[43]+"")&&k(i,r),128&s[0]&&n!==(n=t[43])&&(e.__value=n,e.value=e.__value)},d(t){t&&g(e)}}}function Y0(t){let e,i,n,r,s,o,l,a,h,c,u,f,m=t[40].color+"";function w(...e){return t[19](t[40],...e)}return{c(){e=b("div"),i=b("label"),n=O("#"),r=O(t[42]),s=v(),o=b("div"),l=v(),a=b("label"),h=O(m),c=v(),x(i,"class","circlePickerLabel svelte-1igofh5"),x(o,"class","circlePicker svelte-1igofh5"),C(o,"background-color",t[40].color),x(a,"class","circlePickerLabel svelte-1igofh5"),x(e,"class","circlePickerWrap svelte-1igofh5")},m(t,g){p(t,e,g),d(e,i),d(i,n),d(i,r),d(e,s),d(e,o),d(e,l),d(e,a),d(a,h),d(e,c),u||(f=y(o,"click",w),u=!0)},p(e,i){t=e,256&i[0]&&C(o,"background-color",t[40].color),256&i[0]&&m!==(m=t[40].color+"")&&k(h,m)},d(t){t&&g(e),u=!1,f()}}}function K0(t){let e,i;return e=new q0({props:{item:t[4],explainText:t[6],color:t[0],id:t[1],show:t[2]}}),e.$on("colorChanged",t[37]),e.$on("quitColorPicker",t[38]),{c(){nt(e.$$.fragment)},m(t,n){rt(e,t,n),i=!0},p(t,i){const n={};16&i[0]&&(n.item=t[4]),64&i[0]&&(n.explainText=t[6]),1&i[0]&&(n.color=t[0]),2&i[0]&&(n.id=t[1]),4&i[0]&&(n.show=t[2]),e.$set(n)},i(t){i||(tt(e.$$.fragment,t),i=!0)},o(t){et(e.$$.fragment,t),i=!1},d(t){st(e,t)}}}function J0(t){let e,i,r,s,o,l,a,h,c,u,f,S,A,T,P,M,Q,R,$,_,D,E,N,B,I,z,L,W,V,j,q,H,X,F,Z,G,U,Y,it,nt,rt,st,ot,lt,at,ht,ct,ut,ft,dt,pt,gt,mt,bt,Ot,vt,wt,yt,xt,kt,St,Ct,At,Tt,Pt,Mt,Qt,Rt,$t,_t,Dt,Et,Nt,Bt,It,zt,Lt,Wt,Vt,jt,qt,Ht,Xt,Ft,Zt,Gt,Ut,Yt,Kt,Jt,te,ee,ie,ne,re,se,oe,le,ae,he,ce,ue,fe,de,pe,ge,me,be,Oe,ve,we,ye,xe,ke,Se,Ce,Ae,Te,Pe,Me,Qe,Re,$e,_e,De,Ee,Ne,Be,Ie,ze,Le,We,Ve,je,qe=t[8].textAreaColor+"",He=t[8].backgroundColor+"",Xe=t[8].textColor+"",Fe=t[8].borderColor+"",Ze=t[8].functionColor+"",Ge=t[8].stringColor+"",Ue=t[8].constantColor+"",Ye=t[8].keywordColor+"",Ke=t[8].highlightBackgroundColor+"",Je=t[8].selectionColor+"",ti=t[8].Cyan+"",ei=t[8].Green+"",ii=t[8].Orange+"",ni=t[8].Pink+"",ri=t[8].Purple+"",si=t[8].Red+"",oi=t[8].Yellow+"";function li(t,e){return t[3]?Z0:F0}let ai=li(t),hi=ai(t),ci=t[8].buttons,ui=[];for(let e=0;e<ci.length;e+=1)ui[e]=Y0(H0(t,ci,e));let fi=void 0!==t[8]&&K0(t);return{c(){e=b("div"),i=b("label"),i.textContent="Name of theme:",r=v(),hi.c(),s=v(),o=b("h3"),o.textContent="Circle Colors",l=v(),a=b("div");for(let t=0;t<ui.length;t+=1)ui[t].c();h=v(),c=b("h3"),c.textContent="Various Other Colors",u=v(),f=b("div"),S=b("label"),S.textContent="textAreaColor",A=v(),T=b("div"),P=v(),M=b("label"),Q=O(qe),R=v(),$=b("label"),$.textContent="backgroundColor",_=v(),D=b("div"),E=v(),N=b("label"),B=O(He),I=v(),z=b("label"),z.textContent="textColor",L=v(),W=b("div"),V=v(),j=b("label"),q=O(Xe),H=v(),X=b("label"),X.textContent="borderColor",F=v(),Z=b("div"),G=v(),U=b("label"),Y=O(Fe),it=v(),nt=b("label"),nt.textContent="functionColor",rt=v(),st=b("div"),ot=v(),lt=b("label"),at=O(Ze),ht=v(),ct=b("label"),ct.textContent="stringColor",ut=v(),ft=b("div"),dt=v(),pt=b("label"),gt=O(Ge),mt=v(),bt=b("label"),bt.textContent="constantColor",Ot=v(),vt=b("div"),wt=v(),yt=b("label"),xt=O(Ue),kt=v(),St=b("label"),St.textContent="keywordColor",Ct=v(),At=b("div"),Tt=v(),Pt=b("label"),Mt=O(Ye),Qt=v(),Rt=b("label"),Rt.textContent="highlightBackgroundColor",$t=v(),_t=b("div"),Dt=v(),Et=b("label"),Nt=O(Ke),Bt=v(),It=b("label"),It.textContent="selectionColor",zt=v(),Lt=b("div"),Wt=v(),Vt=b("label"),jt=O(Je),qt=v(),Ht=b("label"),Ht.textContent="Cyan",Xt=v(),Ft=b("div"),Zt=v(),Gt=b("label"),Ut=O(ti),Yt=v(),Kt=b("label"),Kt.textContent="Green",Jt=v(),te=b("div"),ee=v(),ie=b("label"),ne=O(ei),re=v(),se=b("label"),se.textContent="Orange",oe=v(),le=b("div"),ae=v(),he=b("label"),ce=O(ii),ue=v(),fe=b("label"),fe.textContent="Pink",de=v(),pe=b("div"),ge=v(),me=b("label"),be=O(ni),Oe=v(),ve=b("label"),ve.textContent="Purple",we=v(),ye=b("div"),xe=v(),ke=b("label"),Se=O(ri),Ce=v(),Ae=b("label"),Ae.textContent="Red",Te=v(),Pe=b("div"),Me=v(),Qe=b("label"),Re=O(si),$e=v(),_e=b("label"),_e.textContent="Yellow",De=v(),Ee=b("div"),Ne=v(),Be=b("label"),Ie=O(oi),ze=v(),fi&&fi.c(),Le=w(),x(e,"id","themeName"),x(e,"class","svelte-1igofh5"),x(a,"class","circlePickersWrap svelte-1igofh5"),x(S,"class","variousPickerLabel1 svelte-1igofh5"),x(T,"class","circlePicker svelte-1igofh5"),C(T,"background-color",t[8].textAreaColor),x(M,"class","variousPickerLabel2 svelte-1igofh5"),x($,"class","variousPickerLabel1 svelte-1igofh5"),x(D,"class","circlePicker svelte-1igofh5"),C(D,"background-color",t[8].backgroundColor),x(N,"class","variousPickerLabel2 svelte-1igofh5"),x(z,"class","variousPickerLabel1 svelte-1igofh5"),x(W,"class","circlePicker svelte-1igofh5"),C(W,"background-color",t[8].textColor),x(j,"class","variousPickerLabel2 svelte-1igofh5"),x(X,"class","variousPickerLabel1 svelte-1igofh5"),x(Z,"class","circlePicker svelte-1igofh5"),C(Z,"background-color",t[8].borderColor),x(U,"class","variousPickerLabel2 svelte-1igofh5"),x(nt,"class","variousPickerLabel1 svelte-1igofh5"),x(st,"class","circlePicker svelte-1igofh5"),C(st,"background-color",t[8].functionColor),x(lt,"class","variousPickerLabel2 svelte-1igofh5"),x(ct,"class","variousPickerLabel1 svelte-1igofh5"),x(ft,"class","circlePicker svelte-1igofh5"),C(ft,"background-color",t[8].stringColor),x(pt,"class","variousPickerLabel2 svelte-1igofh5"),x(bt,"class","variousPickerLabel1 svelte-1igofh5"),x(vt,"class","circlePicker svelte-1igofh5"),C(vt,"background-color",t[8].constantColor),x(yt,"class","variousPickerLabel2 svelte-1igofh5"),x(St,"class","variousPickerLabel1 svelte-1igofh5"),x(At,"class","circlePicker svelte-1igofh5"),C(At,"background-color",t[8].keywordColor),x(Pt,"class","variousPickerLabel2 svelte-1igofh5"),x(Rt,"class","variousPickerLabel1 svelte-1igofh5"),x(_t,"class","circlePicker svelte-1igofh5"),C(_t,"background-color",t[8].highlightBackgroundColor),x(Et,"class","variousPickerLabel2 svelte-1igofh5"),x(It,"class","variousPickerLabel1 svelte-1igofh5"),x(Lt,"class","circlePicker svelte-1igofh5"),C(Lt,"background-color",t[8].selectionColor),x(Vt,"class","variousPickerLabel2 svelte-1igofh5"),x(Ht,"class","variousPickerLabel1 svelte-1igofh5"),x(Ft,"class","circlePicker svelte-1igofh5"),C(Ft,"background-color",t[8].Cyan),x(Gt,"class","variousPickerLabel2 svelte-1igofh5"),x(Kt,"class","variousPickerLabel1 svelte-1igofh5"),x(te,"class","circlePicker svelte-1igofh5"),C(te,"background-color",t[8].Green),x(ie,"class","variousPickerLabel2 svelte-1igofh5"),x(se,"class","variousPickerLabel1 svelte-1igofh5"),x(le,"class","circlePicker svelte-1igofh5"),C(le,"background-color",t[8].Orange),x(he,"class","variousPickerLabel2 svelte-1igofh5"),x(fe,"class","variousPickerLabel1 svelte-1igofh5"),x(pe,"class","circlePicker svelte-1igofh5"),C(pe,"background-color",t[8].Pink),x(me,"class","variousPickerLabel2 svelte-1igofh5"),x(ve,"class","variousPickerLabel1 svelte-1igofh5"),x(ye,"class","circlePicker svelte-1igofh5"),C(ye,"background-color",t[8].Purple),x(ke,"class","variousPickerLabel2 svelte-1igofh5"),x(Ae,"class","variousPickerLabel1 svelte-1igofh5"),x(Pe,"class","circlePicker svelte-1igofh5"),C(Pe,"background-color",t[8].Red),x(Qe,"class","variousPickerLabel2 svelte-1igofh5"),x(_e,"class","variousPickerLabel1 svelte-1igofh5"),x(Ee,"class","circlePicker svelte-1igofh5"),C(Ee,"background-color",t[8].Yellow),x(Be,"class","variousPickerLabel2 svelte-1igofh5"),x(f,"id","variousOtherColorsDiv"),x(f,"class","svelte-1igofh5")},m(n,g){p(n,e,g),d(e,i),d(e,r),hi.m(e,null),p(n,s,g),p(n,o,g),p(n,l,g),p(n,a,g);for(let t=0;t<ui.length;t+=1)ui[t].m(a,null);p(n,h,g),p(n,c,g),p(n,u,g),p(n,f,g),d(f,S),d(f,A),d(f,T),d(f,P),d(f,M),d(M,Q),d(f,R),d(f,$),d(f,_),d(f,D),d(f,E),d(f,N),d(N,B),d(f,I),d(f,z),d(f,L),d(f,W),d(f,V),d(f,j),d(j,q),d(f,H),d(f,X),d(f,F),d(f,Z),d(f,G),d(f,U),d(U,Y),d(f,it),d(f,nt),d(f,rt),d(f,st),d(f,ot),d(f,lt),d(lt,at),d(f,ht),d(f,ct),d(f,ut),d(f,ft),d(f,dt),d(f,pt),d(pt,gt),d(f,mt),d(f,bt),d(f,Ot),d(f,vt),d(f,wt),d(f,yt),d(yt,xt),d(f,kt),d(f,St),d(f,Ct),d(f,At),d(f,Tt),d(f,Pt),d(Pt,Mt),d(f,Qt),d(f,Rt),d(f,$t),d(f,_t),d(f,Dt),d(f,Et),d(Et,Nt),d(f,Bt),d(f,It),d(f,zt),d(f,Lt),d(f,Wt),d(f,Vt),d(Vt,jt),d(f,qt),d(f,Ht),d(f,Xt),d(f,Ft),d(f,Zt),d(f,Gt),d(Gt,Ut),d(f,Yt),d(f,Kt),d(f,Jt),d(f,te),d(f,ee),d(f,ie),d(ie,ne),d(f,re),d(f,se),d(f,oe),d(f,le),d(f,ae),d(f,he),d(he,ce),d(f,ue),d(f,fe),d(f,de),d(f,pe),d(f,ge),d(f,me),d(me,be),d(f,Oe),d(f,ve),d(f,we),d(f,ye),d(f,xe),d(f,ke),d(ke,Se),d(f,Ce),d(f,Ae),d(f,Te),d(f,Pe),d(f,Me),d(f,Qe),d(Qe,Re),d(f,$e),d(f,_e),d(f,De),d(f,Ee),d(f,Ne),d(f,Be),d(Be,Ie),p(n,ze,g),fi&&fi.m(n,g),p(n,Le,g),We=!0,Ve||(je=[y(T,"click",t[20]),y(D,"click",t[21]),y(W,"click",t[22]),y(Z,"click",t[23]),y(st,"click",t[24]),y(ft,"click",t[25]),y(vt,"click",t[26]),y(At,"click",t[27]),y(_t,"click",t[28]),y(Lt,"click",t[29]),y(Ft,"click",t[30]),y(te,"click",t[31]),y(le,"click",t[32]),y(pe,"click",t[33]),y(ye,"click",t[34]),y(Pe,"click",t[35]),y(Ee,"click",t[36])],Ve=!0)},p(t,i){if(ai===(ai=li(t))&&hi?hi.p(t,i):(hi.d(1),hi=ai(t),hi&&(hi.c(),hi.m(e,null))),2304&i[0]){let e;for(ci=t[8].buttons,e=0;e<ci.length;e+=1){const n=H0(t,ci,e);ui[e]?ui[e].p(n,i):(ui[e]=Y0(n),ui[e].c(),ui[e].m(a,null))}for(;e<ui.length;e+=1)ui[e].d(1);ui.length=ci.length}(!We||256&i[0])&&C(T,"background-color",t[8].textAreaColor),(!We||256&i[0])&&qe!==(qe=t[8].textAreaColor+"")&&k(Q,qe),(!We||256&i[0])&&C(D,"background-color",t[8].backgroundColor),(!We||256&i[0])&&He!==(He=t[8].backgroundColor+"")&&k(B,He),(!We||256&i[0])&&C(W,"background-color",t[8].textColor),(!We||256&i[0])&&Xe!==(Xe=t[8].textColor+"")&&k(q,Xe),(!We||256&i[0])&&C(Z,"background-color",t[8].borderColor),(!We||256&i[0])&&Fe!==(Fe=t[8].borderColor+"")&&k(Y,Fe),(!We||256&i[0])&&C(st,"background-color",t[8].functionColor),(!We||256&i[0])&&Ze!==(Ze=t[8].functionColor+"")&&k(at,Ze),(!We||256&i[0])&&C(ft,"background-color",t[8].stringColor),(!We||256&i[0])&&Ge!==(Ge=t[8].stringColor+"")&&k(gt,Ge),(!We||256&i[0])&&C(vt,"background-color",t[8].constantColor),(!We||256&i[0])&&Ue!==(Ue=t[8].constantColor+"")&&k(xt,Ue),(!We||256&i[0])&&C(At,"background-color",t[8].keywordColor),(!We||256&i[0])&&Ye!==(Ye=t[8].keywordColor+"")&&k(Mt,Ye),(!We||256&i[0])&&C(_t,"background-color",t[8].highlightBackgroundColor),(!We||256&i[0])&&Ke!==(Ke=t[8].highlightBackgroundColor+"")&&k(Nt,Ke),(!We||256&i[0])&&C(Lt,"background-color",t[8].selectionColor),(!We||256&i[0])&&Je!==(Je=t[8].selectionColor+"")&&k(jt,Je),(!We||256&i[0])&&C(Ft,"background-color",t[8].Cyan),(!We||256&i[0])&&ti!==(ti=t[8].Cyan+"")&&k(Ut,ti),(!We||256&i[0])&&C(te,"background-color",t[8].Green),(!We||256&i[0])&&ei!==(ei=t[8].Green+"")&&k(ne,ei),(!We||256&i[0])&&C(le,"background-color",t[8].Orange),(!We||256&i[0])&&ii!==(ii=t[8].Orange+"")&&k(ce,ii),(!We||256&i[0])&&C(pe,"background-color",t[8].Pink),(!We||256&i[0])&&ni!==(ni=t[8].Pink+"")&&k(be,ni),(!We||256&i[0])&&C(ye,"background-color",t[8].Purple),(!We||256&i[0])&&ri!==(ri=t[8].Purple+"")&&k(Se,ri),(!We||256&i[0])&&C(Pe,"background-color",t[8].Red),(!We||256&i[0])&&si!==(si=t[8].Red+"")&&k(Re,si),(!We||256&i[0])&&C(Ee,"background-color",t[8].Yellow),(!We||256&i[0])&&oi!==(oi=t[8].Yellow+"")&&k(Ie,oi),void 0!==t[8]?fi?(fi.p(t,i),256&i[0]&&tt(fi,1)):(fi=K0(t),fi.c(),tt(fi,1),fi.m(Le.parentNode,Le)):fi&&(K(),et(fi,1,1,(()=>{fi=null})),J())},i(t){We||(tt(fi),We=!0)},o(t){et(fi),We=!1},d(t){t&&g(e),hi.d(),t&&g(s),t&&g(o),t&&g(l),t&&g(a),m(ui,t),t&&g(h),t&&g(c),t&&g(u),t&&g(f),t&&g(ze),fi&&fi.d(t),t&&g(Le),Ve=!1,n(je)}}}async function t1(t){let e=await fetch(`http://localhost:9978/api/theme/${t}`,{method:"GET",headers:{"Content-type":"application/json"}}),i=await e.json();return i.theme.name=t,i.theme}async function e1(){let t=await fetch("http://localhost:9978/api/theme/list",{method:"GET",headers:{"Content-type":"application/json"}});return(await t.json()).themes}function i1(t,e,i){let n;o(t,SK,(t=>i(8,n=t)));let r,s,l="",a=0,h=!1,c=!1,u=!1,d="",p="Default";async function g(){"New"===p?(i(3,u=!0),f(SK,n.name=p,n)):(f(SK,n=await t1(p),n),f(SK,n.name=p,n))}function m(t,e){if(c)f(SK,n.buttons[t].color=e,n);else switch(t){case"textAreaColor":f(SK,n.textAreaColor=e,n);break;case"backgroundColor":f(SK,n.backgroundColor=e,n);break;case"textColor":f(SK,n.textColor=e,n);break;case"borderColor":f(SK,n.borderColor=e,n);break;case"Cyan":f(SK,n.Cyan=e,n);break;case"Green":f(SK,n.Green=e,n);break;case"Orange":f(SK,n.Orange=e,n);break;case"Pink":f(SK,n.Pink=e,n);break;case"Purple":f(SK,n.Purple=e,n);break;case"Red":f(SK,n.Red=e,n);break;case"Yellow":f(SK,n.Yellow=e,n);break;case"functionColor":f(SK,n.functionColor=e,n);break;case"stringColor":f(SK,n.stringColor=e,n);break;case"constantColor":f(SK,n.constantColor=e,n);break;case"keywordColor":f(SK,n.keywordColor=e,n);break;case"highlightBackgroundColor":f(SK,n.highlightBackgroundColor=e,n);break;case"selectionColor":f(SK,n.selectionColor=e,n);break;default:console.log("Invalid id.")}i(2,h=!1),c=!1}function b(t){i(0,l=t.color),i(1,a=t.id),i(2,h=!0),isNaN(a)?(c=!1,i(4,d=a),i(6,r=`${a}`)):(c=!0,i(4,d="Circle"),i(6,r=`#${a} Circle`))}async function O(){f(SK,n.name=p,n),await fetch(`http://localhost:9978/api/theme/${p}`,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(n)}),i(7,s=await e1())}_((async()=>{i(7,s=await e1())}));return[l,a,h,u,d,p,r,s,n,g,m,b,function(){i(3,u=!1),O()},O,async function(){await fetch(`http://localhost:9978/api/theme/${p}`,{method:"DELETE",headers:{"Content-type":"application/json"},body:JSON.stringify(n)}),i(7,s=await e1()),i(5,p="Default"),f(SK,n=await t1(p),n)},function(){p=this.value,i(5,p),i(7,s)},()=>{i(3,u=!0)},function(){p=T(this),i(5,p),i(7,s)},()=>{g()},(t,e)=>{b(t)},t=>{b({id:"textAreaColor",color:n.textAreaColor})},t=>{b({id:"backgroundColor",color:n.backgroundColor})},t=>{b({id:"textColor",color:n.textColor})},t=>{b({id:"borderColor",color:n.borderColor})},t=>{b({id:"functionColor",color:n.functionColor})},t=>{b({id:"stringColor",color:n.stringColor})},t=>{b({id:"constantColor",color:n.constantColor})},t=>{b({id:"keywordColor",color:n.keywordColor})},t=>{b({id:"highlightBackgroundColor",color:n.highlightBackgroundColor})},t=>{b({id:"selectionColor",color:n.selectionColor})},t=>{b({id:"Cyan",color:n.Cyan})},t=>{b({id:"Green",color:n.Green})},t=>{b({id:"Orange",color:n.Orange})},t=>{b({id:"Pink",color:n.Pink})},t=>{b({id:"Purple",color:n.Purple})},t=>{b({id:"Red",color:n.Red})},t=>{b({id:"Yellow",color:n.Yellow})},t=>{m(t.detail.data.id,t.detail.data.color)},t=>{i(2,h=!1)}]}class n1 extends lt{constructor(t){super(),ot(this,t,i1,J0,s,{},null,[-1,-1])}}function r1(t,e,i){const n=t.slice();return n[6]=e[i],n}function s1(t){let e,i,n,r,s,o,l=t[6]+"";function a(){return t[4](t[6])}return{c(){e=b("li"),i=b("span"),n=O(l),r=v(),x(i,"class","scriptName svelte-xv3rwd")},m(t,l){p(t,e,l),d(e,i),d(i,n),d(e,r),s||(o=y(i,"click",a),s=!0)},p(e,i){t=e,1&i&&l!==(l=t[6]+"")&&k(n,l)},d(t){t&&g(e),s=!1,o()}}}function o1(e){let i,n,r,s,o,l,a,h,c,u,f=e[0],w=[];for(let t=0;t<f.length;t+=1)w[t]=s1(r1(e,f,t));return{c(){i=b("div"),n=b("h2"),n.textContent="External Scripts",r=v(),s=b("ol");for(let t=0;t<w.length;t+=1)w[t].c();o=v(),l=b("div"),a=b("button"),h=O("New Script"),x(n,"class","svelte-xv3rwd"),x(s,"class","svelte-xv3rwd"),x(a,"id","new"),x(a,"class","buttonStyle svelte-xv3rwd"),x(a,"type","button"),C(a,"background-color",e[1].textAreaColor),C(a,"color",e[1].textColor),C(a,"font-name",e[1].font),C(a,"font-size",e[1].fontSize),x(l,"id","buttonRow"),x(l,"class","svelte-xv3rwd"),x(i,"id","scriptlist"),x(i,"class","svelte-xv3rwd")},m(t,f){p(t,i,f),d(i,n),d(i,r),d(i,s);for(let t=0;t<w.length;t+=1)w[t].m(s,null);d(i,o),d(i,l),d(l,a),d(a,h),c||(u=y(a,"click",e[3]),c=!0)},p(t,[e]){if(5&e){let i;for(f=t[0],i=0;i<f.length;i+=1){const n=r1(t,f,i);w[i]?w[i].p(n,e):(w[i]=s1(n),w[i].c(),w[i].m(s,null))}for(;i<w.length;i+=1)w[i].d(1);w.length=f.length}2&e&&C(a,"background-color",t[1].textAreaColor),2&e&&C(a,"color",t[1].textColor),2&e&&C(a,"font-name",t[1].font),2&e&&C(a,"font-size",t[1].fontSize)},i:t,o:t,d(t){t&&g(i),m(w,t),c=!1,u()}}}function l1(t,e,i){let n;o(t,SK,(t=>i(1,n=t)));let r=[];const s=E();function l(t){s("changeView",{view:"script",config:{script:t}})}_((async()=>{i(0,r=await async function(){let t=await fetch("http://localhost:9978/api/scripts/ext/list",{headers:{"Content-type":"application/json"}});return await t.json()}())}));return[r,n,l,function(){s("changeView",{view:"script",config:{script:"new"}})},t=>{l(t)}]}class a1 extends lt{constructor(t){super(),ot(this,t,l1,o1,s,{})}}function h1(t,e,i){const n=t.slice();return n[13]=e[i],n}function c1(t){let e,i,r,s,o,l,a,h,c,u,f,d,O,w,k,T,P,M=t[1],Q=[];for(let e=0;e<M.length;e+=1)Q[e]=u1(h1(t,M,e));return{c(){e=b("label"),e.textContent="Name of Script",i=v(),r=b("input"),s=v(),o=b("label"),o.textContent="What is the name of the Script file?",l=v(),a=b("input"),h=v(),c=b("label"),c.textContent="What is the directory for the script?",u=v(),f=b("input"),d=v(),O=b("label"),O.textContent="What is the environment for the script?",w=v(),k=b("select");for(let t=0;t<Q.length;t+=1)Q[t].c();x(e,"id","scriptName"),x(e,"for","scriptName"),x(e,"class","svelte-1vxe7fa"),x(r,"id","scriptName"),x(r,"name","scriptName"),C(r,"border-radius","5px"),C(r,"border-color","$"+t[2].borderColor),C(r,"background-color",t[2].textAreaColor),C(r,"color",t[2].textColor),C(r,"font-name",t[2].font),C(r,"font-size",t[2].fontSize),x(o,"id","scriptScript"),x(o,"for","scriptScript"),x(o,"class","svelte-1vxe7fa"),x(a,"id","scriptScript"),x(a,"name","scriptScript"),C(a,"border-radius","5px"),C(a,"border-color","$"+t[2].borderColor),C(a,"background-color",t[2].textAreaColor),C(a,"color",t[2].textColor),C(a,"font-name",t[2].font),C(a,"font-size",t[2].fontSize),x(c,"id","scriptPath"),x(c,"for","scriptPath"),x(c,"class","svelte-1vxe7fa"),x(f,"id","scriptPath"),x(f,"name","scriptPath"),C(f,"border-radius","5px"),C(f,"border-color","$"+t[2].borderColor),C(f,"background-color",t[2].textAreaColor),C(f,"color",t[2].textColor),C(f,"font-name",t[2].font),C(f,"font-size",t[2].fontSize),x(O,"id","scriptEnv"),x(O,"for","scriptEnv"),x(O,"class","svelte-1vxe7fa"),x(k,"id","scriptEnv"),x(k,"name","scriptEnv"),C(k,"border-radius","5px"),C(k,"border-color","$"+t[2].borderColor),C(k,"background-color",t[2].textAreaColor),C(k,"color",t[2].textColor),C(k,"font-name",t[2].font),C(k,"font-size",t[2].fontSize),x(k,"class","svelte-1vxe7fa"),void 0===t[0].env&&q((()=>t[10].call(k)))},m(n,g){p(n,e,g),p(n,i,g),p(n,r,g),S(r,t[0].name),p(n,s,g),p(n,o,g),p(n,l,g),p(n,a,g),S(a,t[0].script),p(n,h,g),p(n,c,g),p(n,u,g),p(n,f,g),S(f,t[0].path),p(n,d,g),p(n,O,g),p(n,w,g),p(n,k,g);for(let t=0;t<Q.length;t+=1)Q[t].m(k,null);A(k,t[0].env),T||(P=[y(r,"blur",t[3]),y(r,"input",t[7]),y(a,"blur",t[3]),y(a,"input",t[8]),y(f,"blur",t[3]),y(f,"input",t[9]),y(k,"blur",t[3]),y(k,"change",t[10])],T=!0)},p(t,e){if(4&e&&C(r,"border-color","$"+t[2].borderColor),4&e&&C(r,"background-color",t[2].textAreaColor),4&e&&C(r,"color",t[2].textColor),4&e&&C(r,"font-name",t[2].font),4&e&&C(r,"font-size",t[2].fontSize),3&e&&r.value!==t[0].name&&S(r,t[0].name),4&e&&C(a,"border-color","$"+t[2].borderColor),4&e&&C(a,"background-color",t[2].textAreaColor),4&e&&C(a,"color",t[2].textColor),4&e&&C(a,"font-name",t[2].font),4&e&&C(a,"font-size",t[2].fontSize),3&e&&a.value!==t[0].script&&S(a,t[0].script),4&e&&C(f,"border-color","$"+t[2].borderColor),4&e&&C(f,"background-color",t[2].textAreaColor),4&e&&C(f,"color",t[2].textColor),4&e&&C(f,"font-name",t[2].font),4&e&&C(f,"font-size",t[2].fontSize),3&e&&f.value!==t[0].path&&S(f,t[0].path),2&e){let i;for(M=t[1],i=0;i<M.length;i+=1){const n=h1(t,M,i);Q[i]?Q[i].p(n,e):(Q[i]=u1(n),Q[i].c(),Q[i].m(k,null))}for(;i<Q.length;i+=1)Q[i].d(1);Q.length=M.length}4&e&&C(k,"border-color","$"+t[2].borderColor),4&e&&C(k,"background-color",t[2].textAreaColor),4&e&&C(k,"color",t[2].textColor),4&e&&C(k,"font-name",t[2].font),4&e&&C(k,"font-size",t[2].fontSize),3&e&&A(k,t[0].env)},d(t){t&&g(e),t&&g(i),t&&g(r),t&&g(s),t&&g(o),t&&g(l),t&&g(a),t&&g(h),t&&g(c),t&&g(u),t&&g(f),t&&g(d),t&&g(O),t&&g(w),t&&g(k),m(Q,t),T=!1,n(P)}}}function u1(t){let e,i,n,r=t[13]+"";return{c(){e=b("option"),i=O(r),e.__value=n=t[13],e.value=e.__value},m(t,n){p(t,e,n),d(e,i)},p(t,s){2&s&&r!==(r=t[13]+"")&&k(i,r),2&s&&n!==(n=t[13])&&(e.__value=n,e.value=e.__value)},d(t){t&&g(e)}}}function f1(e){let i,r,s,o,l,a,h,c,u,f,m=void 0!==e[0]&&void 0!==e[1]&&c1(e);return{c(){i=b("div"),m&&m.c(),r=v(),s=b("div"),o=b("button"),l=O("Return"),a=v(),h=b("button"),c=O("Delete"),x(o,"class","buttonStyle svelte-1vxe7fa"),x(o,"type","button"),C(o,"border-radius","5px"),C(o,"border-color","$"+e[2].borderColor),C(o,"background-color",e[2].textAreaColor),C(o,"color",e[2].textColor),C(o,"font-name",e[2].font),C(o,"font-size",e[2].fontSize),x(h,"class","buttonStyle svelte-1vxe7fa"),x(h,"type","button"),C(h,"border-radius","5px"),C(h,"border-color","$"+e[2].borderColor),C(h,"background-color",e[2].textAreaColor),C(h,"color",e[2].textColor),C(h,"font-name",e[2].font),C(h,"font-size",e[2].fontSize),x(s,"id","buttonRow"),x(s,"class","svelte-1vxe7fa"),x(i,"id","script"),C(i,"color",e[2].textColor),C(i,"font-name",e[2].font),C(i,"font-size",e[2].fontSize),x(i,"class","svelte-1vxe7fa")},m(t,n){p(t,i,n),m&&m.m(i,null),d(i,r),d(i,s),d(s,o),d(o,l),d(s,a),d(s,h),d(h,c),u||(f=[y(o,"click",e[11]),y(h,"click",e[4])],u=!0)},p(t,[e]){void 0!==t[0]&&void 0!==t[1]?m?m.p(t,e):(m=c1(t),m.c(),m.m(i,r)):m&&(m.d(1),m=null),4&e&&C(o,"border-color","$"+t[2].borderColor),4&e&&C(o,"background-color",t[2].textAreaColor),4&e&&C(o,"color",t[2].textColor),4&e&&C(o,"font-name",t[2].font),4&e&&C(o,"font-size",t[2].fontSize),4&e&&C(h,"border-color","$"+t[2].borderColor),4&e&&C(h,"background-color",t[2].textAreaColor),4&e&&C(h,"color",t[2].textColor),4&e&&C(h,"font-name",t[2].font),4&e&&C(h,"font-size",t[2].fontSize),4&e&&C(i,"color",t[2].textColor),4&e&&C(i,"font-name",t[2].font),4&e&&C(i,"font-size",t[2].fontSize)},i:t,o:t,d(t){t&&g(i),m&&m.d(),u=!1,n(f)}}}function d1(t,e,i){let n;o(t,SK,(t=>i(2,n=t)));let r,s,{config:l}=e;const a=E();async function h(){""!==r.name&&null!==r.name&&"new"!==r.name&&await fetch(`http://localhost:9978/api/scripts/ext/${r.name}`,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(r)})}function c(){a("changeView",{view:"lists",config:{}})}_((async()=>{"new"!==l.script?i(0,r=await async function(t){let e=await fetch(`http://localhost:9978/api/scripts/ext/${t}`,{headers:{"Content-type":"application/json"}});return await e.json()}(l.script)):i(0,r={name:"new",script:"",path:"",env:""}),i(1,s=await async function(){let t=await fetch("http://localhost:9978/api/scripts/env/list",{headers:{"Content-type":"application/json"}});return await t.json()}())}));return t.$$set=t=>{"config"in t&&i(6,l=t.config)},[r,s,n,h,async function(){await fetch(`http://localhost:9978/api/scripts/ext/${r.name}`,{method:"DELETE",headers:{"Content-type":"application/json"}}),j(),c()},c,l,function(){r.name=this.value,i(0,r),i(1,s)},function(){r.script=this.value,i(0,r),i(1,s)},function(){r.path=this.value,i(0,r),i(1,s)},function(){r.env=T(this),i(0,r),i(1,s)},()=>{h(),c()}]}class p1 extends lt{constructor(t){super(),ot(this,t,d1,f1,s,{config:6})}}function g1(t){let e,i;return e=new p1({props:{config:t[1]}}),e.$on("changeView",t[3]),{c(){nt(e.$$.fragment)},m(t,n){rt(e,t,n),i=!0},p(t,i){const n={};2&i&&(n.config=t[1]),e.$set(n)},i(t){i||(tt(e.$$.fragment,t),i=!0)},o(t){et(e.$$.fragment,t),i=!1},d(t){st(e,t)}}}function m1(e){let i,n,r;return n=new a1({}),n.$on("changeView",e[3]),{c(){i=b("div"),nt(n.$$.fragment),x(i,"id","listviews"),x(i,"class","svelte-1ix4abu")},m(t,e){p(t,i,e),rt(n,i,null),r=!0},p:t,i(t){r||(tt(n.$$.fragment,t),r=!0)},o(t){et(n.$$.fragment,t),r=!1},d(t){t&&g(i),st(n)}}}function b1(t){let e,i,n,r;const s=[m1,g1],o=[];function l(t,e){return"lists"===t[0]?0:"script"===t[0]?1:-1}return~(i=l(t))&&(n=o[i]=s[i](t)),{c(){e=b("div"),n&&n.c(),x(e,"id","ExtScriptEditor"),C(e,"color",t[2].textcolor),C(e,"background-color",t[2].appBackground),x(e,"class","svelte-1ix4abu")},m(t,n){p(t,e,n),~i&&o[i].m(e,null),r=!0},p(t,[a]){let h=i;i=l(t),i===h?~i&&o[i].p(t,a):(n&&(K(),et(o[h],1,1,(()=>{o[h]=null})),J()),~i?(n=o[i],n?n.p(t,a):(n=o[i]=s[i](t),n.c()),tt(n,1),n.m(e,null)):n=null),(!r||4&a)&&C(e,"color",t[2].textcolor),(!r||4&a)&&C(e,"background-color",t[2].appBackground)},i(t){r||(tt(n),r=!0)},o(t){et(n),r=!1},d(t){t&&g(e),~i&&o[i].d()}}}function O1(t,e,i){let n;o(t,SK,(t=>i(2,n=t)));let r="lists",s={};return[r,s,n,function(t){i(0,r=t.detail.view),i(1,s=t.detail.config)}]}class v1 extends lt{constructor(t){super(),ot(this,t,O1,b1,s,{})}}function w1(t,e,i){const n=t.slice();return n[9]=e[i],n}function y1(t){let e,i,n,r,s,o,l=t[9]+"";function a(){return t[6](t[9])}return{c(){e=b("li"),i=b("span"),n=O(l),r=v(),x(i,"class","envName svelte-1xg0rtz")},m(t,l){p(t,e,l),d(e,i),d(i,n),d(e,r),s||(o=y(i,"click",a),s=!0)},p(e,i){t=e,1&i&&l!==(l=t[9]+"")&&k(n,l)},d(t){t&&g(e),s=!1,o()}}}function x1(t){let e,i,n,r;return{c(){e=b("button"),i=O("Create Default"),x(e,"id","default"),x(e,"class","buttonStyle svelte-1xg0rtz"),C(e,"background-color",t[2].textAreaColor),C(e,"color",t[2].textColor),C(e,"font-name",t[2].font),C(e,"font-size",t[2].fontSize),x(e,"type","button")},m(s,o){p(s,e,o),d(e,i),n||(r=y(e,"click",t[5]),n=!0)},p(t,i){4&i&&C(e,"background-color",t[2].textAreaColor),4&i&&C(e,"color",t[2].textColor),4&i&&C(e,"font-name",t[2].font),4&i&&C(e,"font-size",t[2].fontSize)},d(t){t&&g(e),n=!1,r()}}}function k1(e){let i,n,r,s,o,l,a,h,c,u,f,w=e[0],k=[];for(let t=0;t<w.length;t+=1)k[t]=y1(w1(e,w,t));let S=e[1]&&x1(e);return{c(){i=b("div"),n=b("h2"),n.textContent="Environments",r=v(),s=b("ol");for(let t=0;t<k.length;t+=1)k[t].c();o=v(),l=b("div"),a=b("button"),h=O("New Environment"),c=v(),S&&S.c(),x(n,"class","svelte-1xg0rtz"),x(s,"class","svelte-1xg0rtz"),x(a,"id","new"),x(a,"class","buttonStyle svelte-1xg0rtz"),C(a,"background-color",e[2].textAreaColor),C(a,"color",e[2].textColor),C(a,"font-name",e[2].font),C(a,"font-size",e[2].fontSize),x(a,"type","button"),x(l,"id","buttonRow"),x(l,"class","svelte-1xg0rtz"),x(i,"id","envlist"),x(i,"class","svelte-1xg0rtz")},m(t,g){p(t,i,g),d(i,n),d(i,r),d(i,s);for(let t=0;t<k.length;t+=1)k[t].m(s,null);d(i,o),d(i,l),d(l,a),d(a,h),d(l,c),S&&S.m(l,null),u||(f=y(a,"click",e[3]),u=!0)},p(t,[e]){if(17&e){let i;for(w=t[0],i=0;i<w.length;i+=1){const n=w1(t,w,i);k[i]?k[i].p(n,e):(k[i]=y1(n),k[i].c(),k[i].m(s,null))}for(;i<k.length;i+=1)k[i].d(1);k.length=w.length}4&e&&C(a,"background-color",t[2].textAreaColor),4&e&&C(a,"color",t[2].textColor),4&e&&C(a,"font-name",t[2].font),4&e&&C(a,"font-size",t[2].fontSize),t[1]?S?S.p(t,e):(S=x1(t),S.c(),S.m(l,null)):S&&(S.d(1),S=null)},i:t,o:t,d(t){t&&g(i),m(k,t),S&&S.d(),u=!1,f()}}}function S1(t,e,i){let n;o(t,SK,(t=>i(2,n=t)));let r=[],s=!1;const l=E();function a(t){l("changeView",{view:"env",config:{env:t}})}_((async()=>{await async function(){var t=await fetch("http://localhost:9978/api/scripts/env/list");i(0,r=await t.json())}();var t=r.filter((t=>"Default"==t));Array.isArray(t)&&0===t.length&&i(1,s=!0)}));return[r,s,n,async function(){l("changeView",{view:"env",config:{env:"new",envVar:[]}})},a,async function(){await fetch("http://localhost:9978/api/scripts/env/Default",{method:"PUT"}),l("changeView",{view:"env",config:{env:"Default"}})},t=>{a(t)}]}class C1 extends lt{constructor(t){super(),ot(this,t,S1,k1,s,{})}}function A1(t){let e,i,r,s,o,l,a,h,c,u,f,m,w;return{c(){e=b("td"),i=b("span"),i.textContent="✏️",r=v(),s=b("td"),o=b("span"),o.textContent="❌",l=v(),a=b("td"),h=O(t[0]),c=v(),u=b("td"),f=O(t[1]),x(e,"class","editTD svelte-iq93qk"),C(o,"width","10px"),C(o,"cursor","pointer"),x(s,"class","deleteTD svelte-iq93qk")},m(n,g){p(n,e,g),d(e,i),p(n,r,g),p(n,s,g),d(s,o),p(n,l,g),p(n,a,g),d(a,h),p(n,c,g),p(n,u,g),d(u,f),m||(w=[y(i,"click",t[10]),y(o,"click",t[6])],m=!0)},p(t,e){1&e&&k(h,t[0]),2&e&&k(f,t[1])},d(t){t&&g(e),t&&g(r),t&&g(s),t&&g(l),t&&g(a),t&&g(c),t&&g(u),m=!1,n(w)}}}function T1(t){let e,i,r,s,o,l,a,h,c,u;return{c(){e=b("td"),i=b("td"),r=v(),s=b("td"),o=b("input"),l=v(),a=b("td"),h=b("input"),x(o,"type","text"),C(o,"padding-left","10px"),C(o,"border-radius","10px"),C(o,"border-color",t[4].borderColor),C(o,"background-color",t[4].textAreaColor),C(o,"color",t[4].textColor),C(o,"font-family","'"+t[4].font+"'"),C(o,"font-size",t[4].fontSize),x(h,"type","text"),C(h,"padding-left","10px"),C(h,"border-radius","10px"),C(h,"border-color",t[4].borderColor),C(h,"background-color",t[4].textAreaColor),C(h,"color",t[4].textColor),C(h,"font-family",t[4].font),C(h,"font-size",t[4].fontSize)},m(n,f){p(n,e,f),p(n,i,f),p(n,r,f),p(n,s,f),d(s,o),t[7](o),S(o,t[0]),p(n,l,f),p(n,a,f),d(a,h),S(h,t[1]),c||(u=[y(o,"input",t[8]),y(h,"input",t[9]),y(h,"blur",t[5])],c=!0)},p(t,e){16&e&&C(o,"border-color",t[4].borderColor),16&e&&C(o,"background-color",t[4].textAreaColor),16&e&&C(o,"color",t[4].textColor),16&e&&C(o,"font-family","'"+t[4].font+"'"),16&e&&C(o,"font-size",t[4].fontSize),1&e&&o.value!==t[0]&&S(o,t[0]),16&e&&C(h,"border-color",t[4].borderColor),16&e&&C(h,"background-color",t[4].textAreaColor),16&e&&C(h,"color",t[4].textColor),16&e&&C(h,"font-family",t[4].font),16&e&&C(h,"font-size",t[4].fontSize),2&e&&h.value!==t[1]&&S(h,t[1])},d(o){o&&g(e),o&&g(i),o&&g(r),o&&g(s),t[7](null),o&&g(l),o&&g(a),c=!1,n(u)}}}function P1(e){let i;function n(t,e){return t[2]?T1:A1}let r=n(e),s=r(e);return{c(){i=b("tr"),s.c()},m(t,e){p(t,i,e),s.m(i,null)},p(t,[e]){r===(r=n(t))&&s?s.p(t,e):(s.d(1),s=r(t),s&&(s.c(),s.m(i,null)))},i:t,o:t,d(t){t&&g(i),s.d()}}}function M1(t,e,i){let n;o(t,SK,(t=>i(4,n=t)));const r=E();let{name:s}=e,{value:l}=e;var a,h=!1;D((()=>{h&&a.focus()}));return t.$$set=t=>{"name"in t&&i(0,s=t.name),"value"in t&&i(1,l=t.value)},[s,l,h,a,n,function(){i(2,h=!1),r("editRow",{name:s,value:l})},function(){r("deleteRow",{name:s,value:l})},function(t){B[t?"unshift":"push"]((()=>{i(3,a=t)}))},function(){s=this.value,i(0,s)},function(){l=this.value,i(1,l)},()=>{i(2,h=!0)}]}class Q1 extends lt{constructor(t){super(),ot(this,t,M1,P1,s,{name:0,value:1})}}function R1(t,e,i){const n=t.slice();return n[19]=e[i],n}function $1(t){let e,i,r,s,o,l,a,h,c,u="undefined"!==t[0].envVar&&_1(t);return{c(){e=b("div"),i=b("label"),i.textContent="Name of the Environment",r=v(),s=b("input"),o=v(),u&&u.c(),l=w(),x(i,"id","envName"),x(i,"for","envName"),x(s,"id","envName"),x(s,"name","envName"),C(s,"padding-left","10px"),C(s,"margin-top","-5px"),C(s,"margin-left","20px"),C(s,"border-radius","10px"),C(s,"border-color",t[4].borderColor),C(s,"background-color",t[4].textAreaColor),C(s,"font-family",t[4].font),C(s,"color",t[4].textColor),C(s,"font-size",t[4].fontSize),C(s,"border","solid 3px "+t[4].borderColor),C(e,"display","flex"),C(e,"flex-direction","row")},m(n,f){p(n,e,f),d(e,i),d(e,r),d(e,s),S(s,t[0].name),p(n,o,f),u&&u.m(n,f),p(n,l,f),a=!0,h||(c=[y(s,"blur",t[5]),y(s,"input",t[11])],h=!0)},p(t,e){(!a||16&e)&&C(s,"border-color",t[4].borderColor),(!a||16&e)&&C(s,"background-color",t[4].textAreaColor),(!a||16&e)&&C(s,"font-family",t[4].font),(!a||16&e)&&C(s,"color",t[4].textColor),(!a||16&e)&&C(s,"font-size",t[4].fontSize),(!a||16&e)&&C(s,"border","solid 3px "+t[4].borderColor),1&e&&s.value!==t[0].name&&S(s,t[0].name),"undefined"!==t[0].envVar?u?(u.p(t,e),1&e&&tt(u,1)):(u=_1(t),u.c(),tt(u,1),u.m(l.parentNode,l)):u&&(K(),et(u,1,1,(()=>{u=null})),J())},i(t){a||(tt(u),a=!0)},o(t){et(u),a=!1},d(t){t&&g(e),t&&g(o),u&&u.d(t),t&&g(l),h=!1,n(c)}}}function _1(t){let e,i,n,r,s,o,l,a=Object.entries(t[0].envVar).length>0,h=a&&D1(t);function c(t,e){return t[1]?B1:N1}let u=c(t),f=u(t);return{c(){e=b("div"),i=b("table"),n=b("thead"),n.innerHTML='<tr><th class="svelte-13talvl"></th> \n              <th class="svelte-13talvl"></th> \n              <th class="svelte-13talvl">Name</th> \n              <th class="svelte-13talvl">Value</th></tr>',r=v(),s=b("tbody"),h&&h.c(),o=v(),f.c(),x(e,"id","EnvTable"),x(e,"class","svelte-13talvl")},m(t,a){p(t,e,a),d(e,i),d(i,n),d(i,r),d(i,s),h&&h.m(s,null),d(s,o),f.m(s,null),l=!0},p(t,e){1&e&&(a=Object.entries(t[0].envVar).length>0),a?h?(h.p(t,e),1&e&&tt(h,1)):(h=D1(t),h.c(),tt(h,1),h.m(s,o)):h&&(K(),et(h,1,1,(()=>{h=null})),J()),u===(u=c(t))&&f?f.p(t,e):(f.d(1),f=u(t),f&&(f.c(),f.m(s,null)))},i(t){l||(tt(h),l=!0)},o(t){et(h),l=!1},d(t){t&&g(e),h&&h.d(),f.d()}}}function D1(t){let e,i,n=Object.entries(t[0].envVar),r=[];for(let e=0;e<n.length;e+=1)r[e]=E1(R1(t,n,e));const s=t=>et(r[t],1,1,(()=>{r[t]=null}));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=w()},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);p(t,e,n),i=!0},p(t,i){if(769&i){let o;for(n=Object.entries(t[0].envVar),o=0;o<n.length;o+=1){const s=R1(t,n,o);r[o]?(r[o].p(s,i),tt(r[o],1)):(r[o]=E1(s),r[o].c(),tt(r[o],1),r[o].m(e.parentNode,e))}for(K(),o=n.length;o<r.length;o+=1)s(o);J()}},i(t){if(!i){for(let t=0;t<n.length;t+=1)tt(r[t]);i=!0}},o(t){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)et(r[t]);i=!1},d(t){m(r,t),t&&g(e)}}}function E1(t){let e,i;return e=new Q1({props:{name:t[19][0],value:t[19][1]}}),e.$on("deleteRow",(function(){return t[12](t[19])})),e.$on("editRow",t[13]),{c(){nt(e.$$.fragment)},m(t,n){rt(e,t,n),i=!0},p(i,n){t=i;const r={};1&n&&(r.name=t[19][0]),1&n&&(r.value=t[19][1]),e.$set(r)},i(t){i||(tt(e.$$.fragment,t),i=!0)},o(t){et(e.$$.fragment,t),i=!1},d(t){st(e,t)}}}function N1(e){let i,n,r,s,o;return{c(){i=b("tr"),n=b("td"),r=b("span"),r.textContent="+",x(r,"class","addNewItem svelte-13talvl"),x(n,"span","2"),x(n,"class","svelte-13talvl")},m(t,l){p(t,i,l),d(i,n),d(n,r),s||(o=y(r,"click",e[16]),s=!0)},p:t,d(t){t&&g(i),s=!1,o()}}}function B1(t){let e,i,r,s,o,l,a,h,c,u;return{c(){e=b("tr"),i=b("td"),r=b("input"),o=v(),l=b("td"),a=b("input"),x(r,"class","inputKV"),x(r,"type","text"),x(r,"style",s="background-color: "+t[4].textAreaColor+"; text= "+t[4].textColor+"; font-name: "+t[4].font+"; font-size: "+t[4].fontSize+";"),x(i,"class","svelte-13talvl"),x(a,"class","inputKV"),x(a,"type","text"),x(a,"style",h="background-color: "+t[4].textAreaColor+"; text= "+t[4].textColor+"; font-name: "+t[4].font+"; font-size: "+t[4].fontSize+";"),x(l,"class","svelte-13talvl")},m(n,s){p(n,e,s),d(e,i),d(i,r),S(r,t[2]),d(e,o),d(e,l),d(l,a),S(a,t[3]),c||(u=[y(r,"input",t[14]),y(a,"input",t[15]),y(a,"blur",t[8])],c=!0)},p(t,e){16&e&&s!==(s="background-color: "+t[4].textAreaColor+"; text= "+t[4].textColor+"; font-name: "+t[4].font+"; font-size: "+t[4].fontSize+";")&&x(r,"style",s),4&e&&r.value!==t[2]&&S(r,t[2]),16&e&&h!==(h="background-color: "+t[4].textAreaColor+"; text= "+t[4].textColor+"; font-name: "+t[4].font+"; font-size: "+t[4].fontSize+";")&&x(a,"style",h),8&e&&a.value!==t[3]&&S(a,t[3])},d(t){t&&g(e),c=!1,n(u)}}}function I1(t){let e,i,r,s,o,l,a,h,c,u,f,m=void 0!==t[0]&&$1(t);return{c(){e=b("div"),m&&m.c(),i=v(),r=b("div"),s=b("button"),o=O("Return"),l=v(),a=b("button"),h=O("Delete"),x(s,"id","goback"),x(s,"class","buttonStyle svelte-13talvl"),x(s,"type","button"),C(s,"background-color",t[4].textAreaColor),C(s,"color",t[4].textColor),C(s,"font-name",t[4].font),C(s,"font-size",t[4].fontSize),x(a,"class","buttonStyle svelte-13talvl"),x(a,"type","button"),C(a,"background-color",t[4].textAreaColor),C(a,"color",t[4].textColor),C(a,"font-name",t[4].font),C(a,"font-size",t[4].fontSize),x(r,"id","buttonRow"),x(r,"class","svelte-13talvl"),x(e,"id","env"),C(e,"color",t[4].textColor),C(e,"background-color",t[4].textareaColor),x(e,"class","svelte-13talvl")},m(n,g){p(n,e,g),m&&m.m(e,null),d(e,i),d(e,r),d(r,s),d(s,o),d(r,l),d(r,a),d(a,h),c=!0,u||(f=[y(s,"click",t[17]),y(a,"click",t[6])],u=!0)},p(t,[n]){void 0!==t[0]?m?(m.p(t,n),1&n&&tt(m,1)):(m=$1(t),m.c(),tt(m,1),m.m(e,i)):m&&(K(),et(m,1,1,(()=>{m=null})),J()),(!c||16&n)&&C(s,"background-color",t[4].textAreaColor),(!c||16&n)&&C(s,"color",t[4].textColor),(!c||16&n)&&C(s,"font-name",t[4].font),(!c||16&n)&&C(s,"font-size",t[4].fontSize),(!c||16&n)&&C(a,"background-color",t[4].textAreaColor),(!c||16&n)&&C(a,"color",t[4].textColor),(!c||16&n)&&C(a,"font-name",t[4].font),(!c||16&n)&&C(a,"font-size",t[4].fontSize),(!c||16&n)&&C(e,"color",t[4].textColor),(!c||16&n)&&C(e,"background-color",t[4].textareaColor)},i(t){c||(tt(m),c=!0)},o(t){et(m),c=!1},d(t){t&&g(e),m&&m.d(),u=!1,n(f)}}}async function z1(t){var e=await fetch(`http://localhost:9978/api/scripts/env/${t}`);return await e.json()}function L1(t,e,i){let n;o(t,SK,(t=>i(4,n=t)));let r,{config:s}=e,l=!1,a="",h="";const c=E();async function u(){null!=r&&""!==r.name&&null!==r.name&&"new"!==r.name&&await async function(t){await fetch(`http://localhost:9978/api/scripts/env/${t.name}`,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(t)})}(r)}function f(){c("changeView",{view:"lists",config:{}})}async function d(){i(0,r.envVar[a]=h,r),i(1,l=!1),i(2,a=""),i(3,h=""),await u()}async function p(t){delete r.envVar[t[0]],await u(),i(0,r=await z1(s.env))}_((async()=>{void 0!==s.env&&("new"!==s.env&&null!==s.env?("default"===s.env&&i(10,s.env="Default",s),i(0,r=await z1(s.env))):i(0,r={name:"new",envVar:{}}))}));return t.$$set=t=>{"config"in t&&i(10,s=t.config)},[r,l,a,h,n,u,async function(){void 0!==r&&null!==r.name&&"new"!==r.name&&""!==r.name&&(await async function(t){await fetch(`http://localhost:9978/api/scripts/env/${t}`,{method:"DELETE"})}(r.name),j(),f())},f,d,p,s,function(){r.name=this.value,i(0,r)},t=>{p(t)},t=>{i(0,r.envVar[t.detail.name]=t.detail.value,r),d()},function(){a=this.value,i(2,a)},function(){h=this.value,i(3,h)},()=>{i(1,l=!0)},()=>{u(),f()}]}class W1 extends lt{constructor(t){super(),ot(this,t,L1,I1,s,{config:10})}}function V1(t){let e,i;return e=new W1({props:{config:t[1]}}),e.$on("changeView",t[3]),{c(){nt(e.$$.fragment)},m(t,n){rt(e,t,n),i=!0},p(t,i){const n={};2&i&&(n.config=t[1]),e.$set(n)},i(t){i||(tt(e.$$.fragment,t),i=!0)},o(t){et(e.$$.fragment,t),i=!1},d(t){st(e,t)}}}function j1(e){let i,n,r;return n=new C1({}),n.$on("changeView",e[3]),{c(){i=b("div"),nt(n.$$.fragment),x(i,"id","listviews"),x(i,"class","svelte-gorzvb")},m(t,e){p(t,i,e),rt(n,i,null),r=!0},p:t,i(t){r||(tt(n.$$.fragment,t),r=!0)},o(t){et(n.$$.fragment,t),r=!1},d(t){t&&g(i),st(n)}}}function q1(t){let e,i,n,r;const s=[j1,V1],o=[];function l(t,e){return"lists"===t[0]?0:"env"===t[0]?1:-1}return~(i=l(t))&&(n=o[i]=s[i](t)),{c(){e=b("div"),n&&n.c(),x(e,"id","EnvEditor"),C(e,"color",t[2].textColor),C(e,"background-color",t[2].backgroundColor),x(e,"class","svelte-gorzvb")},m(t,n){p(t,e,n),~i&&o[i].m(e,null),r=!0},p(t,[a]){let h=i;i=l(t),i===h?~i&&o[i].p(t,a):(n&&(K(),et(o[h],1,1,(()=>{o[h]=null})),J()),~i?(n=o[i],n?n.p(t,a):(n=o[i]=s[i](t),n.c()),tt(n,1),n.m(e,null)):n=null),(!r||4&a)&&C(e,"color",t[2].textColor),(!r||4&a)&&C(e,"background-color",t[2].backgroundColor)},i(t){r||(tt(n),r=!0)},o(t){et(n),r=!1},d(t){t&&g(e),~i&&o[i].d()}}}function H1(t,e,i){let n;o(t,SK,(t=>i(2,n=t)));let r="lists",s={env:"Default"};return[r,s,n,function(t){i(0,r=t.detail.view),i(1,s=t.detail.config)}]}class X1 extends lt{constructor(t){super(),ot(this,t,H1,q1,s,{})}}function F1(t,e,i){const n=t.slice();return n[10]=e[i],n}function Z1(t){let e,i,n,r,s,o=t[10].name+"";function l(){return t[6](t[10])}return{c(){e=b("li"),i=O(o),n=v(),x(e,"class","tabName svelte-1c0xrvo"),C(e,"border-color","gray")},m(t,o){p(t,e,o),d(e,i),d(e,n),r||(s=y(e,"click",l),r=!0)},p(e,i){t=e},d(t){t&&g(e),r=!1,s()}}}function G1(t){let e,i,n,r=t[10].name+"";return{c(){e=b("li"),i=O(r),n=v(),x(e,"class","tabName svelte-1c0xrvo"),C(e,"border-bottom","3px "+t[1].backgroundColor),C(e,"z-index","100")},m(t,r){p(t,e,r),d(e,i),d(e,n)},p(t,i){2&i&&C(e,"border-bottom","3px "+t[1].backgroundColor)},d(t){t&&g(e)}}}function U1(t){let e;function i(t,e){return t[10].name===t[0]?G1:Z1}let n=i(t),r=n(t);return{c(){r.c(),e=w()},m(t,i){r.m(t,i),p(t,e,i)},p(t,s){n===(n=i(t))&&r?r.p(t,s):(r.d(1),r=n(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&g(e)}}}function Y1(t){let e,i;return e=new X1({}),{c(){nt(e.$$.fragment)},m(t,n){rt(e,t,n),i=!0},i(t){i||(tt(e.$$.fragment,t),i=!0)},o(t){et(e.$$.fragment,t),i=!1},d(t){st(e,t)}}}function K1(t){let e,i;return e=new v1({}),{c(){nt(e.$$.fragment)},m(t,n){rt(e,t,n),i=!0},i(t){i||(tt(e.$$.fragment,t),i=!0)},o(t){et(e.$$.fragment,t),i=!1},d(t){st(e,t)}}}function J1(t){let e,i;return e=new N0({}),{c(){nt(e.$$.fragment)},m(t,n){rt(e,t,n),i=!0},i(t){i||(tt(e.$$.fragment,t),i=!0)},o(t){et(e.$$.fragment,t),i=!1},d(t){st(e,t)}}}function t2(t){let e,i;return e=new n1({}),{c(){nt(e.$$.fragment)},m(t,n){rt(e,t,n),i=!0},i(t){i||(tt(e.$$.fragment,t),i=!0)},o(t){et(e.$$.fragment,t),i=!1},d(t){st(e,t)}}}function e2(t){let e,i;return e=new z0({}),{c(){nt(e.$$.fragment)},m(t,n){rt(e,t,n),i=!0},i(t){i||(tt(e.$$.fragment,t),i=!0)},o(t){et(e.$$.fragment,t),i=!1},d(t){st(e,t)}}}function i2(t){let e,i,r,s,o,l,a,h,c,u,f,w,k,S,A,T,P=t[2],M=[];for(let e=0;e<P.length;e+=1)M[e]=U1(F1(t,P,e));const Q=[e2,t2,J1,K1,Y1],R=[];function $(t,e){return"General"===t[0]?0:"Theme"===t[0]?1:"Node-Red"===t[0]?2:"External Scripts"===t[0]?3:"Environments"===t[0]?4:-1}return~(o=$(t))&&(l=R[o]=Q[o](t)),{c(){e=b("div"),i=b("ul");for(let t=0;t<M.length;t+=1)M[t].c();r=v(),s=b("div"),l&&l.c(),a=v(),h=b("div"),c=b("button"),u=O("EmailIt+"),f=v(),w=b("button"),k=O("Notes"),x(i,"id","tabs"),x(i,"class","svelte-1c0xrvo"),x(s,"id","prefListWrap"),x(s,"class","svelte-1c0xrvo"),C(c,"background-color",t[1].textAreaColor),C(c,"font-family",t[1].font),C(c,"color",t[1].textColor),C(c,"font-size",t[1].fontSize),x(c,"class","svelte-1c0xrvo"),C(w,"background-color",t[1].textAreaColor),C(w,"font-family",t[1].font),C(w,"color",t[1].textColor),C(w,"font-size",t[1].fontSize),x(w,"class","svelte-1c0xrvo"),x(h,"id","buttonPanel"),x(h,"class","svelte-1c0xrvo"),x(e,"id","PreferencePanel"),C(e,"background-color",t[1].backgroundColor),C(e,"font-family",t[1].font),C(e,"color",t[1].textColor),C(e,"font-size",t[1].fontSize),x(e,"class","svelte-1c0xrvo")},m(n,l){p(n,e,l),d(e,i);for(let t=0;t<M.length;t+=1)M[t].m(i,null);d(e,r),d(e,s),~o&&R[o].m(s,null),d(e,a),d(e,h),d(h,c),d(c,u),d(h,f),d(h,w),d(w,k),S=!0,A||(T=[y(c,"click",t[7]),y(w,"click",t[8])],A=!0)},p(t,[n]){if(15&n){let e;for(P=t[2],e=0;e<P.length;e+=1){const r=F1(t,P,e);M[e]?M[e].p(r,n):(M[e]=U1(r),M[e].c(),M[e].m(i,null))}for(;e<M.length;e+=1)M[e].d(1);M.length=P.length}let r=o;o=$(t),o!==r&&(l&&(K(),et(R[r],1,1,(()=>{R[r]=null})),J()),~o?(l=R[o],l||(l=R[o]=Q[o](t),l.c()),tt(l,1),l.m(s,null)):l=null),(!S||2&n)&&C(c,"background-color",t[1].textAreaColor),(!S||2&n)&&C(c,"font-family",t[1].font),(!S||2&n)&&C(c,"color",t[1].textColor),(!S||2&n)&&C(c,"font-size",t[1].fontSize),(!S||2&n)&&C(w,"background-color",t[1].textAreaColor),(!S||2&n)&&C(w,"font-family",t[1].font),(!S||2&n)&&C(w,"color",t[1].textColor),(!S||2&n)&&C(w,"font-size",t[1].fontSize),(!S||2&n)&&C(e,"background-color",t[1].backgroundColor),(!S||2&n)&&C(e,"font-family",t[1].font),(!S||2&n)&&C(e,"color",t[1].textColor),(!S||2&n)&&C(e,"font-size",t[1].fontSize)},i(t){S||(tt(l),S=!0)},o(t){et(l),S=!1},d(t){t&&g(e),m(M,t),~o&&R[o].d(),A=!1,n(T)}}}function n2(t,e,i){let n,r;o(t,IK,(t=>i(9,n=t))),o(t,SK,(t=>i(1,r=t)));let s="General";function l(t){i(0,s=t)}function a(){f(IK,n="emailit",n)}function h(){f(IK,n="notes",n)}return[s,r,[{name:"General"},{name:"Theme"},{name:"Node-Red"},{name:"External Scripts"},{name:"Environments"}],l,a,h,t=>{l(t.name)},()=>{a()},t=>{h()}]}class r2 extends lt{constructor(t){super(),ot(this,t,n2,i2,s,{})}}function s2(t){let e,i;return e=new r2({}),{c(){nt(e.$$.fragment)},m(t,n){rt(e,t,n),i=!0},i(t){i||(tt(e.$$.fragment,t),i=!0)},o(t){et(e.$$.fragment,t),i=!1},d(t){st(e,t)}}}function o2(t){let e,i;return e=new _0({}),{c(){nt(e.$$.fragment)},m(t,n){rt(e,t,n),i=!0},i(t){i||(tt(e.$$.fragment,t),i=!0)},o(t){et(e.$$.fragment,t),i=!1},d(t){st(e,t)}}}function l2(t){let e,i;return e=new M0({}),{c(){nt(e.$$.fragment)},m(t,n){rt(e,t,n),i=!0},i(t){i||(tt(e.$$.fragment,t),i=!0)},o(t){et(e.$$.fragment,t),i=!1},d(t){st(e,t)}}}function a2(t){let e,i;return e=new MJ({}),{c(){nt(e.$$.fragment)},m(t,n){rt(e,t,n),i=!0},i(t){i||(tt(e.$$.fragment,t),i=!0)},o(t){et(e.$$.fragment,t),i=!1},d(t){st(e,t)}}}function h2(t){let e,i;return e=new wJ({}),{c(){nt(e.$$.fragment)},m(t,n){rt(e,t,n),i=!0},i(t){i||(tt(e.$$.fragment,t),i=!0)},o(t){et(e.$$.fragment,t),i=!1},d(t){st(e,t)}}}function c2(t){let e,i;return e=new pJ({}),{c(){nt(e.$$.fragment)},m(t,n){rt(e,t,n),i=!0},i(t){i||(tt(e.$$.fragment,t),i=!0)},o(t){et(e.$$.fragment,t),i=!1},d(t){st(e,t)}}}function u2(t){let e,i,n,r,s,o,l,a,h,c,u;const f=[c2,h2,a2,l2,o2,s2],d=[];function m(t,e){return"emailit"===t[0]?0:"viewlog"===t[0]?1:"notes"===t[0]?2:"scripts"===t[0]?3:"templates"===t[0]?4:"preferences"===t[0]?5:-1}return~(n=m(t))&&(r=d[n]=f[n](t)),o=new IJ({}),a=new HJ({}),{c(){e=b("div"),i=v(),r&&r.c(),s=v(),nt(o.$$.fragment),l=v(),nt(a.$$.fragment),x(e,"id","dragbar"),x(e,"data-wails-drag",""),x(e,"class","svelte-wpwr83")},m(r,f){p(r,e,f),p(r,i,f),~n&&d[n].m(r,f),p(r,s,f),rt(o,r,f),p(r,l,f),rt(a,r,f),h=!0,c||(u=y(window,"keydown",t[1]),c=!0)},p(t,[e]){let i=n;n=m(t),n!==i&&(r&&(K(),et(d[i],1,1,(()=>{d[i]=null})),J()),~n?(r=d[n],r||(r=d[n]=f[n](t),r.c()),tt(r,1),r.m(s.parentNode,s)):r=null)},i(t){h||(tt(r),tt(o.$$.fragment,t),tt(a.$$.fragment,t),h=!0)},o(t){et(r),et(o.$$.fragment,t),et(a.$$.fragment,t),h=!1},d(t){t&&g(e),t&&g(i),~n&&d[n].d(t),t&&g(s),st(o,t),t&&g(l),st(a,t),c=!1,u()}}}function f2(t,e,i){let n,r,s,l,a,h;return o(t,IK,(t=>i(0,n=t))),o(t,qK,(t=>i(3,r=t))),o(t,jK,(t=>i(4,s=t))),o(t,zJ,(t=>i(5,l=t))),o(t,QJ,(t=>i(6,a=t))),o(t,SK,(t=>i(7,h=t))),_((()=>{fetch("http://localhost:9978/api/scripts/list",{method:"GET",headers:{"Content-type":"application/json"}}).then((t=>t.json())).then((t=>{f(QJ,a=t.data,a),"undefined"!=typeof callback&&callback()})),fetch("http://localhost:9978/api/template/list",{method:"GET",headers:{"Content-type":"application/json"}}).then((t=>t.json())).then((t=>{f(zJ,l=t.templates,l),"undefined"!=typeof callback&&callback()})),fetch("http://localhost:9978/api/theme",{method:"GET",headers:{"Content-type":"application/json"}}).then((t=>t.json())).then((t=>{f(SK,h=t.theme,h),"undefined"!=typeof callback&&callback()}))})),D((()=>{})),[n,function(t){if(t.metaKey&&","===t.key)t.preventDefault(),f(IK,n="preferences",n);else if(t.ctrlKey)switch(t.key){case"e":f(IK,n="emailit",n),t.preventDefault();break;case"v":f(IK,n="viewlog",n),t.preventDefault();break;case"n":f(IK,n="notes",n),t.preventDefault();break;case"m":f(jK,s=!s,s),t.preventDefault();break;case"t":f(qK,r=!r,r),t.preventDefault();break;case"p":f(IK,n="preferences",n),t.preventDefault()}}]}return new class extends lt{constructor(t){super(),ot(this,t,f2,u2,s,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
